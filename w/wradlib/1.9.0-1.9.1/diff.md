# Comparing `tmp/wradlib-1.9.0.tar.gz` & `tmp/wradlib-1.9.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/wradlib-1.9.0.tar", last modified: Wed Nov 25 13:18:01 2020, max compression
+gzip compressed data, was "wradlib-1.9.1.tar", last modified: Tue Mar  2 07:49:14 2021, max compression
```

## Comparing `wradlib-1.9.0.tar` & `wradlib-1.9.1.tar`

### file list

```diff
@@ -1,77 +1,77 @@
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/
--rw-rw-r--   0 travis    (2000) travis    (2000)     2198 2020-11-25 13:10:52.000000 wradlib-1.9.0/CONTRIBUTING.md
--rw-rw-r--   0 travis    (2000) travis    (2000)      438 2020-11-25 13:10:52.000000 wradlib-1.9.0/CONTRIBUTORS.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)     1089 2020-11-25 13:10:52.000000 wradlib-1.9.0/LICENSE.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)      243 2020-11-25 13:10:52.000000 wradlib-1.9.0/MANIFEST.in
--rw-rw-r--   0 travis    (2000) travis    (2000)     1540 2020-11-25 13:18:01.000000 wradlib-1.9.0/PKG-INFO
--rw-rw-r--   0 travis    (2000) travis    (2000)     3414 2020-11-25 13:10:52.000000 wradlib-1.9.0/README.md
--rw-rw-r--   0 travis    (2000) travis    (2000)       59 2020-11-25 13:10:52.000000 wradlib-1.9.0/pyproject.toml
--rw-rw-r--   0 travis    (2000) travis    (2000)       88 2020-11-25 13:10:52.000000 wradlib-1.9.0/requirements.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)       80 2020-11-25 13:10:52.000000 wradlib-1.9.0/requirements_devel.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)      266 2020-11-25 13:18:01.000000 wradlib-1.9.0/setup.cfg
--rw-rw-r--   0 travis    (2000) travis    (2000)     6172 2020-11-25 13:10:52.000000 wradlib-1.9.0/setup.py
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib/
--rw-rw-r--   0 travis    (2000) travis    (2000)     1449 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/__init__.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    34188 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/adjust.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    25035 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/atten.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6292 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/classify.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    20541 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/clutter.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6074 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/comp.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    19168 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/dp.py
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib/georef/
--rw-rw-r--   0 travis    (2000) travis    (2000)      786 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/__init__.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     4427 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/misc.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    24507 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/polar.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    14745 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/projection.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    19688 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/raster.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    11907 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/rect.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     3810 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/satellite.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    10632 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/vector.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6299 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/georef/xarray.py
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib/io/
--rw-rw-r--   0 travis    (2000) travis    (2000)      910 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/__init__.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     5293 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/dem.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     4842 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/gdal.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    23091 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/hdf.py
--rw-rw-r--   0 travis    (2000) travis    (2000)   111001 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/iris.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6503 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/misc.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     7081 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/netcdf.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    29356 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/radolan.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    10674 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/rainbow.py
--rw-rw-r--   0 travis    (2000) travis    (2000)   124739 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/io/xarray.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    56185 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/ipol.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     7768 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/qual.py
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib/tests/
--rw-rw-r--   0 travis    (2000) travis    (2000)      398 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/__init__.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     7916 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_adjust.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     5562 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_atten.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     3558 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_classify.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     5349 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_clutter.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6253 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_comp.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    10308 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_dp.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    49145 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_georef.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    64490 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_io.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    36837 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_io_odim.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    17481 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_ipol.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     3352 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_qual.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     2010 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_trafo.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    14801 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_util.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     3149 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_verify.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     8939 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_vis.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     4626 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_vpr.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    23708 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_zonalstats.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     5268 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/tests/test_zr.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    10397 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/trafo.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    29438 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/util.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     8292 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/verify.py
--rw-rw-r--   0 travis    (2000) travis    (2000)      200 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib/version.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    47423 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/vis.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    21888 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/vpr.py
--rw-rw-r--   0 travis    (2000) travis    (2000)    39324 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/zonalstats.py
--rw-rw-r--   0 travis    (2000) travis    (2000)     6429 2020-11-25 13:10:52.000000 wradlib-1.9.0/wradlib/zr.py
-drwxrwxr-x   0 travis    (2000) travis    (2000)        0 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/
--rw-rw-r--   0 travis    (2000) travis    (2000)     1540 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/PKG-INFO
--rw-rw-r--   0 travis    (2000) travis    (2000)     1545 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/SOURCES.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)        1 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/dependency_links.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)      175 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/requires.txt
--rw-rw-r--   0 travis    (2000) travis    (2000)        8 2020-11-25 13:18:01.000000 wradlib-1.9.0/wradlib.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.335599 wradlib-1.9.1/
+-rw-r--r--   0 runner    (1001) docker     (116)     2198 2021-03-02 07:49:05.000000 wradlib-1.9.1/CONTRIBUTING.md
+-rw-r--r--   0 runner    (1001) docker     (116)      438 2021-03-02 07:49:05.000000 wradlib-1.9.1/CONTRIBUTORS.txt
+-rw-r--r--   0 runner    (1001) docker     (116)     1089 2021-03-02 07:49:05.000000 wradlib-1.9.1/LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (116)      243 2021-03-02 07:49:05.000000 wradlib-1.9.1/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (116)     1540 2021-03-02 07:49:14.335599 wradlib-1.9.1/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (116)     2893 2021-03-02 07:49:05.000000 wradlib-1.9.1/README.md
+-rw-r--r--   0 runner    (1001) docker     (116)       59 2021-03-02 07:49:05.000000 wradlib-1.9.1/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (116)       88 2021-03-02 07:49:05.000000 wradlib-1.9.1/requirements.txt
+-rw-r--r--   0 runner    (1001) docker     (116)       87 2021-03-02 07:49:05.000000 wradlib-1.9.1/requirements_devel.txt
+-rw-r--r--   0 runner    (1001) docker     (116)      266 2021-03-02 07:49:14.335599 wradlib-1.9.1/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (116)     6172 2021-03-02 07:49:05.000000 wradlib-1.9.1/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.327599 wradlib-1.9.1/wradlib/
+-rw-r--r--   0 runner    (1001) docker     (116)     1449 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (116)    34188 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/adjust.py
+-rw-r--r--   0 runner    (1001) docker     (116)    25040 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/atten.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6293 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/classify.py
+-rw-r--r--   0 runner    (1001) docker     (116)    20541 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/clutter.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6074 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/comp.py
+-rw-r--r--   0 runner    (1001) docker     (116)    19168 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/dp.py
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.331599 wradlib-1.9.1/wradlib/georef/
+-rw-r--r--   0 runner    (1001) docker     (116)      786 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (116)     4427 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/misc.py
+-rw-r--r--   0 runner    (1001) docker     (116)    24509 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/polar.py
+-rw-r--r--   0 runner    (1001) docker     (116)    14749 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/projection.py
+-rw-r--r--   0 runner    (1001) docker     (116)    19688 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/raster.py
+-rw-r--r--   0 runner    (1001) docker     (116)    11907 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/rect.py
+-rw-r--r--   0 runner    (1001) docker     (116)     3810 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/satellite.py
+-rw-r--r--   0 runner    (1001) docker     (116)    10632 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/vector.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6299 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/georef/xarray.py
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.331599 wradlib-1.9.1/wradlib/io/
+-rw-r--r--   0 runner    (1001) docker     (116)      910 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (116)     4676 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/dem.py
+-rw-r--r--   0 runner    (1001) docker     (116)     4842 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/gdal.py
+-rw-r--r--   0 runner    (1001) docker     (116)    23091 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/hdf.py
+-rw-r--r--   0 runner    (1001) docker     (116)   111001 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/iris.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6503 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/misc.py
+-rw-r--r--   0 runner    (1001) docker     (116)     7081 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/netcdf.py
+-rw-r--r--   0 runner    (1001) docker     (116)    29359 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/radolan.py
+-rw-r--r--   0 runner    (1001) docker     (116)    10674 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/rainbow.py
+-rw-r--r--   0 runner    (1001) docker     (116)   125130 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/io/xarray.py
+-rw-r--r--   0 runner    (1001) docker     (116)    56390 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/ipol.py
+-rw-r--r--   0 runner    (1001) docker     (116)     7768 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/qual.py
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.335599 wradlib-1.9.1/wradlib/tests/
+-rw-r--r--   0 runner    (1001) docker     (116)      626 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (116)     7916 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_adjust.py
+-rw-r--r--   0 runner    (1001) docker     (116)     5562 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_atten.py
+-rw-r--r--   0 runner    (1001) docker     (116)     3558 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_classify.py
+-rw-r--r--   0 runner    (1001) docker     (116)     5349 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_clutter.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6253 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_comp.py
+-rw-r--r--   0 runner    (1001) docker     (116)    10309 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_dp.py
+-rw-r--r--   0 runner    (1001) docker     (116)    49133 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_georef.py
+-rw-r--r--   0 runner    (1001) docker     (116)    64443 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_io.py
+-rw-r--r--   0 runner    (1001) docker     (116)    36840 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_io_odim.py
+-rw-r--r--   0 runner    (1001) docker     (116)    17481 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_ipol.py
+-rw-r--r--   0 runner    (1001) docker     (116)     3356 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_qual.py
+-rw-r--r--   0 runner    (1001) docker     (116)     2010 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_trafo.py
+-rw-r--r--   0 runner    (1001) docker     (116)    14803 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_util.py
+-rw-r--r--   0 runner    (1001) docker     (116)     3149 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_verify.py
+-rw-r--r--   0 runner    (1001) docker     (116)     9158 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_vis.py
+-rw-r--r--   0 runner    (1001) docker     (116)     4626 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_vpr.py
+-rw-r--r--   0 runner    (1001) docker     (116)    24114 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_zonalstats.py
+-rw-r--r--   0 runner    (1001) docker     (116)     5268 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/tests/test_zr.py
+-rw-r--r--   0 runner    (1001) docker     (116)    10397 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/trafo.py
+-rw-r--r--   0 runner    (1001) docker     (116)    29438 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/util.py
+-rw-r--r--   0 runner    (1001) docker     (116)     8292 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/verify.py
+-rw-r--r--   0 runner    (1001) docker     (116)      200 2021-03-02 07:49:13.000000 wradlib-1.9.1/wradlib/version.py
+-rw-r--r--   0 runner    (1001) docker     (116)    47401 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/vis.py
+-rw-r--r--   0 runner    (1001) docker     (116)    22244 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/vpr.py
+-rw-r--r--   0 runner    (1001) docker     (116)    39325 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/zonalstats.py
+-rw-r--r--   0 runner    (1001) docker     (116)     6429 2021-03-02 07:49:05.000000 wradlib-1.9.1/wradlib/zr.py
+drwxr-xr-x   0 runner    (1001) docker     (116)        0 2021-03-02 07:49:14.331599 wradlib-1.9.1/wradlib.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (116)     1540 2021-03-02 07:49:14.000000 wradlib-1.9.1/wradlib.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (116)     1545 2021-03-02 07:49:14.000000 wradlib-1.9.1/wradlib.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (116)        1 2021-03-02 07:49:14.000000 wradlib-1.9.1/wradlib.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (116)      182 2021-03-02 07:49:14.000000 wradlib-1.9.1/wradlib.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (116)        8 2021-03-02 07:49:14.000000 wradlib-1.9.1/wradlib.egg-info/top_level.txt
```

### filetype from file(1)

```diff
@@ -1 +1 @@
-POSIX tar archive (GNU)
+POSIX tar archive
```

### Comparing `wradlib-1.9.0/CONTRIBUTING.md` & `wradlib-1.9.1/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/LICENSE.txt` & `wradlib-1.9.1/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/PKG-INFO` & `wradlib-1.9.1/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: wradlib
-Version: 1.9.0
+Version: 1.9.1
 Summary: wradlib - An Open Source Library for Weather Radar Data Processing
 Home-page: http://wradlib.org
 Maintainer: wradlib developers
 Maintainer-email: wradlib@wradlib.org
 License: MIT
 Download-URL: https://github.com/wradlib/wradlib
 Description: wradlib is designed to assist you in the most important steps of
```

### Comparing `wradlib-1.9.0/README.md` & `wradlib-1.9.1/README.md`

 * *Files 8% similar despite different names*

```diff
@@ -1,24 +1,22 @@
 # README #
 
 [![Join the chat at https://gitter.im/wradlib/wradlib](https://badges.gitter.im/wradlib/wradlib.svg)](https://gitter.im/wradlib/wradlib?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
 
 **To anyone who wants to use a bleeding edge version of wradlib from this repository:**
 
-wradlib uses the Cloud Services [Travis CI](https://travis-ci.com/), [Appveyor](https://www.appveyor.com/) and [Azure Pipelines](https://azure.microsoft.com/de-de/services/devops/pipelines/) for Continuous Integration. This means that once new code is pushed to the wradlib repository, a suite of tests and checks are run. In case the tests run without failure, a new documentation will be built on readthedocs and is available at the [wradlib documentation website](https://docs.wradlib.org).
+wradlib uses Github Actions for Continuous Integration. This means that once new code is pushed to the wradlib repository, a suite of tests and checks are run. In case the tests run without failure, a new documentation will be built on readthedocs and is available at the [wradlib documentation website](https://docs.wradlib.org).
 
 Below you see the status of wradlib. A green status indicates that the current revision of wradlib did pass the tests successfully. You should be aware of that a green status is not a guarantee that the latest revision is bug free. It just means that our tests did not find any bugs. Also the status of code coverage, of ReadTheDocs documentation builds and of availability of wradlib conda package is displayed.
 
 ## Package Status ##
 
 | Item  | Status  |
 |:---:|:---:|
-| Travis CI | [![Build Status](https://travis-ci.com/wradlib/wradlib.svg?branch=master)](https://travis-ci.com/github/wradlib/wradlib) |
-| Appveyor | [![Build status](https://ci.appveyor.com/api/projects/status/7x7xs1t6hg9m3h2b?svg=true)](https://ci.appveyor.com/project/wradlib/wradlib) |
-| Azure | [![Build Status](https://dev.azure.com/wradlib/wradlib/_apis/build/status/wradlib.wradlib?branchName=master)](https://dev.azure.com/wradlib/wradlib/_build/latest?definitionId=1&branchName=master) |
+| Github Actions | [![Build Status](https://github.com/wradlib/wradlib/workflows/CI/badge.svg)](https://github.com/wradlib/wradlib/actions) |
 | Codecov | [![codecov](https://codecov.io/gh/wradlib/wradlib/branch/master/graph/badge.svg)](https://codecov.io/gh/wradlib/wradlib) |
 | RTD Latest | [![ReadTheDocs Latest](https://readthedocs.org/projects/wradlib-docs/badge/?version=latest)](https://docs.wradlib.org/en/latest/) |
 | RTD Stable | [![ReadTheDocs Stable](https://readthedocs.org/projects/wradlib-docs/badge/?version=stable)](https://docs.wradlib.org/en/stable/) |
 | Anaconda Latest | [![Anaconda Latest](https://anaconda.org/conda-forge/wradlib/badges/latest_release_date.svg)](https://anaconda.org/conda-forge/wradlib/) |
 | Anaconda Version | [![Anaconda Status](https://anaconda.org/conda-forge/wradlib/badges/version.svg)](https://anaconda.org/conda-forge/wradlib/) |
 
 ### Documentation ###
```

### Comparing `wradlib-1.9.0/setup.py` & `wradlib-1.9.1/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -47,15 +47,15 @@
 URL = "http://wradlib.org"
 DOWNLOAD_URL = "https://github.com/wradlib/wradlib"
 LICENSE = "MIT"
 CLASSIFIERS = list(filter(None, CLASSIFIERS.split("\n")))
 PLATFORMS = ["Linux", "Mac OS-X", "Unix", "Windows"]
 MAJOR = 1
 MINOR = 9
-PATCH = 0
+PATCH = 1
 VERSION = "%d.%d.%d" % (MAJOR, MINOR, PATCH)
 
 
 # Return the git revision as a string
 def git_version():
     try:
         git_rev = check_output(["git", "describe", "--tags", "--long"])
```

### Comparing `wradlib-1.9.0/wradlib/__init__.py` & `wradlib-1.9.1/wradlib/__init__.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/adjust.py` & `wradlib-1.9.1/wradlib/adjust.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/atten.py` & `wradlib-1.9.1/wradlib/atten.py`

 * *Files 0% similar despite different names*

```diff
@@ -310,18 +310,18 @@
     """
 
     kernela = np.ones([1] * (mask.ndim - 1) + [min_sector_size])
     kernelb = np.ones((min_sector_size,))
     forward_origin = -(min_sector_size - (min_sector_size // 2)) + min_sector_size % 2
     backward_origin = (min_sector_size - (min_sector_size // 2)) - 1
     forward_sum = ndimage.correlate1d(
-        mask.astype(np.int), kernelb, axis=-1, mode="wrap", origin=forward_origin
+        mask.astype(np.int_), kernelb, axis=-1, mode="wrap", origin=forward_origin
     )
     backward_sum = ndimage.correlate1d(
-        mask.astype(np.int), kernelb, axis=-1, mode="wrap", origin=backward_origin
+        mask.astype(np.int_), kernelb, axis=-1, mode="wrap", origin=backward_origin
     )
     forward_corners = forward_sum == min_sector_size
     backward_corners = backward_sum == min_sector_size
     forward_large_sectors = np.zeros_like(mask)
     backward_large_sectors = np.zeros_like(mask)
     for iii in range(mask.shape[0]):
         forward_large_sectors[iii] = ndimage.morphology.binary_dilation(
@@ -491,16 +491,16 @@
     pia = np.zeros_like(tmp_gateset)
 
     a_used = np.empty(tmp_gateset.shape[:-1])
     b_used = np.empty(tmp_gateset.shape[:-1])
 
     # Calculate attenuation forward.
     # Indexing all rows of last dimension (radarbeams)
-    beams2correct = np.where(np.ones(tmp_gateset.shape[:-1], dtype=np.bool))
-    small_sectors = np.zeros(tmp_gateset.shape[:-1], dtype=np.bool)
+    beams2correct = np.where(np.ones(tmp_gateset.shape[:-1], dtype=np.bool_))
+    small_sectors = np.zeros(tmp_gateset.shape[:-1], dtype=np.bool_)
 
     if n_a != 1:
         delta_a = (a_max - a_min) / (n_a - 1)
     else:
         delta_a = 0.0
     if n_b != 1:
         delta_b = (b_max - b_min) / (n_b - 1)
@@ -516,15 +516,15 @@
             # Generate subset of beams that have to be corrected
             sub_gateset = tmp_gateset[beams2correct]
             sub_pia = calc_attenuation_forward(sub_gateset, a, b, gate_length)
             pia[beams2correct] = sub_pia
             a_used[beams2correct] = a
             b_used[beams2correct] = b
             # Indexing threshold exceeding beams
-            incorrectbeams = np.zeros(tmp_gateset.shape[:-1], dtype=np.bool)
+            incorrectbeams = np.zeros(tmp_gateset.shape[:-1], dtype=np.bool_)
             for constraint, constraint_arg in zip(constraints, constraint_args):
                 incorrectbeams = np.logical_or(
                     incorrectbeams, constraint(tmp_gateset, pia, *constraint_arg)
                 )
             # Determine incorrect sectors larger than sector_thr
             large_sectors = _sector_filter(incorrectbeams, sector_thr)
             # Determine incorrect sectors smaller than sector_thr
```

### Comparing `wradlib-1.9.0/wradlib/classify.py` & `wradlib-1.9.1/wradlib/classify.py`

 * *Files 0% similar despite different names*

```diff
@@ -54,15 +54,15 @@
     out : :class:`numpy:numpy.ndarray`
         Array of shape (hmc-classes, observables, obs.shape, 4) containing the
         membership function values for every radar-bin for every hmc-class and
         observable.
     """
     bins = np.append(idp, idp[-1] + (idp[-1] - idp[-2]))
     idx = np.digitize(obs, bins) - 1
-    idx_mask = np.zeros_like(idx, dtype=np.bool)
+    idx_mask = np.zeros_like(idx, dtype=np.bool_)
     idxm = np.ma.array(idx, mask=idx_mask)
     idxm = np.ma.masked_outside(idxm, 0, bins.shape[0] - 2)
     out = np.zeros((msf.shape[0], msf.shape[1], obs.size, msf.shape[-1]))
     out[:, :, ~idxm.mask.flatten(), :] = msf[:, :, idxm.compressed(), :]
     out = np.reshape(out, ((msf.shape[0], msf.shape[1]) + obs.shape + (msf.shape[-1],)))
     return out
```

### Comparing `wradlib-1.9.0/wradlib/clutter.py` & `wradlib-1.9.1/wradlib/clutter.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/comp.py` & `wradlib-1.9.1/wradlib/comp.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/dp.py` & `wradlib-1.9.1/wradlib/dp.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/__init__.py` & `wradlib-1.9.1/wradlib/georef/__init__.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/misc.py` & `wradlib-1.9.1/wradlib/georef/misc.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/polar.py` & `wradlib-1.9.1/wradlib/georef/polar.py`

 * *Files 0% similar despite different names*

```diff
@@ -619,17 +619,17 @@
     # this may seem odd at first, but d1 and d2 are also used in several
     # plotting functions and thus it may be easier to compare the functions
     d1 = r
     d2 = az
 
     # providing 'reasonable defaults', based on the data's shape
     if d1 is None:
-        d1 = np.arange(data.shape[1], dtype=np.float)
+        d1 = np.arange(data.shape[1], dtype=np.float_)
     if d2 is None:
-        d2 = np.arange(data.shape[0], dtype=np.float)
+        d2 = np.arange(data.shape[0], dtype=np.float_)
 
     if angle is None:
         angle = 0.0
 
     if elev is None:
         elev = 0.0
```

### Comparing `wradlib-1.9.0/wradlib/georef/projection.py` & `wradlib-1.9.1/wradlib/georef/projection.py`

 * *Files 0% similar despite different names*

```diff
@@ -292,18 +292,18 @@
             C = np.concatenate([X.ravel()[:, None], Y.ravel()[:, None]], axis=1)
 
     projection_source = kwargs.get("projection_source", get_default_projection())
     projection_target = kwargs.get("projection_target", get_default_projection())
     area_of_interest = kwargs.get(
         "area_of_interest",
         (
-            np.float(C[..., 0].min()),
-            np.float(C[..., 1].min()),
-            np.float(C[..., 0].max()),
-            np.float(C[..., 1].max()),
+            np.float_(C[..., 0].min()),
+            np.float_(C[..., 1].min()),
+            np.float_(C[..., 0].max()),
+            np.float_(C[..., 1].max()),
         ),
     )
 
     if LooseVersion(gdal.VersionInfo("RELEASE_NAME")) >= LooseVersion("3"):
         axis_order = osr.OAMS_TRADITIONAL_GIS_ORDER
         projection_source.SetAxisMappingStrategy(axis_order)
         projection_target.SetAxisMappingStrategy(axis_order)
```

### Comparing `wradlib-1.9.0/wradlib/georef/raster.py` & `wradlib-1.9.1/wradlib/georef/raster.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/rect.py` & `wradlib-1.9.1/wradlib/georef/rect.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/satellite.py` & `wradlib-1.9.1/wradlib/georef/satellite.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/vector.py` & `wradlib-1.9.1/wradlib/georef/vector.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/georef/xarray.py` & `wradlib-1.9.1/wradlib/georef/xarray.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/__init__.py` & `wradlib-1.9.1/wradlib/io/__init__.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/dem.py` & `wradlib-1.9.1/wradlib/io/dem.py`

 * *Files 11% similar despite different names*

```diff
@@ -23,113 +23,98 @@
 import numpy as np
 import requests
 from osgeo import gdal
 
 from wradlib import util
 
 
-def download_srtm(
-    filename, destination=None, version=2, resolution=3, region=None, token=None
-):
+class HeaderRedirection(requests.Session):
+    AUTH_HOST = "urs.earthdata.nasa.gov"
+
+    def __init__(self, username, password):
+        super().__init__()
+        self.auth = (username, password)
+
+    def rebuild_auth(self, request, response):
+        headers = request.headers
+        url = request.url
+        if "Authorization" in headers:
+            original = requests.utils.urlparse(response.request.url).hostname
+            redirect = requests.utils.urlparse(url).hostname
+            if (
+                original != redirect
+                and redirect != self.AUTH_HOST
+                and original != self.AUTH_HOST
+            ):
+                del headers["Authorization"]
+        return
+
+
+def download_srtm(filename, destination, resolution=3):
     """
     Download NASA SRTM elevation data
-    Version 3 is only available with a login and a token
+    Only available with login/password
 
     Parameters
     ----------
     filename : str
         srtm file to download
     destination : str
         output filename
-    version : int
-        srtm version (2 or 3)
     resolution : int
         resolution of SRTM data (1, 3 or 30)
-    region : str
-        name of the region for SRTM version 2 only:
-        Africa, Australia, Eurasia, Islands, North America, South America
-    token : str
-        filename with authorization token (required for version 3)
 
     """
-    if region is None:
-        region = [
-            "Africa",
-            "Australia",
-            "Eurasia",
-            "Islands",
-            "North_America",
-            "South_America",
-        ]
-    else:
-        region = [region]
-    if version == 2:
-        website = "https://dds.cr.usgs.gov/srtm/version2_1"
-        resolution = "SRTM%s" % (resolution)
-        source = "/".join([website, resolution, "{}"])
-    if version == 3:
-        website = "https://e4ftl01.cr.usgs.gov/MEASURES"
-        resolution = "SRTMGL%d.003" % (resolution)
-        source = "/".join([website, resolution, "2000.02.11"])
-    url = "/".join([source, filename])
 
-    headers = None
-
-    if version == 2:
-        for reg in region:
-            try:
-                r = requests.get(url.format(reg), headers=headers, stream=True)
-                r.raise_for_status()
-            except requests.exceptions.HTTPError as err:
-                status_code = err.response.status_code
-                if status_code == 404:
-                    continue
-                else:
-                    raise err
-            finally:
-                if r.status_code == 200:
-                    break
-
-    elif version == 3:
-        if token is not None:
-            headers.update({"Authorization": "Bearer %s" % (token)})
-        try:
-            r = requests.get(url, headers=headers, stream=True)
-            r.raise_for_status()
-        except requests.exceptions.HTTPError as err:
-            status_code = err.response.status_code
-            if status_code == 404:
-                return
-            else:
-                raise err
+    website = "https://e4ftl01.cr.usgs.gov/MEASURES"
+    subres = 3
+    if resolution == 30:
+        subres = 2
+    resolution = f"SRTMGL{resolution}.00{subres}"
+    source = "/".join([website, resolution, "2000.02.11"])
+    url = "/".join([source, filename])
+    user = os.environ.get("WRADLIB_EARTHDATA_USER", None)
+    pwd = os.environ.get("WRADLIB_EARTHDATA_PASS", None)
 
-    if r.status_code == 200:
+    if user is None or pwd is None:
+        raise ValueError(
+            "WRADLIB_EARTHDATA_USER and/or WRADLIB_EARTHDATA_PASS environment "
+            "variable missing. Downloading SRTM data requires a NASA Earthdata "
+            "Login username and password. To obtain a NASA Earthdata Login account, "
+            "please visit https://urs.earthdata.nasa.gov/users/new/."
+        )
+
+    session = HeaderRedirection(user, pwd)
+
+    try:
+        r = session.get(url, stream=True)
+        r.raise_for_status()
         if destination is None:
             destination = filename
         with open(destination, "wb") as fd:
-            for chunk in r.iter_content(chunk_size=128):
+            for chunk in r.iter_content(chunk_size=1024 * 1014):
                 fd.write(chunk)
+    except requests.exceptions.HTTPError as err:
+        status_code = err.response.status_code
+        if status_code != 404:
+            raise err
 
 
-def get_srtm(extent, version=2, resolution=3, merge=True, download=None):
+def get_srtm(extent, resolution=3, merge=True):
     """
     Get NASA SRTM elevation data
 
     Parameters
     ----------
     extent : str
         lonmin, lonmax, latmin, latmax
-    version : int
-        srtm version (2 or 3)
     resolution : int
         resolution of SRTM data (1, 3 or 30)
     merge : bool
         True to merge the tiles in one dataset
-    download : dict
-        download options (see download_srtm)
 
     Returns
     -------
     dataset : gdal.Dataset
         Raster dataset containing elevation information
     """
 
@@ -147,33 +132,26 @@
     for latitude in range(max(0, latmin), latmax + 1):
         for longitude in range(lonmin, min(lonmax, 0)):
             georef = "N%02gW%03g" % (latitude, -longitude)
             filelist.append(georef)
         for longitude in range(max(lonmin, 0), lonmax + 1):
             georef = "N%02gE%03g" % (latitude, longitude)
             filelist.append(georef)
-    if version == 3:
-        filelist = ["%s.SRTMGL%s" % (f, resolution) for f in filelist]
-
-    filelist = ["%s.hgt.zip" % (f) for f in filelist]
+    filelist = [f"{f}.SRTMGL{resolution}.hgt.zip" for f in filelist]
 
     wrl_data_path = util.get_wradlib_data_path()
     srtm_path = os.path.join(wrl_data_path, "geo")
-    if not os.path.exists(srtm_path) and download is not None:
+    if not os.path.exists(srtm_path):
         os.makedirs(srtm_path)
     demlist = []
     for filename in filelist:
         path = os.path.join(srtm_path, filename)
-        if os.path.exists(path):
-            demlist.append(path)
-            continue
-        if download is not None:
-            download_srtm(filename, path, version, resolution, **download)
-            if os.path.exists(path):
-                demlist.append(path)
+        if not os.path.exists(path):
+            download_srtm(filename, path, resolution)
+        demlist.append(path)
 
     demlist = [gdal.Open(d) for d in demlist]
     if not merge:
         return demlist
     dem = gdal.Warp("", demlist, format="MEM")
 
     return dem
```

### Comparing `wradlib-1.9.0/wradlib/io/gdal.py` & `wradlib-1.9.1/wradlib/io/gdal.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/hdf.py` & `wradlib-1.9.1/wradlib/io/hdf.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/iris.py` & `wradlib-1.9.1/wradlib/io/iris.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/misc.py` & `wradlib-1.9.1/wradlib/io/misc.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/netcdf.py` & `wradlib-1.9.1/wradlib/io/netcdf.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/radolan.py` & `wradlib-1.9.1/wradlib/io/radolan.py`

 * *Files 0% similar despite different names*

```diff
@@ -464,15 +464,15 @@
                     dimstrings[: int(len(dimstrings) / 2)],
                     dimstrings[int(len(dimstrings) / 2) :],
                 )
                 out["nrow"] = int(dimstrings[0])
                 out["ncol"] = int(dimstrings[1])
             if k == "LV":
                 lv = header[v[0] : v[1]].split()
-                out["nlevel"] = np.int(lv[0])
+                out["nlevel"] = np.int_(lv[0])
                 out["level"] = np.array(lv[1:]).astype("float")
             if k == "MS":
                 locationstring = header[v[0] :].strip().split("<")[1].split(">")[0]
                 out["radarlocations"] = locationstring.split(",")
             if k == "ST":
                 locationstring = header[v[0] :].strip().split("<")[1].split(">")[0]
                 out["radardays"] = locationstring.split(",")
@@ -932,24 +932,24 @@
         "valid_max": np.int32(255),
         "_FillValue": np.int32(255),
         "standard_name": "equivalent_reflectivity_factor",
         "long_name": "equivalent_reflectivity_factor",
         "unit": "dBZ",
     },
     "RR": {
-        "add_offset": np.float(0),
+        "add_offset": np.float_(0),
         "valid_min": np.int32(0),
         "valid_max": np.int32(4095),
         "_FillValue": np.int32(65535),
         "standard_name": "rainfall_rate",
         "long_name": "rainfall_rate",
         "unit": "mm h-1",
     },
     "RA": {
-        "add_offset": np.float(0),
+        "add_offset": np.float_(0),
         "valid_min": np.int32(0),
         "valid_max": np.int32(4095),
         "_FillValue": np.int32(65535),
         "standard_name": "rainfall_amount",
         "long_name": "rainfall_amount",
         "unit": "mm",
     },
```

### Comparing `wradlib-1.9.0/wradlib/io/rainbow.py` & `wradlib-1.9.1/wradlib/io/rainbow.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/io/xarray.py` & `wradlib-1.9.1/wradlib/io/xarray.py`

 * *Files 1% similar despite different names*

```diff
@@ -181,7617 +181,7641 @@
 00000b40: 6835 6e65 7463 6466 0a69 6d70 6f72 7420  h5netcdf.import 
 00000b50: 6835 7079 0a69 6d70 6f72 7420 6e65 7443  h5py.import netC
 00000b60: 4446 3420 6173 206e 630a 696d 706f 7274  DF4 as nc.import
 00000b70: 206e 756d 7079 2061 7320 6e70 0a69 6d70   numpy as np.imp
 00000b80: 6f72 7420 7861 7272 6179 2061 7320 7872  ort xarray as xr
 00000b90: 0a66 726f 6d20 7861 7272 6179 2e62 6163  .from xarray.bac
 00000ba0: 6b65 6e64 732e 6170 6920 696d 706f 7274  kends.api import
-00000bb0: 205f 4d75 6c74 6946 696c 6543 6c6f 7365   _MultiFileClose
-00000bc0: 722c 2063 6f6d 6269 6e65 5f62 795f 636f  r, combine_by_co
-00000bd0: 6f72 6473 0a0a 6672 6f6d 2077 7261 646c  ords..from wradl
-00000be0: 6962 2069 6d70 6f72 7420 7665 7273 696f  ib import versio
-00000bf0: 6e0a 6672 6f6d 2077 7261 646c 6962 2e67  n.from wradlib.g
-00000c00: 656f 7265 6620 696d 706f 7274 2078 6172  eoref import xar
-00000c10: 7261 790a 0a74 7279 3a0a 2020 2020 6672  ray..try:.    fr
-00000c20: 6f6d 2074 7164 6d20 696d 706f 7274 2074  om tqdm import t
-00000c30: 7164 6d0a 6578 6365 7074 2049 6d70 6f72  qdm.except Impor
-00000c40: 7445 7272 6f72 3a0a 0a20 2020 2064 6566  tError:..    def
-00000c50: 2074 7164 6d28 7661 6c2c 202a 2a6b 7761   tqdm(val, **kwa
-00000c60: 7267 7329 3a0a 2020 2020 2020 2020 7072  rgs):.        pr
-00000c70: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-00000c80: 2022 7772 6164 6c69 623a 2050 6c65 6173   "wradlib: Pleas
-00000c90: 6520 7761 6974 2066 6f72 2063 6f6d 706c  e wait for compl
-00000ca0: 6574 696f 6e20 6f66 2074 696d 6520 636f  etion of time co
-00000cb0: 6e73 756d 696e 6720 7461 736b 2120 5c6e  nsuming task! \n
-00000cc0: 220a 2020 2020 2020 2020 2020 2020 2277  ".            "w
-00000cd0: 7261 646c 6962 3a20 506c 6561 7365 2069  radlib: Please i
-00000ce0: 6e73 7461 6c6c 2027 7471 646d 2720 666f  nstall 'tqdm' fo
-00000cf0: 7220 7368 6f77 696e 6720 6120 7072 6f67  r showing a prog
-00000d00: 7265 7373 2062 6172 2022 0a20 2020 2020  ress bar ".     
-00000d10: 2020 2020 2020 2022 696e 7374 6561 642e         "instead.
-00000d20: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-00000d30: 2020 2020 7265 7475 726e 2076 616c 0a0a      return val..
-00000d40: 0a40 6465 7072 6563 6174 696f 6e2e 6465  .@deprecation.de
-00000d50: 7072 6563 6174 6564 280a 2020 2020 6465  precated(.    de
-00000d60: 7072 6563 6174 6564 5f69 6e3d 2231 2e35  precated_in="1.5
-00000d70: 222c 0a20 2020 2072 656d 6f76 6564 5f69  ",.    removed_i
-00000d80: 6e3d 2232 2e30 222c 0a20 2020 2063 7572  n="2.0",.    cur
-00000d90: 7265 6e74 5f76 6572 7369 6f6e 3d76 6572  rent_version=ver
-00000da0: 7369 6f6e 2e76 6572 7369 6f6e 2c0a 2020  sion.version,.  
-00000db0: 2020 6465 7461 696c 733d 2255 7365 2060    details="Use `
-00000dc0: 7772 6164 6c69 622e 6765 6f72 6566 2e63  wradlib.georef.c
-00000dd0: 7265 6174 655f 7861 7272 6179 5f64 6174  reate_xarray_dat
-00000de0: 6161 7272 6179 6020 2220 2269 6e73 7465  aarray` " "inste
-00000df0: 6164 2e22 2c0a 290a 6465 6620 6372 6561  ad.",.).def crea
-00000e00: 7465 5f78 6172 7261 795f 6461 7461 6172  te_xarray_dataar
-00000e10: 7261 7928 2a61 7267 732c 202a 2a6b 7761  ray(*args, **kwa
-00000e20: 7267 7329 3a0a 2020 2020 7265 7475 726e  rgs):.    return
-00000e30: 2078 6172 7261 792e 6372 6561 7465 5f78   xarray.create_x
-00000e40: 6172 7261 795f 6461 7461 6172 7261 7928  array_dataarray(
-00000e50: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00000e60: 0a0a 0a6d 6f6d 656e 745f 6174 7472 7320  ...moment_attrs 
-00000e70: 3d20 7b22 7374 616e 6461 7264 5f6e 616d  = {"standard_nam
-00000e80: 6522 2c20 226c 6f6e 675f 6e61 6d65 222c  e", "long_name",
-00000e90: 2022 756e 6974 7322 7d0a 0a23 2043 6652   "units"}..# CfR
-00000ea0: 6164 6961 6c20 322e 3020 2d20 4f44 494d  adial 2.0 - ODIM
-00000eb0: 5f48 3520 6d61 7070 696e 670a 6d6f 6d65  _H5 mapping.mome
-00000ec0: 6e74 735f 6d61 7070 696e 6720 3d20 7b0a  nts_mapping = {.
-00000ed0: 2020 2020 2244 425a 4822 3a20 7b0a 2020      "DBZH": {.  
-00000ee0: 2020 2020 2020 2273 7461 6e64 6172 645f        "standard_
-00000ef0: 6e61 6d65 223a 2022 7261 6461 725f 6571  name": "radar_eq
-00000f00: 7569 7661 6c65 6e74 5f72 6566 6c65 6374  uivalent_reflect
-00000f10: 6976 6974 795f 6661 6374 6f72 5f68 222c  ivity_factor_h",
-00000f20: 0a20 2020 2020 2020 2022 6c6f 6e67 5f6e  .        "long_n
-00000f30: 616d 6522 3a20 2245 7175 6976 616c 656e  ame": "Equivalen
-00000f40: 7420 7265 666c 6563 7469 7669 7479 2066  t reflectivity f
-00000f50: 6163 746f 7220 4822 2c0a 2020 2020 2020  actor H",.      
-00000f60: 2020 2273 686f 7274 5f6e 616d 6522 3a20    "short_name": 
-00000f70: 2244 425a 4822 2c0a 2020 2020 2020 2020  "DBZH",.        
-00000f80: 2275 6e69 7473 223a 2022 6442 5a22 2c0a  "units": "dBZ",.
-00000f90: 2020 2020 2020 2020 2267 616d 6963 223a          "gamic":
-00000fa0: 205b 227a 6822 5d2c 0a20 2020 207d 2c0a   ["zh"],.    },.
-00000fb0: 2020 2020 2244 425a 485f 434c 4541 4e22      "DBZH_CLEAN"
-00000fc0: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
-00000fd0: 6e64 6172 645f 6e61 6d65 223a 2022 7261  ndard_name": "ra
-00000fe0: 6461 725f 6571 7569 7661 6c65 6e74 5f72  dar_equivalent_r
-00000ff0: 6566 6c65 6374 6976 6974 795f 6661 6374  eflectivity_fact
-00001000: 6f72 5f68 222c 0a20 2020 2020 2020 2022  or_h",.        "
-00001010: 6c6f 6e67 5f6e 616d 6522 3a20 2245 7175  long_name": "Equ
-00001020: 6976 616c 656e 7420 7265 666c 6563 7469  ivalent reflecti
-00001030: 7669 7479 2066 6163 746f 7220 4822 2c0a  vity factor H",.
-00001040: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
-00001050: 616d 6522 3a20 2244 425a 485f 434c 4541  ame": "DBZH_CLEA
-00001060: 4e22 2c0a 2020 2020 2020 2020 2275 6e69  N",.        "uni
-00001070: 7473 223a 2022 6442 5a22 2c0a 2020 2020  ts": "dBZ",.    
-00001080: 2020 2020 2267 616d 6963 223a 204e 6f6e      "gamic": Non
-00001090: 652c 0a20 2020 207d 2c0a 2020 2020 2244  e,.    },.    "D
-000010a0: 425a 5622 3a20 7b0a 2020 2020 2020 2020  BZV": {.        
-000010b0: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
-000010c0: 2022 7261 6461 725f 6571 7569 7661 6c65   "radar_equivale
-000010d0: 6e74 5f72 6566 6c65 6374 6976 6974 795f  nt_reflectivity_
-000010e0: 6661 6374 6f72 5f76 222c 0a20 2020 2020  factor_v",.     
-000010f0: 2020 2022 6c6f 6e67 5f6e 616d 6522 3a20     "long_name": 
-00001100: 2245 7175 6976 616c 656e 7420 7265 666c  "Equivalent refl
-00001110: 6563 7469 7669 7479 2066 6163 746f 7220  ectivity factor 
-00001120: 5622 2c0a 2020 2020 2020 2020 2273 686f  V",.        "sho
-00001130: 7274 5f6e 616d 6522 3a20 2244 425a 5622  rt_name": "DBZV"
-00001140: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-00001150: 223a 2022 6442 5a22 2c0a 2020 2020 2020  ": "dBZ",.      
-00001160: 2020 2267 616d 6963 223a 205b 227a 7622    "gamic": ["zv"
-00001170: 5d2c 0a20 2020 207d 2c0a 2020 2020 225a  ],.    },.    "Z
-00001180: 4822 3a20 7b0a 2020 2020 2020 2020 2273  H": {.        "s
-00001190: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
-000011a0: 7261 6461 725f 6c69 6e65 6172 5f65 7175  radar_linear_equ
-000011b0: 6976 616c 656e 745f 7265 666c 6563 7469  ivalent_reflecti
-000011c0: 7669 7479 5f66 6163 746f 725f 6822 2c0a  vity_factor_h",.
-000011d0: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
-000011e0: 6d65 223a 2022 4c69 6e65 6172 2065 7175  me": "Linear equ
-000011f0: 6976 616c 656e 7420 7265 666c 6563 7469  ivalent reflecti
-00001200: 7669 7479 2066 6163 746f 7220 4822 2c0a  vity factor H",.
-00001210: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
-00001220: 616d 6522 3a20 225a 4822 2c0a 2020 2020  ame": "ZH",.    
-00001230: 2020 2020 2275 6e69 7473 223a 2022 756e      "units": "un
-00001240: 6974 6c65 7373 222c 0a20 2020 2020 2020  itless",.       
-00001250: 2022 6761 6d69 6322 3a20 4e6f 6e65 2c0a   "gamic": None,.
-00001260: 2020 2020 7d2c 0a20 2020 2022 5a56 223a      },.    "ZV":
-00001270: 207b 0a20 2020 2020 2020 2022 7374 616e   {.        "stan
-00001280: 6461 7264 5f6e 616d 6522 3a20 2272 6164  dard_name": "rad
-00001290: 6172 5f65 7175 6976 616c 656e 745f 7265  ar_equivalent_re
-000012a0: 666c 6563 7469 7669 7479 5f66 6163 746f  flectivity_facto
-000012b0: 725f 7622 2c0a 2020 2020 2020 2020 226c  r_v",.        "l
-000012c0: 6f6e 675f 6e61 6d65 223a 2022 4c69 6e65  ong_name": "Line
-000012d0: 6172 2065 7175 6976 616c 656e 7420 7265  ar equivalent re
-000012e0: 666c 6563 7469 7669 7479 2066 6163 746f  flectivity facto
-000012f0: 7220 5622 2c0a 2020 2020 2020 2020 2273  r V",.        "s
-00001300: 686f 7274 5f6e 616d 6522 3a20 225a 5622  hort_name": "ZV"
-00001310: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-00001320: 223a 2022 756e 6974 6c65 7373 222c 0a20  ": "unitless",. 
-00001330: 2020 2020 2020 2022 6761 6d69 6322 3a20         "gamic": 
-00001340: 4e6f 6e65 2c0a 2020 2020 7d2c 0a20 2020  None,.    },.   
-00001350: 2022 4442 5a22 3a20 7b0a 2020 2020 2020   "DBZ": {.      
-00001360: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
-00001370: 223a 2022 7261 6461 725f 6571 7569 7661  ": "radar_equiva
-00001380: 6c65 6e74 5f72 6566 6c65 6374 6976 6974  lent_reflectivit
-00001390: 795f 6661 6374 6f72 222c 0a20 2020 2020  y_factor",.     
-000013a0: 2020 2022 6c6f 6e67 5f6e 616d 6522 3a20     "long_name": 
-000013b0: 2245 7175 6976 616c 656e 7420 7265 666c  "Equivalent refl
-000013c0: 6563 7469 7669 7479 2066 6163 746f 7222  ectivity factor"
-000013d0: 2c0a 2020 2020 2020 2020 2273 686f 7274  ,.        "short
-000013e0: 5f6e 616d 6522 3a20 2244 425a 222c 0a20  _name": "DBZ",. 
-000013f0: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
-00001400: 2264 425a 222c 0a20 2020 2020 2020 2022  "dBZ",.        "
-00001410: 6761 6d69 6322 3a20 4e6f 6e65 2c0a 2020  gamic": None,.  
-00001420: 2020 7d2c 0a20 2020 2022 4442 5448 223a    },.    "DBTH":
-00001430: 207b 0a20 2020 2020 2020 2022 7374 616e   {.        "stan
-00001440: 6461 7264 5f6e 616d 6522 3a20 2272 6164  dard_name": "rad
-00001450: 6172 5f65 7175 6976 616c 656e 745f 7265  ar_equivalent_re
-00001460: 666c 6563 7469 7669 7479 5f66 6163 746f  flectivity_facto
-00001470: 725f 6822 2c0a 2020 2020 2020 2020 226c  r_h",.        "l
-00001480: 6f6e 675f 6e61 6d65 223a 2022 546f 7461  ong_name": "Tota
-00001490: 6c20 706f 7765 7220 4820 2875 6e63 6f72  l power H (uncor
-000014a0: 7265 6374 6564 2072 6566 6c65 6374 6976  rected reflectiv
-000014b0: 6974 7929 222c 0a20 2020 2020 2020 2022  ity)",.        "
-000014c0: 7368 6f72 745f 6e61 6d65 223a 2022 4442  short_name": "DB
-000014d0: 5448 222c 0a20 2020 2020 2020 2022 756e  TH",.        "un
-000014e0: 6974 7322 3a20 2264 425a 222c 0a20 2020  its": "dBZ",.   
-000014f0: 2020 2020 2022 6761 6d69 6322 3a20 5b22       "gamic": ["
-00001500: 757a 6822 2c20 2275 6822 5d2c 0a20 2020  uzh", "uh"],.   
-00001510: 207d 2c0a 2020 2020 2244 4254 5622 3a20   },.    "DBTV": 
-00001520: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
-00001530: 6172 645f 6e61 6d65 223a 2022 7261 6461  ard_name": "rada
-00001540: 725f 6571 7569 7661 6c65 6e74 5f72 6566  r_equivalent_ref
-00001550: 6c65 6374 6976 6974 795f 6661 6374 6f72  lectivity_factor
-00001560: 5f76 222c 0a20 2020 2020 2020 2022 6c6f  _v",.        "lo
-00001570: 6e67 5f6e 616d 6522 3a20 2254 6f74 616c  ng_name": "Total
-00001580: 2070 6f77 6572 2056 2028 756e 636f 7272   power V (uncorr
-00001590: 6563 7465 6420 7265 666c 6563 7469 7669  ected reflectivi
-000015a0: 7479 2922 2c0a 2020 2020 2020 2020 2273  ty)",.        "s
-000015b0: 686f 7274 5f6e 616d 6522 3a20 2244 4254  hort_name": "DBT
-000015c0: 5622 2c0a 2020 2020 2020 2020 2275 6e69  V",.        "uni
-000015d0: 7473 223a 2022 6442 5a22 2c0a 2020 2020  ts": "dBZ",.    
-000015e0: 2020 2020 2267 616d 6963 223a 205b 2275      "gamic": ["u
-000015f0: 7a76 222c 2022 7576 225d 2c0a 2020 2020  zv", "uv"],.    
-00001600: 7d2c 0a20 2020 2022 5448 223a 207b 0a20  },.    "TH": {. 
-00001610: 2020 2020 2020 2022 7374 616e 6461 7264         "standard
-00001620: 5f6e 616d 6522 3a20 2272 6164 6172 5f6c  _name": "radar_l
-00001630: 696e 6561 725f 6571 7569 7661 6c65 6e74  inear_equivalent
-00001640: 5f72 6566 6c65 6374 6976 6974 795f 6661  _reflectivity_fa
-00001650: 6374 6f72 5f68 222c 0a20 2020 2020 2020  ctor_h",.       
-00001660: 2022 6c6f 6e67 5f6e 616d 6522 3a20 224c   "long_name": "L
-00001670: 696e 6561 7220 746f 7461 6c20 706f 7765  inear total powe
-00001680: 7220 4820 2875 6e63 6f72 7265 6374 6564  r H (uncorrected
-00001690: 2072 6566 6c65 6374 6976 6974 7929 222c   reflectivity)",
-000016a0: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
-000016b0: 6e61 6d65 223a 2022 5448 222c 0a20 2020  name": "TH",.   
-000016c0: 2020 2020 2022 756e 6974 7322 3a20 2275       "units": "u
-000016d0: 6e69 746c 6573 7322 2c0a 2020 2020 2020  nitless",.      
-000016e0: 2020 2267 616d 6963 223a 204e 6f6e 652c    "gamic": None,
-000016f0: 0a20 2020 207d 2c0a 2020 2020 2254 5622  .    },.    "TV"
-00001700: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
-00001710: 6e64 6172 645f 6e61 6d65 223a 2022 7261  ndard_name": "ra
-00001720: 6461 725f 6c69 6e65 6172 5f65 7175 6976  dar_linear_equiv
-00001730: 616c 656e 745f 7265 666c 6563 7469 7669  alent_reflectivi
-00001740: 7479 5f66 6163 746f 725f 7622 2c0a 2020  ty_factor_v",.  
-00001750: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
-00001760: 223a 2022 4c69 6e65 6172 2074 6f74 616c  ": "Linear total
-00001770: 2070 6f77 6572 2056 2028 756e 636f 7272   power V (uncorr
-00001780: 6563 7465 6420 7265 666c 6563 7469 7669  ected reflectivi
-00001790: 7479 2922 2c0a 2020 2020 2020 2020 2273  ty)",.        "s
-000017a0: 686f 7274 5f6e 616d 6522 3a20 2254 5622  hort_name": "TV"
-000017b0: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-000017c0: 223a 2022 756e 6974 6c65 7373 222c 0a20  ": "unitless",. 
-000017d0: 2020 2020 2020 2022 6761 6d69 6322 3a20         "gamic": 
-000017e0: 4e6f 6e65 2c0a 2020 2020 7d2c 0a20 2020  None,.    },.   
-000017f0: 2022 5652 4144 4822 3a20 7b0a 2020 2020   "VRADH": {.    
-00001800: 2020 2020 2273 7461 6e64 6172 645f 6e61      "standard_na
-00001810: 6d65 223a 2022 7261 6469 616c 5f76 656c  me": "radial_vel
-00001820: 6f63 6974 795f 6f66 5f73 6361 7474 6572  ocity_of_scatter
-00001830: 6572 735f 6177 6179 5f22 2022 6672 6f6d  ers_away_" "from
-00001840: 5f69 6e73 7472 756d 656e 745f 6822 2c0a  _instrument_h",.
-00001850: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
-00001860: 6d65 223a 2022 5261 6469 616c 2076 656c  me": "Radial vel
-00001870: 6f63 6974 7920 6f66 2073 6361 7474 6572  ocity of scatter
-00001880: 6572 7320 6177 6179 2066 726f 6d20 696e  ers away from in
-00001890: 7374 7275 6d65 6e74 2048 222c 0a20 2020  strument H",.   
-000018a0: 2020 2020 2022 7368 6f72 745f 6e61 6d65       "short_name
-000018b0: 223a 2022 5652 4144 4822 2c0a 2020 2020  ": "VRADH",.    
-000018c0: 2020 2020 2275 6e69 7473 223a 2022 6d65      "units": "me
-000018d0: 7465 7273 2070 6572 2073 6563 6f6e 6473  ters per seconds
-000018e0: 222c 0a20 2020 2020 2020 2022 6761 6d69  ",.        "gami
-000018f0: 6322 3a20 5b22 7668 225d 2c0a 2020 2020  c": ["vh"],.    
-00001900: 7d2c 0a20 2020 2022 5652 4144 5622 3a20  },.    "VRADV": 
-00001910: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
-00001920: 6172 645f 6e61 6d65 223a 2022 7261 6469  ard_name": "radi
-00001930: 616c 5f76 656c 6f63 6974 795f 6f66 5f73  al_velocity_of_s
-00001940: 6361 7474 6572 6572 735f 2220 2261 7761  catterers_" "awa
-00001950: 795f 6672 6f6d 5f69 6e73 7472 756d 656e  y_from_instrumen
-00001960: 745f 7622 2c0a 2020 2020 2020 2020 226c  t_v",.        "l
-00001970: 6f6e 675f 6e61 6d65 223a 2022 5261 6469  ong_name": "Radi
-00001980: 616c 2076 656c 6f63 6974 7920 6f66 2073  al velocity of s
-00001990: 6361 7474 6572 6572 7320 6177 6179 2066  catterers away f
-000019a0: 726f 6d20 696e 7374 7275 6d65 6e74 2056  rom instrument V
-000019b0: 222c 0a20 2020 2020 2020 2022 7368 6f72  ",.        "shor
-000019c0: 745f 6e61 6d65 223a 2022 5652 4144 5622  t_name": "VRADV"
-000019d0: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-000019e0: 223a 2022 6d65 7465 7273 2070 6572 2073  ": "meters per s
-000019f0: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
-00001a00: 2267 616d 6963 223a 205b 2276 7622 5d2c  "gamic": ["vv"],
-00001a10: 0a20 2020 207d 2c0a 2020 2020 2256 5222  .    },.    "VR"
-00001a20: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
-00001a30: 6e64 6172 645f 6e61 6d65 223a 2022 7261  ndard_name": "ra
-00001a40: 6469 616c 5f76 656c 6f63 6974 795f 6f66  dial_velocity_of
-00001a50: 5f73 6361 7474 6572 6572 735f 6177 6179  _scatterers_away
-00001a60: 5f22 2022 6672 6f6d 5f69 6e73 7472 756d  _" "from_instrum
-00001a70: 656e 7422 2c0a 2020 2020 2020 2020 226c  ent",.        "l
-00001a80: 6f6e 675f 6e61 6d65 223a 2022 5261 6469  ong_name": "Radi
-00001a90: 616c 2076 656c 6f63 6974 7920 6f66 2073  al velocity of s
-00001aa0: 6361 7474 6572 6572 7320 6177 6179 2066  catterers away f
-00001ab0: 726f 6d20 696e 7374 7275 6d65 6e74 222c  rom instrument",
-00001ac0: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
-00001ad0: 6e61 6d65 223a 2022 5652 222c 0a20 2020  name": "VR",.   
-00001ae0: 2020 2020 2022 756e 6974 7322 3a20 226d       "units": "m
-00001af0: 6574 6572 7320 7065 7220 7365 636f 6e64  eters per second
-00001b00: 7322 2c0a 2020 2020 2020 2020 2267 616d  s",.        "gam
-00001b10: 6963 223a 204e 6f6e 652c 0a20 2020 207d  ic": None,.    }
-00001b20: 2c0a 2020 2020 2256 5241 4422 3a20 7b0a  ,.    "VRAD": {.
-00001b30: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
-00001b40: 645f 6e61 6d65 223a 2022 7261 6469 616c  d_name": "radial
-00001b50: 5f76 656c 6f63 6974 795f 6f66 5f73 6361  _velocity_of_sca
-00001b60: 7474 6572 6572 735f 6177 6179 5f22 2022  tterers_away_" "
-00001b70: 6672 6f6d 5f69 6e73 7472 756d 656e 7422  from_instrument"
-00001b80: 2c0a 2020 2020 2020 2020 226c 6f6e 675f  ,.        "long_
-00001b90: 6e61 6d65 223a 2022 5261 6469 616c 2076  name": "Radial v
-00001ba0: 656c 6f63 6974 7920 6f66 2073 6361 7474  elocity of scatt
-00001bb0: 6572 6572 7320 6177 6179 2066 726f 6d20  erers away from 
-00001bc0: 696e 7374 7275 6d65 6e74 222c 0a20 2020  instrument",.   
-00001bd0: 2020 2020 2022 7368 6f72 745f 6e61 6d65       "short_name
-00001be0: 223a 2022 5652 4144 222c 0a20 2020 2020  ": "VRAD",.     
-00001bf0: 2020 2022 756e 6974 7322 3a20 226d 6574     "units": "met
-00001c00: 6572 7320 7065 7220 7365 636f 6e64 7322  ers per seconds"
-00001c10: 2c0a 2020 2020 2020 2020 2267 616d 6963  ,.        "gamic
-00001c20: 223a 204e 6f6e 652c 0a20 2020 207d 2c0a  ": None,.    },.
-00001c30: 2020 2020 2256 5241 4444 4822 3a20 7b0a      "VRADDH": {.
-00001c40: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
-00001c50: 645f 6e61 6d65 223a 2022 7261 6469 616c  d_name": "radial
-00001c60: 5f76 656c 6f63 6974 795f 6f66 5f73 6361  _velocity_of_sca
-00001c70: 7474 6572 6572 735f 6177 6179 5f22 2022  tterers_away_" "
-00001c80: 6672 6f6d 5f69 6e73 7472 756d 656e 745f  from_instrument_
-00001c90: 6822 2c0a 2020 2020 2020 2020 226c 6f6e  h",.        "lon
-00001ca0: 675f 6e61 6d65 223a 2022 5261 6469 616c  g_name": "Radial
-00001cb0: 2076 656c 6f63 6974 7920 6f66 2073 6361   velocity of sca
-00001cc0: 7474 6572 6572 7320 6177 6179 2066 726f  tterers away fro
-00001cd0: 6d20 696e 7374 7275 6d65 6e74 2048 222c  m instrument H",
-00001ce0: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
-00001cf0: 6e61 6d65 223a 2022 5652 4144 4448 222c  name": "VRADDH",
-00001d00: 0a20 2020 2020 2020 2022 756e 6974 7322  .        "units"
-00001d10: 3a20 226d 6574 6572 7320 7065 7220 7365  : "meters per se
-00001d20: 636f 6e64 7322 2c0a 2020 2020 2020 2020  conds",.        
-00001d30: 2267 616d 6963 223a 204e 6f6e 652c 0a20  "gamic": None,. 
-00001d40: 2020 207d 2c0a 2020 2020 2257 5241 4448     },.    "WRADH
-00001d50: 223a 207b 0a20 2020 2020 2020 2022 7374  ": {.        "st
-00001d60: 616e 6461 7264 5f6e 616d 6522 3a20 2272  andard_name": "r
-00001d70: 6164 6172 5f64 6f70 706c 6572 5f73 7065  adar_doppler_spe
-00001d80: 6374 7275 6d5f 7769 6474 685f 6822 2c0a  ctrum_width_h",.
-00001d90: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
-00001da0: 6d65 223a 2022 446f 7070 6c65 7220 7370  me": "Doppler sp
-00001db0: 6563 7472 756d 2077 6964 7468 2048 222c  ectrum width H",
-00001dc0: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
-00001dd0: 6e61 6d65 223a 2022 5752 4144 4822 2c0a  name": "WRADH",.
-00001de0: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
-00001df0: 2022 6d65 7465 7273 2070 6572 2073 6563   "meters per sec
-00001e00: 6f6e 6473 222c 0a20 2020 2020 2020 2022  onds",.        "
-00001e10: 6761 6d69 6322 3a20 5b22 7768 225d 2c0a  gamic": ["wh"],.
-00001e20: 2020 2020 7d2c 0a20 2020 2022 5557 5241      },.    "UWRA
-00001e30: 4448 223a 207b 0a20 2020 2020 2020 2022  DH": {.        "
-00001e40: 7374 616e 6461 7264 5f6e 616d 6522 3a20  standard_name": 
-00001e50: 2272 6164 6172 5f64 6f70 706c 6572 5f73  "radar_doppler_s
-00001e60: 7065 6374 7275 6d5f 7769 6474 685f 6822  pectrum_width_h"
-00001e70: 2c0a 2020 2020 2020 2020 226c 6f6e 675f  ,.        "long_
-00001e80: 6e61 6d65 223a 2022 446f 7070 6c65 7220  name": "Doppler 
-00001e90: 7370 6563 7472 756d 2077 6964 7468 2048  spectrum width H
-00001ea0: 222c 0a20 2020 2020 2020 2022 7368 6f72  ",.        "shor
-00001eb0: 745f 6e61 6d65 223a 2022 5557 5241 4448  t_name": "UWRADH
-00001ec0: 222c 0a20 2020 2020 2020 2022 756e 6974  ",.        "unit
-00001ed0: 7322 3a20 226d 6574 6572 7320 7065 7220  s": "meters per 
-00001ee0: 7365 636f 6e64 7322 2c0a 2020 2020 2020  seconds",.      
-00001ef0: 2020 2267 616d 6963 223a 205b 2275 7768    "gamic": ["uwh
-00001f00: 225d 2c0a 2020 2020 7d2c 0a20 2020 2022  "],.    },.    "
-00001f10: 5752 4144 5622 3a20 7b0a 2020 2020 2020  WRADV": {.      
-00001f20: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
-00001f30: 223a 2022 7261 6461 725f 646f 7070 6c65  ": "radar_dopple
-00001f40: 725f 7370 6563 7472 756d 5f77 6964 7468  r_spectrum_width
-00001f50: 5f76 222c 0a20 2020 2020 2020 2022 6c6f  _v",.        "lo
-00001f60: 6e67 5f6e 616d 6522 3a20 2244 6f70 706c  ng_name": "Doppl
-00001f70: 6572 2073 7065 6374 7275 6d20 7769 6474  er spectrum widt
-00001f80: 6820 5622 2c0a 2020 2020 2020 2020 2273  h V",.        "s
-00001f90: 686f 7274 5f6e 616d 6522 3a20 2257 5241  hort_name": "WRA
-00001fa0: 4456 222c 0a20 2020 2020 2020 2022 756e  DV",.        "un
-00001fb0: 6974 7322 3a20 226d 6574 6572 7320 7065  its": "meters pe
-00001fc0: 7220 7365 636f 6e64 222c 0a20 2020 2020  r second",.     
-00001fd0: 2020 2022 6761 6d69 6322 3a20 5b22 7776     "gamic": ["wv
-00001fe0: 225d 2c0a 2020 2020 7d2c 0a20 2020 2022  "],.    },.    "
-00001ff0: 5752 4144 223a 207b 0a20 2020 2020 2020  WRAD": {.       
-00002000: 2022 7374 616e 6461 7264 5f6e 616d 6522   "standard_name"
-00002010: 3a20 2272 6164 6172 5f64 6f70 706c 6572  : "radar_doppler
-00002020: 5f73 7065 6374 7275 6d5f 7769 6474 6822  _spectrum_width"
-00002030: 2c0a 2020 2020 2020 2020 226c 6f6e 675f  ,.        "long_
-00002040: 6e61 6d65 223a 2022 446f 7070 6c65 7220  name": "Doppler 
-00002050: 7370 6563 7472 756d 2077 6964 7468 222c  spectrum width",
-00002060: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
-00002070: 6e61 6d65 223a 2022 5752 4144 222c 0a20  name": "WRAD",. 
-00002080: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
-00002090: 226d 6574 6572 7320 7065 7220 7365 636f  "meters per seco
-000020a0: 6e64 222c 0a20 2020 2020 2020 2022 6761  nd",.        "ga
-000020b0: 6d69 6322 3a20 4e6f 6e65 2c0a 2020 2020  mic": None,.    
-000020c0: 7d2c 0a20 2020 2022 5a44 5222 3a20 7b0a  },.    "ZDR": {.
-000020d0: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
-000020e0: 645f 6e61 6d65 223a 2022 7261 6461 725f  d_name": "radar_
-000020f0: 6469 6666 6572 656e 7469 616c 5f72 6566  differential_ref
-00002100: 6c65 6374 6976 6974 795f 6876 222c 0a20  lectivity_hv",. 
-00002110: 2020 2020 2020 2022 6c6f 6e67 5f6e 616d         "long_nam
-00002120: 6522 3a20 224c 6f67 2064 6966 6665 7265  e": "Log differe
-00002130: 6e74 6961 6c20 7265 666c 6563 7469 7669  ntial reflectivi
-00002140: 7479 2048 2f56 222c 0a20 2020 2020 2020  ty H/V",.       
-00002150: 2022 7368 6f72 745f 6e61 6d65 223a 2022   "short_name": "
-00002160: 5a44 5222 2c0a 2020 2020 2020 2020 2275  ZDR",.        "u
-00002170: 6e69 7473 223a 2022 6442 222c 0a20 2020  nits": "dB",.   
-00002180: 2020 2020 2022 6761 6d69 6322 3a20 5b22       "gamic": ["
-00002190: 7a64 7222 5d2c 0a20 2020 207d 2c0a 2020  zdr"],.    },.  
-000021a0: 2020 2255 5a44 5222 3a20 7b0a 2020 2020    "UZDR": {.    
-000021b0: 2020 2020 2273 7461 6e64 6172 645f 6e61      "standard_na
-000021c0: 6d65 223a 2022 7261 6461 725f 6469 6666  me": "radar_diff
-000021d0: 6572 656e 7469 616c 5f72 6566 6c65 6374  erential_reflect
-000021e0: 6976 6974 795f 6876 222c 0a20 2020 2020  ivity_hv",.     
-000021f0: 2020 2022 6c6f 6e67 5f6e 616d 6522 3a20     "long_name": 
-00002200: 224c 6f67 2064 6966 6665 7265 6e74 6961  "Log differentia
-00002210: 6c20 7265 666c 6563 7469 7669 7479 2048  l reflectivity H
-00002220: 2f56 222c 0a20 2020 2020 2020 2022 7368  /V",.        "sh
-00002230: 6f72 745f 6e61 6d65 223a 2022 555a 4452  ort_name": "UZDR
-00002240: 222c 0a20 2020 2020 2020 2022 756e 6974  ",.        "unit
-00002250: 7322 3a20 2264 4222 2c0a 2020 2020 2020  s": "dB",.      
-00002260: 2020 2267 616d 6963 223a 205b 2275 7a64    "gamic": ["uzd
-00002270: 7222 5d2c 0a20 2020 207d 2c0a 2020 2020  r"],.    },.    
-00002280: 224c 4452 223a 207b 0a20 2020 2020 2020  "LDR": {.       
-00002290: 2022 7374 616e 6461 7264 5f6e 616d 6522   "standard_name"
-000022a0: 3a20 2272 6164 6172 5f6c 696e 6561 725f  : "radar_linear_
-000022b0: 6465 706f 6c61 7269 7a61 7469 6f6e 5f72  depolarization_r
-000022c0: 6174 696f 222c 0a20 2020 2020 2020 2022  atio",.        "
-000022d0: 6c6f 6e67 5f6e 616d 6522 3a20 224c 6f67  long_name": "Log
-000022e0: 2d6c 696e 6561 7220 6465 706f 6c61 7269  -linear depolari
-000022f0: 7a61 7469 6f6e 2072 6174 696f 2048 5622  zation ratio HV"
-00002300: 2c0a 2020 2020 2020 2020 2273 686f 7274  ,.        "short
-00002310: 5f6e 616d 6522 3a20 224c 4452 222c 0a20  _name": "LDR",. 
-00002320: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
-00002330: 2264 4222 2c0a 2020 2020 2020 2020 2267  "dB",.        "g
-00002340: 616d 6963 223a 205b 226c 6472 225d 2c0a  amic": ["ldr"],.
-00002350: 2020 2020 7d2c 0a20 2020 2022 5048 4944      },.    "PHID
-00002360: 5022 3a20 7b0a 2020 2020 2020 2020 2273  P": {.        "s
-00002370: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
-00002380: 7261 6461 725f 6469 6666 6572 656e 7469  radar_differenti
-00002390: 616c 5f70 6861 7365 5f68 7622 2c0a 2020  al_phase_hv",.  
-000023a0: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
-000023b0: 223a 2022 4469 6666 6572 656e 7469 616c  ": "Differential
-000023c0: 2070 6861 7365 2048 5622 2c0a 2020 2020   phase HV",.    
-000023d0: 2020 2020 2273 686f 7274 5f6e 616d 6522      "short_name"
-000023e0: 3a20 2250 4849 4450 222c 0a20 2020 2020  : "PHIDP",.     
-000023f0: 2020 2022 756e 6974 7322 3a20 2264 6567     "units": "deg
-00002400: 7265 6573 222c 0a20 2020 2020 2020 2022  rees",.        "
-00002410: 6761 6d69 6322 3a20 5b22 7068 6964 7022  gamic": ["phidp"
-00002420: 5d2c 0a20 2020 207d 2c0a 2020 2020 2255  ],.    },.    "U
-00002430: 5048 4944 5022 3a20 7b0a 2020 2020 2020  PHIDP": {.      
-00002440: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
-00002450: 223a 2022 7261 6461 725f 6469 6666 6572  ": "radar_differ
-00002460: 656e 7469 616c 5f70 6861 7365 5f68 7622  ential_phase_hv"
-00002470: 2c0a 2020 2020 2020 2020 226c 6f6e 675f  ,.        "long_
-00002480: 6e61 6d65 223a 2022 4469 6666 6572 656e  name": "Differen
-00002490: 7469 616c 2070 6861 7365 2048 5622 2c0a  tial phase HV",.
-000024a0: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
-000024b0: 616d 6522 3a20 2255 5048 4944 5022 2c0a  ame": "UPHIDP",.
-000024c0: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
-000024d0: 2022 6465 6772 6565 7322 2c0a 2020 2020   "degrees",.    
-000024e0: 2020 2020 2267 616d 6963 223a 205b 2275      "gamic": ["u
-000024f0: 7068 6964 7022 5d2c 0a20 2020 207d 2c0a  phidp"],.    },.
-00002500: 2020 2020 224b 4450 223a 207b 0a20 2020      "KDP": {.   
-00002510: 2020 2020 2022 7374 616e 6461 7264 5f6e       "standard_n
-00002520: 616d 6522 3a20 2272 6164 6172 5f73 7065  ame": "radar_spe
-00002530: 6369 6669 635f 6469 6666 6572 656e 7469  cific_differenti
-00002540: 616c 5f70 6861 7365 5f68 7622 2c0a 2020  al_phase_hv",.  
-00002550: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
-00002560: 223a 2022 5370 6563 6966 6963 2064 6966  ": "Specific dif
-00002570: 6665 7265 6e74 6961 6c20 7068 6173 6520  ferential phase 
-00002580: 4856 222c 0a20 2020 2020 2020 2022 7368  HV",.        "sh
-00002590: 6f72 745f 6e61 6d65 223a 2022 4b44 5022  ort_name": "KDP"
-000025a0: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-000025b0: 223a 2022 6465 6772 6565 7320 7065 7220  ": "degrees per 
-000025c0: 6b69 6c6f 6d65 7465 7222 2c0a 2020 2020  kilometer",.    
-000025d0: 2020 2020 2267 616d 6963 223a 205b 226b      "gamic": ["k
-000025e0: 6470 225d 2c0a 2020 2020 7d2c 0a20 2020  dp"],.    },.   
-000025f0: 2022 5248 4f48 5622 3a20 7b0a 2020 2020   "RHOHV": {.    
-00002600: 2020 2020 2273 7461 6e64 6172 645f 6e61      "standard_na
-00002610: 6d65 223a 2022 7261 6461 725f 636f 7272  me": "radar_corr
-00002620: 656c 6174 696f 6e5f 636f 6566 6669 6369  elation_coeffici
-00002630: 656e 745f 6876 222c 0a20 2020 2020 2020  ent_hv",.       
-00002640: 2022 6c6f 6e67 5f6e 616d 6522 3a20 2243   "long_name": "C
-00002650: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
-00002660: 6963 6965 6e74 2048 5622 2c0a 2020 2020  icient HV",.    
-00002670: 2020 2020 2273 686f 7274 5f6e 616d 6522      "short_name"
-00002680: 3a20 2252 484f 4856 222c 0a20 2020 2020  : "RHOHV",.     
-00002690: 2020 2022 756e 6974 7322 3a20 2275 6e69     "units": "uni
-000026a0: 746c 6573 7322 2c0a 2020 2020 2020 2020  tless",.        
-000026b0: 2267 616d 6963 223a 205b 2272 686f 6876  "gamic": ["rhohv
-000026c0: 225d 2c0a 2020 2020 7d2c 0a20 2020 2022  "],.    },.    "
-000026d0: 5552 484f 4856 223a 207b 0a20 2020 2020  URHOHV": {.     
-000026e0: 2020 2022 7374 616e 6461 7264 5f6e 616d     "standard_nam
-000026f0: 6522 3a20 2272 6164 6172 5f63 6f72 7265  e": "radar_corre
-00002700: 6c61 7469 6f6e 5f63 6f65 6666 6963 6965  lation_coefficie
-00002710: 6e74 5f68 7622 2c0a 2020 2020 2020 2020  nt_hv",.        
-00002720: 226c 6f6e 675f 6e61 6d65 223a 2022 436f  "long_name": "Co
-00002730: 7272 656c 6174 696f 6e20 636f 6566 6669  rrelation coeffi
-00002740: 6369 656e 7420 4856 222c 0a20 2020 2020  cient HV",.     
-00002750: 2020 2022 7368 6f72 745f 6e61 6d65 223a     "short_name":
-00002760: 2022 5552 484f 4856 222c 0a20 2020 2020   "URHOHV",.     
-00002770: 2020 2022 756e 6974 7322 3a20 2275 6e69     "units": "uni
-00002780: 746c 6573 7322 2c0a 2020 2020 2020 2020  tless",.        
-00002790: 2267 616d 6963 223a 205b 2275 7268 6f68  "gamic": ["urhoh
-000027a0: 7622 5d2c 0a20 2020 207d 2c0a 2020 2020  v"],.    },.    
-000027b0: 2253 4e52 4822 3a20 7b0a 2020 2020 2020  "SNRH": {.      
-000027c0: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
-000027d0: 223a 2022 7369 676e 616c 5f6e 6f69 7365  ": "signal_noise
-000027e0: 5f72 6174 696f 5f68 222c 0a20 2020 2020  _ratio_h",.     
-000027f0: 2020 2022 6c6f 6e67 5f6e 616d 6522 3a20     "long_name": 
-00002800: 2253 6967 6e61 6c20 4e6f 6973 6520 5261  "Signal Noise Ra
-00002810: 7469 6f20 4822 2c0a 2020 2020 2020 2020  tio H",.        
-00002820: 2273 686f 7274 5f6e 616d 6522 3a20 2253  "short_name": "S
-00002830: 4e52 4822 2c0a 2020 2020 2020 2020 2275  NRH",.        "u
-00002840: 6e69 7473 223a 2022 756e 6974 6c65 7373  nits": "unitless
-00002850: 222c 0a20 2020 2020 2020 2022 6761 6d69  ",.        "gami
-00002860: 6322 3a20 4e6f 6e65 2c0a 2020 2020 7d2c  c": None,.    },
-00002870: 0a20 2020 2022 534e 5256 223a 207b 0a20  .    "SNRV": {. 
-00002880: 2020 2020 2020 2022 7374 616e 6461 7264         "standard
-00002890: 5f6e 616d 6522 3a20 2273 6967 6e61 6c5f  _name": "signal_
-000028a0: 6e6f 6973 655f 7261 7469 6f5f 7622 2c0a  noise_ratio_v",.
-000028b0: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
-000028c0: 6d65 223a 2022 5369 676e 616c 204e 6f69  me": "Signal Noi
-000028d0: 7365 2052 6174 696f 2056 222c 0a20 2020  se Ratio V",.   
-000028e0: 2020 2020 2022 7368 6f72 745f 6e61 6d65       "short_name
-000028f0: 223a 2022 534e 5256 222c 0a20 2020 2020  ": "SNRV",.     
-00002900: 2020 2022 756e 6974 7322 3a20 2275 6e69     "units": "uni
-00002910: 746c 6573 7322 2c0a 2020 2020 2020 2020  tless",.        
-00002920: 2267 616d 6963 223a 204e 6f6e 652c 0a20  "gamic": None,. 
-00002930: 2020 207d 2c0a 2020 2020 2253 5149 4822     },.    "SQIH"
-00002940: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
-00002950: 6e64 6172 645f 6e61 6d65 223a 2022 7369  ndard_name": "si
-00002960: 676e 616c 5f71 7561 6c69 7479 5f69 6e64  gnal_quality_ind
-00002970: 6578 5f68 222c 0a20 2020 2020 2020 2022  ex_h",.        "
-00002980: 6c6f 6e67 5f6e 616d 6522 3a20 2253 6967  long_name": "Sig
-00002990: 6e61 6c20 5175 616c 6974 7920 4822 2c0a  nal Quality H",.
-000029a0: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
-000029b0: 616d 6522 3a20 2253 5149 4822 2c0a 2020  ame": "SQIH",.  
-000029c0: 2020 2020 2020 2275 6e69 7473 223a 2022        "units": "
-000029d0: 756e 6974 6c65 7373 222c 0a20 2020 2020  unitless",.     
-000029e0: 2020 2022 6761 6d69 6322 3a20 4e6f 6e65     "gamic": None
-000029f0: 2c0a 2020 2020 7d2c 0a20 2020 2022 5351  ,.    },.    "SQ
-00002a00: 4956 223a 207b 0a20 2020 2020 2020 2022  IV": {.        "
-00002a10: 7374 616e 6461 7264 5f6e 616d 6522 3a20  standard_name": 
-00002a20: 2273 6967 6e61 6c5f 7175 616c 6974 795f  "signal_quality_
-00002a30: 696e 6465 785f 7622 2c0a 2020 2020 2020  index_v",.      
-00002a40: 2020 226c 6f6e 675f 6e61 6d65 223a 2022    "long_name": "
-00002a50: 5369 676e 616c 2051 7561 6c69 7479 2056  Signal Quality V
-00002a60: 222c 0a20 2020 2020 2020 2022 7368 6f72  ",.        "shor
-00002a70: 745f 6e61 6d65 223a 2022 5351 4956 222c  t_name": "SQIV",
-00002a80: 0a20 2020 2020 2020 2022 756e 6974 7322  .        "units"
-00002a90: 3a20 2275 6e69 746c 6573 7322 2c0a 2020  : "unitless",.  
-00002aa0: 2020 2020 2020 2267 616d 6963 223a 204e        "gamic": N
-00002ab0: 6f6e 652c 0a20 2020 207d 2c0a 2020 2020  one,.    },.    
-00002ac0: 2243 434f 5248 223a 207b 0a20 2020 2020  "CCORH": {.     
-00002ad0: 2020 2022 7374 616e 6461 7264 5f6e 616d     "standard_nam
-00002ae0: 6522 3a20 2263 6c75 7474 6572 5f63 6f72  e": "clutter_cor
-00002af0: 7265 6374 696f 6e5f 6822 2c0a 2020 2020  rection_h",.    
-00002b00: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
-00002b10: 2022 436c 7574 7465 7220 436f 7272 6563   "Clutter Correc
-00002b20: 7469 6f6e 2048 222c 0a20 2020 2020 2020  tion H",.       
-00002b30: 2022 7368 6f72 745f 6e61 6d65 223a 2022   "short_name": "
-00002b40: 4343 4f52 4822 2c0a 2020 2020 2020 2020  CCORH",.        
-00002b50: 2275 6e69 7473 223a 2022 756e 6974 6c65  "units": "unitle
-00002b60: 7373 222c 0a20 2020 2020 2020 2022 6761  ss",.        "ga
-00002b70: 6d69 6322 3a20 4e6f 6e65 2c0a 2020 2020  mic": None,.    
-00002b80: 7d2c 0a20 2020 2022 4343 4f52 5622 3a20  },.    "CCORV": 
-00002b90: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
-00002ba0: 6172 645f 6e61 6d65 223a 2022 636c 7574  ard_name": "clut
-00002bb0: 7465 725f 636f 7272 6563 7469 6f6e 5f76  ter_correction_v
-00002bc0: 222c 0a20 2020 2020 2020 2022 6c6f 6e67  ",.        "long
-00002bd0: 5f6e 616d 6522 3a20 2243 6c75 7474 6572  _name": "Clutter
-00002be0: 2043 6f72 7265 6374 696f 6e20 5622 2c0a   Correction V",.
-00002bf0: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
-00002c00: 616d 6522 3a20 2243 434f 5256 222c 0a20  ame": "CCORV",. 
-00002c10: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
-00002c20: 2275 6e69 746c 6573 7322 2c0a 2020 2020  "unitless",.    
-00002c30: 2020 2020 2267 616d 6963 223a 204e 6f6e      "gamic": Non
-00002c40: 652c 0a20 2020 207d 2c0a 2020 2020 2243  e,.    },.    "C
-00002c50: 4d41 5022 3a20 7b0a 2020 2020 2020 2020  MAP": {.        
-00002c60: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
-00002c70: 2022 636c 7574 7465 725f 6d61 7022 2c0a   "clutter_map",.
-00002c80: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
-00002c90: 6d65 223a 2022 436c 7574 7465 7220 4d61  me": "Clutter Ma
-00002ca0: 7022 2c0a 2020 2020 2020 2020 2273 686f  p",.        "sho
-00002cb0: 7274 5f6e 616d 6522 3a20 2243 4d41 5022  rt_name": "CMAP"
-00002cc0: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
-00002cd0: 223a 2022 756e 6974 6c65 7373 222c 0a20  ": "unitless",. 
-00002ce0: 2020 2020 2020 2022 6761 6d69 6322 3a20         "gamic": 
-00002cf0: 5b22 636d 6170 225d 2c0a 2020 2020 7d2c  ["cmap"],.    },
-00002d00: 0a7d 0a0a 4f44 494d 5f4e 414d 4553 203d  .}..ODIM_NAMES =
-00002d10: 207b 7661 6c75 655b 2273 686f 7274 5f6e   {value["short_n
-00002d20: 616d 6522 5d3a 206b 6579 2066 6f72 2028  ame"]: key for (
-00002d30: 6b65 792c 2076 616c 7565 2920 696e 206d  key, value) in m
-00002d40: 6f6d 656e 7473 5f6d 6170 7069 6e67 2e69  oments_mapping.i
-00002d50: 7465 6d73 2829 7d0a 0a47 414d 4943 5f4e  tems()}..GAMIC_N
-00002d60: 414d 4553 203d 207b 0a20 2020 2076 3a20  AMES = {.    v: 
-00002d70: 6b65 790a 2020 2020 666f 7220 286b 6579  key.    for (key
-00002d80: 2c20 7661 6c75 6529 2069 6e20 6d6f 6d65  , value) in mome
-00002d90: 6e74 735f 6d61 7070 696e 672e 6974 656d  nts_mapping.item
-00002da0: 7328 290a 2020 2020 6966 2076 616c 7565  s().    if value
-00002db0: 5b22 6761 6d69 6322 5d20 6973 206e 6f74  ["gamic"] is not
-00002dc0: 204e 6f6e 650a 2020 2020 666f 7220 7620   None.    for v 
-00002dd0: 696e 2076 616c 7565 5b22 6761 6d69 6322  in value["gamic"
-00002de0: 5d0a 7d0a 0a72 616e 6765 5f61 7474 7273  ].}..range_attrs
-00002df0: 203d 207b 0a20 2020 2022 756e 6974 7322   = {.    "units"
-00002e00: 3a20 226d 6574 6572 7322 2c0a 2020 2020  : "meters",.    
-00002e10: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
-00002e20: 2022 7072 6f6a 6563 7469 6f6e 5f72 616e   "projection_ran
-00002e30: 6765 5f63 6f6f 7264 696e 6174 6522 2c0a  ge_coordinate",.
-00002e40: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
-00002e50: 2022 7261 6e67 655f 746f 5f6d 6561 7375   "range_to_measu
-00002e60: 7265 6d65 6e74 5f76 6f6c 756d 6522 2c0a  rement_volume",.
-00002e70: 2020 2020 2273 7061 6369 6e67 5f69 735f      "spacing_is_
-00002e80: 636f 6e73 7461 6e74 223a 2022 7472 7565  constant": "true
-00002e90: 222c 0a20 2020 2022 6178 6973 223a 2022  ",.    "axis": "
-00002ea0: 7261 6469 616c 5f72 616e 6765 5f63 6f6f  radial_range_coo
-00002eb0: 7264 696e 6174 6522 2c0a 2020 2020 226d  rdinate",.    "m
-00002ec0: 6574 6572 735f 746f 5f63 656e 7465 725f  eters_to_center_
-00002ed0: 6f66 5f66 6972 7374 5f67 6174 6522 3a20  of_first_gate": 
-00002ee0: 4e6f 6e65 2c0a 7d0a 0a61 7a5f 6174 7472  None,.}..az_attr
-00002ef0: 7320 3d20 7b0a 2020 2020 2273 7461 6e64  s = {.    "stand
-00002f00: 6172 645f 6e61 6d65 223a 2022 7261 795f  ard_name": "ray_
-00002f10: 617a 696d 7574 685f 616e 676c 6522 2c0a  azimuth_angle",.
-00002f20: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
-00002f30: 2022 617a 696d 7574 685f 616e 676c 655f   "azimuth_angle_
-00002f40: 6672 6f6d 5f74 7275 655f 6e6f 7274 6822  from_true_north"
-00002f50: 2c0a 2020 2020 2275 6e69 7473 223a 2022  ,.    "units": "
-00002f60: 6465 6772 6565 7322 2c0a 2020 2020 2261  degrees",.    "a
-00002f70: 7869 7322 3a20 2272 6164 6961 6c5f 617a  xis": "radial_az
-00002f80: 696d 7574 685f 636f 6f72 6469 6e61 7465  imuth_coordinate
-00002f90: 222c 0a7d 0a0a 656c 5f61 7474 7273 203d  ",.}..el_attrs =
-00002fa0: 207b 0a20 2020 2022 7374 616e 6461 7264   {.    "standard
-00002fb0: 5f6e 616d 6522 3a20 2272 6179 5f65 6c65  _name": "ray_ele
-00002fc0: 7661 7469 6f6e 5f61 6e67 6c65 222c 0a20  vation_angle",. 
-00002fd0: 2020 2022 6c6f 6e67 5f6e 616d 6522 3a20     "long_name": 
-00002fe0: 2265 6c65 7661 7469 6f6e 5f61 6e67 6c65  "elevation_angle
-00002ff0: 5f66 726f 6d5f 686f 7269 7a6f 6e74 616c  _from_horizontal
-00003000: 5f70 6c61 6e65 222c 0a20 2020 2022 756e  _plane",.    "un
-00003010: 6974 7322 3a20 2264 6567 7265 6573 222c  its": "degrees",
-00003020: 0a20 2020 2022 6178 6973 223a 2022 7261  .    "axis": "ra
-00003030: 6469 616c 5f65 6c65 7661 7469 6f6e 5f63  dial_elevation_c
-00003040: 6f6f 7264 696e 6174 6522 2c0a 7d0a 0a74  oordinate",.}..t
-00003050: 696d 655f 6174 7472 7320 3d20 7b0a 2020  ime_attrs = {.  
-00003060: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
-00003070: 223a 2022 7469 6d65 222c 0a20 2020 2022  ": "time",.    "
-00003080: 756e 6974 7322 3a20 2273 6563 6f6e 6473  units": "seconds
-00003090: 2073 696e 6365 2031 3937 302d 3031 2d30   since 1970-01-0
-000030a0: 3154 3030 3a30 303a 3030 5a22 2c0a 7d0a  1T00:00:00Z",.}.
-000030b0: 0a72 6f6f 745f 7661 7273 203d 207b 0a20  .root_vars = {. 
-000030c0: 2020 2022 766f 6c75 6d65 5f6e 756d 6265     "volume_numbe
-000030d0: 7222 2c0a 2020 2020 2270 6c61 7466 6f72  r",.    "platfor
-000030e0: 6d5f 7479 7065 222c 0a20 2020 2022 696e  m_type",.    "in
-000030f0: 7374 7275 6d65 6e74 5f74 7970 6522 2c0a  strument_type",.
-00003100: 2020 2020 2270 7269 6d61 7279 5f61 7869      "primary_axi
-00003110: 7322 2c0a 2020 2020 2274 696d 655f 636f  s",.    "time_co
-00003120: 7665 7261 6765 5f73 7461 7274 222c 0a20  verage_start",. 
-00003130: 2020 2022 7469 6d65 5f63 6f76 6572 6167     "time_coverag
-00003140: 655f 656e 6422 2c0a 2020 2020 226c 6174  e_end",.    "lat
-00003150: 6974 7564 6522 2c0a 2020 2020 226c 6f6e  itude",.    "lon
-00003160: 6769 7475 6465 222c 0a20 2020 2022 616c  gitude",.    "al
-00003170: 7469 7475 6465 222c 0a20 2020 2022 6669  titude",.    "fi
-00003180: 7865 645f 616e 676c 6522 2c0a 2020 2020  xed_angle",.    
-00003190: 2273 7461 7475 735f 786d 6c22 2c0a 7d0a  "status_xml",.}.
-000031a0: 0a73 7765 6570 5f76 6172 7331 203d 207b  .sweep_vars1 = {
-000031b0: 0a20 2020 2022 7377 6565 705f 6e75 6d62  .    "sweep_numb
-000031c0: 6572 222c 0a20 2020 2022 7377 6565 705f  er",.    "sweep_
-000031d0: 6d6f 6465 222c 0a20 2020 2022 706f 6c61  mode",.    "pola
-000031e0: 7269 7a61 7469 6f6e 5f6d 6f64 6522 2c0a  rization_mode",.
-000031f0: 2020 2020 2270 7274 5f6d 6f64 6522 2c0a      "prt_mode",.
-00003200: 2020 2020 2266 6f6c 6c6f 775f 6d6f 6465      "follow_mode
-00003210: 222c 0a20 2020 2022 6669 7865 645f 616e  ",.    "fixed_an
-00003220: 676c 6522 2c0a 2020 2020 2274 6172 6765  gle",.    "targe
-00003230: 745f 7363 616e 5f72 6174 6522 2c0a 2020  t_scan_rate",.  
-00003240: 2020 2273 7765 6570 5f73 7461 7274 5f72    "sweep_start_r
-00003250: 6179 5f69 6e64 6578 222c 0a20 2020 2022  ay_index",.    "
-00003260: 7377 6565 705f 656e 645f 7261 795f 696e  sweep_end_ray_in
-00003270: 6465 7822 2c0a 7d0a 0a73 7765 6570 5f76  dex",.}..sweep_v
-00003280: 6172 7332 203d 207b 0a20 2020 2022 617a  ars2 = {.    "az
-00003290: 696d 7574 6822 2c0a 2020 2020 2265 6c65  imuth",.    "ele
-000032a0: 7661 7469 6f6e 222c 0a20 2020 2022 7075  vation",.    "pu
-000032b0: 6c73 655f 7769 6474 6822 2c0a 2020 2020  lse_width",.    
-000032c0: 2270 7274 222c 0a20 2020 2022 6e79 7175  "prt",.    "nyqu
-000032d0: 6973 745f 7665 6c6f 6369 7479 222c 0a20  ist_velocity",. 
-000032e0: 2020 2022 756e 616d 6269 6775 6f75 735f     "unambiguous_
-000032f0: 7261 6e67 6522 2c0a 2020 2020 2261 6e74  range",.    "ant
-00003300: 656e 6e61 5f74 7261 6e73 6974 696f 6e22  enna_transition"
-00003310: 2c0a 2020 2020 226e 5f73 616d 706c 6573  ,.    "n_samples
-00003320: 222c 0a20 2020 2022 725f 6361 6c69 625f  ",.    "r_calib_
-00003330: 696e 6465 7822 2c0a 2020 2020 2273 6361  index",.    "sca
-00003340: 6e5f 7261 7465 222c 0a7d 0a0a 7377 6565  n_rate",.}..swee
-00003350: 705f 7661 7273 3320 3d20 7b22 4442 5a22  p_vars3 = {"DBZ"
-00003360: 2c20 2256 5222 2c20 2274 696d 6522 2c20  , "VR", "time", 
-00003370: 2272 616e 6765 222c 2022 7265 666c 6563  "range", "reflec
-00003380: 7469 7669 7479 5f68 6f72 697a 6f6e 7461  tivity_horizonta
-00003390: 6c22 7d0a 0a63 665f 6675 6c6c 5f76 6172  l"}..cf_full_var
-000033a0: 7320 3d20 7b22 7072 7422 3a20 2270 7266  s = {"prt": "prf
-000033b0: 222c 2022 6e5f 7361 6d70 6c65 7322 3a20  ", "n_samples": 
-000033c0: 2270 756c 7365 227d 0a0a 676c 6f62 616c  "pulse"}..global
-000033d0: 5f61 7474 7273 203d 205b 0a20 2020 2028  _attrs = [.    (
-000033e0: 2243 6f6e 7665 6e74 696f 6e73 222c 2022  "Conventions", "
-000033f0: 4366 2f52 6164 6961 6c22 292c 0a20 2020  Cf/Radial"),.   
-00003400: 2028 2276 6572 7369 6f6e 222c 2022 4366   ("version", "Cf
-00003410: 2f52 6164 6961 6c20 7665 7273 696f 6e20  /Radial version 
-00003420: 6e75 6d62 6572 2229 2c0a 2020 2020 2822  number"),.    ("
-00003430: 7469 746c 6522 2c20 2273 686f 7274 2064  title", "short d
-00003440: 6573 6372 6970 7469 6f6e 206f 6620 6669  escription of fi
-00003450: 6c65 2063 6f6e 7465 6e74 7322 292c 0a20  le contents"),. 
-00003460: 2020 2028 2269 6e73 7469 7475 7469 6f6e     ("institution
-00003470: 222c 2022 7768 6572 6520 7468 6520 6f72  ", "where the or
-00003480: 6967 696e 616c 2064 6174 6120 7765 7265  iginal data were
-00003490: 2070 726f 6475 6365 6422 292c 0a20 2020   produced"),.   
-000034a0: 2028 0a20 2020 2020 2020 2022 7265 6665   (.        "refe
-000034b0: 7265 6e63 6573 222c 0a20 2020 2020 2020  rences",.       
-000034c0: 2028 2272 6566 6572 656e 6365 7320 7468   ("references th
-000034d0: 6174 2064 6573 6372 6962 6520 7468 6520  at describe the 
-000034e0: 6461 7461 206f 7220 7468 6520 6d65 7468  data or the meth
-000034f0: 6f64 7320 7573 6564 2022 2022 746f 2070  ods used " "to p
-00003500: 726f 6475 6365 2069 7422 292c 0a20 2020  roduce it"),.   
-00003510: 2029 2c0a 2020 2020 2822 736f 7572 6365   ),.    ("source
-00003520: 222c 2022 6d65 7468 6f64 206f 6620 7072  ", "method of pr
-00003530: 6f64 7563 7469 6f6e 206f 6620 7468 6520  oduction of the 
-00003540: 6f72 6967 696e 616c 2064 6174 6122 292c  original data"),
-00003550: 0a20 2020 2028 2268 6973 746f 7279 222c  .    ("history",
-00003560: 2022 6c69 7374 206f 6620 6d6f 6469 6669   "list of modifi
-00003570: 6361 7469 6f6e 7320 746f 2074 6865 206f  cations to the o
-00003580: 7269 6769 6e61 6c20 6461 7461 2229 2c0a  riginal data"),.
-00003590: 2020 2020 2822 636f 6d6d 656e 7422 2c20      ("comment", 
-000035a0: 226d 6973 6365 6c6c 616e 656f 7573 2069  "miscellaneous i
-000035b0: 6e66 6f72 6d61 7469 6f6e 2229 2c0a 2020  nformation"),.  
-000035c0: 2020 2822 696e 7374 7275 6d65 6e74 5f6e    ("instrument_n
-000035d0: 616d 6522 2c20 226e 616d 6554 6865 2020  ame", "nameThe  
-000035e0: 6f66 2072 6164 6172 206f 7220 6c69 6461  of radar or lida
-000035f0: 7222 292c 0a20 2020 2028 2273 6974 655f  r"),.    ("site_
-00003600: 6e61 6d65 222c 2022 6e61 6d65 206f 6620  name", "name of 
-00003610: 7369 7465 2077 6865 7265 2064 6174 6120  site where data 
-00003620: 7765 7265 2067 6174 6865 7265 6422 292c  were gathered"),
-00003630: 0a20 2020 2028 2273 6361 6e5f 6e61 6d65  .    ("scan_name
-00003640: 222c 2022 6e61 6d65 206f 6620 7363 616e  ", "name of scan
-00003650: 2073 7472 6174 6567 7920 7573 6564 2c20   strategy used, 
-00003660: 6966 2061 7070 6c69 6361 626c 6522 292c  if applicable"),
-00003670: 0a20 2020 2028 2273 6361 6e5f 6964 222c  .    ("scan_id",
-00003680: 2022 7363 616e 2073 7472 6174 6567 7920   "scan strategy 
-00003690: 6964 2c20 6966 2061 7070 6c69 6361 626c  id, if applicabl
-000036a0: 652e 2061 7373 756d 6564 2030 2069 6620  e. assumed 0 if 
-000036b0: 6d69 7373 696e 6722 292c 0a20 2020 2028  missing"),.    (
-000036c0: 2270 6c61 7466 6f72 6d5f 6973 5f6d 6f62  "platform_is_mob
-000036d0: 696c 6522 2c20 2722 7472 7565 2220 6f72  ile", '"true" or
-000036e0: 2022 6661 6c73 6522 2c20 6173 7375 6d65   "false", assume
-000036f0: 6420 2266 616c 7365 2220 6966 206d 6973  d "false" if mis
-00003700: 7369 6e67 2729 2c0a 2020 2020 280a 2020  sing'),.    (.  
-00003710: 2020 2020 2020 2272 6179 5f74 696d 6573        "ray_times
-00003720: 5f69 6e63 7265 6173 6522 2c0a 2020 2020  _increase",.    
-00003730: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00003740: 2020 2722 7472 7565 2220 6f72 2022 6661    '"true" or "fa
-00003750: 6c73 6522 2c20 6173 7375 6d65 6420 2274  lse", assumed "t
-00003760: 7275 6522 2069 6620 6d69 7373 696e 672e  rue" if missing.
-00003770: 2027 0a20 2020 2020 2020 2020 2020 2022   '.            "
-00003780: 5468 6973 2069 7320 7365 7420 746f 2074  This is set to t
-00003790: 7275 6520 6966 2072 6179 2074 696d 6573  rue if ray times
-000037a0: 2069 6e63 7265 6173 6520 6d6f 6e6f 746f   increase monoto
-000037b0: 6e69 6361 6c6c 7920 220a 2020 2020 2020  nically ".      
-000037c0: 2020 2020 2020 2274 686f 7567 686f 7574        "thoughout
-000037d0: 2061 6c6c 206f 6620 7468 6520 7377 6565   all of the swee
-000037e0: 7073 2069 6e20 7468 6520 766f 6c75 6d65  ps in the volume
-000037f0: 220a 2020 2020 2020 2020 292c 0a20 2020  ".        ),.   
-00003800: 2029 2c0a 2020 2020 2822 6669 656c 645f   ),.    ("field_
-00003810: 6e61 6d65 7322 2c20 2261 7272 6179 206f  names", "array o
-00003820: 6620 7374 7269 6e67 7320 6f66 2066 6965  f strings of fie
-00003830: 6c64 206e 616d 6573 2070 7265 7365 6e74  ld names present
-00003840: 2069 6e20 7468 6973 2066 696c 652e 2229   in this file.")
-00003850: 2c0a 2020 2020 2822 7469 6d65 5f63 6f76  ,.    ("time_cov
-00003860: 6572 6167 655f 7374 6172 7422 2c20 2263  erage_start", "c
-00003870: 6f70 7920 6f66 2074 696d 655f 636f 7665  opy of time_cove
-00003880: 7261 6765 5f73 7461 7274 2067 6c6f 6261  rage_start globa
-00003890: 6c20 7661 7269 6162 6c65 2229 2c0a 2020  l variable"),.  
-000038a0: 2020 2822 7469 6d65 5f63 6f76 6572 6167    ("time_coverag
-000038b0: 655f 656e 6422 2c20 2263 6f70 7920 6f66  e_end", "copy of
-000038c0: 2074 696d 655f 636f 7665 7261 6765 5f65   time_coverage_e
-000038d0: 6e64 2067 6c6f 6261 6c20 7661 7269 6162  nd global variab
-000038e0: 6c65 2229 2c0a 2020 2020 280a 2020 2020  le"),.    (.    
-000038f0: 2020 2020 2273 696d 756c 6174 6564 2064      "simulated d
-00003900: 6174 6122 2c0a 2020 2020 2020 2020 280a  ata",.        (.
-00003910: 2020 2020 2020 2020 2020 2020 2722 7472              '"tr
-00003920: 7565 2220 6f72 2022 6661 6c73 6522 2c20  ue" or "false", 
-00003930: 6173 7375 6d65 6420 2266 616c 7365 2220  assumed "false" 
-00003940: 6966 206d 6973 7369 6e67 2e20 270a 2020  if missing. '.  
-00003950: 2020 2020 2020 2020 2020 2264 6174 6120            "data 
-00003960: 696e 2074 6869 7320 6669 6c65 2061 7265  in this file are
-00003970: 2073 696d 756c 6174 6564 220a 2020 2020   simulated".    
-00003980: 2020 2020 292c 0a20 2020 2029 2c0a 5d0a      ),.    ),.].
-00003990: 0a67 6c6f 6261 6c5f 7661 7269 6162 6c65  .global_variable
-000039a0: 7320 3d20 6469 6374 280a 2020 2020 5b0a  s = dict(.    [.
-000039b0: 2020 2020 2020 2020 2822 766f 6c75 6d65          ("volume
-000039c0: 5f6e 756d 6265 7222 2c20 6e70 2e69 6e74  _number", np.int
-000039d0: 292c 0a20 2020 2020 2020 2028 2270 6c61  ),.        ("pla
-000039e0: 7466 6f72 6d5f 7479 7065 222c 2022 6669  tform_type", "fi
-000039f0: 7865 6422 292c 0a20 2020 2020 2020 2028  xed"),.        (
-00003a00: 2269 6e73 7472 756d 656e 745f 7479 7065  "instrument_type
-00003a10: 222c 2022 7261 6461 7222 292c 0a20 2020  ", "radar"),.   
-00003a20: 2020 2020 2028 2270 7269 6d61 7279 5f61       ("primary_a
-00003a30: 7869 7322 2c20 2261 7869 735f 7a22 292c  xis", "axis_z"),
-00003a40: 0a20 2020 2020 2020 2028 2274 696d 655f  .        ("time_
-00003a50: 636f 7665 7261 6765 5f73 7461 7274 222c  coverage_start",
-00003a60: 2022 3139 3730 2d30 312d 3031 5430 303a   "1970-01-01T00:
-00003a70: 3030 3a30 305a 2229 2c0a 2020 2020 2020  00:00Z"),.      
-00003a80: 2020 2822 7469 6d65 5f63 6f76 6572 6167    ("time_coverag
-00003a90: 655f 656e 6422 2c20 2231 3937 302d 3031  e_end", "1970-01
-00003aa0: 2d30 3154 3030 3a30 303a 3030 5a22 292c  -01T00:00:00Z"),
-00003ab0: 0a20 2020 2020 2020 2028 226c 6174 6974  .        ("latit
-00003ac0: 7564 6522 2c20 6e70 2e6e 616e 292c 0a20  ude", np.nan),. 
-00003ad0: 2020 2020 2020 2028 226c 6f6e 6769 7475         ("longitu
-00003ae0: 6465 222c 206e 702e 6e61 6e29 2c0a 2020  de", np.nan),.  
-00003af0: 2020 2020 2020 2822 616c 7469 7475 6465        ("altitude
-00003b00: 222c 206e 702e 6e61 6e29 2c0a 2020 2020  ", np.nan),.    
-00003b10: 2020 2020 2822 616c 7469 7475 6465 5f61      ("altitude_a
-00003b20: 676c 222c 206e 702e 6e61 6e29 2c0a 2020  gl", np.nan),.  
-00003b30: 2020 2020 2020 2822 7377 6565 705f 6772        ("sweep_gr
-00003b40: 6f75 705f 6e61 6d65 222c 2028 5b22 7377  oup_name", (["sw
-00003b50: 6565 7022 5d2c 205b 6e70 2e6e 616e 5d29  eep"], [np.nan])
-00003b60: 292c 0a20 2020 2020 2020 2028 2273 7765  ),.        ("swe
-00003b70: 6570 5f66 6978 6564 5f61 6e67 6c65 222c  ep_fixed_angle",
-00003b80: 2028 5b22 7377 6565 7022 5d2c 205b 6e70   (["sweep"], [np
-00003b90: 2e6e 616e 5d29 292c 0a20 2020 2020 2020  .nan])),.       
-00003ba0: 2028 2266 7265 7175 656e 6379 222c 206e   ("frequency", n
-00003bb0: 702e 6e61 6e29 2c0a 2020 2020 2020 2020  p.nan),.        
-00003bc0: 2822 7374 6174 7573 5f78 6d6c 222c 2022  ("status_xml", "
-00003bd0: 4e6f 6e65 2229 2c0a 2020 2020 5d0a 290a  None"),.    ].).
-00003be0: 0a0a 4078 722e 7265 6769 7374 6572 5f64  ..@xr.register_d
-00003bf0: 6174 6173 6574 5f61 6363 6573 736f 7228  ataset_accessor(
-00003c00: 2267 616d 6963 2229 0a63 6c61 7373 2047  "gamic").class G
-00003c10: 616d 6963 4163 6365 7373 6f72 286f 626a  amicAccessor(obj
-00003c20: 6563 7429 3a0a 2020 2020 2222 2244 6174  ect):.    """Dat
-00003c30: 6173 6574 2041 6363 6573 736f 7220 666f  aset Accessor fo
-00003c40: 7220 6861 6e64 6c69 6e67 2047 414d 4943  r handling GAMIC
-00003c50: 2048 4446 3520 6461 7461 2066 696c 6573   HDF5 data files
-00003c60: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
-00003c70: 6e69 745f 5f28 7365 6c66 2c20 7861 7272  nit__(self, xarr
-00003c80: 6179 5f6f 626a 293a 0a20 2020 2020 2020  ay_obj):.       
-00003c90: 2073 656c 662e 5f6f 626a 203d 2078 6172   self._obj = xar
-00003ca0: 7261 795f 6f62 6a0a 2020 2020 2020 2020  ray_obj.        
-00003cb0: 7365 6c66 2e5f 7261 6469 616c 5f72 616e  self._radial_ran
-00003cc0: 6765 203d 204e 6f6e 650a 2020 2020 2020  ge = None.      
-00003cd0: 2020 7365 6c66 2e5f 617a 696d 7574 685f    self._azimuth_
-00003ce0: 7261 6e67 6520 3d20 4e6f 6e65 0a20 2020  range = None.   
-00003cf0: 2020 2020 2073 656c 662e 5f65 6c65 7661       self._eleva
-00003d00: 7469 6f6e 5f72 616e 6765 203d 204e 6f6e  tion_range = Non
-00003d10: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00003d20: 7469 6d65 5f72 616e 6765 203d 204e 6f6e  time_range = Non
-00003d30: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00003d40: 7369 7465 636f 6f72 6473 203d 204e 6f6e  sitecoords = Non
-00003d50: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00003d60: 706f 6c63 6f6f 7264 7320 3d20 4e6f 6e65  polcoords = None
-00003d70: 0a20 2020 2020 2020 2073 656c 662e 5f70  .        self._p
-00003d80: 726f 6a65 6374 696f 6e20 3d20 4e6f 6e65  rojection = None
-00003d90: 0a20 2020 2020 2020 2073 656c 662e 5f74  .        self._t
-00003da0: 696d 6520 3d20 4e6f 6e65 0a0a 2020 2020  ime = None..    
-00003db0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00003dc0: 6620 7261 6469 616c 5f72 616e 6765 2873  f radial_range(s
-00003dd0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00003de0: 2252 6574 7572 6e20 7468 6520 7261 6469  "Return the radi
-00003df0: 616c 2072 616e 6765 206f 6620 7468 6973  al range of this
-00003e00: 2064 6174 6173 6574 2e22 2222 0a20 2020   dataset.""".   
-00003e10: 2020 2020 2069 6620 7365 6c66 2e5f 7261       if self._ra
-00003e20: 6469 616c 5f72 616e 6765 2069 7320 4e6f  dial_range is No
-00003e30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00003e40: 6e67 6174 6573 203d 2073 656c 662e 5f6f  ngates = self._o
-00003e50: 626a 2e61 7474 7273 5b22 6269 6e5f 636f  bj.attrs["bin_co
-00003e60: 756e 7422 5d0a 2020 2020 2020 2020 2020  unt"].          
-00003e70: 2020 2320 7261 6e67 655f 7374 6172 7420    # range_start 
-00003e80: 3d20 7365 6c66 2e5f 6f62 6a2e 6174 7472  = self._obj.attr
-00003e90: 735b 2772 616e 6765 5f73 7461 7274 275d  s['range_start']
-00003ea0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-00003eb0: 6765 5f73 616d 706c 6573 203d 2073 656c  ge_samples = sel
-00003ec0: 662e 5f6f 626a 2e61 7474 7273 5b22 7261  f._obj.attrs["ra
-00003ed0: 6e67 655f 7361 6d70 6c65 7322 5d0a 2020  nge_samples"].  
-00003ee0: 2020 2020 2020 2020 2020 7261 6e67 655f            range_
-00003ef0: 7374 6570 203d 2073 656c 662e 5f6f 626a  step = self._obj
-00003f00: 2e61 7474 7273 5b22 7261 6e67 655f 7374  .attrs["range_st
-00003f10: 6570 225d 0a20 2020 2020 2020 2020 2020  ep"].           
-00003f20: 2062 696e 5f72 616e 6765 203d 2072 616e   bin_range = ran
-00003f30: 6765 5f73 7465 7020 2a20 7261 6e67 655f  ge_step * range_
-00003f40: 7361 6d70 6c65 730a 2020 2020 2020 2020  samples.        
-00003f50: 2020 2020 7261 6e67 655f 6461 7461 203d      range_data =
-00003f60: 206e 702e 6172 616e 6765 280a 2020 2020   np.arange(.    
-00003f70: 2020 2020 2020 2020 2020 2020 6269 6e5f              bin_
-00003f80: 7261 6e67 6520 2f20 322e 302c 2062 696e  range / 2.0, bin
-00003f90: 5f72 616e 6765 202a 206e 6761 7465 732c  _range * ngates,
-00003fa0: 2062 696e 5f72 616e 6765 2c20 6474 7970   bin_range, dtyp
-00003fb0: 653d 2266 6c6f 6174 3332 220a 2020 2020  e="float32".    
-00003fc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00003fd0: 2020 2020 2020 7261 6e67 655f 6174 7472        range_attr
-00003fe0: 735b 226d 6574 6572 735f 746f 5f63 656e  s["meters_to_cen
-00003ff0: 7465 725f 6f66 5f66 6972 7374 5f67 6174  ter_of_first_gat
-00004000: 6522 5d20 3d20 6269 6e5f 7261 6e67 6520  e"] = bin_range 
-00004010: 2f20 322e 300a 2020 2020 2020 2020 2020  / 2.0.          
-00004020: 2020 6461 203d 2078 722e 4461 7461 4172    da = xr.DataAr
-00004030: 7261 7928 7261 6e67 655f 6461 7461 2c20  ray(range_data, 
-00004040: 6469 6d73 3d5b 2264 696d 5f31 225d 2c20  dims=["dim_1"], 
-00004050: 6174 7472 733d 7261 6e67 655f 6174 7472  attrs=range_attr
-00004060: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-00004070: 656c 662e 5f72 6164 6961 6c5f 7261 6e67  elf._radial_rang
-00004080: 6520 3d20 6461 0a20 2020 2020 2020 2072  e = da.        r
-00004090: 6574 7572 6e20 7365 6c66 2e5f 7261 6469  eturn self._radi
-000040a0: 616c 5f72 616e 6765 0a0a 2020 2020 4070  al_range..    @p
-000040b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000040c0: 617a 696d 7574 685f 7261 6e67 6528 7365  azimuth_range(se
-000040d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000040e0: 5265 7475 726e 2074 6865 2061 7a69 6d75  Return the azimu
-000040f0: 7468 2072 616e 6765 206f 6620 7468 6973  th range of this
-00004100: 2064 6174 6173 6574 2e22 2222 0a20 2020   dataset.""".   
-00004110: 2020 2020 2069 6620 7365 6c66 2e5f 617a       if self._az
-00004120: 696d 7574 685f 7261 6e67 6520 6973 204e  imuth_range is N
-00004130: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00004140: 2061 7a73 7461 7274 203d 2073 656c 662e   azstart = self.
-00004150: 5f6f 626a 5b22 617a 696d 7574 685f 7374  _obj["azimuth_st
-00004160: 6172 7422 5d0a 2020 2020 2020 2020 2020  art"].          
-00004170: 2020 617a 7374 6f70 203d 2073 656c 662e    azstop = self.
-00004180: 5f6f 626a 5b22 617a 696d 7574 685f 7374  _obj["azimuth_st
-00004190: 6f70 225d 0a20 2020 2020 2020 2020 2020  op"].           
-000041a0: 207a 6572 6f5f 696e 6465 7820 3d20 6e70   zero_index = np
-000041b0: 2e77 6865 7265 2861 7a73 746f 7020 3c20  .where(azstop < 
-000041c0: 617a 7374 6172 7429 0a20 2020 2020 2020  azstart).       
-000041d0: 2020 2020 2061 7a73 746f 705b 7a65 726f       azstop[zero
-000041e0: 5f69 6e64 6578 5b30 5d5d 202b 3d20 3336  _index[0]] += 36
-000041f0: 300a 2020 2020 2020 2020 2020 2020 617a  0.            az
-00004200: 696d 7574 6820 3d20 2861 7a73 7461 7274  imuth = (azstart
-00004210: 202b 2061 7a73 746f 7029 202f 2032 2e30   + azstop) / 2.0
-00004220: 0a20 2020 2020 2020 2020 2020 2061 7a69  .            azi
-00004230: 6d75 7468 203d 2061 7a69 6d75 7468 2e61  muth = azimuth.a
-00004240: 7373 6967 6e5f 6174 7472 7328 617a 5f61  ssign_attrs(az_a
-00004250: 7474 7273 290a 2020 2020 2020 2020 2020  ttrs).          
-00004260: 2020 7365 6c66 2e5f 617a 696d 7574 685f    self._azimuth_
-00004270: 7261 6e67 6520 3d20 617a 696d 7574 680a  range = azimuth.
-00004280: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00004290: 656c 662e 5f61 7a69 6d75 7468 5f72 616e  elf._azimuth_ran
-000042a0: 6765 0a0a 2020 2020 4070 726f 7065 7274  ge..    @propert
-000042b0: 790a 2020 2020 6465 6620 656c 6576 6174  y.    def elevat
-000042c0: 696f 6e5f 7261 6e67 6528 7365 6c66 293a  ion_range(self):
-000042d0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-000042e0: 726e 2074 6865 2065 6c65 7661 7469 6f6e  rn the elevation
-000042f0: 2072 616e 6765 206f 6620 7468 6973 2064   range of this d
-00004300: 6174 6173 6574 2e22 2222 0a20 2020 2020  ataset.""".     
-00004310: 2020 2069 6620 7365 6c66 2e5f 656c 6576     if self._elev
-00004320: 6174 696f 6e5f 7261 6e67 6520 6973 204e  ation_range is N
-00004330: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00004340: 2065 6c73 7461 7274 203d 2073 656c 662e   elstart = self.
-00004350: 5f6f 626a 5b22 656c 6576 6174 696f 6e5f  _obj["elevation_
-00004360: 7374 6172 7422 5d0a 2020 2020 2020 2020  start"].        
-00004370: 2020 2020 656c 7374 6f70 203d 2073 656c      elstop = sel
-00004380: 662e 5f6f 626a 5b22 656c 6576 6174 696f  f._obj["elevatio
-00004390: 6e5f 7374 6f70 225d 0a20 2020 2020 2020  n_stop"].       
-000043a0: 2020 2020 2065 6c65 7661 7469 6f6e 203d       elevation =
-000043b0: 2028 656c 7374 6172 7420 2b20 656c 7374   (elstart + elst
-000043c0: 6f70 2920 2f20 322e 300a 2020 2020 2020  op) / 2.0.      
-000043d0: 2020 2020 2020 656c 6576 6174 696f 6e20        elevation 
-000043e0: 3d20 656c 6576 6174 696f 6e2e 6173 7369  = elevation.assi
-000043f0: 676e 5f61 7474 7273 2865 6c5f 6174 7472  gn_attrs(el_attr
-00004400: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-00004410: 656c 662e 5f65 6c65 7661 7469 6f6e 5f72  elf._elevation_r
-00004420: 616e 6765 203d 2065 6c65 7661 7469 6f6e  ange = elevation
-00004430: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004440: 7365 6c66 2e5f 656c 6576 6174 696f 6e5f  self._elevation_
-00004450: 7261 6e67 650a 0a20 2020 2040 7072 6f70  range..    @prop
-00004460: 6572 7479 0a20 2020 2064 6566 2074 696d  erty.    def tim
-00004470: 655f 7261 6e67 6528 7365 6c66 293a 0a20  e_range(self):. 
-00004480: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00004490: 2074 6865 2074 696d 6520 7261 6e67 6520   the time range 
-000044a0: 6f66 2074 6869 7320 6461 7461 7365 742e  of this dataset.
-000044b0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
-000044c0: 656c 662e 5f74 696d 655f 7261 6e67 6520  elf._time_range 
-000044d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000044e0: 2020 2020 2074 696d 6573 203d 2073 656c       times = sel
-000044f0: 662e 5f6f 626a 5b22 7469 6d65 7374 616d  f._obj["timestam
-00004500: 7022 5d20 2f20 3165 360a 2020 2020 2020  p"] / 1e6.      
-00004510: 2020 2020 2020 6174 7472 7320 3d20 7b0a        attrs = {.
-00004520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004530: 2275 6e69 7473 223a 2022 7365 636f 6e64  "units": "second
-00004540: 7320 7369 6e63 6520 3139 3730 2d30 312d  s since 1970-01-
-00004550: 3031 5430 303a 3030 3a30 305a 222c 0a20  01T00:00:00Z",. 
-00004560: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00004570: 7374 616e 6461 7264 5f6e 616d 6522 3a20  standard_name": 
-00004580: 2274 696d 6522 2c0a 2020 2020 2020 2020  "time",.        
-00004590: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-000045a0: 2020 6461 203d 2078 722e 4461 7461 4172    da = xr.DataAr
-000045b0: 7261 7928 7469 6d65 732c 2061 7474 7273  ray(times, attrs
-000045c0: 3d61 7474 7273 290a 2020 2020 2020 2020  =attrs).        
-000045d0: 2020 2020 7365 6c66 2e5f 7469 6d65 5f72      self._time_r
-000045e0: 616e 6765 203d 2064 610a 2020 2020 2020  ange = da.      
-000045f0: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
-00004600: 696d 655f 7261 6e67 650a 0a0a 4078 722e  ime_range...@xr.
-00004610: 7265 6769 7374 6572 5f64 6174 6173 6574  register_dataset
-00004620: 5f61 6363 6573 736f 7228 226f 6469 6d22  _accessor("odim"
-00004630: 290a 636c 6173 7320 4f64 696d 4163 6365  ).class OdimAcce
-00004640: 7373 6f72 286f 626a 6563 7429 3a0a 2020  ssor(object):.  
-00004650: 2020 2222 2244 6174 6173 6574 2041 6363    """Dataset Acc
-00004660: 6573 736f 7220 666f 7220 6861 6e64 6c69  essor for handli
-00004670: 6e67 204f 4449 4d5f 4835 2064 6174 6120  ng ODIM_H5 data 
-00004680: 6669 6c65 7322 2222 0a0a 2020 2020 6465  files"""..    de
-00004690: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-000046a0: 2078 6172 7261 795f 6f62 6a29 3a0a 2020   xarray_obj):.  
-000046b0: 2020 2020 2020 7365 6c66 2e5f 6f62 6a20        self._obj 
-000046c0: 3d20 7861 7272 6179 5f6f 626a 0a20 2020  = xarray_obj.   
-000046d0: 2020 2020 2073 656c 662e 5f72 6164 6961       self._radia
-000046e0: 6c5f 7261 6e67 6520 3d20 4e6f 6e65 0a20  l_range = None. 
-000046f0: 2020 2020 2020 2073 656c 662e 5f61 7a69         self._azi
-00004700: 6d75 7468 5f72 616e 6765 203d 204e 6f6e  muth_range = Non
-00004710: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00004720: 656c 6576 6174 696f 6e5f 7261 6e67 6520  elevation_range 
-00004730: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00004740: 656c 662e 5f74 696d 655f 7261 6e67 6520  elf._time_range 
-00004750: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00004760: 656c 662e 5f74 696d 655f 7261 6e67 6532  elf._time_range2
-00004770: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00004780: 7365 6c66 2e5f 7072 7420 3d20 4e6f 6e65  self._prt = None
-00004790: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-000047a0: 5f73 616d 706c 6573 203d 204e 6f6e 650a  _samples = None.
-000047b0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000047c0: 2020 2064 6566 2072 6164 6961 6c5f 7261     def radial_ra
-000047d0: 6e67 6528 7365 6c66 293a 0a20 2020 2020  nge(self):.     
-000047e0: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
-000047f0: 2072 6164 6961 6c20 7261 6e67 6520 6f66   radial range of
-00004800: 2074 6869 7320 6461 7461 7365 742e 2222   this dataset.""
-00004810: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-00004820: 662e 5f72 6164 6961 6c5f 7261 6e67 6520  f._radial_range 
-00004830: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00004840: 2020 2020 206e 6761 7465 7320 3d20 7365       ngates = se
-00004850: 6c66 2e5f 6f62 6a2e 6174 7472 735b 226e  lf._obj.attrs["n
-00004860: 6269 6e73 225d 0a20 2020 2020 2020 2020  bins"].         
-00004870: 2020 2072 616e 6765 5f73 7461 7274 203d     range_start =
-00004880: 2073 656c 662e 5f6f 626a 2e61 7474 7273   self._obj.attrs
-00004890: 5b22 7273 7461 7274 225d 202a 2031 3030  ["rstart"] * 100
-000048a0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-000048b0: 6269 6e5f 7261 6e67 6520 3d20 7365 6c66  bin_range = self
-000048c0: 2e5f 6f62 6a2e 6174 7472 735b 2272 7363  ._obj.attrs["rsc
-000048d0: 616c 6522 5d0a 2020 2020 2020 2020 2020  ale"].          
-000048e0: 2020 6365 6e74 5f66 6972 7374 203d 2072    cent_first = r
-000048f0: 616e 6765 5f73 7461 7274 202b 2062 696e  ange_start + bin
-00004900: 5f72 616e 6765 202f 2032 2e30 0a20 2020  _range / 2.0.   
-00004910: 2020 2020 2020 2020 2072 616e 6765 5f64           range_d
-00004920: 6174 6120 3d20 6e70 2e61 7261 6e67 6528  ata = np.arange(
-00004930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004940: 2063 656e 745f 6669 7273 742c 2072 616e   cent_first, ran
-00004950: 6765 5f73 7461 7274 202b 2062 696e 5f72  ge_start + bin_r
-00004960: 616e 6765 202a 206e 6761 7465 732c 2062  ange * ngates, b
-00004970: 696e 5f72 616e 6765 2c20 6474 7970 653d  in_range, dtype=
-00004980: 2266 6c6f 6174 3332 220a 2020 2020 2020  "float32".      
-00004990: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000049a0: 2020 2020 7261 6e67 655f 6174 7472 735b      range_attrs[
-000049b0: 226d 6574 6572 735f 746f 5f63 656e 7465  "meters_to_cente
-000049c0: 725f 6f66 5f66 6972 7374 5f67 6174 6522  r_of_first_gate"
-000049d0: 5d20 3d20 6365 6e74 5f66 6972 7374 0a20  ] = cent_first. 
-000049e0: 2020 2020 2020 2020 2020 2072 616e 6765             range
-000049f0: 5f61 7474 7273 5b22 6d65 7465 7273 5f62  _attrs["meters_b
-00004a00: 6574 7765 656e 5f67 6174 6573 225d 203d  etween_gates"] =
-00004a10: 2062 696e 5f72 616e 6765 0a0a 2020 2020   bin_range..    
-00004a20: 2020 2020 2020 2020 6461 203d 2078 722e          da = xr.
-00004a30: 4461 7461 4172 7261 7928 7261 6e67 655f  DataArray(range_
-00004a40: 6461 7461 2c20 6469 6d73 3d5b 2264 696d  data, dims=["dim
-00004a50: 5f31 225d 2c20 6174 7472 733d 7261 6e67  _1"], attrs=rang
-00004a60: 655f 6174 7472 7329 0a20 2020 2020 2020  e_attrs).       
-00004a70: 2020 2020 2073 656c 662e 5f72 6164 6961       self._radia
-00004a80: 6c5f 7261 6e67 6520 3d20 6461 0a20 2020  l_range = da.   
-00004a90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004aa0: 2e5f 7261 6469 616c 5f72 616e 6765 0a0a  ._radial_range..
-00004ab0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00004ac0: 2020 6465 6620 617a 696d 7574 685f 7261    def azimuth_ra
-00004ad0: 6e67 6532 2873 656c 6629 3a0a 2020 2020  nge2(self):.    
-00004ae0: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00004af0: 6520 617a 696d 7574 6820 7261 6e67 6520  e azimuth range 
-00004b00: 6f66 2074 6869 7320 6461 7461 7365 742e  of this dataset.
-00004b10: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
-00004b20: 656c 662e 5f61 7a69 6d75 7468 5f72 616e  elf._azimuth_ran
-00004b30: 6765 2069 7320 4e6f 6e65 3a0a 2020 2020  ge is None:.    
-00004b40: 2020 2020 2020 2020 6e72 6179 7320 3d20          nrays = 
-00004b50: 7365 6c66 2e5f 6f62 6a2e 6174 7472 735b  self._obj.attrs[
-00004b60: 226e 7261 7973 225d 0a20 2020 2020 2020  "nrays"].       
-00004b70: 2020 2020 2072 6573 203d 2033 3630 2e30       res = 360.0
-00004b80: 202f 206e 7261 7973 0a20 2020 2020 2020   / nrays.       
-00004b90: 2020 2020 2061 7a69 6d75 7468 5f64 6174       azimuth_dat
-00004ba0: 6120 3d20 6e70 2e61 7261 6e67 6528 7265  a = np.arange(re
-00004bb0: 7320 2f20 322e 302c 2033 3630 2e30 2c20  s / 2.0, 360.0, 
-00004bc0: 7265 732c 2064 7479 7065 3d22 666c 6f61  res, dtype="floa
-00004bd0: 7433 3222 290a 0a20 2020 2020 2020 2020  t32")..         
-00004be0: 2020 2064 6120 3d20 7872 2e44 6174 6141     da = xr.DataA
-00004bf0: 7272 6179 2861 7a69 6d75 7468 5f64 6174  rray(azimuth_dat
-00004c00: 612c 2064 696d 733d 5b22 6469 6d5f 3022  a, dims=["dim_0"
-00004c10: 5d2c 2061 7474 7273 3d61 7a5f 6174 7472  ], attrs=az_attr
-00004c20: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-00004c30: 656c 662e 5f61 7a69 6d75 7468 5f72 616e  elf._azimuth_ran
-00004c40: 6765 203d 2064 610a 2020 2020 2020 2020  ge = da.        
-00004c50: 7265 7475 726e 2073 656c 662e 5f61 7a69  return self._azi
-00004c60: 6d75 7468 5f72 616e 6765 0a0a 2020 2020  muth_range..    
-00004c70: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00004c80: 6620 617a 696d 7574 685f 7261 6e67 6528  f azimuth_range(
-00004c90: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00004ca0: 2222 5265 7475 726e 2074 6865 2061 7a69  ""Return the azi
-00004cb0: 6d75 7468 2072 616e 6765 206f 6620 7468  muth range of th
-00004cc0: 6973 2064 6174 6173 6574 2e22 2222 0a20  is dataset.""". 
-00004cd0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00004ce0: 617a 696d 7574 685f 7261 6e67 6520 6973  azimuth_range is
-00004cf0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00004d00: 2020 2073 7461 7274 617a 203d 2073 656c     startaz = sel
-00004d10: 662e 5f6f 626a 2e61 7474 7273 5b22 7374  f._obj.attrs["st
-00004d20: 6172 7461 7a41 225d 0a20 2020 2020 2020  artazA"].       
-00004d30: 2020 2020 2073 746f 7061 7a20 3d20 7365       stopaz = se
-00004d40: 6c66 2e5f 6f62 6a2e 6174 7472 735b 2273  lf._obj.attrs["s
-00004d50: 746f 7061 7a41 225d 0a20 2020 2020 2020  topazA"].       
-00004d60: 2020 2020 207a 6572 6f5f 696e 6465 7820       zero_index 
-00004d70: 3d20 6e70 2e77 6865 7265 2873 746f 7061  = np.where(stopa
-00004d80: 7a20 3c20 7374 6172 7461 7a29 0a20 2020  z < startaz).   
-00004d90: 2020 2020 2020 2020 2073 746f 7061 7a5b           stopaz[
-00004da0: 7a65 726f 5f69 6e64 6578 5b30 5d5d 202b  zero_index[0]] +
-00004db0: 3d20 3336 300a 2020 2020 2020 2020 2020  = 360.          
-00004dc0: 2020 617a 696d 7574 685f 6461 7461 203d    azimuth_data =
-00004dd0: 2028 7374 6172 7461 7a20 2b20 7374 6f70   (startaz + stop
-00004de0: 617a 2920 2f20 322e 300a 2020 2020 2020  az) / 2.0.      
-00004df0: 2020 2020 2020 6461 203d 2078 722e 4461        da = xr.Da
-00004e00: 7461 4172 7261 7928 617a 696d 7574 685f  taArray(azimuth_
-00004e10: 6461 7461 2c20 6174 7472 733d 617a 5f61  data, attrs=az_a
-00004e20: 7474 7273 290a 2020 2020 2020 2020 2020  ttrs).          
-00004e30: 2020 7365 6c66 2e5f 617a 696d 7574 685f    self._azimuth_
-00004e40: 7261 6e67 6520 3d20 6461 0a20 2020 2020  range = da.     
-00004e50: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00004e60: 617a 696d 7574 685f 7261 6e67 650a 0a20  azimuth_range.. 
-00004e70: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00004e80: 2064 6566 2065 6c65 7661 7469 6f6e 5f72   def elevation_r
-00004e90: 616e 6765 3228 7365 6c66 293a 0a20 2020  ange2(self):.   
-00004ea0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-00004eb0: 6865 2065 6c65 7661 7469 6f6e 2072 616e  he elevation ran
-00004ec0: 6765 206f 6620 7468 6973 2064 6174 6173  ge of this datas
-00004ed0: 6574 2e22 2222 0a20 2020 2020 2020 2069  et.""".        i
-00004ee0: 6620 7365 6c66 2e5f 656c 6576 6174 696f  f self._elevatio
-00004ef0: 6e5f 7261 6e67 6520 6973 204e 6f6e 653a  n_range is None:
-00004f00: 0a20 2020 2020 2020 2020 2020 206e 7261  .            nra
-00004f10: 7973 203d 2073 656c 662e 5f6f 626a 2e61  ys = self._obj.a
-00004f20: 7474 7273 5b22 6e72 6179 7322 5d0a 2020  ttrs["nrays"].  
-00004f30: 2020 2020 2020 2020 2020 656c 616e 676c            elangl
-00004f40: 6520 3d20 7365 6c66 2e5f 6f62 6a2e 6174  e = self._obj.at
-00004f50: 7472 735b 2265 6c61 6e67 6c65 225d 0a20  trs["elangle"]. 
-00004f60: 2020 2020 2020 2020 2020 2065 6c65 7661             eleva
-00004f70: 7469 6f6e 5f64 6174 6120 3d20 6e70 2e6f  tion_data = np.o
-00004f80: 6e65 7328 6e72 6179 732c 2064 7479 7065  nes(nrays, dtype
-00004f90: 3d22 666c 6f61 7433 3222 2920 2a20 656c  ="float32") * el
-00004fa0: 616e 676c 650a 2020 2020 2020 2020 2020  angle.          
-00004fb0: 2020 6461 203d 2078 722e 4461 7461 4172    da = xr.DataAr
-00004fc0: 7261 7928 656c 6576 6174 696f 6e5f 6461  ray(elevation_da
-00004fd0: 7461 2c20 6469 6d73 3d5b 2264 696d 5f30  ta, dims=["dim_0
-00004fe0: 225d 2c20 6174 7472 733d 656c 5f61 7474  "], attrs=el_att
-00004ff0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-00005000: 7365 6c66 2e5f 656c 6576 6174 696f 6e5f  self._elevation_
-00005010: 7261 6e67 6520 3d20 6461 0a20 2020 2020  range = da.     
-00005020: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00005030: 656c 6576 6174 696f 6e5f 7261 6e67 650a  elevation_range.
-00005040: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00005050: 2020 2064 6566 2065 6c65 7661 7469 6f6e     def elevation
-00005060: 5f72 616e 6765 2873 656c 6629 3a0a 2020  _range(self):.  
-00005070: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00005080: 7468 6520 656c 6576 6174 696f 6e20 7261  the elevation ra
-00005090: 6e67 6520 6f66 2074 6869 7320 6461 7461  nge of this data
-000050a0: 7365 742e 2222 220a 2020 2020 2020 2020  set.""".        
-000050b0: 6966 2073 656c 662e 5f65 6c65 7661 7469  if self._elevati
-000050c0: 6f6e 5f72 616e 6765 2069 7320 4e6f 6e65  on_range is None
-000050d0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
-000050e0: 6172 7465 6c20 3d20 7365 6c66 2e5f 6f62  artel = self._ob
-000050f0: 6a2e 6174 7472 735b 2273 7461 7274 656c  j.attrs["startel
-00005100: 4122 5d0a 2020 2020 2020 2020 2020 2020  A"].            
-00005110: 7374 6f70 656c 203d 2073 656c 662e 5f6f  stopel = self._o
-00005120: 626a 2e61 7474 7273 5b22 7374 6f70 656c  bj.attrs["stopel
-00005130: 4122 5d0a 2020 2020 2020 2020 2020 2020  A"].            
-00005140: 656c 6576 6174 696f 6e5f 6461 7461 203d  elevation_data =
-00005150: 2028 7374 6172 7465 6c20 2b20 7374 6f70   (startel + stop
-00005160: 656c 2920 2f20 322e 300a 2020 2020 2020  el) / 2.0.      
-00005170: 2020 2020 2020 6461 203d 2078 722e 4461        da = xr.Da
-00005180: 7461 4172 7261 7928 656c 6576 6174 696f  taArray(elevatio
-00005190: 6e5f 6461 7461 2c20 6469 6d73 3d5b 2264  n_data, dims=["d
-000051a0: 696d 5f30 225d 2c20 6174 7472 733d 656c  im_0"], attrs=el
-000051b0: 5f61 7474 7273 290a 2020 2020 2020 2020  _attrs).        
-000051c0: 2020 2020 7365 6c66 2e5f 656c 6576 6174      self._elevat
-000051d0: 696f 6e5f 7261 6e67 6520 3d20 6461 0a20  ion_range = da. 
-000051e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000051f0: 6c66 2e5f 656c 6576 6174 696f 6e5f 7261  lf._elevation_ra
-00005200: 6e67 650a 0a20 2020 2040 7072 6f70 6572  nge..    @proper
-00005210: 7479 0a20 2020 2064 6566 2074 696d 655f  ty.    def time_
-00005220: 7261 6e67 6528 7365 6c66 293a 0a20 2020  range(self):.   
-00005230: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-00005240: 6865 2074 696d 6520 7261 6e67 6520 6f66  he time range of
-00005250: 2074 6869 7320 6461 7461 7365 742e 2222   this dataset.""
-00005260: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-00005270: 662e 5f74 696d 655f 7261 6e67 6520 6973  f._time_range is
-00005280: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00005290: 2020 2073 7461 7274 5420 3d20 7365 6c66     startT = self
-000052a0: 2e5f 6f62 6a2e 6174 7472 735b 2273 7461  ._obj.attrs["sta
-000052b0: 7274 617a 5422 5d0a 2020 2020 2020 2020  rtazT"].        
-000052c0: 2020 2020 7374 6f70 5420 3d20 7365 6c66      stopT = self
-000052d0: 2e5f 6f62 6a2e 6174 7472 735b 2273 746f  ._obj.attrs["sto
-000052e0: 7061 7a54 225d 0a20 2020 2020 2020 2020  pazT"].         
-000052f0: 2020 2074 696d 6573 203d 2028 7374 6172     times = (star
-00005300: 7454 202b 2073 746f 7054 2920 2f20 322e  tT + stopT) / 2.
-00005310: 300a 2020 2020 2020 2020 2020 2020 7365  0.            se
-00005320: 6c66 2e5f 7469 6d65 5f72 616e 6765 203d  lf._time_range =
-00005330: 2074 696d 6573 0a0a 2020 2020 2020 2020   times..        
-00005340: 7265 7475 726e 2073 656c 662e 5f74 696d  return self._tim
-00005350: 655f 7261 6e67 650a 0a20 2020 2040 7072  e_range..    @pr
-00005360: 6f70 6572 7479 0a20 2020 2064 6566 2074  operty.    def t
-00005370: 696d 655f 7261 6e67 6532 2873 656c 6629  ime_range2(self)
-00005380: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00005390: 7572 6e20 7468 6520 7469 6d65 2072 616e  urn the time ran
-000053a0: 6765 206f 6620 7468 6973 2064 6174 6173  ge of this datas
-000053b0: 6574 2e22 2222 0a20 2020 2020 2020 2069  et.""".        i
-000053c0: 6620 7365 6c66 2e5f 7469 6d65 5f72 616e  f self._time_ran
-000053d0: 6765 3220 6973 204e 6f6e 653a 0a20 2020  ge2 is None:.   
-000053e0: 2020 2020 2020 2020 2073 7461 7274 6461           startda
-000053f0: 7465 203d 2073 656c 662e 5f6f 626a 2e61  te = self._obj.a
-00005400: 7474 7273 5b22 7374 6172 7464 6174 6522  ttrs["startdate"
-00005410: 5d0a 2020 2020 2020 2020 2020 2020 7374  ].            st
-00005420: 6172 7474 696d 6520 3d20 7365 6c66 2e5f  arttime = self._
-00005430: 6f62 6a2e 6174 7472 735b 2273 7461 7274  obj.attrs["start
-00005440: 7469 6d65 225d 0a20 2020 2020 2020 2020  time"].         
-00005450: 2020 2065 6e64 6461 7465 203d 2073 656c     enddate = sel
-00005460: 662e 5f6f 626a 2e61 7474 7273 5b22 656e  f._obj.attrs["en
-00005470: 6464 6174 6522 5d0a 2020 2020 2020 2020  ddate"].        
-00005480: 2020 2020 656e 6474 696d 6520 3d20 7365      endtime = se
-00005490: 6c66 2e5f 6f62 6a2e 6174 7472 735b 2265  lf._obj.attrs["e
-000054a0: 6e64 7469 6d65 225d 0a0a 2020 2020 2020  ndtime"]..      
-000054b0: 2020 2020 2020 7374 6172 7420 3d20 6474        start = dt
-000054c0: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
-000054d0: 6d65 2873 7461 7274 6461 7465 202b 2073  me(startdate + s
-000054e0: 7461 7274 7469 6d65 2c20 2225 5925 6d25  tarttime, "%Y%m%
-000054f0: 6425 4825 4d25 5322 290a 2020 2020 2020  d%H%M%S").      
-00005500: 2020 2020 2020 656e 6420 3d20 6474 2e64        end = dt.d
-00005510: 6174 6574 696d 652e 7374 7270 7469 6d65  atetime.strptime
-00005520: 2865 6e64 6461 7465 202b 2065 6e64 7469  (enddate + endti
-00005530: 6d65 2c20 2225 5925 6d25 6425 4825 4d25  me, "%Y%m%d%H%M%
-00005540: 5322 290a 2020 2020 2020 2020 2020 2020  S").            
-00005550: 7374 6172 7420 3d20 7374 6172 742e 7265  start = start.re
-00005560: 706c 6163 6528 747a 696e 666f 3d64 742e  place(tzinfo=dt.
-00005570: 7469 6d65 7a6f 6e65 2e75 7463 290a 2020  timezone.utc).  
-00005580: 2020 2020 2020 2020 2020 656e 6420 3d20            end = 
-00005590: 656e 642e 7265 706c 6163 6528 747a 696e  end.replace(tzin
-000055a0: 666f 3d64 742e 7469 6d65 7a6f 6e65 2e75  fo=dt.timezone.u
-000055b0: 7463 290a 0a20 2020 2020 2020 2020 2020  tc)..           
-000055c0: 2073 656c 662e 5f74 696d 655f 7261 6e67   self._time_rang
-000055d0: 6532 203d 2028 7374 6172 742e 7469 6d65  e2 = (start.time
-000055e0: 7374 616d 7028 292c 2065 6e64 2e74 696d  stamp(), end.tim
-000055f0: 6573 7461 6d70 2829 290a 2020 2020 2020  estamp()).      
-00005600: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
-00005610: 696d 655f 7261 6e67 6532 0a0a 2020 2020  ime_range2..    
-00005620: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00005630: 6620 7072 7428 7365 6c66 293a 0a20 2020  f prt(self):.   
-00005640: 2020 2020 2069 6620 7365 6c66 2e5f 7072       if self._pr
-00005650: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00005660: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00005670: 2020 2020 2020 2020 2020 2020 7072 7420              prt 
-00005680: 3d20 312e 3020 2f20 7365 6c66 2e5f 6f62  = 1.0 / self._ob
-00005690: 6a2e 6174 7472 735b 2270 7266 225d 0a20  j.attrs["prf"]. 
-000056a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000056b0: 6120 3d20 7872 2e44 6174 6141 7272 6179  a = xr.DataArray
-000056c0: 2870 7274 2c20 6469 6d73 3d5b 2264 696d  (prt, dims=["dim
-000056d0: 5f30 225d 290a 2020 2020 2020 2020 2020  _0"]).          
-000056e0: 2020 2020 2020 7365 6c66 2e5f 7072 7420        self._prt 
-000056f0: 3d20 6461 0a20 2020 2020 2020 2020 2020  = da.           
-00005700: 2065 7863 6570 7420 4b65 7945 7272 6f72   except KeyError
-00005710: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00005720: 2020 7061 7373 0a20 2020 2020 2020 2072    pass.        r
-00005730: 6574 7572 6e20 7365 6c66 2e5f 7072 740a  eturn self._prt.
-00005740: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00005750: 2020 2064 6566 206e 5f73 616d 706c 6573     def n_samples
-00005760: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00005770: 6966 2073 656c 662e 5f6e 5f73 616d 706c  if self._n_sampl
-00005780: 6573 2069 7320 4e6f 6e65 3a0a 2020 2020  es is None:.    
-00005790: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-000057a0: 2020 2020 2020 2020 2020 2020 2064 6120               da 
-000057b0: 3d20 7872 2e44 6174 6141 7272 6179 2873  = xr.DataArray(s
-000057c0: 656c 662e 5f6f 626a 2e61 7474 7273 5b22  elf._obj.attrs["
-000057d0: 7075 6c73 6522 5d2c 2064 696d 733d 5b22  pulse"], dims=["
-000057e0: 6469 6d5f 3022 5d29 0a20 2020 2020 2020  dim_0"]).       
-000057f0: 2020 2020 2020 2020 2073 656c 662e 5f6e           self._n
-00005800: 5f73 616d 706c 6573 203d 2064 610a 2020  _samples = da.  
-00005810: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00005820: 204b 6579 4572 726f 723a 0a20 2020 2020   KeyError:.     
-00005830: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-00005840: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00005850: 656c 662e 5f6e 5f73 616d 706c 6573 0a0a  elf._n_samples..
-00005860: 0a64 6566 2074 6f5f 6366 7261 6469 616c  .def to_cfradial
-00005870: 3228 766f 6c75 6d65 2c20 6669 6c65 6e61  2(volume, filena
-00005880: 6d65 2c20 7469 6d65 7374 6570 3d4e 6f6e  me, timestep=Non
-00005890: 6529 3a0a 2020 2020 2222 2253 6176 6520  e):.    """Save 
-000058a0: 5852 6164 566f 6c2f 5852 6164 566f 6c75  XRadVol/XRadVolu
-000058b0: 6d65 2074 6f20 4366 5261 6469 616c 322e  me to CfRadial2.
-000058c0: 3020 636f 6d70 6c69 616e 7420 6669 6c65  0 compliant file
-000058d0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-000058e0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000058f0: 0a20 2020 2076 6f6c 756d 6520 3a20 5852  .    volume : XR
-00005900: 6164 566f 6c2f 5852 6164 566f 6c75 6d65  adVol/XRadVolume
-00005910: 206f 626a 6563 740a 2020 2020 6669 6c65   object.    file
-00005920: 6e61 6d65 203a 2073 7472 0a20 2020 2020  name : str.     
-00005930: 2020 206f 7574 7075 7420 6669 6c65 6e61     output filena
-00005940: 6d65 0a20 2020 2074 696d 6573 7465 7020  me.    timestep 
-00005950: 3a20 696e 740a 2020 2020 2020 2020 7469  : int.        ti
-00005960: 6d65 7374 6570 206f 6620 7761 6e74 6564  mestep of wanted
-00005970: 2076 6f6c 756d 650a 2020 2020 2222 220a   volume.    """.
-00005980: 2020 2020 766f 6c75 6d65 2e72 6f6f 742e      volume.root.
-00005990: 6c6f 6164 2829 0a20 2020 2072 6f6f 7420  load().    root 
-000059a0: 3d20 766f 6c75 6d65 2e72 6f6f 742e 636f  = volume.root.co
-000059b0: 7079 2864 6565 703d 5472 7565 290a 2020  py(deep=True).  
-000059c0: 2020 726f 6f74 2e61 7474 7273 5b22 436f    root.attrs["Co
-000059d0: 6e76 656e 7469 6f6e 7322 5d20 3d20 2243  nventions"] = "C
-000059e0: 662f 5261 6469 616c 220a 2020 2020 726f  f/Radial".    ro
-000059f0: 6f74 2e61 7474 7273 5b22 7665 7273 696f  ot.attrs["versio
-00005a00: 6e22 5d20 3d20 2232 2e30 220a 2020 2020  n"] = "2.0".    
-00005a10: 726f 6f74 2e74 6f5f 6e65 7463 6466 2866  root.to_netcdf(f
-00005a20: 696c 656e 616d 652c 206d 6f64 653d 2277  ilename, mode="w
-00005a30: 222c 2067 726f 7570 3d22 2f22 290a 2020  ", group="/").  
-00005a40: 2020 666f 7220 6964 782c 206b 6579 2069    for idx, key i
-00005a50: 6e20 656e 756d 6572 6174 6528 726f 6f74  n enumerate(root
-00005a60: 2e73 7765 6570 5f67 726f 7570 5f6e 616d  .sweep_group_nam
-00005a70: 652e 7661 6c75 6573 293a 0a20 2020 2020  e.values):.     
-00005a80: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00005a90: 2020 2020 7377 7020 3d20 766f 6c75 6d65      swp = volume
-00005aa0: 5b6b 6579 5d0a 2020 2020 2020 2020 6578  [key].        ex
-00005ab0: 6365 7074 2054 7970 6545 7272 6f72 3a0a  cept TypeError:.
-00005ac0: 2020 2020 2020 2020 2020 2020 7377 7020              swp 
-00005ad0: 3d20 766f 6c75 6d65 5b69 6478 5d5b 7469  = volume[idx][ti
-00005ae0: 6d65 7374 6570 5d2e 6461 7461 0a20 2020  mestep].data.   
-00005af0: 2020 2020 2073 7770 2e6c 6f61 6428 290a       swp.load().
-00005b00: 2020 2020 2020 2020 6469 6d73 203d 206c          dims = l
-00005b10: 6973 7428 7377 702e 6469 6d73 290a 2020  ist(swp.dims).  
-00005b20: 2020 2020 2020 6469 6d73 2e72 656d 6f76        dims.remov
-00005b30: 6528 2272 616e 6765 2229 0a20 2020 2020  e("range").     
-00005b40: 2020 2064 696d 3020 3d20 6469 6d73 5b30     dim0 = dims[0
-00005b50: 5d0a 2020 2020 2020 2020 7472 793a 0a20  ].        try:. 
-00005b60: 2020 2020 2020 2020 2020 2073 7770 203d             swp =
-00005b70: 2073 7770 2e73 7761 705f 6469 6d73 287b   swp.swap_dims({
-00005b80: 6469 6d30 3a20 2274 696d 6522 7d29 0a20  dim0: "time"}). 
-00005b90: 2020 2020 2020 2065 7863 6570 7420 5661         except Va
-00005ba0: 6c75 6545 7272 6f72 3a0a 2020 2020 2020  lueError:.      
-00005bb0: 2020 2020 2020 7377 7020 3d20 7377 702e        swp = swp.
-00005bc0: 6472 6f70 5f76 6172 7328 2274 696d 6522  drop_vars("time"
-00005bd0: 292e 7265 6e61 6d65 287b 2272 7469 6d65  ).rename({"rtime
-00005be0: 223a 2022 7469 6d65 227d 290a 2020 2020  ": "time"}).    
-00005bf0: 2020 2020 2020 2020 7377 7020 3d20 7377          swp = sw
-00005c00: 702e 7377 6170 5f64 696d 7328 7b64 696d  p.swap_dims({dim
-00005c10: 303a 2022 7469 6d65 227d 290a 2020 2020  0: "time"}).    
-00005c20: 2020 2020 7377 702e 6472 6f70 5f76 6172      swp.drop_var
-00005c30: 7328 5b22 7822 2c20 2279 222c 2022 7a22  s(["x", "y", "z"
-00005c40: 2c20 2267 7222 2c20 2272 6179 7322 2c20  , "gr", "rays", 
-00005c50: 2262 696e 7322 5d2c 2065 7272 6f72 733d  "bins"], errors=
-00005c60: 2269 676e 6f72 6522 290a 2020 2020 2020  "ignore").      
-00005c70: 2020 7377 702e 746f 5f6e 6574 6364 6628    swp.to_netcdf(
-00005c80: 6669 6c65 6e61 6d65 2c20 6d6f 6465 3d22  filename, mode="
-00005c90: 6122 2c20 6772 6f75 703d 6b65 7929 0a0a  a", group=key)..
-00005ca0: 0a64 6566 2074 6f5f 6e65 7463 6466 2876  .def to_netcdf(v
-00005cb0: 6f6c 756d 652c 2066 696c 656e 616d 652c  olume, filename,
-00005cc0: 2074 696d 6573 7465 703d 4e6f 6e65 2c20   timestep=None, 
-00005cd0: 6b65 7973 3d4e 6f6e 6529 3a0a 2020 2020  keys=None):.    
-00005ce0: 2222 2253 6176 6520 5852 6164 566f 6c75  """Save XRadVolu
-00005cf0: 6d65 2074 6f20 6e65 7463 6466 2063 6f6d  me to netcdf com
-00005d00: 706c 6961 6e74 2066 696c 652e 0a0a 2020  pliant file...  
-00005d10: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00005d20: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00005d30: 766f 6c75 6d65 203a 2058 5261 6456 6f6c  volume : XRadVol
-00005d40: 756d 6520 6f62 6a65 6374 0a20 2020 2066  ume object.    f
-00005d50: 696c 656e 616d 6520 3a20 7374 720a 2020  ilename : str.  
-00005d60: 2020 2020 2020 6f75 7470 7574 2066 696c        output fil
-00005d70: 656e 616d 650a 2020 2020 7469 6d65 7374  ename.    timest
-00005d80: 6570 203a 2069 6e74 2c20 736c 6963 650a  ep : int, slice.
-00005d90: 2020 2020 2020 2020 7469 6d65 7374 6570          timestep
-00005da0: 2f73 6c69 6365 206f 6620 7761 6e74 6564  /slice of wanted
-00005db0: 2076 6f6c 756d 650a 2020 2020 6b65 7973   volume.    keys
-00005dc0: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
-00005dd0: 6c69 7374 206f 6620 7377 6565 705f 6772  list of sweep_gr
-00005de0: 6f75 705f 6e61 6d65 7320 7768 6963 6820  oup_names which 
-00005df0: 7368 6f75 6c64 2062 6520 7772 6974 7465  should be writte
-00005e00: 6e20 746f 2074 6865 2066 696c 650a 2020  n to the file.  
-00005e10: 2020 2222 220a 2020 2020 766f 6c75 6d65    """.    volume
-00005e20: 2e72 6f6f 742e 6c6f 6164 2829 0a20 2020  .root.load().   
-00005e30: 2072 6f6f 7420 3d20 766f 6c75 6d65 2e72   root = volume.r
-00005e40: 6f6f 742e 636f 7079 2864 6565 703d 5472  oot.copy(deep=Tr
-00005e50: 7565 290a 2020 2020 726f 6f74 2e61 7474  ue).    root.att
-00005e60: 7273 5b22 436f 6e76 656e 7469 6f6e 7322  rs["Conventions"
-00005e70: 5d20 3d20 2243 662f 5261 6469 616c 220a  ] = "Cf/Radial".
-00005e80: 2020 2020 726f 6f74 2e61 7474 7273 5b22      root.attrs["
-00005e90: 7665 7273 696f 6e22 5d20 3d20 2232 2e30  version"] = "2.0
-00005ea0: 220a 2020 2020 726f 6f74 2e74 6f5f 6e65  ".    root.to_ne
-00005eb0: 7463 6466 2866 696c 656e 616d 652c 206d  tcdf(filename, m
-00005ec0: 6f64 653d 2277 222c 2067 726f 7570 3d22  ode="w", group="
-00005ed0: 2f22 290a 2020 2020 6966 206b 6579 7320  /").    if keys 
-00005ee0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00005ef0: 206b 6579 7320 3d20 726f 6f74 2e73 7765   keys = root.swe
-00005f00: 6570 5f67 726f 7570 5f6e 616d 652e 7661  ep_group_name.va
-00005f10: 6c75 6573 0a20 2020 2066 6f72 2069 6478  lues.    for idx
-00005f20: 2c20 6b65 7920 696e 2065 6e75 6d65 7261  , key in enumera
-00005f30: 7465 2872 6f6f 742e 7377 6565 705f 6772  te(root.sweep_gr
-00005f40: 6f75 705f 6e61 6d65 2e76 616c 7565 7329  oup_name.values)
-00005f50: 3a0a 2020 2020 2020 2020 6966 206b 6579  :.        if key
-00005f60: 2069 6e20 6b65 7973 3a0a 2020 2020 2020   in keys:.      
-00005f70: 2020 2020 2020 7377 7020 3d20 766f 6c75        swp = volu
-00005f80: 6d65 5b69 6478 5d2e 6461 7461 2e69 7365  me[idx].data.ise
-00005f90: 6c28 7469 6d65 3d74 696d 6573 7465 7029  l(time=timestep)
-00005fa0: 0a20 2020 2020 2020 2020 2020 2073 7770  .            swp
-00005fb0: 2e74 6f5f 6e65 7463 6466 2866 696c 656e  .to_netcdf(filen
-00005fc0: 616d 652c 206d 6f64 653d 2261 222c 2067  ame, mode="a", g
-00005fd0: 726f 7570 3d6b 6579 290a 0a0a 6465 6620  roup=key)...def 
-00005fe0: 746f 5f6f 6469 6d28 766f 6c75 6d65 2c20  to_odim(volume, 
-00005ff0: 6669 6c65 6e61 6d65 2c20 7469 6d65 7374  filename, timest
-00006000: 6570 3d30 293a 0a20 2020 2022 2222 5361  ep=0):.    """Sa
-00006010: 7665 2058 5261 6456 6f6c 2f58 5261 6456  ve XRadVol/XRadV
-00006020: 6f6c 756d 6520 746f 204f 4449 4d5f 4835  olume to ODIM_H5
-00006030: 2f56 325f 3220 636f 6d70 6c69 616e 7420  /V2_2 compliant 
-00006040: 6669 6c65 2e0a 0a20 2020 2050 6172 616d  file...    Param
-00006050: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00006060: 2d2d 2d2d 0a20 2020 2076 6f6c 756d 6520  ----.    volume 
-00006070: 3a20 5852 6164 566f 6c2f 5852 6164 566f  : XRadVol/XRadVo
-00006080: 6c75 6d65 206f 626a 6563 740a 2020 2020  lume object.    
-00006090: 6669 6c65 6e61 6d65 203a 2073 7472 0a20  filename : str. 
-000060a0: 2020 2020 2020 206f 7574 7075 7420 6669         output fi
-000060b0: 6c65 6e61 6d65 0a20 2020 2074 696d 6573  lename.    times
-000060c0: 7465 7020 3a20 696e 740a 2020 2020 2020  tep : int.      
-000060d0: 2020 7469 6d65 7374 6570 206f 6620 7761    timestep of wa
-000060e0: 6e74 6564 2076 6f6c 756d 650a 2020 2020  nted volume.    
-000060f0: 2222 220a 2020 2020 726f 6f74 203d 2076  """.    root = v
-00006100: 6f6c 756d 652e 726f 6f74 0a0a 2020 2020  olume.root..    
-00006110: 6835 203d 2068 3570 792e 4669 6c65 2866  h5 = h5py.File(f
-00006120: 696c 656e 616d 652c 2022 7722 290a 0a20  ilename, "w").. 
-00006130: 2020 2023 2072 6f6f 7420 6772 6f75 702c     # root group,
-00006140: 206f 6e6c 7920 436f 6e76 656e 7469 6f6e   only Convention
-00006150: 7320 666f 7220 4f44 494d 5f48 350a 2020  s for ODIM_H5.  
-00006160: 2020 5f77 7269 7465 5f6f 6469 6d28 7b22    _write_odim({"
-00006170: 436f 6e76 656e 7469 6f6e 7322 3a20 224f  Conventions": "O
-00006180: 4449 4d5f 4835 2f56 325f 3222 7d2c 2068  DIM_H5/V2_2"}, h
-00006190: 3529 0a0a 2020 2020 2320 686f 7720 6772  5)..    # how gr
-000061a0: 6f75 700a 2020 2020 686f 7720 3d20 7b7d  oup.    how = {}
-000061b0: 0a20 2020 2068 6f77 2e75 7064 6174 6528  .    how.update(
-000061c0: 7b22 5f6d 6f64 6966 6963 6174 696f 6e5f  {"_modification_
-000061d0: 7072 6f67 7261 6d22 3a20 2277 7261 646c  program": "wradl
-000061e0: 6962 227d 290a 0a20 2020 2068 355f 686f  ib"})..    h5_ho
-000061f0: 7720 3d20 6835 2e63 7265 6174 655f 6772  w = h5.create_gr
-00006200: 6f75 7028 2268 6f77 2229 0a20 2020 205f  oup("how").    _
-00006210: 7772 6974 655f 6f64 696d 2868 6f77 2c20  write_odim(how, 
-00006220: 6835 5f68 6f77 290a 0a20 2020 2073 7765  h5_how)..    swe
-00006230: 6570 6e61 6d65 7320 3d20 726f 6f74 2e73  epnames = root.s
-00006240: 7765 6570 5f67 726f 7570 5f6e 616d 652e  weep_group_name.
-00006250: 7661 6c75 6573 0a0a 2020 2020 2320 7768  values..    # wh
-00006260: 6174 2067 726f 7570 2c20 6f62 6a65 6374  at group, object
-00006270: 2c20 7665 7273 696f 6e2c 2064 6174 652c  , version, date,
-00006280: 2074 696d 652c 2073 6f75 7263 652c 206d   time, source, m
-00006290: 616e 6461 746f 7279 0a20 2020 2023 2070  andatory.    # p
-000062a0: 2e20 3130 2066 0a20 2020 2077 6861 7420  . 10 f.    what 
-000062b0: 3d20 7b7d 0a20 2020 2069 6620 6c65 6e28  = {}.    if len(
-000062c0: 7377 6565 706e 616d 6573 2920 3e20 313a  sweepnames) > 1:
-000062d0: 0a20 2020 2020 2020 2077 6861 745b 226f  .        what["o
-000062e0: 626a 6563 7422 5d20 3d20 2250 564f 4c22  bject"] = "PVOL"
-000062f0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00006300: 2020 2077 6861 745b 226f 626a 6563 7422     what["object"
-00006310: 5d20 3d20 2253 4341 4e22 0a20 2020 2077  ] = "SCAN".    w
-00006320: 6861 745b 2276 6572 7369 6f6e 225d 203d  hat["version"] =
-00006330: 2022 4835 7261 6420 322e 3222 0a20 2020   "H5rad 2.2".   
-00006340: 2077 6861 745b 2264 6174 6522 5d20 3d20   what["date"] = 
-00006350: 7374 7228 726f 6f74 2e74 696d 655f 636f  str(root.time_co
-00006360: 7665 7261 6765 5f73 7461 7274 2e76 616c  verage_start.val
-00006370: 7565 7329 5b3a 3130 5d2e 7265 706c 6163  ues)[:10].replac
-00006380: 6528 222d 222c 2022 2229 0a20 2020 2077  e("-", "").    w
-00006390: 6861 745b 2274 696d 6522 5d20 3d20 7374  hat["time"] = st
-000063a0: 7228 726f 6f74 2e74 696d 655f 636f 7665  r(root.time_cove
-000063b0: 7261 6765 5f65 6e64 2e76 616c 7565 7329  rage_end.values)
-000063c0: 5b31 313a 3139 5d2e 7265 706c 6163 6528  [11:19].replace(
-000063d0: 223a 222c 2022 2229 0a20 2020 2077 6861  ":", "").    wha
-000063e0: 745b 2273 6f75 7263 6522 5d20 3d20 726f  t["source"] = ro
-000063f0: 6f74 2e61 7474 7273 5b22 696e 7374 7275  ot.attrs["instru
-00006400: 6d65 6e74 5f6e 616d 6522 5d0a 0a20 2020  ment_name"]..   
-00006410: 2068 355f 7768 6174 203d 2068 352e 6372   h5_what = h5.cr
-00006420: 6561 7465 5f67 726f 7570 2822 7768 6174  eate_group("what
-00006430: 2229 0a20 2020 205f 7772 6974 655f 6f64  ").    _write_od
-00006440: 696d 2877 6861 742c 2068 355f 7768 6174  im(what, h5_what
-00006450: 290a 0a20 2020 2023 2077 6865 7265 2067  )..    # where g
-00006460: 726f 7570 2c20 6c6f 6e2c 206c 6174 2c20  roup, lon, lat, 
-00006470: 6865 6967 6874 2c20 6d61 6e64 6174 6f72  height, mandator
-00006480: 790a 2020 2020 7768 6572 6520 3d20 7b0a  y.    where = {.
-00006490: 2020 2020 2020 2020 226c 6f6e 223a 2072          "lon": r
-000064a0: 6f6f 742e 6c6f 6e67 6974 7564 652e 7661  oot.longitude.va
-000064b0: 6c75 6573 2c0a 2020 2020 2020 2020 226c  lues,.        "l
-000064c0: 6174 223a 2072 6f6f 742e 6c61 7469 7475  at": root.latitu
-000064d0: 6465 2e76 616c 7565 732c 0a20 2020 2020  de.values,.     
-000064e0: 2020 2022 6865 6967 6874 223a 2072 6f6f     "height": roo
-000064f0: 742e 616c 7469 7475 6465 2e76 616c 7565  t.altitude.value
-00006500: 732c 0a20 2020 207d 0a20 2020 2068 355f  s,.    }.    h5_
-00006510: 7768 6572 6520 3d20 6835 2e63 7265 6174  where = h5.creat
-00006520: 655f 6772 6f75 7028 2277 6865 7265 2229  e_group("where")
-00006530: 0a20 2020 205f 7772 6974 655f 6f64 696d  .    _write_odim
-00006540: 2877 6865 7265 2c20 6835 5f77 6865 7265  (where, h5_where
-00006550: 290a 0a20 2020 2023 2064 6174 6173 6574  )..    # dataset
-00006560: 730a 2020 2020 6473 5f6c 6973 7420 3d20  s.    ds_list = 
-00006570: 5b22 6461 7461 7365 747b 7d22 2e66 6f72  ["dataset{}".for
-00006580: 6d61 7428 6920 2b20 3129 2066 6f72 2069  mat(i + 1) for i
-00006590: 2069 6e20 7261 6e67 6528 6c65 6e28 7377   in range(len(sw
-000065a0: 6565 706e 616d 6573 2929 5d0a 2020 2020  eepnames))].    
-000065b0: 6473 5f69 6478 203d 206e 702e 6172 6773  ds_idx = np.args
-000065c0: 6f72 7428 6473 5f6c 6973 7429 0a20 2020  ort(ds_list).   
-000065d0: 2066 6f72 2069 6478 2069 6e20 6473 5f69   for idx in ds_i
-000065e0: 6478 3a0a 2020 2020 2020 2020 7472 793a  dx:.        try:
-000065f0: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
-00006600: 3d20 766f 6c75 6d65 5b22 7377 6565 705f  = volume["sweep_
-00006610: 7b7d 222e 666f 726d 6174 2869 6478 202b  {}".format(idx +
-00006620: 2031 295d 0a20 2020 2020 2020 2065 7863   1)].        exc
-00006630: 6570 7420 5479 7065 4572 726f 723a 0a20  ept TypeError:. 
-00006640: 2020 2020 2020 2020 2020 2064 7320 3d20             ds = 
-00006650: 766f 6c75 6d65 5b69 6478 5d5b 7469 6d65  volume[idx][time
-00006660: 7374 6570 5d2e 6461 7461 0a20 2020 2020  step].data.     
-00006670: 2020 2068 355f 6461 7461 7365 7420 3d20     h5_dataset = 
-00006680: 6835 2e63 7265 6174 655f 6772 6f75 7028  h5.create_group(
-00006690: 6473 5f6c 6973 745b 6964 785d 290a 0a20  ds_list[idx]).. 
-000066a0: 2020 2020 2020 2023 2077 6861 7420 6772         # what gr
-000066b0: 6f75 7020 702e 2032 3120 6666 2e0a 2020  oup p. 21 ff..  
-000066c0: 2020 2020 2020 6835 5f64 735f 7768 6174        h5_ds_what
-000066d0: 203d 2068 355f 6461 7461 7365 742e 6372   = h5_dataset.cr
-000066e0: 6561 7465 5f67 726f 7570 2822 7768 6174  eate_group("what
-000066f0: 2229 0a20 2020 2020 2020 2064 735f 7768  ").        ds_wh
-00006700: 6174 203d 207b 7d0a 2020 2020 2020 2020  at = {}.        
-00006710: 2320 736b 6970 204e 6154 2076 616c 7565  # skip NaT value
-00006720: 730a 2020 2020 2020 2020 7661 6c69 645f  s.        valid_
-00006730: 7469 6d65 7320 3d20 7e6e 702e 6973 6e61  times = ~np.isna
-00006740: 7428 6473 2e74 696d 652e 7661 6c75 6573  t(ds.time.values
-00006750: 290a 2020 2020 2020 2020 7420 3d20 736f  ).        t = so
-00006760: 7274 6564 2864 732e 7469 6d65 2e76 616c  rted(ds.time.val
-00006770: 7565 735b 7661 6c69 645f 7469 6d65 735d  ues[valid_times]
-00006780: 290a 2020 2020 2020 2020 7374 6172 7420  ).        start 
-00006790: 3d20 6474 2e64 6174 6574 696d 652e 7574  = dt.datetime.ut
-000067a0: 6366 726f 6d74 696d 6573 7461 6d70 286e  cfromtimestamp(n
-000067b0: 702e 7269 6e74 2874 5b30 5d2e 6173 7479  p.rint(t[0].asty
-000067c0: 7065 2822 4f22 2920 2f20 3165 3929 290a  pe("O") / 1e9)).
-000067d0: 2020 2020 2020 2020 656e 6420 3d20 6474          end = dt
-000067e0: 2e64 6174 6574 696d 652e 7574 6366 726f  .datetime.utcfro
-000067f0: 6d74 696d 6573 7461 6d70 286e 702e 7269  mtimestamp(np.ri
-00006800: 6e74 2874 5b2d 315d 2e61 7374 7970 6528  nt(t[-1].astype(
-00006810: 224f 2229 202f 2031 6539 2929 0a20 2020  "O") / 1e9)).   
-00006820: 2020 2020 2064 735f 7768 6174 5b22 7072       ds_what["pr
-00006830: 6f64 7563 7422 5d20 3d20 2253 4341 4e22  oduct"] = "SCAN"
-00006840: 0a20 2020 2020 2020 2064 735f 7768 6174  .        ds_what
-00006850: 5b22 7374 6172 7464 6174 6522 5d20 3d20  ["startdate"] = 
-00006860: 7374 6172 742e 7374 7266 7469 6d65 2822  start.strftime("
-00006870: 2559 256d 2564 2229 0a20 2020 2020 2020  %Y%m%d").       
-00006880: 2064 735f 7768 6174 5b22 7374 6172 7474   ds_what["startt
-00006890: 696d 6522 5d20 3d20 7374 6172 742e 7374  ime"] = start.st
-000068a0: 7266 7469 6d65 2822 2548 254d 2553 2229  rftime("%H%M%S")
-000068b0: 0a20 2020 2020 2020 2064 735f 7768 6174  .        ds_what
-000068c0: 5b22 656e 6464 6174 6522 5d20 3d20 656e  ["enddate"] = en
-000068d0: 642e 7374 7266 7469 6d65 2822 2559 256d  d.strftime("%Y%m
-000068e0: 2564 2229 0a20 2020 2020 2020 2064 735f  %d").        ds_
-000068f0: 7768 6174 5b22 656e 6474 696d 6522 5d20  what["endtime"] 
-00006900: 3d20 656e 642e 7374 7266 7469 6d65 2822  = end.strftime("
-00006910: 2548 254d 2553 2229 0a20 2020 2020 2020  %H%M%S").       
-00006920: 205f 7772 6974 655f 6f64 696d 2864 735f   _write_odim(ds_
-00006930: 7768 6174 2c20 6835 5f64 735f 7768 6174  what, h5_ds_what
-00006940: 290a 0a20 2020 2020 2020 2023 2077 6865  )..        # whe
-00006950: 7265 2067 726f 7570 2c20 702e 2031 3120  re group, p. 11 
-00006960: 6666 2e20 6d61 6e64 6174 6f72 790a 2020  ff. mandatory.  
-00006970: 2020 2020 2020 6835 5f64 735f 7768 6572        h5_ds_wher
-00006980: 6520 3d20 6835 5f64 6174 6173 6574 2e63  e = h5_dataset.c
-00006990: 7265 6174 655f 6772 6f75 7028 2277 6865  reate_group("whe
-000069a0: 7265 2229 0a20 2020 2020 2020 2072 7363  re").        rsc
-000069b0: 616c 6520 3d20 6473 2e72 616e 6765 2e76  ale = ds.range.v
-000069c0: 616c 7565 735b 315d 202f 2031 2e30 202d  alues[1] / 1.0 -
-000069d0: 2064 732e 7261 6e67 652e 7661 6c75 6573   ds.range.values
-000069e0: 5b30 5d0a 2020 2020 2020 2020 7273 7461  [0].        rsta
-000069f0: 7274 203d 2028 6473 2e72 616e 6765 2e76  rt = (ds.range.v
-00006a00: 616c 7565 735b 305d 202d 2072 7363 616c  alues[0] - rscal
-00006a10: 6520 2f20 322e 3029 202f 2031 3030 302e  e / 2.0) / 1000.
-00006a20: 300a 2020 2020 2020 2020 2320 746f 646f  0.        # todo
-00006a30: 3a20 6d61 6b65 2074 6869 7320 776f 726b  : make this work
-00006a40: 2066 6f72 2052 4849 2773 0a20 2020 2020   for RHI's.     
-00006a50: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00006a60: 2020 2020 6131 6761 7465 203d 206e 702e      a1gate = np.
-00006a70: 6172 6773 6f72 7428 6473 2e73 6f72 7462  argsort(ds.sortb
-00006a80: 7928 2274 696d 6522 292e 617a 696d 7574  y("time").azimut
-00006a90: 682e 7661 6c75 6573 295b 305d 0a20 2020  h.values)[0].   
-00006aa0: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-00006ab0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00006ac0: 2020 2020 6131 6761 7465 203d 206e 702e      a1gate = np.
-00006ad0: 6172 6773 6f72 7428 6473 2e73 6f72 7462  argsort(ds.sortb
-00006ae0: 7928 2272 7469 6d65 2229 2e61 7a69 6d75  y("rtime").azimu
-00006af0: 7468 2e76 616c 7565 7329 5b30 5d0a 2020  th.values)[0].  
-00006b00: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00006b10: 2020 2020 2020 2066 6978 6564 5f61 6e67         fixed_ang
-00006b20: 6c65 203d 2064 732e 6669 7865 645f 616e  le = ds.fixed_an
-00006b30: 676c 650a 2020 2020 2020 2020 6578 6365  gle.        exce
-00006b40: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
-00006b50: 723a 0a20 2020 2020 2020 2020 2020 2066  r:.            f
-00006b60: 6978 6564 5f61 6e67 6c65 203d 2064 732e  ixed_angle = ds.
-00006b70: 656c 6576 6174 696f 6e2e 726f 756e 6428  elevation.round(
-00006b80: 6465 6369 6d61 6c73 3d31 292e 6d65 6469  decimals=1).medi
-00006b90: 616e 2829 2e76 616c 7565 730a 2020 2020  an().values.    
-00006ba0: 2020 2020 6473 5f77 6865 7265 203d 207b      ds_where = {
-00006bb0: 0a20 2020 2020 2020 2020 2020 2022 656c  .            "el
-00006bc0: 616e 676c 6522 3a20 6669 7865 645f 616e  angle": fixed_an
-00006bd0: 676c 652c 0a20 2020 2020 2020 2020 2020  gle,.           
-00006be0: 2022 6e62 696e 7322 3a20 6473 2e72 616e   "nbins": ds.ran
-00006bf0: 6765 2e73 6861 7065 5b30 5d2c 0a20 2020  ge.shape[0],.   
-00006c00: 2020 2020 2020 2020 2022 7273 7461 7274           "rstart
-00006c10: 223a 2072 7374 6172 742c 0a20 2020 2020  ": rstart,.     
-00006c20: 2020 2020 2020 2022 7273 6361 6c65 223a         "rscale":
-00006c30: 2072 7363 616c 652c 0a20 2020 2020 2020   rscale,.       
-00006c40: 2020 2020 2022 6e72 6179 7322 3a20 6473       "nrays": ds
-00006c50: 2e61 7a69 6d75 7468 2e73 6861 7065 5b30  .azimuth.shape[0
-00006c60: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00006c70: 6131 6761 7465 223a 2061 3167 6174 652c  a1gate": a1gate,
-00006c80: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00006c90: 2020 205f 7772 6974 655f 6f64 696d 2864     _write_odim(d
-00006ca0: 735f 7768 6572 652c 2068 355f 6473 5f77  s_where, h5_ds_w
-00006cb0: 6865 7265 290a 0a20 2020 2020 2020 2023  here)..        #
-00006cc0: 2068 6f77 2067 726f 7570 2c20 702e 2031   how group, p. 1
-00006cd0: 3420 6666 2e0a 2020 2020 2020 2020 6835  4 ff..        h5
-00006ce0: 5f64 735f 686f 7720 3d20 6835 5f64 6174  _ds_how = h5_dat
-00006cf0: 6173 6574 2e63 7265 6174 655f 6772 6f75  aset.create_grou
-00006d00: 7028 2268 6f77 2229 0a20 2020 2020 2020  p("how").       
-00006d10: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00006d20: 2020 746f 7574 203d 205b 7478 2e61 7374    tout = [tx.ast
-00006d30: 7970 6528 224f 2229 202f 2031 6539 2066  ype("O") / 1e9 f
-00006d40: 6f72 2074 7820 696e 2064 732e 736f 7274  or tx in ds.sort
-00006d50: 6279 2822 617a 696d 7574 6822 292e 7469  by("azimuth").ti
-00006d60: 6d65 5d0a 2020 2020 2020 2020 6578 6365  me].        exce
-00006d70: 7074 2054 7970 6545 7272 6f72 3a0a 2020  pt TypeError:.  
-00006d80: 2020 2020 2020 2020 2020 746f 7574 203d            tout =
-00006d90: 205b 7478 2e61 7374 7970 6528 224f 2229   [tx.astype("O")
-00006da0: 202f 2031 6539 2066 6f72 2074 7820 696e   / 1e9 for tx in
-00006db0: 2064 732e 736f 7274 6279 2822 617a 696d   ds.sortby("azim
-00006dc0: 7574 6822 292e 7274 696d 655d 0a0a 2020  uth").rtime]..  
-00006dd0: 2020 2020 2020 6469 6666 7420 3d20 6e70        difft = np
-00006de0: 2e64 6966 6628 746f 7574 2920 2f20 322e  .diff(tout) / 2.
-00006df0: 300a 2020 2020 2020 2020 6469 6666 7420  0.        difft 
-00006e00: 3d20 6e70 2e69 6e73 6572 7428 6469 6666  = np.insert(diff
-00006e10: 742c 2030 2c20 6469 6666 745b 305d 290a  t, 0, difft[0]).
-00006e20: 2020 2020 2020 2020 617a 6f75 7420 3d20          azout = 
-00006e30: 6473 2e73 6f72 7462 7928 2261 7a69 6d75  ds.sortby("azimu
-00006e40: 7468 2229 2e61 7a69 6d75 7468 0a20 2020  th").azimuth.   
-00006e50: 2020 2020 2064 6966 6661 203d 206e 702e       diffa = np.
-00006e60: 6469 6666 2861 7a6f 7574 2920 2f20 322e  diff(azout) / 2.
-00006e70: 300a 2020 2020 2020 2020 6469 6666 6120  0.        diffa 
-00006e80: 3d20 6e70 2e69 6e73 6572 7428 6469 6666  = np.insert(diff
-00006e90: 612c 2030 2c20 6469 6666 615b 305d 290a  a, 0, diffa[0]).
-00006ea0: 2020 2020 2020 2020 656c 6f75 7420 3d20          elout = 
-00006eb0: 6473 2e73 6f72 7462 7928 2261 7a69 6d75  ds.sortby("azimu
-00006ec0: 7468 2229 2e65 6c65 7661 7469 6f6e 0a20  th").elevation. 
-00006ed0: 2020 2020 2020 2064 6966 6665 203d 206e         diffe = n
-00006ee0: 702e 6469 6666 2865 6c6f 7574 2920 2f20  p.diff(elout) / 
-00006ef0: 322e 300a 2020 2020 2020 2020 6469 6666  2.0.        diff
-00006f00: 6520 3d20 6e70 2e69 6e73 6572 7428 6469  e = np.insert(di
-00006f10: 6666 652c 2030 2c20 6469 6666 655b 305d  ffe, 0, diffe[0]
-00006f20: 290a 2020 2020 2020 2020 7472 793a 0a20  ).        try:. 
-00006f30: 2020 2020 2020 2020 2020 2073 7765 6570             sweep
-00006f40: 5f6e 756d 6265 7220 3d20 6473 2e73 7765  _number = ds.swe
-00006f50: 6570 5f6e 756d 6265 7220 2b20 310a 2020  ep_number + 1.  
-00006f60: 2020 2020 2020 6578 6365 7074 2041 7474        except Att
-00006f70: 7269 6275 7465 4572 726f 723a 0a20 2020  ributeError:.   
-00006f80: 2020 2020 2020 2020 2073 7765 6570 5f6e           sweep_n
-00006f90: 756d 6265 7220 3d20 7469 6d65 7374 6570  umber = timestep
-00006fa0: 0a20 2020 2020 2020 2064 735f 686f 7720  .        ds_how 
-00006fb0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00006fc0: 2273 6361 6e5f 696e 6465 7822 3a20 7377  "scan_index": sw
-00006fd0: 6565 705f 6e75 6d62 6572 2c0a 2020 2020  eep_number,.    
-00006fe0: 2020 2020 2020 2020 2273 6361 6e5f 636f          "scan_co
-00006ff0: 756e 7422 3a20 6c65 6e28 7377 6565 706e  unt": len(sweepn
-00007000: 616d 6573 292c 0a20 2020 2020 2020 2020  ames),.         
-00007010: 2020 2022 7374 6172 7461 7a54 223a 2074     "startazT": t
-00007020: 6f75 7420 2d20 6469 6666 742c 0a20 2020  out - difft,.   
-00007030: 2020 2020 2020 2020 2022 7374 6f70 617a           "stopaz
-00007040: 5422 3a20 746f 7574 202b 2064 6966 6674  T": tout + difft
-00007050: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
-00007060: 7461 7274 617a 4122 3a20 617a 6f75 7420  tartazA": azout 
-00007070: 2d20 6469 6666 612c 0a20 2020 2020 2020  - diffa,.       
-00007080: 2020 2020 2022 7374 6f70 617a 4122 3a20       "stopazA": 
-00007090: 617a 6f75 7420 2b20 6469 6666 612c 0a20  azout + diffa,. 
-000070a0: 2020 2020 2020 2020 2020 2022 7374 6172             "star
-000070b0: 7465 6c41 223a 2065 6c6f 7574 202d 2064  telA": elout - d
-000070c0: 6966 6665 2c0a 2020 2020 2020 2020 2020  iffe,.          
-000070d0: 2020 2273 746f 7065 6c41 223a 2065 6c6f    "stopelA": elo
-000070e0: 7574 202b 2064 6966 6665 2c0a 2020 2020  ut + diffe,.    
-000070f0: 2020 2020 7d0a 2020 2020 2020 2020 5f77      }.        _w
-00007100: 7269 7465 5f6f 6469 6d28 6473 5f68 6f77  rite_odim(ds_how
-00007110: 2c20 6835 5f64 735f 686f 7729 0a0a 2020  , h5_ds_how)..  
-00007120: 2020 2020 2020 2320 7772 6974 6520 6d6f        # write mo
-00007130: 6d65 6e74 730a 2020 2020 2020 2020 5f77  ments.        _w
-00007140: 7269 7465 5f6f 6469 6d5f 6461 7461 7370  rite_odim_datasp
-00007150: 6163 6528 6473 2c20 6835 5f64 6174 6173  ace(ds, h5_datas
-00007160: 6574 290a 0a20 2020 2068 352e 636c 6f73  et)..    h5.clos
-00007170: 6528 290a 0a0a 6465 6620 5f70 7265 7072  e()...def _prepr
-00007180: 6f63 6573 735f 6d6f 6d65 6e74 2864 732c  ocess_moment(ds,
-00007190: 206d 6f6d 2c20 6e6f 6e5f 756e 6966 6f72   mom, non_unifor
-000071a0: 6d5f 7368 6170 6529 3a0a 0a20 2020 2061  m_shape):..    a
-000071b0: 7474 7273 203d 206d 6f6d 2e5f 6465 636f  ttrs = mom._deco
-000071c0: 6465 2864 732e 6461 7461 2e61 7474 7273  de(ds.data.attrs
-000071d0: 290a 2020 2020 7175 616e 7469 7479 203d  ).    quantity =
-000071e0: 206d 6f6d 2e71 7561 6e74 6974 790a 0a20   mom.quantity.. 
-000071f0: 2020 2023 2065 7874 7261 6374 2061 6e64     # extract and
-00007200: 2074 7261 6e73 6c61 7465 2061 7474 7269   translate attri
-00007210: 6275 7465 7320 746f 2063 660a 2020 2020  butes to cf.    
-00007220: 7768 6174 203d 206d 6f6d 2e77 6861 740a  what = mom.what.
-00007230: 2020 2020 6174 7472 735b 2273 6361 6c65      attrs["scale
-00007240: 5f66 6163 746f 7222 5d20 3d20 7768 6174  _factor"] = what
-00007250: 5b22 6761 696e 225d 0a20 2020 2061 7474  ["gain"].    att
-00007260: 7273 5b22 6164 645f 6f66 6673 6574 225d  rs["add_offset"]
-00007270: 203d 2077 6861 745b 226f 6666 7365 7422   = what["offset"
-00007280: 5d0a 2020 2020 6174 7472 735b 225f 4669  ].    attrs["_Fi
-00007290: 6c6c 5661 6c75 6522 5d20 3d20 7768 6174  llValue"] = what
-000072a0: 5b22 6e6f 6461 7461 225d 0a20 2020 2061  ["nodata"].    a
-000072b0: 7474 7273 5b22 5f55 6e64 6574 6563 7422  ttrs["_Undetect"
-000072c0: 5d20 3d20 7768 6174 5b22 756e 6465 7465  ] = what["undete
-000072d0: 6374 225d 0a0a 2020 2020 6966 206d 6f6d  ct"]..    if mom
-000072e0: 2e70 6172 656e 742e 6465 636f 6465 5f63  .parent.decode_c
-000072f0: 6f6f 7264 733a 0a20 2020 2020 2020 2061  oords:.        a
-00007300: 7474 7273 5b22 636f 6f72 6469 6e61 7465  ttrs["coordinate
-00007310: 7322 5d20 3d20 2265 6c65 7661 7469 6f6e  s"] = "elevation
-00007320: 2061 7a69 6d75 7468 2072 616e 6765 220a   azimuth range".
-00007330: 0a20 2020 2023 2068 616e 646c 6520 6e6f  .    # handle no
-00007340: 6e2d 7374 616e 6461 7264 206d 6f6d 656e  n-standard momen
-00007350: 7420 6e61 6d65 730a 2020 2020 7472 793a  t names.    try:
-00007360: 0a20 2020 2020 2020 206d 6170 7069 6e67  .        mapping
-00007370: 203d 206d 6f6d 656e 7473 5f6d 6170 7069   = moments_mappi
-00007380: 6e67 5b71 7561 6e74 6974 795d 0a20 2020  ng[quantity].   
-00007390: 2065 7863 6570 7420 4b65 7945 7272 6f72   except KeyError
-000073a0: 3a0a 2020 2020 2020 2020 7061 7373 0a20  :.        pass. 
-000073b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000073c0: 2061 7474 7273 2e75 7064 6174 6528 7b6b   attrs.update({k
-000073d0: 6579 3a20 6d61 7070 696e 675b 6b65 795d  ey: mapping[key]
-000073e0: 2066 6f72 206b 6579 2069 6e20 6d6f 6d65   for key in mome
-000073f0: 6e74 5f61 7474 7273 7d29 0a0a 2020 2020  nt_attrs})..    
-00007400: 6473 5b22 6461 7461 225d 203d 2064 735b  ds["data"] = ds[
-00007410: 2264 6174 6122 5d2e 6173 7369 676e 5f61  "data"].assign_a
-00007420: 7474 7273 2861 7474 7273 290a 0a20 2020  ttrs(attrs)..   
-00007430: 2023 2066 6978 2064 696d 656e 7369 6f6e   # fix dimension
-00007440: 730a 2020 2020 6469 6d73 203d 2073 6f72  s.    dims = sor
-00007450: 7465 6428 6c69 7374 2864 732e 6469 6d73  ted(list(ds.dims
-00007460: 2e6b 6579 7328 2929 2c20 6b65 793d 6c61  .keys()), key=la
-00007470: 6d62 6461 2078 3a20 696e 7428 785b 6c65  mbda x: int(x[le
-00007480: 6e28 2270 686f 6e79 5f64 696d 5f22 2920  n("phony_dim_") 
-00007490: 3a5d 2929 0a0a 2020 2020 6473 203d 2064  :]))..    ds = d
-000074a0: 732e 7265 6e61 6d65 280a 2020 2020 2020  s.rename(.      
-000074b0: 2020 7b22 6461 7461 223a 2071 7561 6e74    {"data": quant
-000074c0: 6974 792c 2064 696d 735b 305d 3a20 6d6f  ity, dims[0]: mo
-000074d0: 6d2e 7061 7265 6e74 2e5f 6469 6d30 5b30  m.parent._dim0[0
-000074e0: 5d2c 2064 696d 735b 315d 3a20 6d6f 6d2e  ], dims[1]: mom.
-000074f0: 7061 7265 6e74 2e5f 6469 6d31 7d0a 2020  parent._dim1}.  
-00007500: 2020 290a 0a20 2020 2023 2061 7070 6c79    )..    # apply
-00007510: 2063 6f6f 7264 696e 6174 6573 2074 6f20   coordinates to 
-00007520: 6461 7461 7365 7420 6966 2073 6f75 7263  dataset if sourc
-00007530: 6520 6d6f 6d65 6e74 7320 6861 7665 2064  e moments have d
-00007540: 6966 6665 7265 6e74 2073 6861 7065 730a  ifferent shapes.
-00007550: 2020 2020 2320 616e 6420 636f 7272 6563      # and correc
-00007560: 7420 666f 7220 6974 0a20 2020 2069 6620  t for it.    if 
-00007570: 6d6f 6d2e 7061 7265 6e74 2e64 6563 6f64  mom.parent.decod
-00007580: 655f 636f 6f72 6473 2026 206e 6f6e 5f75  e_coords & non_u
-00007590: 6e69 666f 726d 5f73 6861 7065 3a0a 2020  niform_shape:.  
-000075a0: 2020 2020 2020 636f 6f72 6473 203d 206d        coords = m
-000075b0: 6f6d 2e70 6172 656e 742e 5f67 6574 5f63  om.parent._get_c
-000075c0: 6f6f 7264 7328 290a 2020 2020 2020 2020  oords().        
-000075d0: 6473 203d 2064 732e 6173 7369 676e 5f63  ds = ds.assign_c
-000075e0: 6f6f 7264 7328 636f 6f72 6473 2e63 6f6f  oords(coords.coo
-000075f0: 7264 7329 0a20 2020 2020 2020 2069 6620  rds).        if 
-00007600: 6d6f 6d2e 7061 7265 6e74 2e5f 6469 6d30  mom.parent._dim0
-00007610: 5b30 5d20 3d3d 2022 617a 696d 7574 6822  [0] == "azimuth"
-00007620: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-00007630: 203d 2064 732e 736f 7274 6279 286d 6f6d   = ds.sortby(mom
-00007640: 2e70 6172 656e 742e 5f64 696d 305b 305d  .parent._dim0[0]
-00007650: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
-00007660: 203d 2064 732e 7069 7065 285f 7265 696e   = ds.pipe(_rein
-00007670: 6465 785f 616e 676c 652c 206d 6f6d 2e70  dex_angle, mom.p
-00007680: 6172 656e 7429 0a0a 2020 2020 7265 7475  arent)..    retu
-00007690: 726e 2064 730a 0a0a 6465 6620 5f72 6569  rn ds...def _rei
-000076a0: 6e64 6578 5f61 6e67 6c65 2864 732c 2073  ndex_angle(ds, s
-000076b0: 7765 6570 2c20 666f 7263 653d 4661 6c73  weep, force=Fals
-000076c0: 6529 3a0a 2020 2020 2320 546f 646f 3a20  e):.    # Todo: 
-000076d0: 5468 6520 6375 7272 656e 7420 636f 6465  The current code
-000076e0: 2061 7373 756d 6573 2074 6f20 6861 7665   assumes to have
-000076f0: 2050 5049 2773 206f 6620 3336 3064 6567   PPI's of 360deg
-00007700: 2061 6e64 2052 4849 2773 206f 6620 3930   and RHI's of 90
-00007710: 6465 672c 0a20 2020 2023 2020 2020 2020  deg,.    #      
-00007720: 206d 616b 6520 7468 6973 2077 6f72 6b20   make this work 
-00007730: 616c 736f 2066 6f72 2073 6563 746f 7269  also for sectori
-00007740: 7a65 6420 6d65 6173 7572 656d 656e 7473  zed measurements
-00007750: 0a20 2020 2066 756c 6c5f 7261 6e67 6520  .    full_range 
-00007760: 3d20 6469 6374 2861 7a69 6d75 7468 3d33  = dict(azimuth=3
-00007770: 3630 2c20 656c 6576 6174 696f 6e3d 3930  60, elevation=90
-00007780: 290a 2020 2020 6469 6d6e 616d 6520 3d20  ).    dimname = 
-00007790: 6c69 7374 2864 732e 6469 6d73 295b 305d  list(ds.dims)[0]
-000077a0: 0a20 2020 2073 6563 6e61 6d65 203d 2073  .    secname = s
-000077b0: 7765 6570 2e5f 6469 6d30 5b31 5d0a 2020  weep._dim0[1].  
-000077c0: 2020 6469 6d20 3d20 6473 5b64 696d 6e61    dim = ds[dimna
-000077d0: 6d65 5d0a 2020 2020 6469 6666 203d 2064  me].    diff = d
-000077e0: 696d 2e64 6966 6628 6469 6d6e 616d 6529  im.diff(dimname)
-000077f0: 0a20 2020 2023 2074 6869 7320 6361 7074  .    # this capt
-00007800: 7572 6573 2064 6966 6665 7265 6e74 2061  ures different a
-00007810: 6e67 6c65 2073 7061 6369 6e67 0a20 2020  ngle spacing.   
-00007820: 2023 2063 6174 6368 6573 2061 6c73 6f20   # catches also 
-00007830: 6d69 7373 696e 6720 7261 7973 2061 6e64  missing rays and
-00007840: 2064 6f75 626c 6520 7261 7973 0a20 2020   double rays.   
-00007850: 2023 2061 6e64 206f 7468 6572 2065 7272   # and other err
-00007860: 6f6e 656f 7573 2072 6179 2061 6c69 676e  oneous ray align
-00007870: 6d65 6e74 7320 7768 6963 6820 7265 7375  ments which resu
-00007880: 6c74 2069 6e20 6469 6666 6572 656e 7420  lt in different 
-00007890: 6469 6666 2076 616c 7565 730a 2020 2020  diff values.    
-000078a0: 6469 6666 7365 7420 3d20 7365 7428 6469  diffset = set(di
-000078b0: 6666 2e76 616c 7565 7329 0a20 2020 206e  ff.values).    n
-000078c0: 6f6e 5f75 6e69 666f 726d 5f61 6e67 6c65  on_uniform_angle
-000078d0: 5f73 7061 6369 6e67 203d 206c 656e 2864  _spacing = len(d
-000078e0: 6966 6673 6574 2920 3e20 310a 2020 2020  iffset) > 1.    
-000078f0: 2320 7468 6973 2063 6170 7475 7265 7320  # this captures 
-00007900: 6d69 7373 696e 6720 616e 6420 6164 6469  missing and addi
-00007910: 7469 6f6e 616c 2072 6179 7320 696e 2063  tional rays in c
-00007920: 6173 6520 7468 6520 616e 676c 6520 6469  ase the angle di
-00007930: 6666 6572 656e 6365 730a 2020 2020 2320  fferences.    # 
-00007940: 6172 6520 6571 7561 6c0a 2020 2020 6e6f  are equal.    no
-00007950: 6e5f 6675 6c6c 5f63 6972 636c 6520 3d20  n_full_circle = 
-00007960: 4661 6c73 650a 2020 2020 6966 206e 6f74  False.    if not
-00007970: 206e 6f6e 5f75 6e69 666f 726d 5f61 6e67   non_uniform_ang
-00007980: 6c65 5f73 7061 6369 6e67 3a0a 2020 2020  le_spacing:.    
-00007990: 2020 2020 7265 7320 3d20 6c69 7374 2864      res = list(d
-000079a0: 6966 6673 6574 295b 305d 0a20 2020 2020  iffset)[0].     
-000079b0: 2020 206e 6f6e 5f66 756c 6c5f 6369 7263     non_full_circ
-000079c0: 6c65 203d 2028 2872 6573 202a 2073 7765  le = ((res * swe
-000079d0: 6570 2e6e 7261 7973 2920 2520 6675 6c6c  ep.nrays) % full
-000079e0: 5f72 616e 6765 5b64 696d 6e61 6d65 5d29  _range[dimname])
-000079f0: 2021 3d20 300a 0a20 2020 2023 2066 6978   != 0..    # fix
-00007a00: 2069 7373 7565 7320 7769 7468 2072 6179   issues with ray
-00007a10: 2061 6c69 676e 6d65 6e74 0a20 2020 2069   alignment.    i
-00007a20: 6620 666f 7263 6520 7c20 6e6f 6e5f 756e  f force | non_un
-00007a30: 6966 6f72 6d5f 616e 676c 655f 7370 6163  iform_angle_spac
-00007a40: 696e 6720 7c20 6e6f 6e5f 6675 6c6c 5f63  ing | non_full_c
-00007a50: 6972 636c 653a 0a20 2020 2020 2020 2023  ircle:.        #
-00007a60: 2063 7265 6174 6520 6e65 7720 6172 7261   create new arra
-00007a70: 7920 616e 6420 7265 696e 6465 780a 2020  y and reindex.  
-00007a80: 2020 2020 2020 7265 7320 3d20 7377 6565        res = swee
-00007a90: 702e 616e 676c 655f 7265 736f 6c75 7469  p.angle_resoluti
-00007aa0: 6f6e 0a20 2020 2020 2020 206e 6577 5f72  on.        new_r
-00007ab0: 6179 7320 3d20 696e 7428 6e70 2e72 6f75  ays = int(np.rou
-00007ac0: 6e64 2866 756c 6c5f 7261 6e67 655b 6469  nd(full_range[di
-00007ad0: 6d6e 616d 655d 202f 2072 6573 2c20 6465  mname] / res, de
-00007ae0: 6369 6d61 6c73 3d30 2929 0a0a 2020 2020  cimals=0))..    
-00007af0: 2020 2020 2320 6669 6e64 2065 7861 6374      # find exact
-00007b00: 2064 7570 6c69 6361 7465 7320 616e 6420   duplicates and 
-00007b10: 7265 6d6f 7665 0a20 2020 2020 2020 205f  remove.        _
-00007b20: 2c20 6964 7820 3d20 6e70 2e75 6e69 7175  , idx = np.uniqu
-00007b30: 6528 6473 5b64 696d 6e61 6d65 5d2c 2072  e(ds[dimname], r
-00007b40: 6574 7572 6e5f 696e 6465 783d 5472 7565  eturn_index=True
-00007b50: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
-00007b60: 2869 6478 2920 3c20 6c65 6e28 6473 5b64  (idx) < len(ds[d
-00007b70: 696d 6e61 6d65 5d29 3a0a 2020 2020 2020  imname]):.      
-00007b80: 2020 2020 2020 6473 203d 2064 732e 6973        ds = ds.is
-00007b90: 656c 287b 6469 6d6e 616d 653a 2069 6478  el({dimname: idx
-00007ba0: 7d29 0a20 2020 2020 2020 2020 2020 2023  }).            #
-00007bb0: 2069 6620 7261 795f 7469 6d65 2077 6173   if ray_time was
-00007bc0: 2065 7272 6f75 6e65 6f75 736c 7920 6372   errouneously cr
-00007bd0: 6561 7465 6420 6672 6f6d 2077 726f 6e67  eated from wrong
-00007be0: 2064 696d 656e 7369 6f6e 730a 2020 2020   dimensions.    
-00007bf0: 2020 2020 2020 2020 2320 7765 206e 6565          # we nee
-00007c00: 6420 746f 2072 6563 616c 6375 6c61 7465  d to recalculate
-00007c10: 2069 740a 2020 2020 2020 2020 2020 2020   it.            
-00007c20: 6966 2073 7765 6570 2e5f 6e65 6564 5f74  if sweep._need_t
-00007c30: 696d 655f 7265 6361 6c63 3a0a 2020 2020  ime_recalc:.    
-00007c40: 2020 2020 2020 2020 2020 2020 7261 795f              ray_
-00007c50: 7469 6d65 7320 3d20 7377 6565 702e 5f67  times = sweep._g
-00007c60: 6574 5f72 6179 5f74 696d 6573 286e 7261  et_ray_times(nra
-00007c70: 7973 3d6c 656e 2869 6478 2929 0a20 2020  ys=len(idx)).   
-00007c80: 2020 2020 2020 2020 2020 2020 2072 6179               ray
-00007c90: 5f74 696d 6573 203d 2073 7765 6570 2e5f  _times = sweep._
-00007ca0: 6465 636f 6465 5f63 6628 7261 795f 7469  decode_cf(ray_ti
-00007cb0: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
-00007cc0: 2020 2020 2064 7320 3d20 6473 2e61 7373       ds = ds.ass
-00007cd0: 6967 6e28 7b22 7274 696d 6522 3a20 7261  ign({"rtime": ra
-00007ce0: 795f 7469 6d65 737d 290a 0a20 2020 2020  y_times})..     
-00007cf0: 2020 2023 2074 6f64 6f3a 2063 6865 636b     # todo: check
-00007d00: 2069 6620 6173 7375 6d70 7469 6f6e 2074   if assumption t
-00007d10: 6861 7420 6265 616d 2063 656e 7465 7220  hat beam center 
-00007d20: 706f 696e 7473 2074 6f0a 2020 2020 2020  points to.      
-00007d30: 2020 2320 2020 2020 2020 6d75 6c74 6970    #       multip
-00007d40: 6c65 7320 6f66 2072 6573 2f32 2e20 6973  les of res/2. is
-00007d50: 2063 6f72 7265 6374 2069 6e20 616e 7920   correct in any 
-00007d60: 6361 7365 0a20 2020 2020 2020 2061 7a72  case.        azr
-00007d70: 203d 206e 702e 6172 616e 6765 2872 6573   = np.arange(res
-00007d80: 202f 2032 2e30 2c20 6e65 775f 7261 7973   / 2.0, new_rays
-00007d90: 202a 2072 6573 2c20 7265 732c 2064 7479   * res, res, dty
-00007da0: 7065 3d64 6966 662e 6474 7970 6529 0a20  pe=diff.dtype). 
-00007db0: 2020 2020 2020 2064 7320 3d20 6473 2e72         ds = ds.r
-00007dc0: 6569 6e64 6578 280a 2020 2020 2020 2020  eindex(.        
-00007dd0: 2020 2020 7b64 696d 6e61 6d65 3a20 617a      {dimname: az
-00007de0: 727d 2c0a 2020 2020 2020 2020 2020 2020  r},.            
-00007df0: 6d65 7468 6f64 3d22 6e65 6172 6573 7422  method="nearest"
-00007e00: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00007e10: 6c65 7261 6e63 653d 7265 7320 2f20 342e  lerance=res / 4.
-00007e20: 302c 0a20 2020 2020 2020 2020 2020 2023  0,.            #
-00007e30: 2066 696c 6c5f 7661 6c75 653d 7872 2e63   fill_value=xr.c
-00007e40: 6f72 652e 6474 7970 6573 2e4e 412c 0a20  ore.dtypes.NA,. 
-00007e50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00007e60: 2023 2063 6865 636b 206f 7468 6572 2063   # check other c
-00007e70: 6f6f 7264 696e 6174 6573 0a20 2020 2020  oordinates.     
-00007e80: 2020 2023 2063 6865 636b 2073 6563 6f6e     # check secon
-00007e90: 6461 7279 2061 6e67 6c65 2063 6f6f 7264  dary angle coord
-00007ea0: 696e 6174 6520 286e 6f20 6e61 6e29 0a20  inate (no nan). 
-00007eb0: 2020 2020 2020 2023 2073 6574 206e 616e         # set nan
-00007ec0: 2076 616c 7565 7320 746f 2072 6561 736f   values to reaso
-00007ed0: 6e61 626c 6520 6d65 6469 616e 0a20 2020  nable median.   
-00007ee0: 2020 2020 2069 6620 6e70 2e63 6f75 6e74       if np.count
-00007ef0: 5f6e 6f6e 7a65 726f 286e 702e 6973 6e61  _nonzero(np.isna
-00007f00: 6e28 6473 5b73 6563 6e61 6d65 5d29 293a  n(ds[secname])):
-00007f10: 0a20 2020 2020 2020 2020 2020 2064 735b  .            ds[
-00007f20: 7365 636e 616d 655d 203d 2064 735b 7365  secname] = ds[se
-00007f30: 636e 616d 655d 2e66 696c 6c6e 6128 6473  cname].fillna(ds
-00007f40: 5b73 6563 6e61 6d65 5d2e 6d65 6469 616e  [secname].median
-00007f50: 2873 6b69 706e 613d 5472 7565 2929 0a20  (skipna=True)). 
-00007f60: 2020 2020 2020 2023 2074 6f64 6f3a 2072         # todo: r
-00007f70: 7469 6d65 2069 7320 616c 736f 2061 6666  time is also aff
-00007f80: 6563 7465 642c 206d 6967 6874 206e 6565  ected, might nee
-00007f90: 6420 746f 2062 6520 7472 6561 7465 6420  d to be treated 
-00007fa0: 6163 636f 7264 696e 676c 790a 0a20 2020  accordingly..   
-00007fb0: 2072 6574 7572 6e20 6473 0a0a 0a64 6566   return ds...def
-00007fc0: 205f 6669 785f 616e 676c 6528 6461 293a   _fix_angle(da):
-00007fd0: 0a20 2020 2023 2066 6978 2065 6c65 7661  .    # fix eleva
-00007fe0: 7469 6f6e 206f 7574 6c69 6572 730a 2020  tion outliers.  
-00007ff0: 2020 6966 206c 656e 2873 6574 2864 612e    if len(set(da.
-00008000: 7661 6c75 6573 2929 203e 2031 3a0a 2020  values)) > 1:.  
-00008010: 2020 2020 2020 6d65 6420 3d20 6461 2e6d        med = da.m
-00008020: 6564 6961 6e28 736b 6970 6e61 3d54 7275  edian(skipna=Tru
-00008030: 6529 0a20 2020 2020 2020 2064 6120 3d20  e).        da = 
-00008040: 6461 2e77 6865 7265 2864 6120 3d3d 206d  da.where(da == m
-00008050: 6564 292e 6669 6c6c 6e61 286d 6564 290a  ed).fillna(med).
-00008060: 2020 2020 7265 7475 726e 2064 610a 0a0a      return da...
-00008070: 6465 6620 5f6f 7065 6e5f 6d66 6d6f 6d65  def _open_mfmome
-00008080: 6e74 7328 0a20 2020 206d 6f6d 656e 7473  nts(.    moments
-00008090: 2c0a 2020 2020 6368 756e 6b73 3d4e 6f6e  ,.    chunks=Non
-000080a0: 652c 0a20 2020 2063 6f6d 7061 743d 226e  e,.    compat="n
-000080b0: 6f5f 636f 6e66 6c69 6374 7322 2c0a 2020  o_conflicts",.  
-000080c0: 2020 7072 6570 726f 6365 7373 3d4e 6f6e    preprocess=Non
-000080d0: 652c 0a20 2020 2065 6e67 696e 653d 4e6f  e,.    engine=No
-000080e0: 6e65 2c0a 2020 2020 6c6f 636b 3d4e 6f6e  ne,.    lock=Non
-000080f0: 652c 0a20 2020 2064 6174 615f 7661 7273  e,.    data_vars
-00008100: 3d22 616c 6c22 2c0a 2020 2020 636f 6f72  ="all",.    coor
-00008110: 6473 3d22 6d69 6e69 6d61 6c22 2c0a 2020  ds="minimal",.  
-00008120: 2020 7061 7261 6c6c 656c 3d46 616c 7365    parallel=False
-00008130: 2c0a 2020 2020 2a2a 6b77 6172 6773 2c0a  ,.    **kwargs,.
-00008140: 293a 0a20 2020 2022 2222 4f70 656e 206d  ):.    """Open m
-00008150: 756c 7469 706c 6520 4f64 696d 4835 206d  ultiple OdimH5 m
-00008160: 6f6d 656e 7473 2061 7320 6120 7369 6e67  oments as a sing
-00008170: 6c65 2064 6174 6173 6574 2e0a 0a20 2020  le dataset...   
-00008180: 2054 6869 7320 6973 2064 6572 6976 6564   This is derived
-00008190: 2066 726f 6d20 7861 7272 6179 2e6f 7065   from xarray.ope
-000081a0: 6e5f 6d66 6461 7461 7365 7420 5b31 5d0a  n_mfdataset [1].
-000081b0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-000081c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000081d0: 2020 206d 6f6d 656e 7473 203a 2073 6571     moments : seq
-000081e0: 7565 6e63 650a 2020 2020 2020 2020 4c69  uence.        Li
-000081f0: 7374 206f 6620 5852 6164 5377 6565 7020  st of XRadSweep 
-00008200: 6f62 6a65 6374 732e 0a20 2020 2063 6875  objects..    chu
-00008210: 6e6b 7320 3a20 696e 7420 6f72 2064 6963  nks : int or dic
-00008220: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00008230: 2020 2020 4368 756e 6b20 7369 7a65 0a20      Chunk size. 
-00008240: 2020 2070 7265 7072 6f63 6573 7320 3a20     preprocess : 
-00008250: 6361 6c6c 6162 6c65 2c20 6f70 7469 6f6e  callable, option
-00008260: 616c 0a20 2020 2020 2020 2049 6620 7072  al.        If pr
-00008270: 6f76 6964 6564 2c20 6361 6c6c 2074 6869  ovided, call thi
-00008280: 7320 6675 6e63 7469 6f6e 206f 6e20 6561  s function on ea
-00008290: 6368 2064 6174 6173 6574 2070 7269 6f72  ch dataset prior
-000082a0: 2074 6f20 636f 6e63 6174 656e 6174 696f   to concatenatio
-000082b0: 6e2e 0a20 2020 2065 6e67 696e 6520 3a20  n..    engine : 
-000082c0: 7b27 6e65 7463 6466 3427 2c20 2768 356e  {'netcdf4', 'h5n
-000082d0: 6574 6364 6627 7d2c 206f 7074 696f 6e61  etcdf'}, optiona
-000082e0: 6c0a 2020 2020 2020 2020 456e 6769 6e65  l.        Engine
-000082f0: 2074 6f20 7573 6520 7768 656e 2072 6561   to use when rea
-00008300: 6469 6e67 2066 696c 6573 2e20 4465 6661  ding files. Defa
-00008310: 756c 7473 2074 6f20 276e 6574 6364 6634  ults to 'netcdf4
-00008320: 272e 0a20 2020 206c 6f63 6b20 3a20 4661  '..    lock : Fa
-00008330: 6c73 6520 6f72 2064 7563 6b20 7468 7265  lse or duck thre
-00008340: 6164 696e 672e 4c6f 636b 2c20 6f70 7469  ading.Lock, opti
-00008350: 6f6e 616c 0a20 2020 2020 2020 2052 6573  onal.        Res
-00008360: 6f75 7263 6520 6c6f 636b 2074 6f20 7573  ource lock to us
-00008370: 6520 7768 656e 2072 6561 6469 6e67 2064  e when reading d
-00008380: 6174 6120 6672 6f6d 2064 6973 6b2e 204f  ata from disk. O
-00008390: 6e6c 7920 7265 6c65 7661 6e74 2077 6865  nly relevant whe
-000083a0: 6e0a 2020 2020 2020 2020 7573 696e 6720  n.        using 
-000083b0: 6461 736b 206f 7220 616e 6f74 6865 7220  dask or another 
-000083c0: 666f 726d 206f 6620 7061 7261 6c6c 656c  form of parallel
-000083d0: 6973 6d2e 2042 7920 6465 6661 756c 742c  ism. By default,
-000083e0: 2061 7070 726f 7072 6961 7465 0a20 2020   appropriate.   
-000083f0: 2020 2020 206c 6f63 6b73 2061 7265 2063       locks are c
-00008400: 686f 7365 6e20 746f 2073 6166 656c 7920  hosen to safely 
-00008410: 7265 6164 2061 6e64 2077 7269 7465 2066  read and write f
-00008420: 696c 6573 2077 6974 6820 7468 6520 6375  iles with the cu
-00008430: 7272 656e 746c 790a 2020 2020 2020 2020  rrently.        
-00008440: 6163 7469 7665 2064 6173 6b20 7363 6865  active dask sche
-00008450: 6475 6c65 722e 0a20 2020 2064 6174 615f  duler..    data_
-00008460: 7661 7273 203a 207b 276d 696e 696d 616c  vars : {'minimal
-00008470: 272c 2027 6469 6666 6572 656e 7427 2c20  ', 'different', 
-00008480: 2761 6c6c 2720 6f72 206c 6973 7420 6f66  'all' or list of
-00008490: 2073 7472 7d2c 206f 7074 696f 6e61 6c0a   str}, optional.
-000084a0: 2020 2020 2020 2020 5468 6573 6520 6461          These da
-000084b0: 7461 2076 6172 6961 626c 6573 2077 696c  ta variables wil
-000084c0: 6c20 6265 2063 6f6e 6361 7465 6e61 7465  l be concatenate
-000084d0: 6420 746f 6765 7468 6572 3a0a 2020 2020  d together:.    
-000084e0: 2020 2020 2020 2a20 276d 696e 696d 616c        * 'minimal
-000084f0: 273a 204f 6e6c 7920 6461 7461 2076 6172  ': Only data var
-00008500: 6961 626c 6573 2069 6e20 7768 6963 6820  iables in which 
-00008510: 7468 6520 6469 6d65 6e73 696f 6e20 616c  the dimension al
-00008520: 7265 6164 790a 2020 2020 2020 2020 2020  ready.          
-00008530: 2020 6170 7065 6172 7320 6172 6520 696e    appears are in
-00008540: 636c 7564 6564 2e0a 2020 2020 2020 2020  cluded..        
-00008550: 2020 2a20 2764 6966 6665 7265 6e74 273a    * 'different':
-00008560: 2044 6174 6120 7661 7269 6162 6c65 7320   Data variables 
-00008570: 7768 6963 6820 6172 6520 6e6f 7420 6571  which are not eq
-00008580: 7561 6c20 2869 676e 6f72 696e 670a 2020  ual (ignoring.  
-00008590: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-000085a0: 7574 6573 2920 6163 726f 7373 2061 6c6c  utes) across all
-000085b0: 2064 6174 6173 6574 7320 6172 6520 616c   datasets are al
-000085c0: 736f 2063 6f6e 6361 7465 6e61 7465 6420  so concatenated 
-000085d0: 2861 7320 7765 6c6c 2061 730a 2020 2020  (as well as.    
-000085e0: 2020 2020 2020 2020 616c 6c20 666f 7220          all for 
-000085f0: 7768 6963 6820 6469 6d65 6e73 696f 6e20  which dimension 
-00008600: 616c 7265 6164 7920 6170 7065 6172 7329  already appears)
-00008610: 2e20 4265 7761 7265 3a20 7468 6973 206f  . Beware: this o
-00008620: 7074 696f 6e20 6d61 790a 2020 2020 2020  ption may.      
-00008630: 2020 2020 2020 6c6f 6164 2074 6865 2064        load the d
-00008640: 6174 6120 7061 796c 6f61 6420 6f66 2064  ata payload of d
-00008650: 6174 6120 7661 7269 6162 6c65 7320 696e  ata variables in
-00008660: 746f 206d 656d 6f72 7920 6966 2074 6865  to memory if the
-00008670: 7920 6172 6520 6e6f 740a 2020 2020 2020  y are not.      
-00008680: 2020 2020 2020 616c 7265 6164 7920 6c6f        already lo
-00008690: 6164 6564 2e0a 2020 2020 2020 2020 2020  aded..          
-000086a0: 2a20 2761 6c6c 273a 2041 6c6c 2064 6174  * 'all': All dat
-000086b0: 6120 7661 7269 6162 6c65 7320 7769 6c6c  a variables will
-000086c0: 2062 6520 636f 6e63 6174 656e 6174 6564   be concatenated
-000086d0: 2e0a 2020 2020 2020 2020 2020 2a20 6c69  ..          * li
-000086e0: 7374 206f 6620 7374 723a 2054 6865 206c  st of str: The l
-000086f0: 6973 7465 6420 6461 7461 2076 6172 6961  isted data varia
-00008700: 626c 6573 2077 696c 6c20 6265 2063 6f6e  bles will be con
-00008710: 6361 7465 6e61 7465 642c 2069 6e0a 2020  catenated, in.  
-00008720: 2020 2020 2020 2020 2020 6164 6469 7469            additi
-00008730: 6f6e 2074 6f20 7468 6520 276d 696e 696d  on to the 'minim
-00008740: 616c 2720 6461 7461 2076 6172 6961 626c  al' data variabl
-00008750: 6573 2e0a 2020 2020 7061 7261 6c6c 656c  es..    parallel
-00008760: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00008770: 6c0a 2020 2020 2020 2020 4966 2054 7275  l.        If Tru
-00008780: 652c 2074 6865 206f 7065 6e20 616e 6420  e, the open and 
-00008790: 7072 6570 726f 6365 7373 2073 7465 7073  preprocess steps
-000087a0: 206f 6620 7468 6973 2066 756e 6374 696f   of this functio
-000087b0: 6e20 7769 6c6c 2062 650a 2020 2020 2020  n will be.      
-000087c0: 2020 7065 7266 6f72 6d65 6420 696e 2070    performed in p
-000087d0: 6172 616c 6c65 6c20 7573 696e 6720 6060  arallel using ``
-000087e0: 6461 736b 2e64 656c 6179 6564 6060 2e20  dask.delayed``. 
-000087f0: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-00008800: 2e0a 2020 2020 2a2a 6b77 6172 6773 203a  ..    **kwargs :
-00008810: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00008820: 2020 4164 6469 7469 6f6e 616c 2061 7267    Additional arg
-00008830: 756d 656e 7473 2070 6173 7365 6420 6f6e  uments passed on
-00008840: 2074 6f20 3a70 793a 6675 6e63 3a60 7861   to :py:func:`xa
-00008850: 7272 6179 2e6f 7065 6e5f 6461 7461 7365  rray.open_datase
-00008860: 7460 2e0a 0a20 2020 2052 6574 7572 6e73  t`...    Returns
-00008870: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00008880: 2078 6172 7261 792e 4461 7461 7365 740a   xarray.Dataset.
-00008890: 0a20 2020 2052 6566 6572 656e 6365 730a  .    References.
-000088a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a      ----------..
-000088b0: 2020 2020 2e2e 205b 315d 2068 7474 7073      .. [1] https
-000088c0: 3a2f 2f78 6172 7261 792e 7079 6461 7461  ://xarray.pydata
-000088d0: 2e6f 7267 2f65 6e2f 7374 6162 6c65 2f67  .org/en/stable/g
-000088e0: 656e 6572 6174 6564 2f78 6172 7261 792e  enerated/xarray.
-000088f0: 6f70 656e 5f6d 6664 6174 6173 6574 2e68  open_mfdataset.h
-00008900: 746d 6c0a 0a20 2020 2022 2222 2020 2320  tml..    """  # 
-00008910: 6e6f 7161 0a0a 2020 2020 6f70 656e 5f6b  noqa..    open_k
-00008920: 7761 7267 7320 3d20 6469 6374 2863 6875  wargs = dict(chu
-00008930: 6e6b 733d 6368 756e 6b73 2c20 2a2a 6b77  nks=chunks, **kw
-00008940: 6172 6773 290a 0a20 2020 2023 2069 6620  args)..    # if 
-00008950: 6d6f 6d65 6e74 7320 6172 6520 7370 6563  moments are spec
-00008960: 6966 6965 6420 696e 2058 5261 6454 696d  ified in XRadTim
-00008970: 6573 6572 6965 7320 6f6e 6c79 206c 6f61  eseries only loa
-00008980: 6420 7468 6f73 650a 2020 2020 6966 206d  d those.    if m
-00008990: 6f6d 656e 7473 2e70 6172 656e 742e 5f6d  oments.parent._m
-000089a0: 6f6d 656e 7473 2069 7320 6e6f 7420 4e6f  oments is not No
-000089b0: 6e65 3a0a 2020 2020 2020 2020 6d6f 6d65  ne:.        mome
-000089c0: 6e74 7320 3d20 5b70 2066 6f72 2070 2069  nts = [p for p i
-000089d0: 6e20 6d6f 6d65 6e74 7320 6966 2070 2e71  n moments if p.q
-000089e0: 7561 6e74 6974 7920 696e 206d 6f6d 656e  uantity in momen
-000089f0: 7473 2e70 6172 656e 742e 5f6d 6f6d 656e  ts.parent._momen
-00008a00: 7473 5d0a 0a20 2020 2065 6e67 696e 6520  ts]..    engine 
-00008a10: 3d20 6d6f 6d65 6e74 735b 305d 2e65 6e67  = moments[0].eng
-00008a20: 696e 650a 2020 2020 6966 2065 6e67 696e  ine.    if engin
-00008a30: 6520 3d3d 2022 6e65 7463 6466 3422 3a0a  e == "netcdf4":.
-00008a40: 2020 2020 2020 2020 6f70 656e 6572 203d          opener =
-00008a50: 206e 632e 4461 7461 7365 740a 2020 2020   nc.Dataset.    
-00008a60: 2020 2020 6f70 656e 6572 5f6b 7761 7267      opener_kwarg
-00008a70: 7320 3d20 7b7d 0a20 2020 2020 2020 2073  s = {}.        s
-00008a80: 746f 7265 203d 2078 722e 6261 636b 656e  tore = xr.backen
-00008a90: 6473 2e4e 6574 4344 4634 4461 7461 5374  ds.NetCDF4DataSt
-00008aa0: 6f72 650a 2020 2020 656c 7365 3a0a 2020  ore.    else:.  
-00008ab0: 2020 2020 2020 6966 204c 6f6f 7365 5665        if LooseVe
-00008ac0: 7273 696f 6e28 6835 6e65 7463 6466 2e5f  rsion(h5netcdf._
-00008ad0: 5f76 6572 7369 6f6e 5f5f 2920 3c20 4c6f  _version__) < Lo
-00008ae0: 6f73 6556 6572 7369 6f6e 2822 302e 382e  oseVersion("0.8.
-00008af0: 3022 293a 0a20 2020 2020 2020 2020 2020  0"):.           
-00008b00: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00008b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b20: 6622 5752 4144 4c49 423a 2027 6835 6e65  f"WRADLIB: 'h5ne
-00008b30: 7463 6466 3e3d 302e 382e 3027 206e 6565  tcdf>=0.8.0' nee
-00008b40: 6465 6420 746f 2070 6572 666f 726d 2074  ded to perform t
-00008b50: 6869 7320 220a 2020 2020 2020 2020 2020  his ".          
-00008b60: 2020 2020 2020 6622 6f70 6572 6174 696f        f"operatio
-00008b70: 6e2e 2027 6835 6e65 7463 6466 3d7b 6835  n. 'h5netcdf={h5
-00008b80: 6e65 7463 6466 2e5f 5f76 6572 7369 6f6e  netcdf.__version
-00008b90: 5f5f 7d20 220a 2020 2020 2020 2020 2020  __} ".          
-00008ba0: 2020 2020 2020 6622 6176 6169 6c61 626c        f"availabl
-00008bb0: 652e 222c 0a20 2020 2020 2020 2020 2020  e.",.           
-00008bc0: 2020 2020 2055 7365 7257 6172 6e69 6e67       UserWarning
-00008bd0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00008be0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00008bf0: 726e 204e 6f6e 650a 2020 2020 2020 2020  rn None.        
-00008c00: 6966 204c 6f6f 7365 5665 7273 696f 6e28  if LooseVersion(
-00008c10: 7872 2e5f 5f76 6572 7369 6f6e 5f5f 2920  xr.__version__) 
-00008c20: 3c20 4c6f 6f73 6556 6572 7369 6f6e 2822  < LooseVersion("
-00008c30: 302e 3135 2e30 2229 3a0a 2020 2020 2020  0.15.0"):.      
-00008c40: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00008c50: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00008c60: 2020 2020 2066 2257 5241 444c 4942 3a20       f"WRADLIB: 
-00008c70: 2778 6172 7261 793e 3d30 2e31 352e 3027  'xarray>=0.15.0'
-00008c80: 206e 6565 6465 6420 746f 2070 6572 666f   needed to perfo
-00008c90: 726d 2074 6869 7320 220a 2020 2020 2020  rm this ".      
-00008ca0: 2020 2020 2020 2020 2020 6622 6f70 6572            f"oper
-00008cb0: 6174 696f 6e2e 2027 7861 7272 6179 3d7b  ation. 'xarray={
-00008cc0: 7872 2e5f 5f76 6572 7369 6f6e 5f5f 7d20  xr.__version__} 
-00008cd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00008ce0: 2020 6622 6176 6169 6c61 626c 652e 222c    f"available.",
-00008cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008d00: 2055 7365 7257 6172 6e69 6e67 2c0a 2020   UserWarning,.  
-00008d10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00008d20: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00008d30: 6f6e 650a 2020 2020 2020 2020 6f70 656e  one.        open
-00008d40: 6572 203d 2068 356e 6574 6364 662e 4669  er = h5netcdf.Fi
-00008d50: 6c65 0a20 2020 2020 2020 206f 7065 6e65  le.        opene
-00008d60: 725f 6b77 6172 6773 203d 2064 6963 7428  r_kwargs = dict(
-00008d70: 7068 6f6e 795f 6469 6d73 3d22 6163 6365  phony_dims="acce
-00008d80: 7373 2229 0a20 2020 2020 2020 2073 746f  ss").        sto
-00008d90: 7265 203d 2078 722e 6261 636b 656e 6473  re = xr.backends
-00008da0: 2e48 354e 6574 4344 4653 746f 7265 0a0a  .H5NetCDFStore..
-00008db0: 2020 2020 2320 646f 206e 6f74 2075 7365      # do not use
-00008dc0: 2070 6172 616c 6c65 6c20 6966 2061 6c6c   parallel if all
-00008dd0: 206d 6f6d 656e 7473 2069 6e20 6f6e 6520   moments in one 
-00008de0: 6669 6c65 0a20 2020 2069 6620 6c65 6e28  file.    if len(
-00008df0: 7365 7428 5b70 2e66 696c 656e 616d 6520  set([p.filename 
-00008e00: 666f 7220 7020 696e 206d 6f6d 656e 7473  for p in moments
-00008e10: 5d29 2920 3d3d 2031 3a0a 2020 2020 2020  ])) == 1:.      
-00008e20: 2020 7369 6e67 6c65 5f66 696c 6520 3d20    single_file = 
-00008e30: 5472 7565 0a20 2020 2020 2020 2069 6620  True.        if 
-00008e40: 6f73 2e70 6174 682e 6973 6669 6c65 286d  os.path.isfile(m
-00008e50: 6f6d 656e 7473 5b30 5d2e 6669 6c65 6e61  oments[0].filena
-00008e60: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-00008e70: 2064 7330 203d 206f 7065 6e65 7228 6d6f   ds0 = opener(mo
-00008e80: 6d65 6e74 735b 305d 2e66 696c 656e 616d  ments[0].filenam
-00008e90: 652c 2022 7222 2c20 2a2a 6f70 656e 6572  e, "r", **opener
-00008ea0: 5f6b 7761 7267 7329 0a20 2020 2020 2020  _kwargs).       
-00008eb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00008ec0: 2020 2064 7330 203d 206d 6f6d 656e 7473     ds0 = moments
-00008ed0: 5b30 5d2e 6e63 6669 6c65 0a20 2020 2065  [0].ncfile.    e
-00008ee0: 6c73 653a 0a20 2020 2020 2020 2073 696e  lse:.        sin
-00008ef0: 676c 655f 6669 6c65 203d 2046 616c 7365  gle_file = False
-00008f00: 0a0a 2020 2020 6966 2070 6172 616c 6c65  ..    if paralle
-00008f10: 6c3a 0a20 2020 2020 2020 2069 6d70 6f72  l:.        impor
-00008f20: 7420 6461 736b 0a0a 2020 2020 2020 2020  t dask..        
-00008f30: 2320 7772 6170 2074 6865 206f 7065 6e5f  # wrap the open_
-00008f40: 6461 7461 7365 742c 2067 6574 6174 7472  dataset, getattr
-00008f50: 2c20 616e 6420 7072 6570 726f 6365 7373  , and preprocess
-00008f60: 2077 6974 6820 6465 6c61 7965 640a 2020   with delayed.  
-00008f70: 2020 2020 2020 6f70 656e 5f20 3d20 6461        open_ = da
-00008f80: 736b 2e64 656c 6179 6564 2878 722e 6f70  sk.delayed(xr.op
-00008f90: 656e 5f64 6174 6173 6574 290a 2020 2020  en_dataset).    
-00008fa0: 2020 2020 6765 7461 7474 725f 203d 2064      getattr_ = d
-00008fb0: 6173 6b2e 6465 6c61 7965 6428 6765 7461  ask.delayed(geta
-00008fc0: 7474 7229 0a20 2020 2020 2020 2069 6620  ttr).        if 
-00008fd0: 7072 6570 726f 6365 7373 2069 7320 6e6f  preprocess is no
-00008fe0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00008ff0: 2020 2020 7072 6570 726f 6365 7373 203d      preprocess =
-00009000: 2064 6173 6b2e 6465 6c61 7965 6428 7072   dask.delayed(pr
-00009010: 6570 726f 6365 7373 290a 2020 2020 656c  eprocess).    el
-00009020: 7365 3a0a 2020 2020 2020 2020 6f70 656e  se:.        open
-00009030: 5f20 3d20 7872 2e6f 7065 6e5f 6461 7461  _ = xr.open_data
-00009040: 7365 740a 2020 2020 2020 2020 6765 7461  set.        geta
-00009050: 7474 725f 203d 2067 6574 6174 7472 0a0a  ttr_ = getattr..
-00009060: 2020 2020 6966 2073 696e 676c 655f 6669      if single_fi
-00009070: 6c65 3a0a 2020 2020 2020 2020 6461 7461  le:.        data
-00009080: 7365 7473 203d 205b 0a20 2020 2020 2020  sets = [.       
-00009090: 2020 2020 206f 7065 6e5f 280a 2020 2020       open_(.    
-000090a0: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
-000090b0: 6528 6473 302c 2067 726f 7570 3d70 2e6e  e(ds0, group=p.n
-000090c0: 6370 6174 682c 206c 6f63 6b3d 6c6f 636b  cpath, lock=lock
-000090d0: 2c20 6175 746f 636c 6f73 653d 4e6f 6e65  , autoclose=None
-000090e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000090f0: 2020 2065 6e67 696e 653d 656e 6769 6e65     engine=engine
-00009100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009110: 2020 2a2a 6f70 656e 5f6b 7761 7267 732c    **open_kwargs,
-00009120: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00009130: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-00009140: 2069 6e20 6d6f 6d65 6e74 730a 2020 2020   in moments.    
-00009150: 2020 2020 5d0a 2020 2020 656c 7365 3a0a      ].    else:.
-00009160: 2020 2020 2020 2020 6669 6c65 6964 203d          fileid =
-00009170: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00009180: 7020 696e 206d 6f6d 656e 7473 3a0a 2020  p in moments:.  
-00009190: 2020 2020 2020 2020 2020 6966 206f 732e            if os.
-000091a0: 7061 7468 2e69 7366 696c 6528 702e 6669  path.isfile(p.fi
-000091b0: 6c65 6e61 6d65 293a 0a20 2020 2020 2020  lename):.       
-000091c0: 2020 2020 2020 2020 2070 203d 206f 7065           p = ope
-000091d0: 6e65 7228 702e 6669 6c65 6e61 6d65 2c20  ner(p.filename, 
-000091e0: 2272 222c 202a 2a6f 7065 6e65 725f 6b77  "r", **opener_kw
-000091f0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-00009200: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00009210: 2020 2020 2020 2020 7020 3d20 702e 6e63          p = p.nc
-00009220: 6669 6c65 0a20 2020 2020 2020 2020 2020  file.           
-00009230: 2066 696c 6569 642e 6170 7065 6e64 2870   fileid.append(p
-00009240: 290a 2020 2020 2020 2020 6461 7461 7365  ).        datase
-00009250: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
-00009260: 2020 206f 7065 6e5f 280a 2020 2020 2020     open_(.      
-00009270: 2020 2020 2020 2020 2020 7374 6f72 6528            store(
-00009280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009290: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
-000092a0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-000092b0: 703d 702e 6e63 7061 7468 2c0a 2020 2020  p=p.ncpath,.    
-000092c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092d0: 6c6f 636b 3d6c 6f63 6b2c 0a20 2020 2020  lock=lock,.     
-000092e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000092f0: 7574 6f63 6c6f 7365 3d4e 6f6e 652c 0a20  utoclose=None,. 
-00009300: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00009310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009320: 2020 656e 6769 6e65 3d65 6e67 696e 652c    engine=engine,
-00009330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009340: 202a 2a6f 7065 6e5f 6b77 6172 6773 2c0a   **open_kwargs,.
-00009350: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00009360: 2020 2020 2020 2020 2020 666f 7220 662c            for f,
-00009370: 2070 2069 6e20 7a69 7028 6669 6c65 6964   p in zip(fileid
-00009380: 2c20 6d6f 6d65 6e74 7329 0a20 2020 2020  , moments).     
-00009390: 2020 205d 0a0a 2020 2020 6669 6c65 5f6f     ]..    file_o
-000093a0: 626a 7320 3d20 5b67 6574 6174 7472 5f28  bjs = [getattr_(
-000093b0: 6473 2c20 225f 6669 6c65 5f6f 626a 2229  ds, "_file_obj")
-000093c0: 2066 6f72 2064 7320 696e 2064 6174 6173   for ds in datas
-000093d0: 6574 735d 0a0a 2020 2020 2320 6368 6563  ets]..    # chec
-000093e0: 6b20 666f 7220 6469 6666 6572 656e 6365  k for difference
-000093f0: 7320 696e 2073 6861 7065 206f 6620 6d6f  s in shape of mo
-00009400: 6d65 6e74 730a 2020 2020 6e6f 6e5f 756e  ments.    non_un
-00009410: 6966 6f72 6d5f 7368 6170 6520 3d20 6c65  iform_shape = le
-00009420: 6e28 7365 7428 5b74 7570 6c65 2864 732e  n(set([tuple(ds.
-00009430: 7369 7a65 732e 7661 6c75 6573 2829 2920  sizes.values()) 
-00009440: 666f 7220 6473 2069 6e20 6461 7461 7365  for ds in datase
-00009450: 7473 5d29 2920 3e20 310a 2020 2020 6966  ts])) > 1.    if
-00009460: 2070 7265 7072 6f63 6573 7320 6973 206e   preprocess is n
-00009470: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00009480: 2064 6174 6173 6574 7320 3d20 5b0a 2020   datasets = [.  
-00009490: 2020 2020 2020 2020 2020 7072 6570 726f            prepro
-000094a0: 6365 7373 2864 732c 206d 6f6d 2c20 6e6f  cess(ds, mom, no
-000094b0: 6e5f 756e 6966 6f72 6d5f 7368 6170 6529  n_uniform_shape)
-000094c0: 2066 6f72 2064 732c 206d 6f6d 2069 6e20   for ds, mom in 
-000094d0: 7a69 7028 6461 7461 7365 7473 2c20 6d6f  zip(datasets, mo
-000094e0: 6d65 6e74 7329 0a20 2020 2020 2020 205d  ments).        ]
-000094f0: 0a0a 2020 2020 6966 2070 6172 616c 6c65  ..    if paralle
-00009500: 6c3a 0a20 2020 2020 2020 2023 2063 616c  l:.        # cal
-00009510: 6c69 6e67 2063 6f6d 7075 7465 2068 6572  ling compute her
-00009520: 6520 7769 6c6c 2072 6574 7572 6e20 7468  e will return th
-00009530: 6520 6461 7461 7365 7473 2f66 696c 655f  e datasets/file_
-00009540: 6f62 6a73 206c 6973 7473 2c0a 2020 2020  objs lists,.    
-00009550: 2020 2020 2320 7468 6520 756e 6465 726c      # the underl
-00009560: 7969 6e67 2064 6174 6173 6574 7320 7769  ying datasets wi
-00009570: 6c6c 2073 7469 6c6c 2062 6520 7374 6f72  ll still be stor
-00009580: 6564 2061 7320 6461 736b 2061 7272 6179  ed as dask array
-00009590: 730a 2020 2020 2020 2020 6461 7461 7365  s.        datase
-000095a0: 7473 2c20 6669 6c65 5f6f 626a 7320 3d20  ts, file_objs = 
-000095b0: 6461 736b 2e63 6f6d 7075 7465 2864 6174  dask.compute(dat
-000095c0: 6173 6574 732c 2066 696c 655f 6f62 6a73  asets, file_objs
-000095d0: 290a 0a20 2020 2023 2043 6f6d 6269 6e65  )..    # Combine
-000095e0: 2061 6c6c 2064 6174 6173 6574 732c 2063   all datasets, c
-000095f0: 6c6f 7369 6e67 2074 6865 6d20 696e 2063  losing them in c
-00009600: 6173 6520 6f66 2061 2056 616c 7565 4572  ase of a ValueEr
-00009610: 726f 720a 2020 2020 7472 793a 0a20 2020  ror.    try:.   
-00009620: 2020 2020 2063 6f6d 6269 6e65 6420 3d20       combined = 
-00009630: 636f 6d62 696e 655f 6279 5f63 6f6f 7264  combine_by_coord
-00009640: 7328 0a20 2020 2020 2020 2020 2020 2064  s(.            d
-00009650: 6174 6173 6574 732c 2063 6f6d 7061 743d  atasets, compat=
-00009660: 226e 6f5f 636f 6e66 6c69 6374 7322 2c20  "no_conflicts", 
-00009670: 6461 7461 5f76 6172 733d 2261 6c6c 222c  data_vars="all",
-00009680: 2063 6f6f 7264 733d 226d 696e 696d 616c   coords="minimal
-00009690: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-000096a0: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
-000096b0: 723a 0a20 2020 2020 2020 2066 6f72 2064  r:.        for d
-000096c0: 7320 696e 2064 6174 6173 6574 733a 0a20  s in datasets:. 
-000096d0: 2020 2020 2020 2020 2020 2064 732e 636c             ds.cl
-000096e0: 6f73 6528 290a 2020 2020 2020 2020 7261  ose().        ra
-000096f0: 6973 650a 0a20 2020 2063 6f6d 6269 6e65  ise..    combine
-00009700: 642e 5f66 696c 655f 6f62 6a20 3d20 5f4d  d._file_obj = _M
-00009710: 756c 7469 4669 6c65 436c 6f73 6572 2866  ultiFileCloser(f
-00009720: 696c 655f 6f62 6a73 290a 2020 2020 636f  ile_objs).    co
-00009730: 6d62 696e 6564 2e61 7474 7273 203d 2064  mbined.attrs = d
-00009740: 6174 6173 6574 735b 305d 2e61 7474 7273  atasets[0].attrs
-00009750: 0a20 2020 2072 6574 7572 6e20 636f 6d62  .    return comb
-00009760: 696e 6564 0a0a 0a63 6c61 7373 2058 5261  ined...class XRa
-00009770: 6442 6173 6528 636f 6c6c 6563 7469 6f6e  dBase(collection
-00009780: 732e 6162 632e 4d75 7461 626c 6553 6571  s.abc.MutableSeq
-00009790: 7565 6e63 6529 3a0a 2020 2020 2222 2242  uence):.    """B
-000097a0: 6173 6520 436c 6173 7320 666f 7220 616c  ase Class for al
-000097b0: 6c20 5852 6164 2d63 6c61 7373 6573 2e22  l XRad-classes."
-000097c0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-000097d0: 6974 5f5f 2873 656c 662c 202a 2a6b 7761  it__(self, **kwa
-000097e0: 7267 7329 3a0a 2020 2020 2020 2020 7375  rgs):.        su
-000097f0: 7065 7228 5852 6164 4261 7365 2c20 7365  per(XRadBase, se
-00009800: 6c66 292e 5f5f 696e 6974 5f5f 2829 0a20  lf).__init__(). 
-00009810: 2020 2020 2020 2073 656c 662e 5f73 6571         self._seq
-00009820: 203d 205b 5d0a 0a20 2020 2064 6566 205f   = []..    def _
-00009830: 5f67 6574 6974 656d 5f5f 2873 656c 662c  _getitem__(self,
-00009840: 2069 6e64 6578 293a 0a20 2020 2020 2020   index):.       
-00009850: 2072 6574 7572 6e20 7365 6c66 2e5f 7365   return self._se
-00009860: 715b 696e 6465 785d 0a0a 2020 2020 6465  q[index]..    de
-00009870: 6620 5f5f 7365 7469 7465 6d5f 5f28 7365  f __setitem__(se
-00009880: 6c66 2c20 696e 6465 782c 2076 616c 7565  lf, index, value
-00009890: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000098a0: 5f73 6571 5b69 6e64 6578 5d20 3d20 7661  _seq[index] = va
-000098b0: 6c75 650a 0a20 2020 2064 6566 205f 5f64  lue..    def __d
-000098c0: 656c 6974 656d 5f5f 2873 656c 662c 2069  elitem__(self, i
-000098d0: 6e64 6578 293a 0a20 2020 2020 2020 2064  ndex):.        d
-000098e0: 656c 2073 656c 662e 5f73 6571 5b69 6e64  el self._seq[ind
-000098f0: 6578 5d0a 0a20 2020 2064 6566 2069 6e73  ex]..    def ins
-00009900: 6572 7428 7365 6c66 2c20 706f 732c 2076  ert(self, pos, v
-00009910: 616c 293a 0a20 2020 2020 2020 2073 656c  al):.        sel
-00009920: 662e 5f73 6571 2e69 6e73 6572 7428 706f  f._seq.insert(po
-00009930: 732c 2076 616c 290a 0a20 2020 2064 6566  s, val)..    def
-00009940: 205f 5f69 7465 725f 5f28 7365 6c66 293a   __iter__(self):
-00009950: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009960: 6974 6572 2873 656c 662e 5f73 6571 290a  iter(self._seq).
-00009970: 0a20 2020 2064 6566 205f 5f6c 656e 5f5f  .    def __len__
-00009980: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00009990: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
-000099a0: 5f73 6571 290a 0a20 2020 2064 6566 205f  _seq)..    def _
-000099b0: 5f72 6570 725f 5f28 7365 6c66 293a 0a20  _repr__(self):. 
-000099c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000099d0: 6c66 2e5f 7365 712e 5f5f 7265 7072 5f5f  lf._seq.__repr__
-000099e0: 2829 0a0a 2020 2020 6465 6620 5f5f 6465  ()..    def __de
-000099f0: 6c5f 5f28 7365 6c66 293a 0a20 2020 2020  l__(self):.     
-00009a00: 2020 2069 6620 7365 6c66 2e5f 7365 713a     if self._seq:
-00009a10: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00009a20: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-00009a30: 7365 6c66 2e5f 7365 7129 293a 0a20 2020  self._seq)):.   
-00009a40: 2020 2020 2020 2020 2020 2020 2064 656c               del
-00009a50: 2073 656c 662e 5f73 6571 5b30 5d0a 2020   self._seq[0].  
-00009a60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00009a70: 7365 7120 3d20 4e6f 6e65 0a0a 2020 2020  seq = None..    
-00009a80: 6465 6620 736f 7274 2873 656c 662c 202a  def sort(self, *
-00009a90: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00009aa0: 2020 7365 6c66 2e5f 7365 712e 736f 7274    self._seq.sort
-00009ab0: 282a 2a6b 7761 7267 7329 0a0a 0a63 6c61  (**kwargs)...cla
-00009ac0: 7373 204f 6469 6d48 3547 726f 7570 4174  ss OdimH5GroupAt
-00009ad0: 7472 6962 7574 654d 6978 696e 3a0a 2020  tributeMixin:.  
-00009ae0: 2020 2222 224d 6978 696e 2043 6c61 7373    """Mixin Class
-00009af0: 2066 6f72 204f 6469 6d20 4772 6f75 7020   for Odim Group 
-00009b00: 4174 7472 6962 7574 6520 5265 7472 6965  Attribute Retrie
-00009b10: 7661 6c22 2222 0a0a 2020 2020 5f5f 736c  val"""..    __sl
-00009b20: 6f74 735f 5f20 3d20 5b22 5f61 7474 7273  ots__ = ["_attrs
-00009b30: 222c 2022 5f6e 6366 696c 6522 2c20 225f  ", "_ncfile", "_
-00009b40: 6e63 7061 7468 222c 2022 5f70 6172 656e  ncpath", "_paren
-00009b50: 7422 2c20 225f 686f 7722 2c20 225f 7768  t", "_how", "_wh
-00009b60: 6174 222c 2022 5f77 6865 7265 225d 0a0a  at", "_where"]..
-00009b70: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00009b80: 2873 656c 662c 206e 6366 696c 653d 4e6f  (self, ncfile=No
-00009b90: 6e65 2c20 6e63 7061 7468 3d4e 6f6e 652c  ne, ncpath=None,
-00009ba0: 2070 6172 656e 743d 4e6f 6e65 293a 0a20   parent=None):. 
-00009bb0: 2020 2020 2020 2073 7570 6572 284f 6469         super(Odi
-00009bc0: 6d48 3547 726f 7570 4174 7472 6962 7574  mH5GroupAttribut
-00009bd0: 654d 6978 696e 2c20 7365 6c66 292e 5f5f  eMixin, self).__
-00009be0: 696e 6974 5f5f 2829 0a20 2020 2020 2020  init__().       
-00009bf0: 2073 656c 662e 5f6e 6366 696c 6520 3d20   self._ncfile = 
-00009c00: 6e63 6669 6c65 0a20 2020 2020 2020 2073  ncfile.        s
-00009c10: 656c 662e 5f6e 6370 6174 6820 3d20 6e63  elf._ncpath = nc
-00009c20: 7061 7468 0a20 2020 2020 2020 2073 656c  path.        sel
-00009c30: 662e 5f70 6172 656e 7420 3d20 7061 7265  f._parent = pare
-00009c40: 6e74 0a20 2020 2020 2020 2073 656c 662e  nt.        self.
-00009c50: 5f61 7474 7273 203d 204e 6f6e 650a 2020  _attrs = None.  
-00009c60: 2020 2020 2020 7365 6c66 2e5f 686f 7720        self._how 
-00009c70: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00009c80: 656c 662e 5f77 6861 7420 3d20 4e6f 6e65  elf._what = None
-00009c90: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
-00009ca0: 6865 7265 203d 204e 6f6e 650a 0a20 2020  here = None..   
-00009cb0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00009cc0: 6566 206e 6370 6174 6828 7365 6c66 293a  ef ncpath(self):
-00009cd0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00009ce0: 726e 7320 7061 7468 2073 7472 696e 6720  rns path string 
-00009cf0: 696e 7369 6465 2048 4446 3520 4669 6c65  inside HDF5 File
-00009d00: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-00009d10: 7572 6e20 7365 6c66 2e5f 6e63 7061 7468  urn self._ncpath
-00009d20: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00009d30: 2020 2020 6465 6620 6e63 6964 2873 656c      def ncid(sel
-00009d40: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00009d50: 6574 7572 6e73 2068 616e 646c 6520 666f  eturns handle fo
-00009d60: 7220 6375 7272 656e 7420 7061 7468 2e22  r current path."
-00009d70: 2222 0a20 2020 2020 2020 2023 2072 6f6f  "".        # roo
-00009d80: 742d 6772 6f75 7020 6361 6e27 7420 6265  t-group can't be
-00009d90: 2073 7562 7365 7420 7769 7468 206e 6574   subset with net
-00009da0: 6364 6634 2061 6e64 2068 356e 6574 6364  cdf4 and h5netcd
-00009db0: 660a 2020 2020 2020 2020 6966 2073 656c  f.        if sel
-00009dc0: 662e 5f6e 6370 6174 6820 3d3d 2022 2f22  f._ncpath == "/"
-00009dd0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00009de0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00009df0: 2e6e 6366 696c 652c 2028 6e63 2e44 6174  .ncfile, (nc.Dat
-00009e00: 6173 6574 2c20 6835 6e65 7463 6466 2e46  aset, h5netcdf.F
-00009e10: 696c 6529 293a 0a20 2020 2020 2020 2020  ile)):.         
-00009e20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00009e30: 6c66 2e5f 6e63 6669 6c65 0a20 2020 2020  lf._ncfile.     
-00009e40: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00009e50: 6e63 6669 6c65 5b73 656c 662e 6e63 7061  ncfile[self.ncpa
-00009e60: 7468 5d0a 0a20 2020 2040 7072 6f70 6572  th]..    @proper
-00009e70: 7479 0a20 2020 2064 6566 206e 6366 696c  ty.    def ncfil
-00009e80: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00009e90: 2022 2222 5265 7475 726e 7320 6669 6c65   """Returns file
-00009ea0: 2068 616e 646c 652e 2222 220a 2020 2020   handle.""".    
-00009eb0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00009ec0: 5f6e 6366 696c 650a 0a20 2020 2040 7072  _ncfile..    @pr
-00009ed0: 6f70 6572 7479 0a20 2020 2064 6566 2068  operty.    def h
-00009ee0: 6f77 2873 656c 6629 3a0a 2020 2020 2020  ow(self):.      
-00009ef0: 2020 2222 2252 6574 7572 6e20 6174 7472    """Return attr
-00009f00: 6962 7574 6573 206f 6620 6068 6f77 602d  ibutes of `how`-
-00009f10: 6772 6f75 702e 2222 220a 2020 2020 2020  group.""".      
-00009f20: 2020 6966 2073 656c 662e 5f68 6f77 2069    if self._how i
-00009f30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00009f40: 2020 2020 7365 6c66 2e5f 686f 7720 3d20      self._how = 
-00009f50: 7365 6c66 2e5f 6765 745f 6174 7472 6962  self._get_attrib
-00009f60: 7574 6573 2822 686f 7722 290a 2020 2020  utes("how").    
-00009f70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00009f80: 5f68 6f77 0a0a 2020 2020 4070 726f 7065  _how..    @prope
-00009f90: 7274 790a 2020 2020 6465 6620 7768 6174  rty.    def what
-00009fa0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00009fb0: 2222 2252 6574 7572 6e20 6174 7472 6962  """Return attrib
-00009fc0: 7574 6573 206f 6620 6077 6861 7460 2d67  utes of `what`-g
-00009fd0: 726f 7570 2e22 2222 0a20 2020 2020 2020  roup.""".       
-00009fe0: 2069 6620 7365 6c66 2e5f 7768 6174 2069   if self._what i
-00009ff0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000a000: 2020 2020 7365 6c66 2e5f 7768 6174 203d      self._what =
-0000a010: 2073 656c 662e 5f67 6574 5f61 7474 7269   self._get_attri
-0000a020: 6275 7465 7328 2277 6861 7422 290a 2020  butes("what").  
-0000a030: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a040: 662e 5f77 6861 740a 0a20 2020 2040 7072  f._what..    @pr
-0000a050: 6f70 6572 7479 0a20 2020 2064 6566 2077  operty.    def w
-0000a060: 6865 7265 2873 656c 6629 3a0a 2020 2020  here(self):.    
-0000a070: 2020 2020 2222 2252 6574 7572 6e20 6174      """Return at
-0000a080: 7472 6962 7574 6573 206f 6620 6077 6865  tributes of `whe
-0000a090: 7265 602d 6772 6f75 702e 2222 220a 2020  re`-group.""".  
-0000a0a0: 2020 2020 2020 6966 2073 656c 662e 5f77        if self._w
-0000a0b0: 6865 7265 2069 7320 4e6f 6e65 3a0a 2020  here is None:.  
+00000bb0: 2063 6f6d 6269 6e65 5f62 795f 636f 6f72   combine_by_coor
+00000bc0: 6473 0a0a 6672 6f6d 2077 7261 646c 6962  ds..from wradlib
+00000bd0: 2069 6d70 6f72 7420 7665 7273 696f 6e0a   import version.
+00000be0: 6672 6f6d 2077 7261 646c 6962 2e67 656f  from wradlib.geo
+00000bf0: 7265 6620 696d 706f 7274 2078 6172 7261  ref import xarra
+00000c00: 790a 0a74 7279 3a0a 2020 2020 6672 6f6d  y..try:.    from
+00000c10: 2074 7164 6d20 696d 706f 7274 2074 7164   tqdm import tqd
+00000c20: 6d0a 6578 6365 7074 2049 6d70 6f72 7445  m.except ImportE
+00000c30: 7272 6f72 3a0a 0a20 2020 2064 6566 2074  rror:..    def t
+00000c40: 7164 6d28 7661 6c2c 202a 2a6b 7761 7267  qdm(val, **kwarg
+00000c50: 7329 3a0a 2020 2020 2020 2020 7072 696e  s):.        prin
+00000c60: 7428 0a20 2020 2020 2020 2020 2020 2022  t(.            "
+00000c70: 7772 6164 6c69 623a 2050 6c65 6173 6520  wradlib: Please 
+00000c80: 7761 6974 2066 6f72 2063 6f6d 706c 6574  wait for complet
+00000c90: 696f 6e20 6f66 2074 696d 6520 636f 6e73  ion of time cons
+00000ca0: 756d 696e 6720 7461 736b 2120 5c6e 220a  uming task! \n".
+00000cb0: 2020 2020 2020 2020 2020 2020 2277 7261              "wra
+00000cc0: 646c 6962 3a20 506c 6561 7365 2069 6e73  dlib: Please ins
+00000cd0: 7461 6c6c 2027 7471 646d 2720 666f 7220  tall 'tqdm' for 
+00000ce0: 7368 6f77 696e 6720 6120 7072 6f67 7265  showing a progre
+00000cf0: 7373 2062 6172 2022 0a20 2020 2020 2020  ss bar ".       
+00000d00: 2020 2020 2022 696e 7374 6561 642e 220a       "instead.".
+00000d10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00000d20: 2020 7265 7475 726e 2076 616c 0a0a 0a40    return val...@
+00000d30: 6465 7072 6563 6174 696f 6e2e 6465 7072  deprecation.depr
+00000d40: 6563 6174 6564 280a 2020 2020 6465 7072  ecated(.    depr
+00000d50: 6563 6174 6564 5f69 6e3d 2231 2e35 222c  ecated_in="1.5",
+00000d60: 0a20 2020 2072 656d 6f76 6564 5f69 6e3d  .    removed_in=
+00000d70: 2232 2e30 222c 0a20 2020 2063 7572 7265  "2.0",.    curre
+00000d80: 6e74 5f76 6572 7369 6f6e 3d76 6572 7369  nt_version=versi
+00000d90: 6f6e 2e76 6572 7369 6f6e 2c0a 2020 2020  on.version,.    
+00000da0: 6465 7461 696c 733d 2255 7365 2060 7772  details="Use `wr
+00000db0: 6164 6c69 622e 6765 6f72 6566 2e63 7265  adlib.georef.cre
+00000dc0: 6174 655f 7861 7272 6179 5f64 6174 6161  ate_xarray_dataa
+00000dd0: 7272 6179 6020 2220 2269 6e73 7465 6164  rray` " "instead
+00000de0: 2e22 2c0a 290a 6465 6620 6372 6561 7465  .",.).def create
+00000df0: 5f78 6172 7261 795f 6461 7461 6172 7261  _xarray_dataarra
+00000e00: 7928 2a61 7267 732c 202a 2a6b 7761 7267  y(*args, **kwarg
+00000e10: 7329 3a0a 2020 2020 7265 7475 726e 2078  s):.    return x
+00000e20: 6172 7261 792e 6372 6561 7465 5f78 6172  array.create_xar
+00000e30: 7261 795f 6461 7461 6172 7261 7928 2a61  ray_dataarray(*a
+00000e40: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
+00000e50: 0a6d 6f6d 656e 745f 6174 7472 7320 3d20  .moment_attrs = 
+00000e60: 7b22 7374 616e 6461 7264 5f6e 616d 6522  {"standard_name"
+00000e70: 2c20 226c 6f6e 675f 6e61 6d65 222c 2022  , "long_name", "
+00000e80: 756e 6974 7322 7d0a 0a23 2043 6652 6164  units"}..# CfRad
+00000e90: 6961 6c20 322e 3020 2d20 4f44 494d 5f48  ial 2.0 - ODIM_H
+00000ea0: 3520 6d61 7070 696e 670a 6d6f 6d65 6e74  5 mapping.moment
+00000eb0: 735f 6d61 7070 696e 6720 3d20 7b0a 2020  s_mapping = {.  
+00000ec0: 2020 2244 425a 4822 3a20 7b0a 2020 2020    "DBZH": {.    
+00000ed0: 2020 2020 2273 7461 6e64 6172 645f 6e61      "standard_na
+00000ee0: 6d65 223a 2022 7261 6461 725f 6571 7569  me": "radar_equi
+00000ef0: 7661 6c65 6e74 5f72 6566 6c65 6374 6976  valent_reflectiv
+00000f00: 6974 795f 6661 6374 6f72 5f68 222c 0a20  ity_factor_h",. 
+00000f10: 2020 2020 2020 2022 6c6f 6e67 5f6e 616d         "long_nam
+00000f20: 6522 3a20 2245 7175 6976 616c 656e 7420  e": "Equivalent 
+00000f30: 7265 666c 6563 7469 7669 7479 2066 6163  reflectivity fac
+00000f40: 746f 7220 4822 2c0a 2020 2020 2020 2020  tor H",.        
+00000f50: 2273 686f 7274 5f6e 616d 6522 3a20 2244  "short_name": "D
+00000f60: 425a 4822 2c0a 2020 2020 2020 2020 2275  BZH",.        "u
+00000f70: 6e69 7473 223a 2022 6442 5a22 2c0a 2020  nits": "dBZ",.  
+00000f80: 2020 2020 2020 2267 616d 6963 223a 205b        "gamic": [
+00000f90: 227a 6822 5d2c 0a20 2020 207d 2c0a 2020  "zh"],.    },.  
+00000fa0: 2020 2244 425a 485f 434c 4541 4e22 3a20    "DBZH_CLEAN": 
+00000fb0: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
+00000fc0: 6172 645f 6e61 6d65 223a 2022 7261 6461  ard_name": "rada
+00000fd0: 725f 6571 7569 7661 6c65 6e74 5f72 6566  r_equivalent_ref
+00000fe0: 6c65 6374 6976 6974 795f 6661 6374 6f72  lectivity_factor
+00000ff0: 5f68 222c 0a20 2020 2020 2020 2022 6c6f  _h",.        "lo
+00001000: 6e67 5f6e 616d 6522 3a20 2245 7175 6976  ng_name": "Equiv
+00001010: 616c 656e 7420 7265 666c 6563 7469 7669  alent reflectivi
+00001020: 7479 2066 6163 746f 7220 4822 2c0a 2020  ty factor H",.  
+00001030: 2020 2020 2020 2273 686f 7274 5f6e 616d        "short_nam
+00001040: 6522 3a20 2244 425a 485f 434c 4541 4e22  e": "DBZH_CLEAN"
+00001050: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
+00001060: 223a 2022 6442 5a22 2c0a 2020 2020 2020  ": "dBZ",.      
+00001070: 2020 2267 616d 6963 223a 204e 6f6e 652c    "gamic": None,
+00001080: 0a20 2020 207d 2c0a 2020 2020 2244 425a  .    },.    "DBZ
+00001090: 5622 3a20 7b0a 2020 2020 2020 2020 2273  V": {.        "s
+000010a0: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
+000010b0: 7261 6461 725f 6571 7569 7661 6c65 6e74  radar_equivalent
+000010c0: 5f72 6566 6c65 6374 6976 6974 795f 6661  _reflectivity_fa
+000010d0: 6374 6f72 5f76 222c 0a20 2020 2020 2020  ctor_v",.       
+000010e0: 2022 6c6f 6e67 5f6e 616d 6522 3a20 2245   "long_name": "E
+000010f0: 7175 6976 616c 656e 7420 7265 666c 6563  quivalent reflec
+00001100: 7469 7669 7479 2066 6163 746f 7220 5622  tivity factor V"
+00001110: 2c0a 2020 2020 2020 2020 2273 686f 7274  ,.        "short
+00001120: 5f6e 616d 6522 3a20 2244 425a 5622 2c0a  _name": "DBZV",.
+00001130: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+00001140: 2022 6442 5a22 2c0a 2020 2020 2020 2020   "dBZ",.        
+00001150: 2267 616d 6963 223a 205b 227a 7622 5d2c  "gamic": ["zv"],
+00001160: 0a20 2020 207d 2c0a 2020 2020 225a 4822  .    },.    "ZH"
+00001170: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
+00001180: 6e64 6172 645f 6e61 6d65 223a 2022 7261  ndard_name": "ra
+00001190: 6461 725f 6c69 6e65 6172 5f65 7175 6976  dar_linear_equiv
+000011a0: 616c 656e 745f 7265 666c 6563 7469 7669  alent_reflectivi
+000011b0: 7479 5f66 6163 746f 725f 6822 2c0a 2020  ty_factor_h",.  
+000011c0: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
+000011d0: 223a 2022 4c69 6e65 6172 2065 7175 6976  ": "Linear equiv
+000011e0: 616c 656e 7420 7265 666c 6563 7469 7669  alent reflectivi
+000011f0: 7479 2066 6163 746f 7220 4822 2c0a 2020  ty factor H",.  
+00001200: 2020 2020 2020 2273 686f 7274 5f6e 616d        "short_nam
+00001210: 6522 3a20 225a 4822 2c0a 2020 2020 2020  e": "ZH",.      
+00001220: 2020 2275 6e69 7473 223a 2022 756e 6974    "units": "unit
+00001230: 6c65 7373 222c 0a20 2020 2020 2020 2022  less",.        "
+00001240: 6761 6d69 6322 3a20 4e6f 6e65 2c0a 2020  gamic": None,.  
+00001250: 2020 7d2c 0a20 2020 2022 5a56 223a 207b    },.    "ZV": {
+00001260: 0a20 2020 2020 2020 2022 7374 616e 6461  .        "standa
+00001270: 7264 5f6e 616d 6522 3a20 2272 6164 6172  rd_name": "radar
+00001280: 5f65 7175 6976 616c 656e 745f 7265 666c  _equivalent_refl
+00001290: 6563 7469 7669 7479 5f66 6163 746f 725f  ectivity_factor_
+000012a0: 7622 2c0a 2020 2020 2020 2020 226c 6f6e  v",.        "lon
+000012b0: 675f 6e61 6d65 223a 2022 4c69 6e65 6172  g_name": "Linear
+000012c0: 2065 7175 6976 616c 656e 7420 7265 666c   equivalent refl
+000012d0: 6563 7469 7669 7479 2066 6163 746f 7220  ectivity factor 
+000012e0: 5622 2c0a 2020 2020 2020 2020 2273 686f  V",.        "sho
+000012f0: 7274 5f6e 616d 6522 3a20 225a 5622 2c0a  rt_name": "ZV",.
+00001300: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+00001310: 2022 756e 6974 6c65 7373 222c 0a20 2020   "unitless",.   
+00001320: 2020 2020 2022 6761 6d69 6322 3a20 4e6f       "gamic": No
+00001330: 6e65 2c0a 2020 2020 7d2c 0a20 2020 2022  ne,.    },.    "
+00001340: 4442 5a22 3a20 7b0a 2020 2020 2020 2020  DBZ": {.        
+00001350: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
+00001360: 2022 7261 6461 725f 6571 7569 7661 6c65   "radar_equivale
+00001370: 6e74 5f72 6566 6c65 6374 6976 6974 795f  nt_reflectivity_
+00001380: 6661 6374 6f72 222c 0a20 2020 2020 2020  factor",.       
+00001390: 2022 6c6f 6e67 5f6e 616d 6522 3a20 2245   "long_name": "E
+000013a0: 7175 6976 616c 656e 7420 7265 666c 6563  quivalent reflec
+000013b0: 7469 7669 7479 2066 6163 746f 7222 2c0a  tivity factor",.
+000013c0: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
+000013d0: 616d 6522 3a20 2244 425a 222c 0a20 2020  ame": "DBZ",.   
+000013e0: 2020 2020 2022 756e 6974 7322 3a20 2264       "units": "d
+000013f0: 425a 222c 0a20 2020 2020 2020 2022 6761  BZ",.        "ga
+00001400: 6d69 6322 3a20 4e6f 6e65 2c0a 2020 2020  mic": None,.    
+00001410: 7d2c 0a20 2020 2022 4442 5448 223a 207b  },.    "DBTH": {
+00001420: 0a20 2020 2020 2020 2022 7374 616e 6461  .        "standa
+00001430: 7264 5f6e 616d 6522 3a20 2272 6164 6172  rd_name": "radar
+00001440: 5f65 7175 6976 616c 656e 745f 7265 666c  _equivalent_refl
+00001450: 6563 7469 7669 7479 5f66 6163 746f 725f  ectivity_factor_
+00001460: 6822 2c0a 2020 2020 2020 2020 226c 6f6e  h",.        "lon
+00001470: 675f 6e61 6d65 223a 2022 546f 7461 6c20  g_name": "Total 
+00001480: 706f 7765 7220 4820 2875 6e63 6f72 7265  power H (uncorre
+00001490: 6374 6564 2072 6566 6c65 6374 6976 6974  cted reflectivit
+000014a0: 7929 222c 0a20 2020 2020 2020 2022 7368  y)",.        "sh
+000014b0: 6f72 745f 6e61 6d65 223a 2022 4442 5448  ort_name": "DBTH
+000014c0: 222c 0a20 2020 2020 2020 2022 756e 6974  ",.        "unit
+000014d0: 7322 3a20 2264 425a 222c 0a20 2020 2020  s": "dBZ",.     
+000014e0: 2020 2022 6761 6d69 6322 3a20 5b22 757a     "gamic": ["uz
+000014f0: 6822 2c20 2275 6822 5d2c 0a20 2020 207d  h", "uh"],.    }
+00001500: 2c0a 2020 2020 2244 4254 5622 3a20 7b0a  ,.    "DBTV": {.
+00001510: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
+00001520: 645f 6e61 6d65 223a 2022 7261 6461 725f  d_name": "radar_
+00001530: 6571 7569 7661 6c65 6e74 5f72 6566 6c65  equivalent_refle
+00001540: 6374 6976 6974 795f 6661 6374 6f72 5f76  ctivity_factor_v
+00001550: 222c 0a20 2020 2020 2020 2022 6c6f 6e67  ",.        "long
+00001560: 5f6e 616d 6522 3a20 2254 6f74 616c 2070  _name": "Total p
+00001570: 6f77 6572 2056 2028 756e 636f 7272 6563  ower V (uncorrec
+00001580: 7465 6420 7265 666c 6563 7469 7669 7479  ted reflectivity
+00001590: 2922 2c0a 2020 2020 2020 2020 2273 686f  )",.        "sho
+000015a0: 7274 5f6e 616d 6522 3a20 2244 4254 5622  rt_name": "DBTV"
+000015b0: 2c0a 2020 2020 2020 2020 2275 6e69 7473  ,.        "units
+000015c0: 223a 2022 6442 5a22 2c0a 2020 2020 2020  ": "dBZ",.      
+000015d0: 2020 2267 616d 6963 223a 205b 2275 7a76    "gamic": ["uzv
+000015e0: 222c 2022 7576 225d 2c0a 2020 2020 7d2c  ", "uv"],.    },
+000015f0: 0a20 2020 2022 5448 223a 207b 0a20 2020  .    "TH": {.   
+00001600: 2020 2020 2022 7374 616e 6461 7264 5f6e       "standard_n
+00001610: 616d 6522 3a20 2272 6164 6172 5f6c 696e  ame": "radar_lin
+00001620: 6561 725f 6571 7569 7661 6c65 6e74 5f72  ear_equivalent_r
+00001630: 6566 6c65 6374 6976 6974 795f 6661 6374  eflectivity_fact
+00001640: 6f72 5f68 222c 0a20 2020 2020 2020 2022  or_h",.        "
+00001650: 6c6f 6e67 5f6e 616d 6522 3a20 224c 696e  long_name": "Lin
+00001660: 6561 7220 746f 7461 6c20 706f 7765 7220  ear total power 
+00001670: 4820 2875 6e63 6f72 7265 6374 6564 2072  H (uncorrected r
+00001680: 6566 6c65 6374 6976 6974 7929 222c 0a20  eflectivity)",. 
+00001690: 2020 2020 2020 2022 7368 6f72 745f 6e61         "short_na
+000016a0: 6d65 223a 2022 5448 222c 0a20 2020 2020  me": "TH",.     
+000016b0: 2020 2022 756e 6974 7322 3a20 2275 6e69     "units": "uni
+000016c0: 746c 6573 7322 2c0a 2020 2020 2020 2020  tless",.        
+000016d0: 2267 616d 6963 223a 204e 6f6e 652c 0a20  "gamic": None,. 
+000016e0: 2020 207d 2c0a 2020 2020 2254 5622 3a20     },.    "TV": 
+000016f0: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
+00001700: 6172 645f 6e61 6d65 223a 2022 7261 6461  ard_name": "rada
+00001710: 725f 6c69 6e65 6172 5f65 7175 6976 616c  r_linear_equival
+00001720: 656e 745f 7265 666c 6563 7469 7669 7479  ent_reflectivity
+00001730: 5f66 6163 746f 725f 7622 2c0a 2020 2020  _factor_v",.    
+00001740: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
+00001750: 2022 4c69 6e65 6172 2074 6f74 616c 2070   "Linear total p
+00001760: 6f77 6572 2056 2028 756e 636f 7272 6563  ower V (uncorrec
+00001770: 7465 6420 7265 666c 6563 7469 7669 7479  ted reflectivity
+00001780: 2922 2c0a 2020 2020 2020 2020 2273 686f  )",.        "sho
+00001790: 7274 5f6e 616d 6522 3a20 2254 5622 2c0a  rt_name": "TV",.
+000017a0: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+000017b0: 2022 756e 6974 6c65 7373 222c 0a20 2020   "unitless",.   
+000017c0: 2020 2020 2022 6761 6d69 6322 3a20 4e6f       "gamic": No
+000017d0: 6e65 2c0a 2020 2020 7d2c 0a20 2020 2022  ne,.    },.    "
+000017e0: 5652 4144 4822 3a20 7b0a 2020 2020 2020  VRADH": {.      
+000017f0: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
+00001800: 223a 2022 7261 6469 616c 5f76 656c 6f63  ": "radial_veloc
+00001810: 6974 795f 6f66 5f73 6361 7474 6572 6572  ity_of_scatterer
+00001820: 735f 6177 6179 5f22 2022 6672 6f6d 5f69  s_away_" "from_i
+00001830: 6e73 7472 756d 656e 745f 6822 2c0a 2020  nstrument_h",.  
+00001840: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
+00001850: 223a 2022 5261 6469 616c 2076 656c 6f63  ": "Radial veloc
+00001860: 6974 7920 6f66 2073 6361 7474 6572 6572  ity of scatterer
+00001870: 7320 6177 6179 2066 726f 6d20 696e 7374  s away from inst
+00001880: 7275 6d65 6e74 2048 222c 0a20 2020 2020  rument H",.     
+00001890: 2020 2022 7368 6f72 745f 6e61 6d65 223a     "short_name":
+000018a0: 2022 5652 4144 4822 2c0a 2020 2020 2020   "VRADH",.      
+000018b0: 2020 2275 6e69 7473 223a 2022 6d65 7465    "units": "mete
+000018c0: 7273 2070 6572 2073 6563 6f6e 6473 222c  rs per seconds",
+000018d0: 0a20 2020 2020 2020 2022 6761 6d69 6322  .        "gamic"
+000018e0: 3a20 5b22 7668 225d 2c0a 2020 2020 7d2c  : ["vh"],.    },
+000018f0: 0a20 2020 2022 5652 4144 5622 3a20 7b0a  .    "VRADV": {.
+00001900: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
+00001910: 645f 6e61 6d65 223a 2022 7261 6469 616c  d_name": "radial
+00001920: 5f76 656c 6f63 6974 795f 6f66 5f73 6361  _velocity_of_sca
+00001930: 7474 6572 6572 735f 2220 2261 7761 795f  tterers_" "away_
+00001940: 6672 6f6d 5f69 6e73 7472 756d 656e 745f  from_instrument_
+00001950: 7622 2c0a 2020 2020 2020 2020 226c 6f6e  v",.        "lon
+00001960: 675f 6e61 6d65 223a 2022 5261 6469 616c  g_name": "Radial
+00001970: 2076 656c 6f63 6974 7920 6f66 2073 6361   velocity of sca
+00001980: 7474 6572 6572 7320 6177 6179 2066 726f  tterers away fro
+00001990: 6d20 696e 7374 7275 6d65 6e74 2056 222c  m instrument V",
+000019a0: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
+000019b0: 6e61 6d65 223a 2022 5652 4144 5622 2c0a  name": "VRADV",.
+000019c0: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+000019d0: 2022 6d65 7465 7273 2070 6572 2073 6563   "meters per sec
+000019e0: 6f6e 6422 2c0a 2020 2020 2020 2020 2267  ond",.        "g
+000019f0: 616d 6963 223a 205b 2276 7622 5d2c 0a20  amic": ["vv"],. 
+00001a00: 2020 207d 2c0a 2020 2020 2256 5222 3a20     },.    "VR": 
+00001a10: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
+00001a20: 6172 645f 6e61 6d65 223a 2022 7261 6469  ard_name": "radi
+00001a30: 616c 5f76 656c 6f63 6974 795f 6f66 5f73  al_velocity_of_s
+00001a40: 6361 7474 6572 6572 735f 6177 6179 5f22  catterers_away_"
+00001a50: 2022 6672 6f6d 5f69 6e73 7472 756d 656e   "from_instrumen
+00001a60: 7422 2c0a 2020 2020 2020 2020 226c 6f6e  t",.        "lon
+00001a70: 675f 6e61 6d65 223a 2022 5261 6469 616c  g_name": "Radial
+00001a80: 2076 656c 6f63 6974 7920 6f66 2073 6361   velocity of sca
+00001a90: 7474 6572 6572 7320 6177 6179 2066 726f  tterers away fro
+00001aa0: 6d20 696e 7374 7275 6d65 6e74 222c 0a20  m instrument",. 
+00001ab0: 2020 2020 2020 2022 7368 6f72 745f 6e61         "short_na
+00001ac0: 6d65 223a 2022 5652 222c 0a20 2020 2020  me": "VR",.     
+00001ad0: 2020 2022 756e 6974 7322 3a20 226d 6574     "units": "met
+00001ae0: 6572 7320 7065 7220 7365 636f 6e64 7322  ers per seconds"
+00001af0: 2c0a 2020 2020 2020 2020 2267 616d 6963  ,.        "gamic
+00001b00: 223a 204e 6f6e 652c 0a20 2020 207d 2c0a  ": None,.    },.
+00001b10: 2020 2020 2256 5241 4422 3a20 7b0a 2020      "VRAD": {.  
+00001b20: 2020 2020 2020 2273 7461 6e64 6172 645f        "standard_
+00001b30: 6e61 6d65 223a 2022 7261 6469 616c 5f76  name": "radial_v
+00001b40: 656c 6f63 6974 795f 6f66 5f73 6361 7474  elocity_of_scatt
+00001b50: 6572 6572 735f 6177 6179 5f22 2022 6672  erers_away_" "fr
+00001b60: 6f6d 5f69 6e73 7472 756d 656e 7422 2c0a  om_instrument",.
+00001b70: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
+00001b80: 6d65 223a 2022 5261 6469 616c 2076 656c  me": "Radial vel
+00001b90: 6f63 6974 7920 6f66 2073 6361 7474 6572  ocity of scatter
+00001ba0: 6572 7320 6177 6179 2066 726f 6d20 696e  ers away from in
+00001bb0: 7374 7275 6d65 6e74 222c 0a20 2020 2020  strument",.     
+00001bc0: 2020 2022 7368 6f72 745f 6e61 6d65 223a     "short_name":
+00001bd0: 2022 5652 4144 222c 0a20 2020 2020 2020   "VRAD",.       
+00001be0: 2022 756e 6974 7322 3a20 226d 6574 6572   "units": "meter
+00001bf0: 7320 7065 7220 7365 636f 6e64 7322 2c0a  s per seconds",.
+00001c00: 2020 2020 2020 2020 2267 616d 6963 223a          "gamic":
+00001c10: 204e 6f6e 652c 0a20 2020 207d 2c0a 2020   None,.    },.  
+00001c20: 2020 2256 5241 4444 4822 3a20 7b0a 2020    "VRADDH": {.  
+00001c30: 2020 2020 2020 2273 7461 6e64 6172 645f        "standard_
+00001c40: 6e61 6d65 223a 2022 7261 6469 616c 5f76  name": "radial_v
+00001c50: 656c 6f63 6974 795f 6f66 5f73 6361 7474  elocity_of_scatt
+00001c60: 6572 6572 735f 6177 6179 5f22 2022 6672  erers_away_" "fr
+00001c70: 6f6d 5f69 6e73 7472 756d 656e 745f 6822  om_instrument_h"
+00001c80: 2c0a 2020 2020 2020 2020 226c 6f6e 675f  ,.        "long_
+00001c90: 6e61 6d65 223a 2022 5261 6469 616c 2076  name": "Radial v
+00001ca0: 656c 6f63 6974 7920 6f66 2073 6361 7474  elocity of scatt
+00001cb0: 6572 6572 7320 6177 6179 2066 726f 6d20  erers away from 
+00001cc0: 696e 7374 7275 6d65 6e74 2048 222c 0a20  instrument H",. 
+00001cd0: 2020 2020 2020 2022 7368 6f72 745f 6e61         "short_na
+00001ce0: 6d65 223a 2022 5652 4144 4448 222c 0a20  me": "VRADDH",. 
+00001cf0: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
+00001d00: 226d 6574 6572 7320 7065 7220 7365 636f  "meters per seco
+00001d10: 6e64 7322 2c0a 2020 2020 2020 2020 2267  nds",.        "g
+00001d20: 616d 6963 223a 204e 6f6e 652c 0a20 2020  amic": None,.   
+00001d30: 207d 2c0a 2020 2020 2257 5241 4448 223a   },.    "WRADH":
+00001d40: 207b 0a20 2020 2020 2020 2022 7374 616e   {.        "stan
+00001d50: 6461 7264 5f6e 616d 6522 3a20 2272 6164  dard_name": "rad
+00001d60: 6172 5f64 6f70 706c 6572 5f73 7065 6374  ar_doppler_spect
+00001d70: 7275 6d5f 7769 6474 685f 6822 2c0a 2020  rum_width_h",.  
+00001d80: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
+00001d90: 223a 2022 446f 7070 6c65 7220 7370 6563  ": "Doppler spec
+00001da0: 7472 756d 2077 6964 7468 2048 222c 0a20  trum width H",. 
+00001db0: 2020 2020 2020 2022 7368 6f72 745f 6e61         "short_na
+00001dc0: 6d65 223a 2022 5752 4144 4822 2c0a 2020  me": "WRADH",.  
+00001dd0: 2020 2020 2020 2275 6e69 7473 223a 2022        "units": "
+00001de0: 6d65 7465 7273 2070 6572 2073 6563 6f6e  meters per secon
+00001df0: 6473 222c 0a20 2020 2020 2020 2022 6761  ds",.        "ga
+00001e00: 6d69 6322 3a20 5b22 7768 225d 2c0a 2020  mic": ["wh"],.  
+00001e10: 2020 7d2c 0a20 2020 2022 5557 5241 4448    },.    "UWRADH
+00001e20: 223a 207b 0a20 2020 2020 2020 2022 7374  ": {.        "st
+00001e30: 616e 6461 7264 5f6e 616d 6522 3a20 2272  andard_name": "r
+00001e40: 6164 6172 5f64 6f70 706c 6572 5f73 7065  adar_doppler_spe
+00001e50: 6374 7275 6d5f 7769 6474 685f 6822 2c0a  ctrum_width_h",.
+00001e60: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
+00001e70: 6d65 223a 2022 446f 7070 6c65 7220 7370  me": "Doppler sp
+00001e80: 6563 7472 756d 2077 6964 7468 2048 222c  ectrum width H",
+00001e90: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
+00001ea0: 6e61 6d65 223a 2022 5557 5241 4448 222c  name": "UWRADH",
+00001eb0: 0a20 2020 2020 2020 2022 756e 6974 7322  .        "units"
+00001ec0: 3a20 226d 6574 6572 7320 7065 7220 7365  : "meters per se
+00001ed0: 636f 6e64 7322 2c0a 2020 2020 2020 2020  conds",.        
+00001ee0: 2267 616d 6963 223a 205b 2275 7768 225d  "gamic": ["uwh"]
+00001ef0: 2c0a 2020 2020 7d2c 0a20 2020 2022 5752  ,.    },.    "WR
+00001f00: 4144 5622 3a20 7b0a 2020 2020 2020 2020  ADV": {.        
+00001f10: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
+00001f20: 2022 7261 6461 725f 646f 7070 6c65 725f   "radar_doppler_
+00001f30: 7370 6563 7472 756d 5f77 6964 7468 5f76  spectrum_width_v
+00001f40: 222c 0a20 2020 2020 2020 2022 6c6f 6e67  ",.        "long
+00001f50: 5f6e 616d 6522 3a20 2244 6f70 706c 6572  _name": "Doppler
+00001f60: 2073 7065 6374 7275 6d20 7769 6474 6820   spectrum width 
+00001f70: 5622 2c0a 2020 2020 2020 2020 2273 686f  V",.        "sho
+00001f80: 7274 5f6e 616d 6522 3a20 2257 5241 4456  rt_name": "WRADV
+00001f90: 222c 0a20 2020 2020 2020 2022 756e 6974  ",.        "unit
+00001fa0: 7322 3a20 226d 6574 6572 7320 7065 7220  s": "meters per 
+00001fb0: 7365 636f 6e64 222c 0a20 2020 2020 2020  second",.       
+00001fc0: 2022 6761 6d69 6322 3a20 5b22 7776 225d   "gamic": ["wv"]
+00001fd0: 2c0a 2020 2020 7d2c 0a20 2020 2022 5752  ,.    },.    "WR
+00001fe0: 4144 223a 207b 0a20 2020 2020 2020 2022  AD": {.        "
+00001ff0: 7374 616e 6461 7264 5f6e 616d 6522 3a20  standard_name": 
+00002000: 2272 6164 6172 5f64 6f70 706c 6572 5f73  "radar_doppler_s
+00002010: 7065 6374 7275 6d5f 7769 6474 6822 2c0a  pectrum_width",.
+00002020: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
+00002030: 6d65 223a 2022 446f 7070 6c65 7220 7370  me": "Doppler sp
+00002040: 6563 7472 756d 2077 6964 7468 222c 0a20  ectrum width",. 
+00002050: 2020 2020 2020 2022 7368 6f72 745f 6e61         "short_na
+00002060: 6d65 223a 2022 5752 4144 222c 0a20 2020  me": "WRAD",.   
+00002070: 2020 2020 2022 756e 6974 7322 3a20 226d       "units": "m
+00002080: 6574 6572 7320 7065 7220 7365 636f 6e64  eters per second
+00002090: 222c 0a20 2020 2020 2020 2022 6761 6d69  ",.        "gami
+000020a0: 6322 3a20 4e6f 6e65 2c0a 2020 2020 7d2c  c": None,.    },
+000020b0: 0a20 2020 2022 5a44 5222 3a20 7b0a 2020  .    "ZDR": {.  
+000020c0: 2020 2020 2020 2273 7461 6e64 6172 645f        "standard_
+000020d0: 6e61 6d65 223a 2022 7261 6461 725f 6469  name": "radar_di
+000020e0: 6666 6572 656e 7469 616c 5f72 6566 6c65  fferential_refle
+000020f0: 6374 6976 6974 795f 6876 222c 0a20 2020  ctivity_hv",.   
+00002100: 2020 2020 2022 6c6f 6e67 5f6e 616d 6522       "long_name"
+00002110: 3a20 224c 6f67 2064 6966 6665 7265 6e74  : "Log different
+00002120: 6961 6c20 7265 666c 6563 7469 7669 7479  ial reflectivity
+00002130: 2048 2f56 222c 0a20 2020 2020 2020 2022   H/V",.        "
+00002140: 7368 6f72 745f 6e61 6d65 223a 2022 5a44  short_name": "ZD
+00002150: 5222 2c0a 2020 2020 2020 2020 2275 6e69  R",.        "uni
+00002160: 7473 223a 2022 6442 222c 0a20 2020 2020  ts": "dB",.     
+00002170: 2020 2022 6761 6d69 6322 3a20 5b22 7a64     "gamic": ["zd
+00002180: 7222 5d2c 0a20 2020 207d 2c0a 2020 2020  r"],.    },.    
+00002190: 2255 5a44 5222 3a20 7b0a 2020 2020 2020  "UZDR": {.      
+000021a0: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
+000021b0: 223a 2022 7261 6461 725f 6469 6666 6572  ": "radar_differ
+000021c0: 656e 7469 616c 5f72 6566 6c65 6374 6976  ential_reflectiv
+000021d0: 6974 795f 6876 222c 0a20 2020 2020 2020  ity_hv",.       
+000021e0: 2022 6c6f 6e67 5f6e 616d 6522 3a20 224c   "long_name": "L
+000021f0: 6f67 2064 6966 6665 7265 6e74 6961 6c20  og differential 
+00002200: 7265 666c 6563 7469 7669 7479 2048 2f56  reflectivity H/V
+00002210: 222c 0a20 2020 2020 2020 2022 7368 6f72  ",.        "shor
+00002220: 745f 6e61 6d65 223a 2022 555a 4452 222c  t_name": "UZDR",
+00002230: 0a20 2020 2020 2020 2022 756e 6974 7322  .        "units"
+00002240: 3a20 2264 4222 2c0a 2020 2020 2020 2020  : "dB",.        
+00002250: 2267 616d 6963 223a 205b 2275 7a64 7222  "gamic": ["uzdr"
+00002260: 5d2c 0a20 2020 207d 2c0a 2020 2020 224c  ],.    },.    "L
+00002270: 4452 223a 207b 0a20 2020 2020 2020 2022  DR": {.        "
+00002280: 7374 616e 6461 7264 5f6e 616d 6522 3a20  standard_name": 
+00002290: 2272 6164 6172 5f6c 696e 6561 725f 6465  "radar_linear_de
+000022a0: 706f 6c61 7269 7a61 7469 6f6e 5f72 6174  polarization_rat
+000022b0: 696f 222c 0a20 2020 2020 2020 2022 6c6f  io",.        "lo
+000022c0: 6e67 5f6e 616d 6522 3a20 224c 6f67 2d6c  ng_name": "Log-l
+000022d0: 696e 6561 7220 6465 706f 6c61 7269 7a61  inear depolariza
+000022e0: 7469 6f6e 2072 6174 696f 2048 5622 2c0a  tion ratio HV",.
+000022f0: 2020 2020 2020 2020 2273 686f 7274 5f6e          "short_n
+00002300: 616d 6522 3a20 224c 4452 222c 0a20 2020  ame": "LDR",.   
+00002310: 2020 2020 2022 756e 6974 7322 3a20 2264       "units": "d
+00002320: 4222 2c0a 2020 2020 2020 2020 2267 616d  B",.        "gam
+00002330: 6963 223a 205b 226c 6472 225d 2c0a 2020  ic": ["ldr"],.  
+00002340: 2020 7d2c 0a20 2020 2022 5048 4944 5022    },.    "PHIDP"
+00002350: 3a20 7b0a 2020 2020 2020 2020 2273 7461  : {.        "sta
+00002360: 6e64 6172 645f 6e61 6d65 223a 2022 7261  ndard_name": "ra
+00002370: 6461 725f 6469 6666 6572 656e 7469 616c  dar_differential
+00002380: 5f70 6861 7365 5f68 7622 2c0a 2020 2020  _phase_hv",.    
+00002390: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
+000023a0: 2022 4469 6666 6572 656e 7469 616c 2070   "Differential p
+000023b0: 6861 7365 2048 5622 2c0a 2020 2020 2020  hase HV",.      
+000023c0: 2020 2273 686f 7274 5f6e 616d 6522 3a20    "short_name": 
+000023d0: 2250 4849 4450 222c 0a20 2020 2020 2020  "PHIDP",.       
+000023e0: 2022 756e 6974 7322 3a20 2264 6567 7265   "units": "degre
+000023f0: 6573 222c 0a20 2020 2020 2020 2022 6761  es",.        "ga
+00002400: 6d69 6322 3a20 5b22 7068 6964 7022 5d2c  mic": ["phidp"],
+00002410: 0a20 2020 207d 2c0a 2020 2020 2255 5048  .    },.    "UPH
+00002420: 4944 5022 3a20 7b0a 2020 2020 2020 2020  IDP": {.        
+00002430: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
+00002440: 2022 7261 6461 725f 6469 6666 6572 656e   "radar_differen
+00002450: 7469 616c 5f70 6861 7365 5f68 7622 2c0a  tial_phase_hv",.
+00002460: 2020 2020 2020 2020 226c 6f6e 675f 6e61          "long_na
+00002470: 6d65 223a 2022 4469 6666 6572 656e 7469  me": "Differenti
+00002480: 616c 2070 6861 7365 2048 5622 2c0a 2020  al phase HV",.  
+00002490: 2020 2020 2020 2273 686f 7274 5f6e 616d        "short_nam
+000024a0: 6522 3a20 2255 5048 4944 5022 2c0a 2020  e": "UPHIDP",.  
+000024b0: 2020 2020 2020 2275 6e69 7473 223a 2022        "units": "
+000024c0: 6465 6772 6565 7322 2c0a 2020 2020 2020  degrees",.      
+000024d0: 2020 2267 616d 6963 223a 205b 2275 7068    "gamic": ["uph
+000024e0: 6964 7022 5d2c 0a20 2020 207d 2c0a 2020  idp"],.    },.  
+000024f0: 2020 224b 4450 223a 207b 0a20 2020 2020    "KDP": {.     
+00002500: 2020 2022 7374 616e 6461 7264 5f6e 616d     "standard_nam
+00002510: 6522 3a20 2272 6164 6172 5f73 7065 6369  e": "radar_speci
+00002520: 6669 635f 6469 6666 6572 656e 7469 616c  fic_differential
+00002530: 5f70 6861 7365 5f68 7622 2c0a 2020 2020  _phase_hv",.    
+00002540: 2020 2020 226c 6f6e 675f 6e61 6d65 223a      "long_name":
+00002550: 2022 5370 6563 6966 6963 2064 6966 6665   "Specific diffe
+00002560: 7265 6e74 6961 6c20 7068 6173 6520 4856  rential phase HV
+00002570: 222c 0a20 2020 2020 2020 2022 7368 6f72  ",.        "shor
+00002580: 745f 6e61 6d65 223a 2022 4b44 5022 2c0a  t_name": "KDP",.
+00002590: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+000025a0: 2022 6465 6772 6565 7320 7065 7220 6b69   "degrees per ki
+000025b0: 6c6f 6d65 7465 7222 2c0a 2020 2020 2020  lometer",.      
+000025c0: 2020 2267 616d 6963 223a 205b 226b 6470    "gamic": ["kdp
+000025d0: 225d 2c0a 2020 2020 7d2c 0a20 2020 2022  "],.    },.    "
+000025e0: 5248 4f48 5622 3a20 7b0a 2020 2020 2020  RHOHV": {.      
+000025f0: 2020 2273 7461 6e64 6172 645f 6e61 6d65    "standard_name
+00002600: 223a 2022 7261 6461 725f 636f 7272 656c  ": "radar_correl
+00002610: 6174 696f 6e5f 636f 6566 6669 6369 656e  ation_coefficien
+00002620: 745f 6876 222c 0a20 2020 2020 2020 2022  t_hv",.        "
+00002630: 6c6f 6e67 5f6e 616d 6522 3a20 2243 6f72  long_name": "Cor
+00002640: 7265 6c61 7469 6f6e 2063 6f65 6666 6963  relation coeffic
+00002650: 6965 6e74 2048 5622 2c0a 2020 2020 2020  ient HV",.      
+00002660: 2020 2273 686f 7274 5f6e 616d 6522 3a20    "short_name": 
+00002670: 2252 484f 4856 222c 0a20 2020 2020 2020  "RHOHV",.       
+00002680: 2022 756e 6974 7322 3a20 2275 6e69 746c   "units": "unitl
+00002690: 6573 7322 2c0a 2020 2020 2020 2020 2267  ess",.        "g
+000026a0: 616d 6963 223a 205b 2272 686f 6876 225d  amic": ["rhohv"]
+000026b0: 2c0a 2020 2020 7d2c 0a20 2020 2022 5552  ,.    },.    "UR
+000026c0: 484f 4856 223a 207b 0a20 2020 2020 2020  HOHV": {.       
+000026d0: 2022 7374 616e 6461 7264 5f6e 616d 6522   "standard_name"
+000026e0: 3a20 2272 6164 6172 5f63 6f72 7265 6c61  : "radar_correla
+000026f0: 7469 6f6e 5f63 6f65 6666 6963 6965 6e74  tion_coefficient
+00002700: 5f68 7622 2c0a 2020 2020 2020 2020 226c  _hv",.        "l
+00002710: 6f6e 675f 6e61 6d65 223a 2022 436f 7272  ong_name": "Corr
+00002720: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
+00002730: 656e 7420 4856 222c 0a20 2020 2020 2020  ent HV",.       
+00002740: 2022 7368 6f72 745f 6e61 6d65 223a 2022   "short_name": "
+00002750: 5552 484f 4856 222c 0a20 2020 2020 2020  URHOHV",.       
+00002760: 2022 756e 6974 7322 3a20 2275 6e69 746c   "units": "unitl
+00002770: 6573 7322 2c0a 2020 2020 2020 2020 2267  ess",.        "g
+00002780: 616d 6963 223a 205b 2275 7268 6f68 7622  amic": ["urhohv"
+00002790: 5d2c 0a20 2020 207d 2c0a 2020 2020 2253  ],.    },.    "S
+000027a0: 4e52 4822 3a20 7b0a 2020 2020 2020 2020  NRH": {.        
+000027b0: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
+000027c0: 2022 7369 676e 616c 5f6e 6f69 7365 5f72   "signal_noise_r
+000027d0: 6174 696f 5f68 222c 0a20 2020 2020 2020  atio_h",.       
+000027e0: 2022 6c6f 6e67 5f6e 616d 6522 3a20 2253   "long_name": "S
+000027f0: 6967 6e61 6c20 4e6f 6973 6520 5261 7469  ignal Noise Rati
+00002800: 6f20 4822 2c0a 2020 2020 2020 2020 2273  o H",.        "s
+00002810: 686f 7274 5f6e 616d 6522 3a20 2253 4e52  hort_name": "SNR
+00002820: 4822 2c0a 2020 2020 2020 2020 2275 6e69  H",.        "uni
+00002830: 7473 223a 2022 756e 6974 6c65 7373 222c  ts": "unitless",
+00002840: 0a20 2020 2020 2020 2022 6761 6d69 6322  .        "gamic"
+00002850: 3a20 4e6f 6e65 2c0a 2020 2020 7d2c 0a20  : None,.    },. 
+00002860: 2020 2022 534e 5256 223a 207b 0a20 2020     "SNRV": {.   
+00002870: 2020 2020 2022 7374 616e 6461 7264 5f6e       "standard_n
+00002880: 616d 6522 3a20 2273 6967 6e61 6c5f 6e6f  ame": "signal_no
+00002890: 6973 655f 7261 7469 6f5f 7622 2c0a 2020  ise_ratio_v",.  
+000028a0: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
+000028b0: 223a 2022 5369 676e 616c 204e 6f69 7365  ": "Signal Noise
+000028c0: 2052 6174 696f 2056 222c 0a20 2020 2020   Ratio V",.     
+000028d0: 2020 2022 7368 6f72 745f 6e61 6d65 223a     "short_name":
+000028e0: 2022 534e 5256 222c 0a20 2020 2020 2020   "SNRV",.       
+000028f0: 2022 756e 6974 7322 3a20 2275 6e69 746c   "units": "unitl
+00002900: 6573 7322 2c0a 2020 2020 2020 2020 2267  ess",.        "g
+00002910: 616d 6963 223a 204e 6f6e 652c 0a20 2020  amic": None,.   
+00002920: 207d 2c0a 2020 2020 2253 5149 4822 3a20   },.    "SQIH": 
+00002930: 7b0a 2020 2020 2020 2020 2273 7461 6e64  {.        "stand
+00002940: 6172 645f 6e61 6d65 223a 2022 7369 676e  ard_name": "sign
+00002950: 616c 5f71 7561 6c69 7479 5f69 6e64 6578  al_quality_index
+00002960: 5f68 222c 0a20 2020 2020 2020 2022 6c6f  _h",.        "lo
+00002970: 6e67 5f6e 616d 6522 3a20 2253 6967 6e61  ng_name": "Signa
+00002980: 6c20 5175 616c 6974 7920 4822 2c0a 2020  l Quality H",.  
+00002990: 2020 2020 2020 2273 686f 7274 5f6e 616d        "short_nam
+000029a0: 6522 3a20 2253 5149 4822 2c0a 2020 2020  e": "SQIH",.    
+000029b0: 2020 2020 2275 6e69 7473 223a 2022 756e      "units": "un
+000029c0: 6974 6c65 7373 222c 0a20 2020 2020 2020  itless",.       
+000029d0: 2022 6761 6d69 6322 3a20 4e6f 6e65 2c0a   "gamic": None,.
+000029e0: 2020 2020 7d2c 0a20 2020 2022 5351 4956      },.    "SQIV
+000029f0: 223a 207b 0a20 2020 2020 2020 2022 7374  ": {.        "st
+00002a00: 616e 6461 7264 5f6e 616d 6522 3a20 2273  andard_name": "s
+00002a10: 6967 6e61 6c5f 7175 616c 6974 795f 696e  ignal_quality_in
+00002a20: 6465 785f 7622 2c0a 2020 2020 2020 2020  dex_v",.        
+00002a30: 226c 6f6e 675f 6e61 6d65 223a 2022 5369  "long_name": "Si
+00002a40: 676e 616c 2051 7561 6c69 7479 2056 222c  gnal Quality V",
+00002a50: 0a20 2020 2020 2020 2022 7368 6f72 745f  .        "short_
+00002a60: 6e61 6d65 223a 2022 5351 4956 222c 0a20  name": "SQIV",. 
+00002a70: 2020 2020 2020 2022 756e 6974 7322 3a20         "units": 
+00002a80: 2275 6e69 746c 6573 7322 2c0a 2020 2020  "unitless",.    
+00002a90: 2020 2020 2267 616d 6963 223a 204e 6f6e      "gamic": Non
+00002aa0: 652c 0a20 2020 207d 2c0a 2020 2020 2243  e,.    },.    "C
+00002ab0: 434f 5248 223a 207b 0a20 2020 2020 2020  CORH": {.       
+00002ac0: 2022 7374 616e 6461 7264 5f6e 616d 6522   "standard_name"
+00002ad0: 3a20 2263 6c75 7474 6572 5f63 6f72 7265  : "clutter_corre
+00002ae0: 6374 696f 6e5f 6822 2c0a 2020 2020 2020  ction_h",.      
+00002af0: 2020 226c 6f6e 675f 6e61 6d65 223a 2022    "long_name": "
+00002b00: 436c 7574 7465 7220 436f 7272 6563 7469  Clutter Correcti
+00002b10: 6f6e 2048 222c 0a20 2020 2020 2020 2022  on H",.        "
+00002b20: 7368 6f72 745f 6e61 6d65 223a 2022 4343  short_name": "CC
+00002b30: 4f52 4822 2c0a 2020 2020 2020 2020 2275  ORH",.        "u
+00002b40: 6e69 7473 223a 2022 756e 6974 6c65 7373  nits": "unitless
+00002b50: 222c 0a20 2020 2020 2020 2022 6761 6d69  ",.        "gami
+00002b60: 6322 3a20 4e6f 6e65 2c0a 2020 2020 7d2c  c": None,.    },
+00002b70: 0a20 2020 2022 4343 4f52 5622 3a20 7b0a  .    "CCORV": {.
+00002b80: 2020 2020 2020 2020 2273 7461 6e64 6172          "standar
+00002b90: 645f 6e61 6d65 223a 2022 636c 7574 7465  d_name": "clutte
+00002ba0: 725f 636f 7272 6563 7469 6f6e 5f76 222c  r_correction_v",
+00002bb0: 0a20 2020 2020 2020 2022 6c6f 6e67 5f6e  .        "long_n
+00002bc0: 616d 6522 3a20 2243 6c75 7474 6572 2043  ame": "Clutter C
+00002bd0: 6f72 7265 6374 696f 6e20 5622 2c0a 2020  orrection V",.  
+00002be0: 2020 2020 2020 2273 686f 7274 5f6e 616d        "short_nam
+00002bf0: 6522 3a20 2243 434f 5256 222c 0a20 2020  e": "CCORV",.   
+00002c00: 2020 2020 2022 756e 6974 7322 3a20 2275       "units": "u
+00002c10: 6e69 746c 6573 7322 2c0a 2020 2020 2020  nitless",.      
+00002c20: 2020 2267 616d 6963 223a 204e 6f6e 652c    "gamic": None,
+00002c30: 0a20 2020 207d 2c0a 2020 2020 2243 4d41  .    },.    "CMA
+00002c40: 5022 3a20 7b0a 2020 2020 2020 2020 2273  P": {.        "s
+00002c50: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
+00002c60: 636c 7574 7465 725f 6d61 7022 2c0a 2020  clutter_map",.  
+00002c70: 2020 2020 2020 226c 6f6e 675f 6e61 6d65        "long_name
+00002c80: 223a 2022 436c 7574 7465 7220 4d61 7022  ": "Clutter Map"
+00002c90: 2c0a 2020 2020 2020 2020 2273 686f 7274  ,.        "short
+00002ca0: 5f6e 616d 6522 3a20 2243 4d41 5022 2c0a  _name": "CMAP",.
+00002cb0: 2020 2020 2020 2020 2275 6e69 7473 223a          "units":
+00002cc0: 2022 756e 6974 6c65 7373 222c 0a20 2020   "unitless",.   
+00002cd0: 2020 2020 2022 6761 6d69 6322 3a20 5b22       "gamic": ["
+00002ce0: 636d 6170 225d 2c0a 2020 2020 7d2c 0a7d  cmap"],.    },.}
+00002cf0: 0a0a 4f44 494d 5f4e 414d 4553 203d 207b  ..ODIM_NAMES = {
+00002d00: 7661 6c75 655b 2273 686f 7274 5f6e 616d  value["short_nam
+00002d10: 6522 5d3a 206b 6579 2066 6f72 2028 6b65  e"]: key for (ke
+00002d20: 792c 2076 616c 7565 2920 696e 206d 6f6d  y, value) in mom
+00002d30: 656e 7473 5f6d 6170 7069 6e67 2e69 7465  ents_mapping.ite
+00002d40: 6d73 2829 7d0a 0a47 414d 4943 5f4e 414d  ms()}..GAMIC_NAM
+00002d50: 4553 203d 207b 0a20 2020 2076 3a20 6b65  ES = {.    v: ke
+00002d60: 790a 2020 2020 666f 7220 286b 6579 2c20  y.    for (key, 
+00002d70: 7661 6c75 6529 2069 6e20 6d6f 6d65 6e74  value) in moment
+00002d80: 735f 6d61 7070 696e 672e 6974 656d 7328  s_mapping.items(
+00002d90: 290a 2020 2020 6966 2076 616c 7565 5b22  ).    if value["
+00002da0: 6761 6d69 6322 5d20 6973 206e 6f74 204e  gamic"] is not N
+00002db0: 6f6e 650a 2020 2020 666f 7220 7620 696e  one.    for v in
+00002dc0: 2076 616c 7565 5b22 6761 6d69 6322 5d0a   value["gamic"].
+00002dd0: 7d0a 0a72 616e 6765 5f61 7474 7273 203d  }..range_attrs =
+00002de0: 207b 0a20 2020 2022 756e 6974 7322 3a20   {.    "units": 
+00002df0: 226d 6574 6572 7322 2c0a 2020 2020 2273  "meters",.    "s
+00002e00: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
+00002e10: 7072 6f6a 6563 7469 6f6e 5f72 616e 6765  projection_range
+00002e20: 5f63 6f6f 7264 696e 6174 6522 2c0a 2020  _coordinate",.  
+00002e30: 2020 226c 6f6e 675f 6e61 6d65 223a 2022    "long_name": "
+00002e40: 7261 6e67 655f 746f 5f6d 6561 7375 7265  range_to_measure
+00002e50: 6d65 6e74 5f76 6f6c 756d 6522 2c0a 2020  ment_volume",.  
+00002e60: 2020 2273 7061 6369 6e67 5f69 735f 636f    "spacing_is_co
+00002e70: 6e73 7461 6e74 223a 2022 7472 7565 222c  nstant": "true",
+00002e80: 0a20 2020 2022 6178 6973 223a 2022 7261  .    "axis": "ra
+00002e90: 6469 616c 5f72 616e 6765 5f63 6f6f 7264  dial_range_coord
+00002ea0: 696e 6174 6522 2c0a 2020 2020 226d 6574  inate",.    "met
+00002eb0: 6572 735f 746f 5f63 656e 7465 725f 6f66  ers_to_center_of
+00002ec0: 5f66 6972 7374 5f67 6174 6522 3a20 4e6f  _first_gate": No
+00002ed0: 6e65 2c0a 7d0a 0a61 7a5f 6174 7472 7320  ne,.}..az_attrs 
+00002ee0: 3d20 7b0a 2020 2020 2273 7461 6e64 6172  = {.    "standar
+00002ef0: 645f 6e61 6d65 223a 2022 7261 795f 617a  d_name": "ray_az
+00002f00: 696d 7574 685f 616e 676c 6522 2c0a 2020  imuth_angle",.  
+00002f10: 2020 226c 6f6e 675f 6e61 6d65 223a 2022    "long_name": "
+00002f20: 617a 696d 7574 685f 616e 676c 655f 6672  azimuth_angle_fr
+00002f30: 6f6d 5f74 7275 655f 6e6f 7274 6822 2c0a  om_true_north",.
+00002f40: 2020 2020 2275 6e69 7473 223a 2022 6465      "units": "de
+00002f50: 6772 6565 7322 2c0a 2020 2020 2261 7869  grees",.    "axi
+00002f60: 7322 3a20 2272 6164 6961 6c5f 617a 696d  s": "radial_azim
+00002f70: 7574 685f 636f 6f72 6469 6e61 7465 222c  uth_coordinate",
+00002f80: 0a7d 0a0a 656c 5f61 7474 7273 203d 207b  .}..el_attrs = {
+00002f90: 0a20 2020 2022 7374 616e 6461 7264 5f6e  .    "standard_n
+00002fa0: 616d 6522 3a20 2272 6179 5f65 6c65 7661  ame": "ray_eleva
+00002fb0: 7469 6f6e 5f61 6e67 6c65 222c 0a20 2020  tion_angle",.   
+00002fc0: 2022 6c6f 6e67 5f6e 616d 6522 3a20 2265   "long_name": "e
+00002fd0: 6c65 7661 7469 6f6e 5f61 6e67 6c65 5f66  levation_angle_f
+00002fe0: 726f 6d5f 686f 7269 7a6f 6e74 616c 5f70  rom_horizontal_p
+00002ff0: 6c61 6e65 222c 0a20 2020 2022 756e 6974  lane",.    "unit
+00003000: 7322 3a20 2264 6567 7265 6573 222c 0a20  s": "degrees",. 
+00003010: 2020 2022 6178 6973 223a 2022 7261 6469     "axis": "radi
+00003020: 616c 5f65 6c65 7661 7469 6f6e 5f63 6f6f  al_elevation_coo
+00003030: 7264 696e 6174 6522 2c0a 7d0a 0a74 696d  rdinate",.}..tim
+00003040: 655f 6174 7472 7320 3d20 7b0a 2020 2020  e_attrs = {.    
+00003050: 2273 7461 6e64 6172 645f 6e61 6d65 223a  "standard_name":
+00003060: 2022 7469 6d65 222c 0a20 2020 2022 756e   "time",.    "un
+00003070: 6974 7322 3a20 2273 6563 6f6e 6473 2073  its": "seconds s
+00003080: 696e 6365 2031 3937 302d 3031 2d30 3154  ince 1970-01-01T
+00003090: 3030 3a30 303a 3030 5a22 2c0a 7d0a 0a72  00:00:00Z",.}..r
+000030a0: 6f6f 745f 7661 7273 203d 207b 0a20 2020  oot_vars = {.   
+000030b0: 2022 766f 6c75 6d65 5f6e 756d 6265 7222   "volume_number"
+000030c0: 2c0a 2020 2020 2270 6c61 7466 6f72 6d5f  ,.    "platform_
+000030d0: 7479 7065 222c 0a20 2020 2022 696e 7374  type",.    "inst
+000030e0: 7275 6d65 6e74 5f74 7970 6522 2c0a 2020  rument_type",.  
+000030f0: 2020 2270 7269 6d61 7279 5f61 7869 7322    "primary_axis"
+00003100: 2c0a 2020 2020 2274 696d 655f 636f 7665  ,.    "time_cove
+00003110: 7261 6765 5f73 7461 7274 222c 0a20 2020  rage_start",.   
+00003120: 2022 7469 6d65 5f63 6f76 6572 6167 655f   "time_coverage_
+00003130: 656e 6422 2c0a 2020 2020 226c 6174 6974  end",.    "latit
+00003140: 7564 6522 2c0a 2020 2020 226c 6f6e 6769  ude",.    "longi
+00003150: 7475 6465 222c 0a20 2020 2022 616c 7469  tude",.    "alti
+00003160: 7475 6465 222c 0a20 2020 2022 6669 7865  tude",.    "fixe
+00003170: 645f 616e 676c 6522 2c0a 2020 2020 2273  d_angle",.    "s
+00003180: 7461 7475 735f 786d 6c22 2c0a 7d0a 0a73  tatus_xml",.}..s
+00003190: 7765 6570 5f76 6172 7331 203d 207b 0a20  weep_vars1 = {. 
+000031a0: 2020 2022 7377 6565 705f 6e75 6d62 6572     "sweep_number
+000031b0: 222c 0a20 2020 2022 7377 6565 705f 6d6f  ",.    "sweep_mo
+000031c0: 6465 222c 0a20 2020 2022 706f 6c61 7269  de",.    "polari
+000031d0: 7a61 7469 6f6e 5f6d 6f64 6522 2c0a 2020  zation_mode",.  
+000031e0: 2020 2270 7274 5f6d 6f64 6522 2c0a 2020    "prt_mode",.  
+000031f0: 2020 2266 6f6c 6c6f 775f 6d6f 6465 222c    "follow_mode",
+00003200: 0a20 2020 2022 6669 7865 645f 616e 676c  .    "fixed_angl
+00003210: 6522 2c0a 2020 2020 2274 6172 6765 745f  e",.    "target_
+00003220: 7363 616e 5f72 6174 6522 2c0a 2020 2020  scan_rate",.    
+00003230: 2273 7765 6570 5f73 7461 7274 5f72 6179  "sweep_start_ray
+00003240: 5f69 6e64 6578 222c 0a20 2020 2022 7377  _index",.    "sw
+00003250: 6565 705f 656e 645f 7261 795f 696e 6465  eep_end_ray_inde
+00003260: 7822 2c0a 7d0a 0a73 7765 6570 5f76 6172  x",.}..sweep_var
+00003270: 7332 203d 207b 0a20 2020 2022 617a 696d  s2 = {.    "azim
+00003280: 7574 6822 2c0a 2020 2020 2265 6c65 7661  uth",.    "eleva
+00003290: 7469 6f6e 222c 0a20 2020 2022 7075 6c73  tion",.    "puls
+000032a0: 655f 7769 6474 6822 2c0a 2020 2020 2270  e_width",.    "p
+000032b0: 7274 222c 0a20 2020 2022 6e79 7175 6973  rt",.    "nyquis
+000032c0: 745f 7665 6c6f 6369 7479 222c 0a20 2020  t_velocity",.   
+000032d0: 2022 756e 616d 6269 6775 6f75 735f 7261   "unambiguous_ra
+000032e0: 6e67 6522 2c0a 2020 2020 2261 6e74 656e  nge",.    "anten
+000032f0: 6e61 5f74 7261 6e73 6974 696f 6e22 2c0a  na_transition",.
+00003300: 2020 2020 226e 5f73 616d 706c 6573 222c      "n_samples",
+00003310: 0a20 2020 2022 725f 6361 6c69 625f 696e  .    "r_calib_in
+00003320: 6465 7822 2c0a 2020 2020 2273 6361 6e5f  dex",.    "scan_
+00003330: 7261 7465 222c 0a7d 0a0a 7377 6565 705f  rate",.}..sweep_
+00003340: 7661 7273 3320 3d20 7b22 4442 5a22 2c20  vars3 = {"DBZ", 
+00003350: 2256 5222 2c20 2274 696d 6522 2c20 2272  "VR", "time", "r
+00003360: 616e 6765 222c 2022 7265 666c 6563 7469  ange", "reflecti
+00003370: 7669 7479 5f68 6f72 697a 6f6e 7461 6c22  vity_horizontal"
+00003380: 7d0a 0a63 665f 6675 6c6c 5f76 6172 7320  }..cf_full_vars 
+00003390: 3d20 7b22 7072 7422 3a20 2270 7266 222c  = {"prt": "prf",
+000033a0: 2022 6e5f 7361 6d70 6c65 7322 3a20 2270   "n_samples": "p
+000033b0: 756c 7365 227d 0a0a 676c 6f62 616c 5f61  ulse"}..global_a
+000033c0: 7474 7273 203d 205b 0a20 2020 2028 2243  ttrs = [.    ("C
+000033d0: 6f6e 7665 6e74 696f 6e73 222c 2022 4366  onventions", "Cf
+000033e0: 2f52 6164 6961 6c22 292c 0a20 2020 2028  /Radial"),.    (
+000033f0: 2276 6572 7369 6f6e 222c 2022 4366 2f52  "version", "Cf/R
+00003400: 6164 6961 6c20 7665 7273 696f 6e20 6e75  adial version nu
+00003410: 6d62 6572 2229 2c0a 2020 2020 2822 7469  mber"),.    ("ti
+00003420: 746c 6522 2c20 2273 686f 7274 2064 6573  tle", "short des
+00003430: 6372 6970 7469 6f6e 206f 6620 6669 6c65  cription of file
+00003440: 2063 6f6e 7465 6e74 7322 292c 0a20 2020   contents"),.   
+00003450: 2028 2269 6e73 7469 7475 7469 6f6e 222c   ("institution",
+00003460: 2022 7768 6572 6520 7468 6520 6f72 6967   "where the orig
+00003470: 696e 616c 2064 6174 6120 7765 7265 2070  inal data were p
+00003480: 726f 6475 6365 6422 292c 0a20 2020 2028  roduced"),.    (
+00003490: 0a20 2020 2020 2020 2022 7265 6665 7265  .        "refere
+000034a0: 6e63 6573 222c 0a20 2020 2020 2020 2028  nces",.        (
+000034b0: 2272 6566 6572 656e 6365 7320 7468 6174  "references that
+000034c0: 2064 6573 6372 6962 6520 7468 6520 6461   describe the da
+000034d0: 7461 206f 7220 7468 6520 6d65 7468 6f64  ta or the method
+000034e0: 7320 7573 6564 2022 2022 746f 2070 726f  s used " "to pro
+000034f0: 6475 6365 2069 7422 292c 0a20 2020 2029  duce it"),.    )
+00003500: 2c0a 2020 2020 2822 736f 7572 6365 222c  ,.    ("source",
+00003510: 2022 6d65 7468 6f64 206f 6620 7072 6f64   "method of prod
+00003520: 7563 7469 6f6e 206f 6620 7468 6520 6f72  uction of the or
+00003530: 6967 696e 616c 2064 6174 6122 292c 0a20  iginal data"),. 
+00003540: 2020 2028 2268 6973 746f 7279 222c 2022     ("history", "
+00003550: 6c69 7374 206f 6620 6d6f 6469 6669 6361  list of modifica
+00003560: 7469 6f6e 7320 746f 2074 6865 206f 7269  tions to the ori
+00003570: 6769 6e61 6c20 6461 7461 2229 2c0a 2020  ginal data"),.  
+00003580: 2020 2822 636f 6d6d 656e 7422 2c20 226d    ("comment", "m
+00003590: 6973 6365 6c6c 616e 656f 7573 2069 6e66  iscellaneous inf
+000035a0: 6f72 6d61 7469 6f6e 2229 2c0a 2020 2020  ormation"),.    
+000035b0: 2822 696e 7374 7275 6d65 6e74 5f6e 616d  ("instrument_nam
+000035c0: 6522 2c20 226e 616d 6554 6865 2020 6f66  e", "nameThe  of
+000035d0: 2072 6164 6172 206f 7220 6c69 6461 7222   radar or lidar"
+000035e0: 292c 0a20 2020 2028 2273 6974 655f 6e61  ),.    ("site_na
+000035f0: 6d65 222c 2022 6e61 6d65 206f 6620 7369  me", "name of si
+00003600: 7465 2077 6865 7265 2064 6174 6120 7765  te where data we
+00003610: 7265 2067 6174 6865 7265 6422 292c 0a20  re gathered"),. 
+00003620: 2020 2028 2273 6361 6e5f 6e61 6d65 222c     ("scan_name",
+00003630: 2022 6e61 6d65 206f 6620 7363 616e 2073   "name of scan s
+00003640: 7472 6174 6567 7920 7573 6564 2c20 6966  trategy used, if
+00003650: 2061 7070 6c69 6361 626c 6522 292c 0a20   applicable"),. 
+00003660: 2020 2028 2273 6361 6e5f 6964 222c 2022     ("scan_id", "
+00003670: 7363 616e 2073 7472 6174 6567 7920 6964  scan strategy id
+00003680: 2c20 6966 2061 7070 6c69 6361 626c 652e  , if applicable.
+00003690: 2061 7373 756d 6564 2030 2069 6620 6d69   assumed 0 if mi
+000036a0: 7373 696e 6722 292c 0a20 2020 2028 2270  ssing"),.    ("p
+000036b0: 6c61 7466 6f72 6d5f 6973 5f6d 6f62 696c  latform_is_mobil
+000036c0: 6522 2c20 2722 7472 7565 2220 6f72 2022  e", '"true" or "
+000036d0: 6661 6c73 6522 2c20 6173 7375 6d65 6420  false", assumed 
+000036e0: 2266 616c 7365 2220 6966 206d 6973 7369  "false" if missi
+000036f0: 6e67 2729 2c0a 2020 2020 280a 2020 2020  ng'),.    (.    
+00003700: 2020 2020 2272 6179 5f74 696d 6573 5f69      "ray_times_i
+00003710: 6e63 7265 6173 6522 2c0a 2020 2020 2020  ncrease",.      
+00003720: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00003730: 2722 7472 7565 2220 6f72 2022 6661 6c73  '"true" or "fals
+00003740: 6522 2c20 6173 7375 6d65 6420 2274 7275  e", assumed "tru
+00003750: 6522 2069 6620 6d69 7373 696e 672e 2027  e" if missing. '
+00003760: 0a20 2020 2020 2020 2020 2020 2022 5468  .            "Th
+00003770: 6973 2069 7320 7365 7420 746f 2074 7275  is is set to tru
+00003780: 6520 6966 2072 6179 2074 696d 6573 2069  e if ray times i
+00003790: 6e63 7265 6173 6520 6d6f 6e6f 746f 6e69  ncrease monotoni
+000037a0: 6361 6c6c 7920 220a 2020 2020 2020 2020  cally ".        
+000037b0: 2020 2020 2274 686f 7567 686f 7574 2061      "thoughout a
+000037c0: 6c6c 206f 6620 7468 6520 7377 6565 7073  ll of the sweeps
+000037d0: 2069 6e20 7468 6520 766f 6c75 6d65 220a   in the volume".
+000037e0: 2020 2020 2020 2020 292c 0a20 2020 2029          ),.    )
+000037f0: 2c0a 2020 2020 2822 6669 656c 645f 6e61  ,.    ("field_na
+00003800: 6d65 7322 2c20 2261 7272 6179 206f 6620  mes", "array of 
+00003810: 7374 7269 6e67 7320 6f66 2066 6965 6c64  strings of field
+00003820: 206e 616d 6573 2070 7265 7365 6e74 2069   names present i
+00003830: 6e20 7468 6973 2066 696c 652e 2229 2c0a  n this file."),.
+00003840: 2020 2020 2822 7469 6d65 5f63 6f76 6572      ("time_cover
+00003850: 6167 655f 7374 6172 7422 2c20 2263 6f70  age_start", "cop
+00003860: 7920 6f66 2074 696d 655f 636f 7665 7261  y of time_covera
+00003870: 6765 5f73 7461 7274 2067 6c6f 6261 6c20  ge_start global 
+00003880: 7661 7269 6162 6c65 2229 2c0a 2020 2020  variable"),.    
+00003890: 2822 7469 6d65 5f63 6f76 6572 6167 655f  ("time_coverage_
+000038a0: 656e 6422 2c20 2263 6f70 7920 6f66 2074  end", "copy of t
+000038b0: 696d 655f 636f 7665 7261 6765 5f65 6e64  ime_coverage_end
+000038c0: 2067 6c6f 6261 6c20 7661 7269 6162 6c65   global variable
+000038d0: 2229 2c0a 2020 2020 280a 2020 2020 2020  "),.    (.      
+000038e0: 2020 2273 696d 756c 6174 6564 2064 6174    "simulated dat
+000038f0: 6122 2c0a 2020 2020 2020 2020 280a 2020  a",.        (.  
+00003900: 2020 2020 2020 2020 2020 2722 7472 7565            '"true
+00003910: 2220 6f72 2022 6661 6c73 6522 2c20 6173  " or "false", as
+00003920: 7375 6d65 6420 2266 616c 7365 2220 6966  sumed "false" if
+00003930: 206d 6973 7369 6e67 2e20 270a 2020 2020   missing. '.    
+00003940: 2020 2020 2020 2020 2264 6174 6120 696e          "data in
+00003950: 2074 6869 7320 6669 6c65 2061 7265 2073   this file are s
+00003960: 696d 756c 6174 6564 220a 2020 2020 2020  imulated".      
+00003970: 2020 292c 0a20 2020 2029 2c0a 5d0a 0a67    ),.    ),.]..g
+00003980: 6c6f 6261 6c5f 7661 7269 6162 6c65 7320  lobal_variables 
+00003990: 3d20 6469 6374 280a 2020 2020 5b0a 2020  = dict(.    [.  
+000039a0: 2020 2020 2020 2822 766f 6c75 6d65 5f6e        ("volume_n
+000039b0: 756d 6265 7222 2c20 6e70 2e69 6e74 5f29  umber", np.int_)
+000039c0: 2c0a 2020 2020 2020 2020 2822 706c 6174  ,.        ("plat
+000039d0: 666f 726d 5f74 7970 6522 2c20 2266 6978  form_type", "fix
+000039e0: 6564 2229 2c0a 2020 2020 2020 2020 2822  ed"),.        ("
+000039f0: 696e 7374 7275 6d65 6e74 5f74 7970 6522  instrument_type"
+00003a00: 2c20 2272 6164 6172 2229 2c0a 2020 2020  , "radar"),.    
+00003a10: 2020 2020 2822 7072 696d 6172 795f 6178      ("primary_ax
+00003a20: 6973 222c 2022 6178 6973 5f7a 2229 2c0a  is", "axis_z"),.
+00003a30: 2020 2020 2020 2020 2822 7469 6d65 5f63          ("time_c
+00003a40: 6f76 6572 6167 655f 7374 6172 7422 2c20  overage_start", 
+00003a50: 2231 3937 302d 3031 2d30 3154 3030 3a30  "1970-01-01T00:0
+00003a60: 303a 3030 5a22 292c 0a20 2020 2020 2020  0:00Z"),.       
+00003a70: 2028 2274 696d 655f 636f 7665 7261 6765   ("time_coverage
+00003a80: 5f65 6e64 222c 2022 3139 3730 2d30 312d  _end", "1970-01-
+00003a90: 3031 5430 303a 3030 3a30 305a 2229 2c0a  01T00:00:00Z"),.
+00003aa0: 2020 2020 2020 2020 2822 6c61 7469 7475          ("latitu
+00003ab0: 6465 222c 206e 702e 6e61 6e29 2c0a 2020  de", np.nan),.  
+00003ac0: 2020 2020 2020 2822 6c6f 6e67 6974 7564        ("longitud
+00003ad0: 6522 2c20 6e70 2e6e 616e 292c 0a20 2020  e", np.nan),.   
+00003ae0: 2020 2020 2028 2261 6c74 6974 7564 6522       ("altitude"
+00003af0: 2c20 6e70 2e6e 616e 292c 0a20 2020 2020  , np.nan),.     
+00003b00: 2020 2028 2261 6c74 6974 7564 655f 6167     ("altitude_ag
+00003b10: 6c22 2c20 6e70 2e6e 616e 292c 0a20 2020  l", np.nan),.   
+00003b20: 2020 2020 2028 2273 7765 6570 5f67 726f       ("sweep_gro
+00003b30: 7570 5f6e 616d 6522 2c20 285b 2273 7765  up_name", (["swe
+00003b40: 6570 225d 2c20 5b6e 702e 6e61 6e5d 2929  ep"], [np.nan]))
+00003b50: 2c0a 2020 2020 2020 2020 2822 7377 6565  ,.        ("swee
+00003b60: 705f 6669 7865 645f 616e 676c 6522 2c20  p_fixed_angle", 
+00003b70: 285b 2273 7765 6570 225d 2c20 5b6e 702e  (["sweep"], [np.
+00003b80: 6e61 6e5d 2929 2c0a 2020 2020 2020 2020  nan])),.        
+00003b90: 2822 6672 6571 7565 6e63 7922 2c20 6e70  ("frequency", np
+00003ba0: 2e6e 616e 292c 0a20 2020 2020 2020 2028  .nan),.        (
+00003bb0: 2273 7461 7475 735f 786d 6c22 2c20 224e  "status_xml", "N
+00003bc0: 6f6e 6522 292c 0a20 2020 205d 0a29 0a0a  one"),.    ].)..
+00003bd0: 0a40 7872 2e72 6567 6973 7465 725f 6461  .@xr.register_da
+00003be0: 7461 7365 745f 6163 6365 7373 6f72 2822  taset_accessor("
+00003bf0: 6761 6d69 6322 290a 636c 6173 7320 4761  gamic").class Ga
+00003c00: 6d69 6341 6363 6573 736f 7228 6f62 6a65  micAccessor(obje
+00003c10: 6374 293a 0a20 2020 2022 2222 4461 7461  ct):.    """Data
+00003c20: 7365 7420 4163 6365 7373 6f72 2066 6f72  set Accessor for
+00003c30: 2068 616e 646c 696e 6720 4741 4d49 4320   handling GAMIC 
+00003c40: 4844 4635 2064 6174 6120 6669 6c65 7322  HDF5 data files"
+00003c50: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+00003c60: 6974 5f5f 2873 656c 662c 2078 6172 7261  it__(self, xarra
+00003c70: 795f 6f62 6a29 3a0a 2020 2020 2020 2020  y_obj):.        
+00003c80: 7365 6c66 2e5f 6f62 6a20 3d20 7861 7272  self._obj = xarr
+00003c90: 6179 5f6f 626a 0a20 2020 2020 2020 2073  ay_obj.        s
+00003ca0: 656c 662e 5f72 6164 6961 6c5f 7261 6e67  elf._radial_rang
+00003cb0: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
+00003cc0: 2073 656c 662e 5f61 7a69 6d75 7468 5f72   self._azimuth_r
+00003cd0: 616e 6765 203d 204e 6f6e 650a 2020 2020  ange = None.    
+00003ce0: 2020 2020 7365 6c66 2e5f 656c 6576 6174      self._elevat
+00003cf0: 696f 6e5f 7261 6e67 6520 3d20 4e6f 6e65  ion_range = None
+00003d00: 0a20 2020 2020 2020 2073 656c 662e 5f74  .        self._t
+00003d10: 696d 655f 7261 6e67 6520 3d20 4e6f 6e65  ime_range = None
+00003d20: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+00003d30: 6974 6563 6f6f 7264 7320 3d20 4e6f 6e65  itecoords = None
+00003d40: 0a20 2020 2020 2020 2073 656c 662e 5f70  .        self._p
+00003d50: 6f6c 636f 6f72 6473 203d 204e 6f6e 650a  olcoords = None.
+00003d60: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
+00003d70: 6f6a 6563 7469 6f6e 203d 204e 6f6e 650a  ojection = None.
+00003d80: 2020 2020 2020 2020 7365 6c66 2e5f 7469          self._ti
+00003d90: 6d65 203d 204e 6f6e 650a 0a20 2020 2040  me = None..    @
+00003da0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00003db0: 2072 6164 6961 6c5f 7261 6e67 6528 7365   radial_range(se
+00003dc0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00003dd0: 5265 7475 726e 2074 6865 2072 6164 6961  Return the radia
+00003de0: 6c20 7261 6e67 6520 6f66 2074 6869 7320  l range of this 
+00003df0: 6461 7461 7365 742e 2222 220a 2020 2020  dataset.""".    
+00003e00: 2020 2020 6966 2073 656c 662e 5f72 6164      if self._rad
+00003e10: 6961 6c5f 7261 6e67 6520 6973 204e 6f6e  ial_range is Non
+00003e20: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
+00003e30: 6761 7465 7320 3d20 7365 6c66 2e5f 6f62  gates = self._ob
+00003e40: 6a2e 6174 7472 735b 2262 696e 5f63 6f75  j.attrs["bin_cou
+00003e50: 6e74 225d 0a20 2020 2020 2020 2020 2020  nt"].           
+00003e60: 2023 2072 616e 6765 5f73 7461 7274 203d   # range_start =
+00003e70: 2073 656c 662e 5f6f 626a 2e61 7474 7273   self._obj.attrs
+00003e80: 5b27 7261 6e67 655f 7374 6172 7427 5d0a  ['range_start'].
+00003e90: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
+00003ea0: 655f 7361 6d70 6c65 7320 3d20 7365 6c66  e_samples = self
+00003eb0: 2e5f 6f62 6a2e 6174 7472 735b 2272 616e  ._obj.attrs["ran
+00003ec0: 6765 5f73 616d 706c 6573 225d 0a20 2020  ge_samples"].   
+00003ed0: 2020 2020 2020 2020 2072 616e 6765 5f73           range_s
+00003ee0: 7465 7020 3d20 7365 6c66 2e5f 6f62 6a2e  tep = self._obj.
+00003ef0: 6174 7472 735b 2272 616e 6765 5f73 7465  attrs["range_ste
+00003f00: 7022 5d0a 2020 2020 2020 2020 2020 2020  p"].            
+00003f10: 6269 6e5f 7261 6e67 6520 3d20 7261 6e67  bin_range = rang
+00003f20: 655f 7374 6570 202a 2072 616e 6765 5f73  e_step * range_s
+00003f30: 616d 706c 6573 0a20 2020 2020 2020 2020  amples.         
+00003f40: 2020 2072 616e 6765 5f64 6174 6120 3d20     range_data = 
+00003f50: 6e70 2e61 7261 6e67 6528 0a20 2020 2020  np.arange(.     
+00003f60: 2020 2020 2020 2020 2020 2062 696e 5f72             bin_r
+00003f70: 616e 6765 202f 2032 2e30 2c20 6269 6e5f  ange / 2.0, bin_
+00003f80: 7261 6e67 6520 2a20 6e67 6174 6573 2c20  range * ngates, 
+00003f90: 6269 6e5f 7261 6e67 652c 2064 7479 7065  bin_range, dtype
+00003fa0: 3d22 666c 6f61 7433 3222 0a20 2020 2020  ="float32".     
+00003fb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00003fc0: 2020 2020 2072 616e 6765 5f61 7474 7273       range_attrs
+00003fd0: 5b22 6d65 7465 7273 5f74 6f5f 6365 6e74  ["meters_to_cent
+00003fe0: 6572 5f6f 665f 6669 7273 745f 6761 7465  er_of_first_gate
+00003ff0: 225d 203d 2062 696e 5f72 616e 6765 202f  "] = bin_range /
+00004000: 2032 2e30 0a20 2020 2020 2020 2020 2020   2.0.           
+00004010: 2064 6120 3d20 7872 2e44 6174 6141 7272   da = xr.DataArr
+00004020: 6179 2872 616e 6765 5f64 6174 612c 2064  ay(range_data, d
+00004030: 696d 733d 5b22 6469 6d5f 3122 5d2c 2061  ims=["dim_1"], a
+00004040: 7474 7273 3d72 616e 6765 5f61 7474 7273  ttrs=range_attrs
+00004050: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004060: 6c66 2e5f 7261 6469 616c 5f72 616e 6765  lf._radial_range
+00004070: 203d 2064 610a 2020 2020 2020 2020 7265   = da.        re
+00004080: 7475 726e 2073 656c 662e 5f72 6164 6961  turn self._radia
+00004090: 6c5f 7261 6e67 650a 0a20 2020 2040 7072  l_range..    @pr
+000040a0: 6f70 6572 7479 0a20 2020 2064 6566 2061  operty.    def a
+000040b0: 7a69 6d75 7468 5f72 616e 6765 2873 656c  zimuth_range(sel
+000040c0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+000040d0: 6574 7572 6e20 7468 6520 617a 696d 7574  eturn the azimut
+000040e0: 6820 7261 6e67 6520 6f66 2074 6869 7320  h range of this 
+000040f0: 6461 7461 7365 742e 2222 220a 2020 2020  dataset.""".    
+00004100: 2020 2020 6966 2073 656c 662e 5f61 7a69      if self._azi
+00004110: 6d75 7468 5f72 616e 6765 2069 7320 4e6f  muth_range is No
+00004120: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00004130: 617a 7374 6172 7420 3d20 7365 6c66 2e5f  azstart = self._
+00004140: 6f62 6a5b 2261 7a69 6d75 7468 5f73 7461  obj["azimuth_sta
+00004150: 7274 225d 0a20 2020 2020 2020 2020 2020  rt"].           
+00004160: 2061 7a73 746f 7020 3d20 7365 6c66 2e5f   azstop = self._
+00004170: 6f62 6a5b 2261 7a69 6d75 7468 5f73 746f  obj["azimuth_sto
+00004180: 7022 5d0a 2020 2020 2020 2020 2020 2020  p"].            
+00004190: 7a65 726f 5f69 6e64 6578 203d 206e 702e  zero_index = np.
+000041a0: 7768 6572 6528 617a 7374 6f70 203c 2061  where(azstop < a
+000041b0: 7a73 7461 7274 290a 2020 2020 2020 2020  zstart).        
+000041c0: 2020 2020 617a 7374 6f70 5b7a 6572 6f5f      azstop[zero_
+000041d0: 696e 6465 785b 305d 5d20 2b3d 2033 3630  index[0]] += 360
+000041e0: 0a20 2020 2020 2020 2020 2020 2061 7a69  .            azi
+000041f0: 6d75 7468 203d 2028 617a 7374 6172 7420  muth = (azstart 
+00004200: 2b20 617a 7374 6f70 2920 2f20 322e 300a  + azstop) / 2.0.
+00004210: 2020 2020 2020 2020 2020 2020 617a 696d              azim
+00004220: 7574 6820 3d20 617a 696d 7574 682e 6173  uth = azimuth.as
+00004230: 7369 676e 5f61 7474 7273 2861 7a5f 6174  sign_attrs(az_at
+00004240: 7472 7329 0a20 2020 2020 2020 2020 2020  trs).           
+00004250: 2073 656c 662e 5f61 7a69 6d75 7468 5f72   self._azimuth_r
+00004260: 616e 6765 203d 2061 7a69 6d75 7468 0a20  ange = azimuth. 
+00004270: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00004280: 6c66 2e5f 617a 696d 7574 685f 7261 6e67  lf._azimuth_rang
+00004290: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+000042a0: 0a20 2020 2064 6566 2065 6c65 7661 7469  .    def elevati
+000042b0: 6f6e 5f72 616e 6765 2873 656c 6629 3a0a  on_range(self):.
+000042c0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000042d0: 6e20 7468 6520 656c 6576 6174 696f 6e20  n the elevation 
+000042e0: 7261 6e67 6520 6f66 2074 6869 7320 6461  range of this da
+000042f0: 7461 7365 742e 2222 220a 2020 2020 2020  taset.""".      
+00004300: 2020 6966 2073 656c 662e 5f65 6c65 7661    if self._eleva
+00004310: 7469 6f6e 5f72 616e 6765 2069 7320 4e6f  tion_range is No
+00004320: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00004330: 656c 7374 6172 7420 3d20 7365 6c66 2e5f  elstart = self._
+00004340: 6f62 6a5b 2265 6c65 7661 7469 6f6e 5f73  obj["elevation_s
+00004350: 7461 7274 225d 0a20 2020 2020 2020 2020  tart"].         
+00004360: 2020 2065 6c73 746f 7020 3d20 7365 6c66     elstop = self
+00004370: 2e5f 6f62 6a5b 2265 6c65 7661 7469 6f6e  ._obj["elevation
+00004380: 5f73 746f 7022 5d0a 2020 2020 2020 2020  _stop"].        
+00004390: 2020 2020 656c 6576 6174 696f 6e20 3d20      elevation = 
+000043a0: 2865 6c73 7461 7274 202b 2065 6c73 746f  (elstart + elsto
+000043b0: 7029 202f 2032 2e30 0a20 2020 2020 2020  p) / 2.0.       
+000043c0: 2020 2020 2065 6c65 7661 7469 6f6e 203d       elevation =
+000043d0: 2065 6c65 7661 7469 6f6e 2e61 7373 6967   elevation.assig
+000043e0: 6e5f 6174 7472 7328 656c 5f61 7474 7273  n_attrs(el_attrs
+000043f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004400: 6c66 2e5f 656c 6576 6174 696f 6e5f 7261  lf._elevation_ra
+00004410: 6e67 6520 3d20 656c 6576 6174 696f 6e0a  nge = elevation.
+00004420: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004430: 656c 662e 5f65 6c65 7661 7469 6f6e 5f72  elf._elevation_r
+00004440: 616e 6765 0a0a 2020 2020 4070 726f 7065  ange..    @prope
+00004450: 7274 790a 2020 2020 6465 6620 7469 6d65  rty.    def time
+00004460: 5f72 616e 6765 2873 656c 6629 3a0a 2020  _range(self):.  
+00004470: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00004480: 7468 6520 7469 6d65 2072 616e 6765 206f  the time range o
+00004490: 6620 7468 6973 2064 6174 6173 6574 2e22  f this dataset."
+000044a0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+000044b0: 6c66 2e5f 7469 6d65 5f72 616e 6765 2069  lf._time_range i
+000044c0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000044d0: 2020 2020 7469 6d65 7320 3d20 7365 6c66      times = self
+000044e0: 2e5f 6f62 6a5b 2274 696d 6573 7461 6d70  ._obj["timestamp
+000044f0: 225d 202f 2031 6536 0a20 2020 2020 2020  "] / 1e6.       
+00004500: 2020 2020 2061 7474 7273 203d 207b 0a20       attrs = {. 
+00004510: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00004520: 756e 6974 7322 3a20 2273 6563 6f6e 6473  units": "seconds
+00004530: 2073 696e 6365 2031 3937 302d 3031 2d30   since 1970-01-0
+00004540: 3154 3030 3a30 303a 3030 5a22 2c0a 2020  1T00:00:00Z",.  
+00004550: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+00004560: 7461 6e64 6172 645f 6e61 6d65 223a 2022  tandard_name": "
+00004570: 7469 6d65 222c 0a20 2020 2020 2020 2020  time",.         
+00004580: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00004590: 2064 6120 3d20 7872 2e44 6174 6141 7272   da = xr.DataArr
+000045a0: 6179 2874 696d 6573 2c20 6174 7472 733d  ay(times, attrs=
+000045b0: 6174 7472 7329 0a20 2020 2020 2020 2020  attrs).         
+000045c0: 2020 2073 656c 662e 5f74 696d 655f 7261     self._time_ra
+000045d0: 6e67 6520 3d20 6461 0a20 2020 2020 2020  nge = da.       
+000045e0: 2072 6574 7572 6e20 7365 6c66 2e5f 7469   return self._ti
+000045f0: 6d65 5f72 616e 6765 0a0a 0a40 7872 2e72  me_range...@xr.r
+00004600: 6567 6973 7465 725f 6461 7461 7365 745f  egister_dataset_
+00004610: 6163 6365 7373 6f72 2822 6f64 696d 2229  accessor("odim")
+00004620: 0a63 6c61 7373 204f 6469 6d41 6363 6573  .class OdimAcces
+00004630: 736f 7228 6f62 6a65 6374 293a 0a20 2020  sor(object):.   
+00004640: 2022 2222 4461 7461 7365 7420 4163 6365   """Dataset Acce
+00004650: 7373 6f72 2066 6f72 2068 616e 646c 696e  ssor for handlin
+00004660: 6720 4f44 494d 5f48 3520 6461 7461 2066  g ODIM_H5 data f
+00004670: 696c 6573 2222 220a 0a20 2020 2064 6566  iles"""..    def
+00004680: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00004690: 7861 7272 6179 5f6f 626a 293a 0a20 2020  xarray_obj):.   
+000046a0: 2020 2020 2073 656c 662e 5f6f 626a 203d       self._obj =
+000046b0: 2078 6172 7261 795f 6f62 6a0a 2020 2020   xarray_obj.    
+000046c0: 2020 2020 7365 6c66 2e5f 7261 6469 616c      self._radial
+000046d0: 5f72 616e 6765 203d 204e 6f6e 650a 2020  _range = None.  
+000046e0: 2020 2020 2020 7365 6c66 2e5f 617a 696d        self._azim
+000046f0: 7574 685f 7261 6e67 6520 3d20 4e6f 6e65  uth_range = None
+00004700: 0a20 2020 2020 2020 2073 656c 662e 5f65  .        self._e
+00004710: 6c65 7661 7469 6f6e 5f72 616e 6765 203d  levation_range =
+00004720: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+00004730: 6c66 2e5f 7469 6d65 5f72 616e 6765 203d  lf._time_range =
+00004740: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+00004750: 6c66 2e5f 7469 6d65 5f72 616e 6765 3220  lf._time_range2 
+00004760: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00004770: 656c 662e 5f70 7274 203d 204e 6f6e 650a  elf._prt = None.
+00004780: 2020 2020 2020 2020 7365 6c66 2e5f 6e5f          self._n_
+00004790: 7361 6d70 6c65 7320 3d20 4e6f 6e65 0a0a  samples = None..
+000047a0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000047b0: 2020 6465 6620 7261 6469 616c 5f72 616e    def radial_ran
+000047c0: 6765 2873 656c 6629 3a0a 2020 2020 2020  ge(self):.      
+000047d0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+000047e0: 7261 6469 616c 2072 616e 6765 206f 6620  radial range of 
+000047f0: 7468 6973 2064 6174 6173 6574 2e22 2222  this dataset."""
+00004800: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00004810: 2e5f 7261 6469 616c 5f72 616e 6765 2069  ._radial_range i
+00004820: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00004830: 2020 2020 6e67 6174 6573 203d 2073 656c      ngates = sel
+00004840: 662e 5f6f 626a 2e61 7474 7273 5b22 6e62  f._obj.attrs["nb
+00004850: 696e 7322 5d0a 2020 2020 2020 2020 2020  ins"].          
+00004860: 2020 7261 6e67 655f 7374 6172 7420 3d20    range_start = 
+00004870: 7365 6c66 2e5f 6f62 6a2e 6174 7472 735b  self._obj.attrs[
+00004880: 2272 7374 6172 7422 5d20 2a20 3130 3030  "rstart"] * 1000
+00004890: 2e30 0a20 2020 2020 2020 2020 2020 2062  .0.            b
+000048a0: 696e 5f72 616e 6765 203d 2073 656c 662e  in_range = self.
+000048b0: 5f6f 626a 2e61 7474 7273 5b22 7273 6361  _obj.attrs["rsca
+000048c0: 6c65 225d 0a20 2020 2020 2020 2020 2020  le"].           
+000048d0: 2063 656e 745f 6669 7273 7420 3d20 7261   cent_first = ra
+000048e0: 6e67 655f 7374 6172 7420 2b20 6269 6e5f  nge_start + bin_
+000048f0: 7261 6e67 6520 2f20 322e 300a 2020 2020  range / 2.0.    
+00004900: 2020 2020 2020 2020 7261 6e67 655f 6461          range_da
+00004910: 7461 203d 206e 702e 6172 616e 6765 280a  ta = np.arange(.
+00004920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004930: 6365 6e74 5f66 6972 7374 2c20 7261 6e67  cent_first, rang
+00004940: 655f 7374 6172 7420 2b20 6269 6e5f 7261  e_start + bin_ra
+00004950: 6e67 6520 2a20 6e67 6174 6573 2c20 6269  nge * ngates, bi
+00004960: 6e5f 7261 6e67 652c 2064 7479 7065 3d22  n_range, dtype="
+00004970: 666c 6f61 7433 3222 0a20 2020 2020 2020  float32".       
+00004980: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00004990: 2020 2072 616e 6765 5f61 7474 7273 5b22     range_attrs["
+000049a0: 6d65 7465 7273 5f74 6f5f 6365 6e74 6572  meters_to_center
+000049b0: 5f6f 665f 6669 7273 745f 6761 7465 225d  _of_first_gate"]
+000049c0: 203d 2063 656e 745f 6669 7273 740a 2020   = cent_first.  
+000049d0: 2020 2020 2020 2020 2020 7261 6e67 655f            range_
+000049e0: 6174 7472 735b 226d 6574 6572 735f 6265  attrs["meters_be
+000049f0: 7477 6565 6e5f 6761 7465 7322 5d20 3d20  tween_gates"] = 
+00004a00: 6269 6e5f 7261 6e67 650a 0a20 2020 2020  bin_range..     
+00004a10: 2020 2020 2020 2064 6120 3d20 7872 2e44         da = xr.D
+00004a20: 6174 6141 7272 6179 2872 616e 6765 5f64  ataArray(range_d
+00004a30: 6174 612c 2064 696d 733d 5b22 6469 6d5f  ata, dims=["dim_
+00004a40: 3122 5d2c 2061 7474 7273 3d72 616e 6765  1"], attrs=range
+00004a50: 5f61 7474 7273 290a 2020 2020 2020 2020  _attrs).        
+00004a60: 2020 2020 7365 6c66 2e5f 7261 6469 616c      self._radial
+00004a70: 5f72 616e 6765 203d 2064 610a 2020 2020  _range = da.    
+00004a80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00004a90: 5f72 6164 6961 6c5f 7261 6e67 650a 0a20  _radial_range.. 
+00004aa0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00004ab0: 2064 6566 2061 7a69 6d75 7468 5f72 616e   def azimuth_ran
+00004ac0: 6765 3228 7365 6c66 293a 0a20 2020 2020  ge2(self):.     
+00004ad0: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
+00004ae0: 2061 7a69 6d75 7468 2072 616e 6765 206f   azimuth range o
+00004af0: 6620 7468 6973 2064 6174 6173 6574 2e22  f this dataset."
+00004b00: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+00004b10: 6c66 2e5f 617a 696d 7574 685f 7261 6e67  lf._azimuth_rang
+00004b20: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00004b30: 2020 2020 2020 206e 7261 7973 203d 2073         nrays = s
+00004b40: 656c 662e 5f6f 626a 2e61 7474 7273 5b22  elf._obj.attrs["
+00004b50: 6e72 6179 7322 5d0a 2020 2020 2020 2020  nrays"].        
+00004b60: 2020 2020 7265 7320 3d20 3336 302e 3020      res = 360.0 
+00004b70: 2f20 6e72 6179 730a 2020 2020 2020 2020  / nrays.        
+00004b80: 2020 2020 617a 696d 7574 685f 6461 7461      azimuth_data
+00004b90: 203d 206e 702e 6172 616e 6765 2872 6573   = np.arange(res
+00004ba0: 202f 2032 2e30 2c20 3336 302e 302c 2072   / 2.0, 360.0, r
+00004bb0: 6573 2c20 6474 7970 653d 2266 6c6f 6174  es, dtype="float
+00004bc0: 3332 2229 0a0a 2020 2020 2020 2020 2020  32")..          
+00004bd0: 2020 6461 203d 2078 722e 4461 7461 4172    da = xr.DataAr
+00004be0: 7261 7928 617a 696d 7574 685f 6461 7461  ray(azimuth_data
+00004bf0: 2c20 6469 6d73 3d5b 2264 696d 5f30 225d  , dims=["dim_0"]
+00004c00: 2c20 6174 7472 733d 617a 5f61 7474 7273  , attrs=az_attrs
+00004c10: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004c20: 6c66 2e5f 617a 696d 7574 685f 7261 6e67  lf._azimuth_rang
+00004c30: 6520 3d20 6461 0a20 2020 2020 2020 2072  e = da.        r
+00004c40: 6574 7572 6e20 7365 6c66 2e5f 617a 696d  eturn self._azim
+00004c50: 7574 685f 7261 6e67 650a 0a20 2020 2040  uth_range..    @
+00004c60: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00004c70: 2061 7a69 6d75 7468 5f72 616e 6765 2873   azimuth_range(s
+00004c80: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00004c90: 2252 6574 7572 6e20 7468 6520 617a 696d  "Return the azim
+00004ca0: 7574 6820 7261 6e67 6520 6f66 2074 6869  uth range of thi
+00004cb0: 7320 6461 7461 7365 742e 2222 220a 2020  s dataset.""".  
+00004cc0: 2020 2020 2020 6966 2073 656c 662e 5f61        if self._a
+00004cd0: 7a69 6d75 7468 5f72 616e 6765 2069 7320  zimuth_range is 
+00004ce0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00004cf0: 2020 7374 6172 7461 7a20 3d20 7365 6c66    startaz = self
+00004d00: 2e5f 6f62 6a2e 6174 7472 735b 2273 7461  ._obj.attrs["sta
+00004d10: 7274 617a 4122 5d0a 2020 2020 2020 2020  rtazA"].        
+00004d20: 2020 2020 7374 6f70 617a 203d 2073 656c      stopaz = sel
+00004d30: 662e 5f6f 626a 2e61 7474 7273 5b22 7374  f._obj.attrs["st
+00004d40: 6f70 617a 4122 5d0a 2020 2020 2020 2020  opazA"].        
+00004d50: 2020 2020 7a65 726f 5f69 6e64 6578 203d      zero_index =
+00004d60: 206e 702e 7768 6572 6528 7374 6f70 617a   np.where(stopaz
+00004d70: 203c 2073 7461 7274 617a 290a 2020 2020   < startaz).    
+00004d80: 2020 2020 2020 2020 7374 6f70 617a 5b7a          stopaz[z
+00004d90: 6572 6f5f 696e 6465 785b 305d 5d20 2b3d  ero_index[0]] +=
+00004da0: 2033 3630 0a20 2020 2020 2020 2020 2020   360.           
+00004db0: 2061 7a69 6d75 7468 5f64 6174 6120 3d20   azimuth_data = 
+00004dc0: 2873 7461 7274 617a 202b 2073 746f 7061  (startaz + stopa
+00004dd0: 7a29 202f 2032 2e30 0a20 2020 2020 2020  z) / 2.0.       
+00004de0: 2020 2020 2064 6120 3d20 7872 2e44 6174       da = xr.Dat
+00004df0: 6141 7272 6179 2861 7a69 6d75 7468 5f64  aArray(azimuth_d
+00004e00: 6174 612c 2061 7474 7273 3d61 7a5f 6174  ata, attrs=az_at
+00004e10: 7472 7329 0a20 2020 2020 2020 2020 2020  trs).           
+00004e20: 2073 656c 662e 5f61 7a69 6d75 7468 5f72   self._azimuth_r
+00004e30: 616e 6765 203d 2064 610a 2020 2020 2020  ange = da.      
+00004e40: 2020 7265 7475 726e 2073 656c 662e 5f61    return self._a
+00004e50: 7a69 6d75 7468 5f72 616e 6765 0a0a 2020  zimuth_range..  
+00004e60: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00004e70: 6465 6620 656c 6576 6174 696f 6e5f 7261  def elevation_ra
+00004e80: 6e67 6532 2873 656c 6629 3a0a 2020 2020  nge2(self):.    
+00004e90: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+00004ea0: 6520 656c 6576 6174 696f 6e20 7261 6e67  e elevation rang
+00004eb0: 6520 6f66 2074 6869 7320 6461 7461 7365  e of this datase
+00004ec0: 742e 2222 220a 2020 2020 2020 2020 6966  t.""".        if
+00004ed0: 2073 656c 662e 5f65 6c65 7661 7469 6f6e   self._elevation
+00004ee0: 5f72 616e 6765 2069 7320 4e6f 6e65 3a0a  _range is None:.
+00004ef0: 2020 2020 2020 2020 2020 2020 6e72 6179              nray
+00004f00: 7320 3d20 7365 6c66 2e5f 6f62 6a2e 6174  s = self._obj.at
+00004f10: 7472 735b 226e 7261 7973 225d 0a20 2020  trs["nrays"].   
+00004f20: 2020 2020 2020 2020 2065 6c61 6e67 6c65           elangle
+00004f30: 203d 2073 656c 662e 5f6f 626a 2e61 7474   = self._obj.att
+00004f40: 7273 5b22 656c 616e 676c 6522 5d0a 2020  rs["elangle"].  
+00004f50: 2020 2020 2020 2020 2020 656c 6576 6174            elevat
+00004f60: 696f 6e5f 6461 7461 203d 206e 702e 6f6e  ion_data = np.on
+00004f70: 6573 286e 7261 7973 2c20 6474 7970 653d  es(nrays, dtype=
+00004f80: 2266 6c6f 6174 3332 2229 202a 2065 6c61  "float32") * ela
+00004f90: 6e67 6c65 0a20 2020 2020 2020 2020 2020  ngle.           
+00004fa0: 2064 6120 3d20 7872 2e44 6174 6141 7272   da = xr.DataArr
+00004fb0: 6179 2865 6c65 7661 7469 6f6e 5f64 6174  ay(elevation_dat
+00004fc0: 612c 2064 696d 733d 5b22 6469 6d5f 3022  a, dims=["dim_0"
+00004fd0: 5d2c 2061 7474 7273 3d65 6c5f 6174 7472  ], attrs=el_attr
+00004fe0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
+00004ff0: 656c 662e 5f65 6c65 7661 7469 6f6e 5f72  elf._elevation_r
+00005000: 616e 6765 203d 2064 610a 2020 2020 2020  ange = da.      
+00005010: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
+00005020: 6c65 7661 7469 6f6e 5f72 616e 6765 0a0a  levation_range..
+00005030: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00005040: 2020 6465 6620 656c 6576 6174 696f 6e5f    def elevation_
+00005050: 7261 6e67 6528 7365 6c66 293a 0a20 2020  range(self):.   
+00005060: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+00005070: 6865 2065 6c65 7661 7469 6f6e 2072 616e  he elevation ran
+00005080: 6765 206f 6620 7468 6973 2064 6174 6173  ge of this datas
+00005090: 6574 2e22 2222 0a20 2020 2020 2020 2069  et.""".        i
+000050a0: 6620 7365 6c66 2e5f 656c 6576 6174 696f  f self._elevatio
+000050b0: 6e5f 7261 6e67 6520 6973 204e 6f6e 653a  n_range is None:
+000050c0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+000050d0: 7274 656c 203d 2073 656c 662e 5f6f 626a  rtel = self._obj
+000050e0: 2e61 7474 7273 5b22 7374 6172 7465 6c41  .attrs["startelA
+000050f0: 225d 0a20 2020 2020 2020 2020 2020 2073  "].            s
+00005100: 746f 7065 6c20 3d20 7365 6c66 2e5f 6f62  topel = self._ob
+00005110: 6a2e 6174 7472 735b 2273 746f 7065 6c41  j.attrs["stopelA
+00005120: 225d 0a20 2020 2020 2020 2020 2020 2065  "].            e
+00005130: 6c65 7661 7469 6f6e 5f64 6174 6120 3d20  levation_data = 
+00005140: 2873 7461 7274 656c 202b 2073 746f 7065  (startel + stope
+00005150: 6c29 202f 2032 2e30 0a20 2020 2020 2020  l) / 2.0.       
+00005160: 2020 2020 2064 6120 3d20 7872 2e44 6174       da = xr.Dat
+00005170: 6141 7272 6179 2865 6c65 7661 7469 6f6e  aArray(elevation
+00005180: 5f64 6174 612c 2064 696d 733d 5b22 6469  _data, dims=["di
+00005190: 6d5f 3022 5d2c 2061 7474 7273 3d65 6c5f  m_0"], attrs=el_
+000051a0: 6174 7472 7329 0a20 2020 2020 2020 2020  attrs).         
+000051b0: 2020 2073 656c 662e 5f65 6c65 7661 7469     self._elevati
+000051c0: 6f6e 5f72 616e 6765 203d 2064 610a 2020  on_range = da.  
+000051d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000051e0: 662e 5f65 6c65 7661 7469 6f6e 5f72 616e  f._elevation_ran
+000051f0: 6765 0a0a 2020 2020 4070 726f 7065 7274  ge..    @propert
+00005200: 790a 2020 2020 6465 6620 7469 6d65 5f72  y.    def time_r
+00005210: 616e 6765 2873 656c 6629 3a0a 2020 2020  ange(self):.    
+00005220: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+00005230: 6520 7469 6d65 2072 616e 6765 206f 6620  e time range of 
+00005240: 7468 6973 2064 6174 6173 6574 2e22 2222  this dataset."""
+00005250: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00005260: 2e5f 7469 6d65 5f72 616e 6765 2069 7320  ._time_range is 
+00005270: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00005280: 2020 7374 6172 7454 203d 2073 656c 662e    startT = self.
+00005290: 5f6f 626a 2e61 7474 7273 5b22 7374 6172  _obj.attrs["star
+000052a0: 7461 7a54 225d 0a20 2020 2020 2020 2020  tazT"].         
+000052b0: 2020 2073 746f 7054 203d 2073 656c 662e     stopT = self.
+000052c0: 5f6f 626a 2e61 7474 7273 5b22 7374 6f70  _obj.attrs["stop
+000052d0: 617a 5422 5d0a 2020 2020 2020 2020 2020  azT"].          
+000052e0: 2020 7469 6d65 7320 3d20 2873 7461 7274    times = (start
+000052f0: 5420 2b20 7374 6f70 5429 202f 2032 2e30  T + stopT) / 2.0
+00005300: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005310: 662e 5f74 696d 655f 7261 6e67 6520 3d20  f._time_range = 
+00005320: 7469 6d65 730a 0a20 2020 2020 2020 2072  times..        r
+00005330: 6574 7572 6e20 7365 6c66 2e5f 7469 6d65  eturn self._time
+00005340: 5f72 616e 6765 0a0a 2020 2020 4070 726f  _range..    @pro
+00005350: 7065 7274 790a 2020 2020 6465 6620 7469  perty.    def ti
+00005360: 6d65 5f72 616e 6765 3228 7365 6c66 293a  me_range2(self):
+00005370: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00005380: 726e 2074 6865 2074 696d 6520 7261 6e67  rn the time rang
+00005390: 6520 6f66 2074 6869 7320 6461 7461 7365  e of this datase
+000053a0: 742e 2222 220a 2020 2020 2020 2020 6966  t.""".        if
+000053b0: 2073 656c 662e 5f74 696d 655f 7261 6e67   self._time_rang
+000053c0: 6532 2069 7320 4e6f 6e65 3a0a 2020 2020  e2 is None:.    
+000053d0: 2020 2020 2020 2020 7374 6172 7464 6174          startdat
+000053e0: 6520 3d20 7365 6c66 2e5f 6f62 6a2e 6174  e = self._obj.at
+000053f0: 7472 735b 2273 7461 7274 6461 7465 225d  trs["startdate"]
+00005400: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00005410: 7274 7469 6d65 203d 2073 656c 662e 5f6f  rttime = self._o
+00005420: 626a 2e61 7474 7273 5b22 7374 6172 7474  bj.attrs["startt
+00005430: 696d 6522 5d0a 2020 2020 2020 2020 2020  ime"].          
+00005440: 2020 656e 6464 6174 6520 3d20 7365 6c66    enddate = self
+00005450: 2e5f 6f62 6a2e 6174 7472 735b 2265 6e64  ._obj.attrs["end
+00005460: 6461 7465 225d 0a20 2020 2020 2020 2020  date"].         
+00005470: 2020 2065 6e64 7469 6d65 203d 2073 656c     endtime = sel
+00005480: 662e 5f6f 626a 2e61 7474 7273 5b22 656e  f._obj.attrs["en
+00005490: 6474 696d 6522 5d0a 0a20 2020 2020 2020  dtime"]..       
+000054a0: 2020 2020 2073 7461 7274 203d 2064 742e       start = dt.
+000054b0: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
+000054c0: 6528 7374 6172 7464 6174 6520 2b20 7374  e(startdate + st
+000054d0: 6172 7474 696d 652c 2022 2559 256d 2564  arttime, "%Y%m%d
+000054e0: 2548 254d 2553 2229 0a20 2020 2020 2020  %H%M%S").       
+000054f0: 2020 2020 2065 6e64 203d 2064 742e 6461       end = dt.da
+00005500: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
+00005510: 656e 6464 6174 6520 2b20 656e 6474 696d  enddate + endtim
+00005520: 652c 2022 2559 256d 2564 2548 254d 2553  e, "%Y%m%d%H%M%S
+00005530: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
+00005540: 7461 7274 203d 2073 7461 7274 2e72 6570  tart = start.rep
+00005550: 6c61 6365 2874 7a69 6e66 6f3d 6474 2e74  lace(tzinfo=dt.t
+00005560: 696d 657a 6f6e 652e 7574 6329 0a20 2020  imezone.utc).   
+00005570: 2020 2020 2020 2020 2065 6e64 203d 2065           end = e
+00005580: 6e64 2e72 6570 6c61 6365 2874 7a69 6e66  nd.replace(tzinf
+00005590: 6f3d 6474 2e74 696d 657a 6f6e 652e 7574  o=dt.timezone.ut
+000055a0: 6329 0a0a 2020 2020 2020 2020 2020 2020  c)..            
+000055b0: 7365 6c66 2e5f 7469 6d65 5f72 616e 6765  self._time_range
+000055c0: 3220 3d20 2873 7461 7274 2e74 696d 6573  2 = (start.times
+000055d0: 7461 6d70 2829 2c20 656e 642e 7469 6d65  tamp(), end.time
+000055e0: 7374 616d 7028 2929 0a20 2020 2020 2020  stamp()).       
+000055f0: 2072 6574 7572 6e20 7365 6c66 2e5f 7469   return self._ti
+00005600: 6d65 5f72 616e 6765 320a 0a20 2020 2040  me_range2..    @
+00005610: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00005620: 2070 7274 2873 656c 6629 3a0a 2020 2020   prt(self):.    
+00005630: 2020 2020 6966 2073 656c 662e 5f70 7274      if self._prt
+00005640: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00005650: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00005660: 2020 2020 2020 2020 2020 2070 7274 203d             prt =
+00005670: 2031 2e30 202f 2073 656c 662e 5f6f 626a   1.0 / self._obj
+00005680: 2e61 7474 7273 5b22 7072 6622 5d0a 2020  .attrs["prf"].  
+00005690: 2020 2020 2020 2020 2020 2020 2020 6461                da
+000056a0: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
+000056b0: 7072 742c 2064 696d 733d 5b22 6469 6d5f  prt, dims=["dim_
+000056c0: 3022 5d29 0a20 2020 2020 2020 2020 2020  0"]).           
+000056d0: 2020 2020 2073 656c 662e 5f70 7274 203d       self._prt =
+000056e0: 2064 610a 2020 2020 2020 2020 2020 2020   da.            
+000056f0: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
+00005700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005710: 2070 6173 730a 2020 2020 2020 2020 7265   pass.        re
+00005720: 7475 726e 2073 656c 662e 5f70 7274 0a0a  turn self._prt..
+00005730: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00005740: 2020 6465 6620 6e5f 7361 6d70 6c65 7328    def n_samples(
+00005750: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+00005760: 6620 7365 6c66 2e5f 6e5f 7361 6d70 6c65  f self._n_sample
+00005770: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+00005780: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00005790: 2020 2020 2020 2020 2020 2020 6461 203d              da =
+000057a0: 2078 722e 4461 7461 4172 7261 7928 7365   xr.DataArray(se
+000057b0: 6c66 2e5f 6f62 6a2e 6174 7472 735b 2270  lf._obj.attrs["p
+000057c0: 756c 7365 225d 2c20 6469 6d73 3d5b 2264  ulse"], dims=["d
+000057d0: 696d 5f30 225d 290a 2020 2020 2020 2020  im_0"]).        
+000057e0: 2020 2020 2020 2020 7365 6c66 2e5f 6e5f          self._n_
+000057f0: 7361 6d70 6c65 7320 3d20 6461 0a20 2020  samples = da.   
+00005800: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00005810: 4b65 7945 7272 6f72 3a0a 2020 2020 2020  KeyError:.      
+00005820: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+00005830: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00005840: 6c66 2e5f 6e5f 7361 6d70 6c65 730a 0a0a  lf._n_samples...
+00005850: 6465 6620 746f 5f63 6672 6164 6961 6c32  def to_cfradial2
+00005860: 2876 6f6c 756d 652c 2066 696c 656e 616d  (volume, filenam
+00005870: 652c 2074 696d 6573 7465 703d 4e6f 6e65  e, timestep=None
+00005880: 293a 0a20 2020 2022 2222 5361 7665 2058  ):.    """Save X
+00005890: 5261 6456 6f6c 2f58 5261 6456 6f6c 756d  RadVol/XRadVolum
+000058a0: 6520 746f 2043 6652 6164 6961 6c32 2e30  e to CfRadial2.0
+000058b0: 2063 6f6d 706c 6961 6e74 2066 696c 652e   compliant file.
+000058c0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000058d0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000058e0: 2020 2020 766f 6c75 6d65 203a 2058 5261      volume : XRa
+000058f0: 6456 6f6c 2f58 5261 6456 6f6c 756d 6520  dVol/XRadVolume 
+00005900: 6f62 6a65 6374 0a20 2020 2066 696c 656e  object.    filen
+00005910: 616d 6520 3a20 7374 720a 2020 2020 2020  ame : str.      
+00005920: 2020 6f75 7470 7574 2066 696c 656e 616d    output filenam
+00005930: 650a 2020 2020 7469 6d65 7374 6570 203a  e.    timestep :
+00005940: 2069 6e74 0a20 2020 2020 2020 2074 696d   int.        tim
+00005950: 6573 7465 7020 6f66 2077 616e 7465 6420  estep of wanted 
+00005960: 766f 6c75 6d65 0a20 2020 2022 2222 0a20  volume.    """. 
+00005970: 2020 2076 6f6c 756d 652e 726f 6f74 2e6c     volume.root.l
+00005980: 6f61 6428 290a 2020 2020 726f 6f74 203d  oad().    root =
+00005990: 2076 6f6c 756d 652e 726f 6f74 2e63 6f70   volume.root.cop
+000059a0: 7928 6465 6570 3d54 7275 6529 0a20 2020  y(deep=True).   
+000059b0: 2072 6f6f 742e 6174 7472 735b 2243 6f6e   root.attrs["Con
+000059c0: 7665 6e74 696f 6e73 225d 203d 2022 4366  ventions"] = "Cf
+000059d0: 2f52 6164 6961 6c22 0a20 2020 2072 6f6f  /Radial".    roo
+000059e0: 742e 6174 7472 735b 2276 6572 7369 6f6e  t.attrs["version
+000059f0: 225d 203d 2022 322e 3022 0a20 2020 2072  "] = "2.0".    r
+00005a00: 6f6f 742e 746f 5f6e 6574 6364 6628 6669  oot.to_netcdf(fi
+00005a10: 6c65 6e61 6d65 2c20 6d6f 6465 3d22 7722  lename, mode="w"
+00005a20: 2c20 6772 6f75 703d 222f 2229 0a20 2020  , group="/").   
+00005a30: 2066 6f72 2069 6478 2c20 6b65 7920 696e   for idx, key in
+00005a40: 2065 6e75 6d65 7261 7465 2872 6f6f 742e   enumerate(root.
+00005a50: 7377 6565 705f 6772 6f75 705f 6e61 6d65  sweep_group_name
+00005a60: 2e76 616c 7565 7329 3a0a 2020 2020 2020  .values):.      
+00005a70: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00005a80: 2020 2073 7770 203d 2076 6f6c 756d 655b     swp = volume[
+00005a90: 6b65 795d 0a20 2020 2020 2020 2065 7863  key].        exc
+00005aa0: 6570 7420 5479 7065 4572 726f 723a 0a20  ept TypeError:. 
+00005ab0: 2020 2020 2020 2020 2020 2073 7770 203d             swp =
+00005ac0: 2076 6f6c 756d 655b 6964 785d 5b74 696d   volume[idx][tim
+00005ad0: 6573 7465 705d 2e64 6174 610a 2020 2020  estep].data.    
+00005ae0: 2020 2020 7377 702e 6c6f 6164 2829 0a20      swp.load(). 
+00005af0: 2020 2020 2020 2064 696d 7320 3d20 6c69         dims = li
+00005b00: 7374 2873 7770 2e64 696d 7329 0a20 2020  st(swp.dims).   
+00005b10: 2020 2020 2064 696d 732e 7265 6d6f 7665       dims.remove
+00005b20: 2822 7261 6e67 6522 290a 2020 2020 2020  ("range").      
+00005b30: 2020 6469 6d30 203d 2064 696d 735b 305d    dim0 = dims[0]
+00005b40: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00005b50: 2020 2020 2020 2020 2020 7377 7020 3d20            swp = 
+00005b60: 7377 702e 7377 6170 5f64 696d 7328 7b64  swp.swap_dims({d
+00005b70: 696d 303a 2022 7469 6d65 227d 290a 2020  im0: "time"}).  
+00005b80: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+00005b90: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+00005ba0: 2020 2020 2073 7770 203d 2073 7770 2e64       swp = swp.d
+00005bb0: 726f 705f 7661 7273 2822 7469 6d65 2229  rop_vars("time")
+00005bc0: 2e72 656e 616d 6528 7b22 7274 696d 6522  .rename({"rtime"
+00005bd0: 3a20 2274 696d 6522 7d29 0a20 2020 2020  : "time"}).     
+00005be0: 2020 2020 2020 2073 7770 203d 2073 7770         swp = swp
+00005bf0: 2e73 7761 705f 6469 6d73 287b 6469 6d30  .swap_dims({dim0
+00005c00: 3a20 2274 696d 6522 7d29 0a20 2020 2020  : "time"}).     
+00005c10: 2020 2073 7770 2e64 726f 705f 7661 7273     swp.drop_vars
+00005c20: 285b 2278 222c 2022 7922 2c20 227a 222c  (["x", "y", "z",
+00005c30: 2022 6772 222c 2022 7261 7973 222c 2022   "gr", "rays", "
+00005c40: 6269 6e73 225d 2c20 6572 726f 7273 3d22  bins"], errors="
+00005c50: 6967 6e6f 7265 2229 0a20 2020 2020 2020  ignore").       
+00005c60: 2073 7770 2e74 6f5f 6e65 7463 6466 2866   swp.to_netcdf(f
+00005c70: 696c 656e 616d 652c 206d 6f64 653d 2261  ilename, mode="a
+00005c80: 222c 2067 726f 7570 3d6b 6579 290a 0a0a  ", group=key)...
+00005c90: 6465 6620 746f 5f6e 6574 6364 6628 766f  def to_netcdf(vo
+00005ca0: 6c75 6d65 2c20 6669 6c65 6e61 6d65 2c20  lume, filename, 
+00005cb0: 7469 6d65 7374 6570 3d4e 6f6e 652c 206b  timestep=None, k
+00005cc0: 6579 733d 4e6f 6e65 293a 0a20 2020 2022  eys=None):.    "
+00005cd0: 2222 5361 7665 2058 5261 6456 6f6c 756d  ""Save XRadVolum
+00005ce0: 6520 746f 206e 6574 6364 6620 636f 6d70  e to netcdf comp
+00005cf0: 6c69 616e 7420 6669 6c65 2e0a 0a20 2020  liant file...   
+00005d00: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00005d10: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2076  ----------.    v
+00005d20: 6f6c 756d 6520 3a20 5852 6164 566f 6c75  olume : XRadVolu
+00005d30: 6d65 206f 626a 6563 740a 2020 2020 6669  me object.    fi
+00005d40: 6c65 6e61 6d65 203a 2073 7472 0a20 2020  lename : str.   
+00005d50: 2020 2020 206f 7574 7075 7420 6669 6c65       output file
+00005d60: 6e61 6d65 0a20 2020 2074 696d 6573 7465  name.    timeste
+00005d70: 7020 3a20 696e 742c 2073 6c69 6365 0a20  p : int, slice. 
+00005d80: 2020 2020 2020 2074 696d 6573 7465 702f         timestep/
+00005d90: 736c 6963 6520 6f66 2077 616e 7465 6420  slice of wanted 
+00005da0: 766f 6c75 6d65 0a20 2020 206b 6579 7320  volume.    keys 
+00005db0: 3a20 6c69 7374 0a20 2020 2020 2020 206c  : list.        l
+00005dc0: 6973 7420 6f66 2073 7765 6570 5f67 726f  ist of sweep_gro
+00005dd0: 7570 5f6e 616d 6573 2077 6869 6368 2073  up_names which s
+00005de0: 686f 756c 6420 6265 2077 7269 7474 656e  hould be written
+00005df0: 2074 6f20 7468 6520 6669 6c65 0a20 2020   to the file.   
+00005e00: 2022 2222 0a20 2020 2076 6f6c 756d 652e   """.    volume.
+00005e10: 726f 6f74 2e6c 6f61 6428 290a 2020 2020  root.load().    
+00005e20: 726f 6f74 203d 2076 6f6c 756d 652e 726f  root = volume.ro
+00005e30: 6f74 2e63 6f70 7928 6465 6570 3d54 7275  ot.copy(deep=Tru
+00005e40: 6529 0a20 2020 2072 6f6f 742e 6174 7472  e).    root.attr
+00005e50: 735b 2243 6f6e 7665 6e74 696f 6e73 225d  s["Conventions"]
+00005e60: 203d 2022 4366 2f52 6164 6961 6c22 0a20   = "Cf/Radial". 
+00005e70: 2020 2072 6f6f 742e 6174 7472 735b 2276     root.attrs["v
+00005e80: 6572 7369 6f6e 225d 203d 2022 322e 3022  ersion"] = "2.0"
+00005e90: 0a20 2020 2072 6f6f 742e 746f 5f6e 6574  .    root.to_net
+00005ea0: 6364 6628 6669 6c65 6e61 6d65 2c20 6d6f  cdf(filename, mo
+00005eb0: 6465 3d22 7722 2c20 6772 6f75 703d 222f  de="w", group="/
+00005ec0: 2229 0a20 2020 2069 6620 6b65 7973 2069  ").    if keys i
+00005ed0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00005ee0: 6b65 7973 203d 2072 6f6f 742e 7377 6565  keys = root.swee
+00005ef0: 705f 6772 6f75 705f 6e61 6d65 2e76 616c  p_group_name.val
+00005f00: 7565 730a 2020 2020 666f 7220 6964 782c  ues.    for idx,
+00005f10: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
+00005f20: 6528 726f 6f74 2e73 7765 6570 5f67 726f  e(root.sweep_gro
+00005f30: 7570 5f6e 616d 652e 7661 6c75 6573 293a  up_name.values):
+00005f40: 0a20 2020 2020 2020 2069 6620 6b65 7920  .        if key 
+00005f50: 696e 206b 6579 733a 0a20 2020 2020 2020  in keys:.       
+00005f60: 2020 2020 2073 7770 203d 2076 6f6c 756d       swp = volum
+00005f70: 655b 6964 785d 2e64 6174 612e 6973 656c  e[idx].data.isel
+00005f80: 2874 696d 653d 7469 6d65 7374 6570 290a  (time=timestep).
+00005f90: 2020 2020 2020 2020 2020 2020 7377 702e              swp.
+00005fa0: 746f 5f6e 6574 6364 6628 6669 6c65 6e61  to_netcdf(filena
+00005fb0: 6d65 2c20 6d6f 6465 3d22 6122 2c20 6772  me, mode="a", gr
+00005fc0: 6f75 703d 6b65 7929 0a0a 0a64 6566 2074  oup=key)...def t
+00005fd0: 6f5f 6f64 696d 2876 6f6c 756d 652c 2066  o_odim(volume, f
+00005fe0: 696c 656e 616d 652c 2074 696d 6573 7465  ilename, timeste
+00005ff0: 703d 3029 3a0a 2020 2020 2222 2253 6176  p=0):.    """Sav
+00006000: 6520 5852 6164 566f 6c2f 5852 6164 566f  e XRadVol/XRadVo
+00006010: 6c75 6d65 2074 6f20 4f44 494d 5f48 352f  lume to ODIM_H5/
+00006020: 5632 5f32 2063 6f6d 706c 6961 6e74 2066  V2_2 compliant f
+00006030: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
+00006040: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00006050: 2d2d 2d0a 2020 2020 766f 6c75 6d65 203a  ---.    volume :
+00006060: 2058 5261 6456 6f6c 2f58 5261 6456 6f6c   XRadVol/XRadVol
+00006070: 756d 6520 6f62 6a65 6374 0a20 2020 2066  ume object.    f
+00006080: 696c 656e 616d 6520 3a20 7374 720a 2020  ilename : str.  
+00006090: 2020 2020 2020 6f75 7470 7574 2066 696c        output fil
+000060a0: 656e 616d 650a 2020 2020 7469 6d65 7374  ename.    timest
+000060b0: 6570 203a 2069 6e74 0a20 2020 2020 2020  ep : int.       
+000060c0: 2074 696d 6573 7465 7020 6f66 2077 616e   timestep of wan
+000060d0: 7465 6420 766f 6c75 6d65 0a20 2020 2022  ted volume.    "
+000060e0: 2222 0a20 2020 2072 6f6f 7420 3d20 766f  "".    root = vo
+000060f0: 6c75 6d65 2e72 6f6f 740a 0a20 2020 2068  lume.root..    h
+00006100: 3520 3d20 6835 7079 2e46 696c 6528 6669  5 = h5py.File(fi
+00006110: 6c65 6e61 6d65 2c20 2277 2229 0a0a 2020  lename, "w")..  
+00006120: 2020 2320 726f 6f74 2067 726f 7570 2c20    # root group, 
+00006130: 6f6e 6c79 2043 6f6e 7665 6e74 696f 6e73  only Conventions
+00006140: 2066 6f72 204f 4449 4d5f 4835 0a20 2020   for ODIM_H5.   
+00006150: 205f 7772 6974 655f 6f64 696d 287b 2243   _write_odim({"C
+00006160: 6f6e 7665 6e74 696f 6e73 223a 2022 4f44  onventions": "OD
+00006170: 494d 5f48 352f 5632 5f32 227d 2c20 6835  IM_H5/V2_2"}, h5
+00006180: 290a 0a20 2020 2023 2068 6f77 2067 726f  )..    # how gro
+00006190: 7570 0a20 2020 2068 6f77 203d 207b 7d0a  up.    how = {}.
+000061a0: 2020 2020 686f 772e 7570 6461 7465 287b      how.update({
+000061b0: 225f 6d6f 6469 6669 6361 7469 6f6e 5f70  "_modification_p
+000061c0: 726f 6772 616d 223a 2022 7772 6164 6c69  rogram": "wradli
+000061d0: 6222 7d29 0a0a 2020 2020 6835 5f68 6f77  b"})..    h5_how
+000061e0: 203d 2068 352e 6372 6561 7465 5f67 726f   = h5.create_gro
+000061f0: 7570 2822 686f 7722 290a 2020 2020 5f77  up("how").    _w
+00006200: 7269 7465 5f6f 6469 6d28 686f 772c 2068  rite_odim(how, h
+00006210: 355f 686f 7729 0a0a 2020 2020 7377 6565  5_how)..    swee
+00006220: 706e 616d 6573 203d 2072 6f6f 742e 7377  pnames = root.sw
+00006230: 6565 705f 6772 6f75 705f 6e61 6d65 2e76  eep_group_name.v
+00006240: 616c 7565 730a 0a20 2020 2023 2077 6861  alues..    # wha
+00006250: 7420 6772 6f75 702c 206f 626a 6563 742c  t group, object,
+00006260: 2076 6572 7369 6f6e 2c20 6461 7465 2c20   version, date, 
+00006270: 7469 6d65 2c20 736f 7572 6365 2c20 6d61  time, source, ma
+00006280: 6e64 6174 6f72 790a 2020 2020 2320 702e  ndatory.    # p.
+00006290: 2031 3020 660a 2020 2020 7768 6174 203d   10 f.    what =
+000062a0: 207b 7d0a 2020 2020 6966 206c 656e 2873   {}.    if len(s
+000062b0: 7765 6570 6e61 6d65 7329 203e 2031 3a0a  weepnames) > 1:.
+000062c0: 2020 2020 2020 2020 7768 6174 5b22 6f62          what["ob
+000062d0: 6a65 6374 225d 203d 2022 5056 4f4c 220a  ject"] = "PVOL".
+000062e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000062f0: 2020 7768 6174 5b22 6f62 6a65 6374 225d    what["object"]
+00006300: 203d 2022 5343 414e 220a 2020 2020 7768   = "SCAN".    wh
+00006310: 6174 5b22 7665 7273 696f 6e22 5d20 3d20  at["version"] = 
+00006320: 2248 3572 6164 2032 2e32 220a 2020 2020  "H5rad 2.2".    
+00006330: 7768 6174 5b22 6461 7465 225d 203d 2073  what["date"] = s
+00006340: 7472 2872 6f6f 742e 7469 6d65 5f63 6f76  tr(root.time_cov
+00006350: 6572 6167 655f 7374 6172 742e 7661 6c75  erage_start.valu
+00006360: 6573 295b 3a31 305d 2e72 6570 6c61 6365  es)[:10].replace
+00006370: 2822 2d22 2c20 2222 290a 2020 2020 7768  ("-", "").    wh
+00006380: 6174 5b22 7469 6d65 225d 203d 2073 7472  at["time"] = str
+00006390: 2872 6f6f 742e 7469 6d65 5f63 6f76 6572  (root.time_cover
+000063a0: 6167 655f 656e 642e 7661 6c75 6573 295b  age_end.values)[
+000063b0: 3131 3a31 395d 2e72 6570 6c61 6365 2822  11:19].replace("
+000063c0: 3a22 2c20 2222 290a 2020 2020 7768 6174  :", "").    what
+000063d0: 5b22 736f 7572 6365 225d 203d 2072 6f6f  ["source"] = roo
+000063e0: 742e 6174 7472 735b 2269 6e73 7472 756d  t.attrs["instrum
+000063f0: 656e 745f 6e61 6d65 225d 0a0a 2020 2020  ent_name"]..    
+00006400: 6835 5f77 6861 7420 3d20 6835 2e63 7265  h5_what = h5.cre
+00006410: 6174 655f 6772 6f75 7028 2277 6861 7422  ate_group("what"
+00006420: 290a 2020 2020 5f77 7269 7465 5f6f 6469  ).    _write_odi
+00006430: 6d28 7768 6174 2c20 6835 5f77 6861 7429  m(what, h5_what)
+00006440: 0a0a 2020 2020 2320 7768 6572 6520 6772  ..    # where gr
+00006450: 6f75 702c 206c 6f6e 2c20 6c61 742c 2068  oup, lon, lat, h
+00006460: 6569 6768 742c 206d 616e 6461 746f 7279  eight, mandatory
+00006470: 0a20 2020 2077 6865 7265 203d 207b 0a20  .    where = {. 
+00006480: 2020 2020 2020 2022 6c6f 6e22 3a20 726f         "lon": ro
+00006490: 6f74 2e6c 6f6e 6769 7475 6465 2e76 616c  ot.longitude.val
+000064a0: 7565 732c 0a20 2020 2020 2020 2022 6c61  ues,.        "la
+000064b0: 7422 3a20 726f 6f74 2e6c 6174 6974 7564  t": root.latitud
+000064c0: 652e 7661 6c75 6573 2c0a 2020 2020 2020  e.values,.      
+000064d0: 2020 2268 6569 6768 7422 3a20 726f 6f74    "height": root
+000064e0: 2e61 6c74 6974 7564 652e 7661 6c75 6573  .altitude.values
+000064f0: 2c0a 2020 2020 7d0a 2020 2020 6835 5f77  ,.    }.    h5_w
+00006500: 6865 7265 203d 2068 352e 6372 6561 7465  here = h5.create
+00006510: 5f67 726f 7570 2822 7768 6572 6522 290a  _group("where").
+00006520: 2020 2020 5f77 7269 7465 5f6f 6469 6d28      _write_odim(
+00006530: 7768 6572 652c 2068 355f 7768 6572 6529  where, h5_where)
+00006540: 0a0a 2020 2020 2320 6461 7461 7365 7473  ..    # datasets
+00006550: 0a20 2020 2064 735f 6c69 7374 203d 205b  .    ds_list = [
+00006560: 2264 6174 6173 6574 7b7d 222e 666f 726d  "dataset{}".form
+00006570: 6174 2869 202b 2031 2920 666f 7220 6920  at(i + 1) for i 
+00006580: 696e 2072 616e 6765 286c 656e 2873 7765  in range(len(swe
+00006590: 6570 6e61 6d65 7329 295d 0a20 2020 2064  epnames))].    d
+000065a0: 735f 6964 7820 3d20 6e70 2e61 7267 736f  s_idx = np.argso
+000065b0: 7274 2864 735f 6c69 7374 290a 2020 2020  rt(ds_list).    
+000065c0: 666f 7220 6964 7820 696e 2064 735f 6964  for idx in ds_id
+000065d0: 783a 0a20 2020 2020 2020 2074 7279 3a0a  x:.        try:.
+000065e0: 2020 2020 2020 2020 2020 2020 6473 203d              ds =
+000065f0: 2076 6f6c 756d 655b 2273 7765 6570 5f7b   volume["sweep_{
+00006600: 7d22 2e66 6f72 6d61 7428 6964 7820 2b20  }".format(idx + 
+00006610: 3129 5d0a 2020 2020 2020 2020 6578 6365  1)].        exce
+00006620: 7074 2054 7970 6545 7272 6f72 3a0a 2020  pt TypeError:.  
+00006630: 2020 2020 2020 2020 2020 6473 203d 2076            ds = v
+00006640: 6f6c 756d 655b 6964 785d 5b74 696d 6573  olume[idx][times
+00006650: 7465 705d 2e64 6174 610a 2020 2020 2020  tep].data.      
+00006660: 2020 6835 5f64 6174 6173 6574 203d 2068    h5_dataset = h
+00006670: 352e 6372 6561 7465 5f67 726f 7570 2864  5.create_group(d
+00006680: 735f 6c69 7374 5b69 6478 5d29 0a0a 2020  s_list[idx])..  
+00006690: 2020 2020 2020 2320 7768 6174 2067 726f        # what gro
+000066a0: 7570 2070 2e20 3231 2066 662e 0a20 2020  up p. 21 ff..   
+000066b0: 2020 2020 2068 355f 6473 5f77 6861 7420       h5_ds_what 
+000066c0: 3d20 6835 5f64 6174 6173 6574 2e63 7265  = h5_dataset.cre
+000066d0: 6174 655f 6772 6f75 7028 2277 6861 7422  ate_group("what"
+000066e0: 290a 2020 2020 2020 2020 6473 5f77 6861  ).        ds_wha
+000066f0: 7420 3d20 7b7d 0a20 2020 2020 2020 2023  t = {}.        #
+00006700: 2073 6b69 7020 4e61 5420 7661 6c75 6573   skip NaT values
+00006710: 0a20 2020 2020 2020 2076 616c 6964 5f74  .        valid_t
+00006720: 696d 6573 203d 207e 6e70 2e69 736e 6174  imes = ~np.isnat
+00006730: 2864 732e 7469 6d65 2e76 616c 7565 7329  (ds.time.values)
+00006740: 0a20 2020 2020 2020 2074 203d 2073 6f72  .        t = sor
+00006750: 7465 6428 6473 2e74 696d 652e 7661 6c75  ted(ds.time.valu
+00006760: 6573 5b76 616c 6964 5f74 696d 6573 5d29  es[valid_times])
+00006770: 0a20 2020 2020 2020 2073 7461 7274 203d  .        start =
+00006780: 2064 742e 6461 7465 7469 6d65 2e75 7463   dt.datetime.utc
+00006790: 6672 6f6d 7469 6d65 7374 616d 7028 6e70  fromtimestamp(np
+000067a0: 2e72 696e 7428 745b 305d 2e61 7374 7970  .rint(t[0].astyp
+000067b0: 6528 224f 2229 202f 2031 6539 2929 0a20  e("O") / 1e9)). 
+000067c0: 2020 2020 2020 2065 6e64 203d 2064 742e         end = dt.
+000067d0: 6461 7465 7469 6d65 2e75 7463 6672 6f6d  datetime.utcfrom
+000067e0: 7469 6d65 7374 616d 7028 6e70 2e72 696e  timestamp(np.rin
+000067f0: 7428 745b 2d31 5d2e 6173 7479 7065 2822  t(t[-1].astype("
+00006800: 4f22 2920 2f20 3165 3929 290a 2020 2020  O") / 1e9)).    
+00006810: 2020 2020 6473 5f77 6861 745b 2270 726f      ds_what["pro
+00006820: 6475 6374 225d 203d 2022 5343 414e 220a  duct"] = "SCAN".
+00006830: 2020 2020 2020 2020 6473 5f77 6861 745b          ds_what[
+00006840: 2273 7461 7274 6461 7465 225d 203d 2073  "startdate"] = s
+00006850: 7461 7274 2e73 7472 6674 696d 6528 2225  tart.strftime("%
+00006860: 5925 6d25 6422 290a 2020 2020 2020 2020  Y%m%d").        
+00006870: 6473 5f77 6861 745b 2273 7461 7274 7469  ds_what["startti
+00006880: 6d65 225d 203d 2073 7461 7274 2e73 7472  me"] = start.str
+00006890: 6674 696d 6528 2225 4825 4d25 5322 290a  ftime("%H%M%S").
+000068a0: 2020 2020 2020 2020 6473 5f77 6861 745b          ds_what[
+000068b0: 2265 6e64 6461 7465 225d 203d 2065 6e64  "enddate"] = end
+000068c0: 2e73 7472 6674 696d 6528 2225 5925 6d25  .strftime("%Y%m%
+000068d0: 6422 290a 2020 2020 2020 2020 6473 5f77  d").        ds_w
+000068e0: 6861 745b 2265 6e64 7469 6d65 225d 203d  hat["endtime"] =
+000068f0: 2065 6e64 2e73 7472 6674 696d 6528 2225   end.strftime("%
+00006900: 4825 4d25 5322 290a 2020 2020 2020 2020  H%M%S").        
+00006910: 5f77 7269 7465 5f6f 6469 6d28 6473 5f77  _write_odim(ds_w
+00006920: 6861 742c 2068 355f 6473 5f77 6861 7429  hat, h5_ds_what)
+00006930: 0a0a 2020 2020 2020 2020 2320 7768 6572  ..        # wher
+00006940: 6520 6772 6f75 702c 2070 2e20 3131 2066  e group, p. 11 f
+00006950: 662e 206d 616e 6461 746f 7279 0a20 2020  f. mandatory.   
+00006960: 2020 2020 2068 355f 6473 5f77 6865 7265       h5_ds_where
+00006970: 203d 2068 355f 6461 7461 7365 742e 6372   = h5_dataset.cr
+00006980: 6561 7465 5f67 726f 7570 2822 7768 6572  eate_group("wher
+00006990: 6522 290a 2020 2020 2020 2020 7273 6361  e").        rsca
+000069a0: 6c65 203d 2064 732e 7261 6e67 652e 7661  le = ds.range.va
+000069b0: 6c75 6573 5b31 5d20 2f20 312e 3020 2d20  lues[1] / 1.0 - 
+000069c0: 6473 2e72 616e 6765 2e76 616c 7565 735b  ds.range.values[
+000069d0: 305d 0a20 2020 2020 2020 2072 7374 6172  0].        rstar
+000069e0: 7420 3d20 2864 732e 7261 6e67 652e 7661  t = (ds.range.va
+000069f0: 6c75 6573 5b30 5d20 2d20 7273 6361 6c65  lues[0] - rscale
+00006a00: 202f 2032 2e30 2920 2f20 3130 3030 2e30   / 2.0) / 1000.0
+00006a10: 0a20 2020 2020 2020 2023 2074 6f64 6f3a  .        # todo:
+00006a20: 206d 616b 6520 7468 6973 2077 6f72 6b20   make this work 
+00006a30: 666f 7220 5248 4927 730a 2020 2020 2020  for RHI's.      
+00006a40: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00006a50: 2020 2061 3167 6174 6520 3d20 6e70 2e61     a1gate = np.a
+00006a60: 7267 736f 7274 2864 732e 736f 7274 6279  rgsort(ds.sortby
+00006a70: 2822 7469 6d65 2229 2e61 7a69 6d75 7468  ("time").azimuth
+00006a80: 2e76 616c 7565 7329 5b30 5d0a 2020 2020  .values)[0].    
+00006a90: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+00006aa0: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+00006ab0: 2020 2061 3167 6174 6520 3d20 6e70 2e61     a1gate = np.a
+00006ac0: 7267 736f 7274 2864 732e 736f 7274 6279  rgsort(ds.sortby
+00006ad0: 2822 7274 696d 6522 292e 617a 696d 7574  ("rtime").azimut
+00006ae0: 682e 7661 6c75 6573 295b 305d 0a20 2020  h.values)[0].   
+00006af0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00006b00: 2020 2020 2020 6669 7865 645f 616e 676c        fixed_angl
+00006b10: 6520 3d20 6473 2e66 6978 6564 5f61 6e67  e = ds.fixed_ang
+00006b20: 6c65 0a20 2020 2020 2020 2065 7863 6570  le.        excep
+00006b30: 7420 4174 7472 6962 7574 6545 7272 6f72  t AttributeError
+00006b40: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+00006b50: 7865 645f 616e 676c 6520 3d20 6473 2e65  xed_angle = ds.e
+00006b60: 6c65 7661 7469 6f6e 2e72 6f75 6e64 2864  levation.round(d
+00006b70: 6563 696d 616c 733d 3129 2e6d 6564 6961  ecimals=1).media
+00006b80: 6e28 292e 7661 6c75 6573 0a20 2020 2020  n().values.     
+00006b90: 2020 2064 735f 7768 6572 6520 3d20 7b0a     ds_where = {.
+00006ba0: 2020 2020 2020 2020 2020 2020 2265 6c61              "ela
+00006bb0: 6e67 6c65 223a 2066 6978 6564 5f61 6e67  ngle": fixed_ang
+00006bc0: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+00006bd0: 226e 6269 6e73 223a 2064 732e 7261 6e67  "nbins": ds.rang
+00006be0: 652e 7368 6170 655b 305d 2c0a 2020 2020  e.shape[0],.    
+00006bf0: 2020 2020 2020 2020 2272 7374 6172 7422          "rstart"
+00006c00: 3a20 7273 7461 7274 2c0a 2020 2020 2020  : rstart,.      
+00006c10: 2020 2020 2020 2272 7363 616c 6522 3a20        "rscale": 
+00006c20: 7273 6361 6c65 2c0a 2020 2020 2020 2020  rscale,.        
+00006c30: 2020 2020 226e 7261 7973 223a 2064 732e      "nrays": ds.
+00006c40: 617a 696d 7574 682e 7368 6170 655b 305d  azimuth.shape[0]
+00006c50: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+00006c60: 3167 6174 6522 3a20 6131 6761 7465 2c0a  1gate": a1gate,.
+00006c70: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00006c80: 2020 5f77 7269 7465 5f6f 6469 6d28 6473    _write_odim(ds
+00006c90: 5f77 6865 7265 2c20 6835 5f64 735f 7768  _where, h5_ds_wh
+00006ca0: 6572 6529 0a0a 2020 2020 2020 2020 2320  ere)..        # 
+00006cb0: 686f 7720 6772 6f75 702c 2070 2e20 3134  how group, p. 14
+00006cc0: 2066 662e 0a20 2020 2020 2020 2068 355f   ff..        h5_
+00006cd0: 6473 5f68 6f77 203d 2068 355f 6461 7461  ds_how = h5_data
+00006ce0: 7365 742e 6372 6561 7465 5f67 726f 7570  set.create_group
+00006cf0: 2822 686f 7722 290a 2020 2020 2020 2020  ("how").        
+00006d00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00006d10: 2074 6f75 7420 3d20 5b74 782e 6173 7479   tout = [tx.asty
+00006d20: 7065 2822 4f22 2920 2f20 3165 3920 666f  pe("O") / 1e9 fo
+00006d30: 7220 7478 2069 6e20 6473 2e73 6f72 7462  r tx in ds.sortb
+00006d40: 7928 2261 7a69 6d75 7468 2229 2e74 696d  y("azimuth").tim
+00006d50: 655d 0a20 2020 2020 2020 2065 7863 6570  e].        excep
+00006d60: 7420 5479 7065 4572 726f 723a 0a20 2020  t TypeError:.   
+00006d70: 2020 2020 2020 2020 2074 6f75 7420 3d20           tout = 
+00006d80: 5b74 782e 6173 7479 7065 2822 4f22 2920  [tx.astype("O") 
+00006d90: 2f20 3165 3920 666f 7220 7478 2069 6e20  / 1e9 for tx in 
+00006da0: 6473 2e73 6f72 7462 7928 2261 7a69 6d75  ds.sortby("azimu
+00006db0: 7468 2229 2e72 7469 6d65 5d0a 0a20 2020  th").rtime]..   
+00006dc0: 2020 2020 2064 6966 6674 203d 206e 702e       difft = np.
+00006dd0: 6469 6666 2874 6f75 7429 202f 2032 2e30  diff(tout) / 2.0
+00006de0: 0a20 2020 2020 2020 2064 6966 6674 203d  .        difft =
+00006df0: 206e 702e 696e 7365 7274 2864 6966 6674   np.insert(difft
+00006e00: 2c20 302c 2064 6966 6674 5b30 5d29 0a20  , 0, difft[0]). 
+00006e10: 2020 2020 2020 2061 7a6f 7574 203d 2064         azout = d
+00006e20: 732e 736f 7274 6279 2822 617a 696d 7574  s.sortby("azimut
+00006e30: 6822 292e 617a 696d 7574 680a 2020 2020  h").azimuth.    
+00006e40: 2020 2020 6469 6666 6120 3d20 6e70 2e64      diffa = np.d
+00006e50: 6966 6628 617a 6f75 7429 202f 2032 2e30  iff(azout) / 2.0
+00006e60: 0a20 2020 2020 2020 2064 6966 6661 203d  .        diffa =
+00006e70: 206e 702e 696e 7365 7274 2864 6966 6661   np.insert(diffa
+00006e80: 2c20 302c 2064 6966 6661 5b30 5d29 0a20  , 0, diffa[0]). 
+00006e90: 2020 2020 2020 2065 6c6f 7574 203d 2064         elout = d
+00006ea0: 732e 736f 7274 6279 2822 617a 696d 7574  s.sortby("azimut
+00006eb0: 6822 292e 656c 6576 6174 696f 6e0a 2020  h").elevation.  
+00006ec0: 2020 2020 2020 6469 6666 6520 3d20 6e70        diffe = np
+00006ed0: 2e64 6966 6628 656c 6f75 7429 202f 2032  .diff(elout) / 2
+00006ee0: 2e30 0a20 2020 2020 2020 2064 6966 6665  .0.        diffe
+00006ef0: 203d 206e 702e 696e 7365 7274 2864 6966   = np.insert(dif
+00006f00: 6665 2c20 302c 2064 6966 6665 5b30 5d29  fe, 0, diffe[0])
+00006f10: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00006f20: 2020 2020 2020 2020 2020 7377 6565 705f            sweep_
+00006f30: 6e75 6d62 6572 203d 2064 732e 7377 6565  number = ds.swee
+00006f40: 705f 6e75 6d62 6572 202b 2031 0a20 2020  p_number + 1.   
+00006f50: 2020 2020 2065 7863 6570 7420 4174 7472       except Attr
+00006f60: 6962 7574 6545 7272 6f72 3a0a 2020 2020  ibuteError:.    
+00006f70: 2020 2020 2020 2020 7377 6565 705f 6e75          sweep_nu
+00006f80: 6d62 6572 203d 2074 696d 6573 7465 700a  mber = timestep.
+00006f90: 2020 2020 2020 2020 6473 5f68 6f77 203d          ds_how =
+00006fa0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00006fb0: 7363 616e 5f69 6e64 6578 223a 2073 7765  scan_index": swe
+00006fc0: 6570 5f6e 756d 6265 722c 0a20 2020 2020  ep_number,.     
+00006fd0: 2020 2020 2020 2022 7363 616e 5f63 6f75         "scan_cou
+00006fe0: 6e74 223a 206c 656e 2873 7765 6570 6e61  nt": len(sweepna
+00006ff0: 6d65 7329 2c0a 2020 2020 2020 2020 2020  mes),.          
+00007000: 2020 2273 7461 7274 617a 5422 3a20 746f    "startazT": to
+00007010: 7574 202d 2064 6966 6674 2c0a 2020 2020  ut - difft,.    
+00007020: 2020 2020 2020 2020 2273 746f 7061 7a54          "stopazT
+00007030: 223a 2074 6f75 7420 2b20 6469 6666 742c  ": tout + difft,
+00007040: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+00007050: 6172 7461 7a41 223a 2061 7a6f 7574 202d  artazA": azout -
+00007060: 2064 6966 6661 2c0a 2020 2020 2020 2020   diffa,.        
+00007070: 2020 2020 2273 746f 7061 7a41 223a 2061      "stopazA": a
+00007080: 7a6f 7574 202b 2064 6966 6661 2c0a 2020  zout + diffa,.  
+00007090: 2020 2020 2020 2020 2020 2273 7461 7274            "start
+000070a0: 656c 4122 3a20 656c 6f75 7420 2d20 6469  elA": elout - di
+000070b0: 6666 652c 0a20 2020 2020 2020 2020 2020  ffe,.           
+000070c0: 2022 7374 6f70 656c 4122 3a20 656c 6f75   "stopelA": elou
+000070d0: 7420 2b20 6469 6666 652c 0a20 2020 2020  t + diffe,.     
+000070e0: 2020 207d 0a20 2020 2020 2020 205f 7772     }.        _wr
+000070f0: 6974 655f 6f64 696d 2864 735f 686f 772c  ite_odim(ds_how,
+00007100: 2068 355f 6473 5f68 6f77 290a 0a20 2020   h5_ds_how)..   
+00007110: 2020 2020 2023 2077 7269 7465 206d 6f6d       # write mom
+00007120: 656e 7473 0a20 2020 2020 2020 205f 7772  ents.        _wr
+00007130: 6974 655f 6f64 696d 5f64 6174 6173 7061  ite_odim_dataspa
+00007140: 6365 2864 732c 2068 355f 6461 7461 7365  ce(ds, h5_datase
+00007150: 7429 0a0a 2020 2020 6835 2e63 6c6f 7365  t)..    h5.close
+00007160: 2829 0a0a 0a64 6566 205f 7072 6570 726f  ()...def _prepro
+00007170: 6365 7373 5f6d 6f6d 656e 7428 6473 2c20  cess_moment(ds, 
+00007180: 6d6f 6d2c 206e 6f6e 5f75 6e69 666f 726d  mom, non_uniform
+00007190: 5f73 6861 7065 293a 0a0a 2020 2020 6174  _shape):..    at
+000071a0: 7472 7320 3d20 6d6f 6d2e 5f64 6563 6f64  trs = mom._decod
+000071b0: 6528 6473 2e64 6174 612e 6174 7472 7329  e(ds.data.attrs)
+000071c0: 0a20 2020 2071 7561 6e74 6974 7920 3d20  .    quantity = 
+000071d0: 6d6f 6d2e 7175 616e 7469 7479 0a0a 2020  mom.quantity..  
+000071e0: 2020 2320 6578 7472 6163 7420 616e 6420    # extract and 
+000071f0: 7472 616e 736c 6174 6520 6174 7472 6962  translate attrib
+00007200: 7574 6573 2074 6f20 6366 0a20 2020 2077  utes to cf.    w
+00007210: 6861 7420 3d20 6d6f 6d2e 7768 6174 0a20  hat = mom.what. 
+00007220: 2020 2061 7474 7273 5b22 7363 616c 655f     attrs["scale_
+00007230: 6661 6374 6f72 225d 203d 2077 6861 745b  factor"] = what[
+00007240: 2267 6169 6e22 5d0a 2020 2020 6174 7472  "gain"].    attr
+00007250: 735b 2261 6464 5f6f 6666 7365 7422 5d20  s["add_offset"] 
+00007260: 3d20 7768 6174 5b22 6f66 6673 6574 225d  = what["offset"]
+00007270: 0a20 2020 2061 7474 7273 5b22 5f46 696c  .    attrs["_Fil
+00007280: 6c56 616c 7565 225d 203d 2077 6861 745b  lValue"] = what[
+00007290: 226e 6f64 6174 6122 5d0a 2020 2020 6174  "nodata"].    at
+000072a0: 7472 735b 225f 556e 6465 7465 6374 225d  trs["_Undetect"]
+000072b0: 203d 2077 6861 745b 2275 6e64 6574 6563   = what["undetec
+000072c0: 7422 5d0a 0a20 2020 2069 6620 6d6f 6d2e  t"]..    if mom.
+000072d0: 7061 7265 6e74 2e64 6563 6f64 655f 636f  parent.decode_co
+000072e0: 6f72 6473 3a0a 2020 2020 2020 2020 6174  ords:.        at
+000072f0: 7472 735b 2263 6f6f 7264 696e 6174 6573  trs["coordinates
+00007300: 225d 203d 2022 656c 6576 6174 696f 6e20  "] = "elevation 
+00007310: 617a 696d 7574 6820 7261 6e67 6522 0a0a  azimuth range"..
+00007320: 2020 2020 2320 6861 6e64 6c65 206e 6f6e      # handle non
+00007330: 2d73 7461 6e64 6172 6420 6d6f 6d65 6e74  -standard moment
+00007340: 206e 616d 6573 0a20 2020 2074 7279 3a0a   names.    try:.
+00007350: 2020 2020 2020 2020 6d61 7070 696e 6720          mapping 
+00007360: 3d20 6d6f 6d65 6e74 735f 6d61 7070 696e  = moments_mappin
+00007370: 675b 7175 616e 7469 7479 5d0a 2020 2020  g[quantity].    
+00007380: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
+00007390: 0a20 2020 2020 2020 2070 6173 730a 2020  .        pass.  
+000073a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000073b0: 6174 7472 732e 7570 6461 7465 287b 6b65  attrs.update({ke
+000073c0: 793a 206d 6170 7069 6e67 5b6b 6579 5d20  y: mapping[key] 
+000073d0: 666f 7220 6b65 7920 696e 206d 6f6d 656e  for key in momen
+000073e0: 745f 6174 7472 737d 290a 0a20 2020 2064  t_attrs})..    d
+000073f0: 735b 2264 6174 6122 5d20 3d20 6473 5b22  s["data"] = ds["
+00007400: 6461 7461 225d 2e61 7373 6967 6e5f 6174  data"].assign_at
+00007410: 7472 7328 6174 7472 7329 0a0a 2020 2020  trs(attrs)..    
+00007420: 2320 6669 7820 6469 6d65 6e73 696f 6e73  # fix dimensions
+00007430: 0a20 2020 2064 696d 7320 3d20 736f 7274  .    dims = sort
+00007440: 6564 286c 6973 7428 6473 2e64 696d 732e  ed(list(ds.dims.
+00007450: 6b65 7973 2829 292c 206b 6579 3d6c 616d  keys()), key=lam
+00007460: 6264 6120 783a 2069 6e74 2878 5b6c 656e  bda x: int(x[len
+00007470: 2822 7068 6f6e 795f 6469 6d5f 2229 203a  ("phony_dim_") :
+00007480: 5d29 290a 0a20 2020 2064 7320 3d20 6473  ]))..    ds = ds
+00007490: 2e72 656e 616d 6528 0a20 2020 2020 2020  .rename(.       
+000074a0: 207b 2264 6174 6122 3a20 7175 616e 7469   {"data": quanti
+000074b0: 7479 2c20 6469 6d73 5b30 5d3a 206d 6f6d  ty, dims[0]: mom
+000074c0: 2e70 6172 656e 742e 5f64 696d 305b 305d  .parent._dim0[0]
+000074d0: 2c20 6469 6d73 5b31 5d3a 206d 6f6d 2e70  , dims[1]: mom.p
+000074e0: 6172 656e 742e 5f64 696d 317d 0a20 2020  arent._dim1}.   
+000074f0: 2029 0a0a 2020 2020 2320 6170 706c 7920   )..    # apply 
+00007500: 636f 6f72 6469 6e61 7465 7320 746f 2064  coordinates to d
+00007510: 6174 6173 6574 2069 6620 736f 7572 6365  ataset if source
+00007520: 206d 6f6d 656e 7473 2068 6176 6520 6469   moments have di
+00007530: 6666 6572 656e 7420 7368 6170 6573 0a20  fferent shapes. 
+00007540: 2020 2023 2061 6e64 2063 6f72 7265 6374     # and correct
+00007550: 2066 6f72 2069 740a 2020 2020 6966 206d   for it.    if m
+00007560: 6f6d 2e70 6172 656e 742e 6465 636f 6465  om.parent.decode
+00007570: 5f63 6f6f 7264 7320 2620 6e6f 6e5f 756e  _coords & non_un
+00007580: 6966 6f72 6d5f 7368 6170 653a 0a20 2020  iform_shape:.   
+00007590: 2020 2020 2063 6f6f 7264 7320 3d20 6d6f       coords = mo
+000075a0: 6d2e 7061 7265 6e74 2e5f 6765 745f 636f  m.parent._get_co
+000075b0: 6f72 6473 2829 0a20 2020 2020 2020 2064  ords().        d
+000075c0: 7320 3d20 6473 2e61 7373 6967 6e5f 636f  s = ds.assign_co
+000075d0: 6f72 6473 2863 6f6f 7264 732e 636f 6f72  ords(coords.coor
+000075e0: 6473 290a 2020 2020 2020 2020 6966 206d  ds).        if m
+000075f0: 6f6d 2e70 6172 656e 742e 5f64 696d 305b  om.parent._dim0[
+00007600: 305d 203d 3d20 2261 7a69 6d75 7468 223a  0] == "azimuth":
+00007610: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
+00007620: 3d20 6473 2e73 6f72 7462 7928 6d6f 6d2e  = ds.sortby(mom.
+00007630: 7061 7265 6e74 2e5f 6469 6d30 5b30 5d29  parent._dim0[0])
+00007640: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
+00007650: 3d20 6473 2e70 6970 6528 5f72 6569 6e64  = ds.pipe(_reind
+00007660: 6578 5f61 6e67 6c65 2c20 6d6f 6d2e 7061  ex_angle, mom.pa
+00007670: 7265 6e74 290a 0a20 2020 2072 6574 7572  rent)..    retur
+00007680: 6e20 6473 0a0a 0a64 6566 205f 7265 696e  n ds...def _rein
+00007690: 6465 785f 616e 676c 6528 6473 2c20 7377  dex_angle(ds, sw
+000076a0: 6565 702c 2066 6f72 6365 3d46 616c 7365  eep, force=False
+000076b0: 293a 0a20 2020 2023 2054 6f64 6f3a 2054  ):.    # Todo: T
+000076c0: 6865 2063 7572 7265 6e74 2063 6f64 6520  he current code 
+000076d0: 6173 7375 6d65 7320 746f 2068 6176 6520  assumes to have 
+000076e0: 5050 4927 7320 6f66 2033 3630 6465 6720  PPI's of 360deg 
+000076f0: 616e 6420 5248 4927 7320 6f66 2039 3064  and RHI's of 90d
+00007700: 6567 2c0a 2020 2020 2320 2020 2020 2020  eg,.    #       
+00007710: 6d61 6b65 2074 6869 7320 776f 726b 2061  make this work a
+00007720: 6c73 6f20 666f 7220 7365 6374 6f72 697a  lso for sectoriz
+00007730: 6564 206d 6561 7375 7265 6d65 6e74 730a  ed measurements.
+00007740: 2020 2020 6675 6c6c 5f72 616e 6765 203d      full_range =
+00007750: 2064 6963 7428 617a 696d 7574 683d 3336   dict(azimuth=36
+00007760: 302c 2065 6c65 7661 7469 6f6e 3d39 3029  0, elevation=90)
+00007770: 0a20 2020 2064 696d 6e61 6d65 203d 206c  .    dimname = l
+00007780: 6973 7428 6473 2e64 696d 7329 5b30 5d0a  ist(ds.dims)[0].
+00007790: 2020 2020 7365 636e 616d 6520 3d20 7377      secname = sw
+000077a0: 6565 702e 5f64 696d 305b 315d 0a20 2020  eep._dim0[1].   
+000077b0: 2064 696d 203d 2064 735b 6469 6d6e 616d   dim = ds[dimnam
+000077c0: 655d 0a20 2020 2064 6966 6620 3d20 6469  e].    diff = di
+000077d0: 6d2e 6469 6666 2864 696d 6e61 6d65 290a  m.diff(dimname).
+000077e0: 2020 2020 2320 7468 6973 2063 6170 7475      # this captu
+000077f0: 7265 7320 6469 6666 6572 656e 7420 616e  res different an
+00007800: 676c 6520 7370 6163 696e 670a 2020 2020  gle spacing.    
+00007810: 2320 6361 7463 6865 7320 616c 736f 206d  # catches also m
+00007820: 6973 7369 6e67 2072 6179 7320 616e 6420  issing rays and 
+00007830: 646f 7562 6c65 2072 6179 730a 2020 2020  double rays.    
+00007840: 2320 616e 6420 6f74 6865 7220 6572 726f  # and other erro
+00007850: 6e65 6f75 7320 7261 7920 616c 6967 6e6d  neous ray alignm
+00007860: 656e 7473 2077 6869 6368 2072 6573 756c  ents which resul
+00007870: 7420 696e 2064 6966 6665 7265 6e74 2064  t in different d
+00007880: 6966 6620 7661 6c75 6573 0a20 2020 2064  iff values.    d
+00007890: 6966 6673 6574 203d 2073 6574 2864 6966  iffset = set(dif
+000078a0: 662e 7661 6c75 6573 290a 2020 2020 6e6f  f.values).    no
+000078b0: 6e5f 756e 6966 6f72 6d5f 616e 676c 655f  n_uniform_angle_
+000078c0: 7370 6163 696e 6720 3d20 6c65 6e28 6469  spacing = len(di
+000078d0: 6666 7365 7429 203e 2031 0a20 2020 2023  ffset) > 1.    #
+000078e0: 2074 6869 7320 6361 7074 7572 6573 206d   this captures m
+000078f0: 6973 7369 6e67 2061 6e64 2061 6464 6974  issing and addit
+00007900: 696f 6e61 6c20 7261 7973 2069 6e20 6361  ional rays in ca
+00007910: 7365 2074 6865 2061 6e67 6c65 2064 6966  se the angle dif
+00007920: 6665 7265 6e63 6573 0a20 2020 2023 2061  ferences.    # a
+00007930: 7265 2065 7175 616c 0a20 2020 206e 6f6e  re equal.    non
+00007940: 5f66 756c 6c5f 6369 7263 6c65 203d 2046  _full_circle = F
+00007950: 616c 7365 0a20 2020 2069 6620 6e6f 7420  alse.    if not 
+00007960: 6e6f 6e5f 756e 6966 6f72 6d5f 616e 676c  non_uniform_angl
+00007970: 655f 7370 6163 696e 673a 0a20 2020 2020  e_spacing:.     
+00007980: 2020 2072 6573 203d 206c 6973 7428 6469     res = list(di
+00007990: 6666 7365 7429 5b30 5d0a 2020 2020 2020  ffset)[0].      
+000079a0: 2020 6e6f 6e5f 6675 6c6c 5f63 6972 636c    non_full_circl
+000079b0: 6520 3d20 2828 7265 7320 2a20 7377 6565  e = ((res * swee
+000079c0: 702e 6e72 6179 7329 2025 2066 756c 6c5f  p.nrays) % full_
+000079d0: 7261 6e67 655b 6469 6d6e 616d 655d 2920  range[dimname]) 
+000079e0: 213d 2030 0a0a 2020 2020 2320 6669 7820  != 0..    # fix 
+000079f0: 6973 7375 6573 2077 6974 6820 7261 7920  issues with ray 
+00007a00: 616c 6967 6e6d 656e 740a 2020 2020 6966  alignment.    if
+00007a10: 2066 6f72 6365 207c 206e 6f6e 5f75 6e69   force | non_uni
+00007a20: 666f 726d 5f61 6e67 6c65 5f73 7061 6369  form_angle_spaci
+00007a30: 6e67 207c 206e 6f6e 5f66 756c 6c5f 6369  ng | non_full_ci
+00007a40: 7263 6c65 3a0a 2020 2020 2020 2020 2320  rcle:.        # 
+00007a50: 6372 6561 7465 206e 6577 2061 7272 6179  create new array
+00007a60: 2061 6e64 2072 6569 6e64 6578 0a20 2020   and reindex.   
+00007a70: 2020 2020 2072 6573 203d 2073 7765 6570       res = sweep
+00007a80: 2e61 6e67 6c65 5f72 6573 6f6c 7574 696f  .angle_resolutio
+00007a90: 6e0a 2020 2020 2020 2020 6e65 775f 7261  n.        new_ra
+00007aa0: 7973 203d 2069 6e74 286e 702e 726f 756e  ys = int(np.roun
+00007ab0: 6428 6675 6c6c 5f72 616e 6765 5b64 696d  d(full_range[dim
+00007ac0: 6e61 6d65 5d20 2f20 7265 732c 2064 6563  name] / res, dec
+00007ad0: 696d 616c 733d 3029 290a 0a20 2020 2020  imals=0))..     
+00007ae0: 2020 2023 2066 696e 6420 6578 6163 7420     # find exact 
+00007af0: 6475 706c 6963 6174 6573 2061 6e64 2072  duplicates and r
+00007b00: 656d 6f76 650a 2020 2020 2020 2020 5f2c  emove.        _,
+00007b10: 2069 6478 203d 206e 702e 756e 6971 7565   idx = np.unique
+00007b20: 2864 735b 6469 6d6e 616d 655d 2c20 7265  (ds[dimname], re
+00007b30: 7475 726e 5f69 6e64 6578 3d54 7275 6529  turn_index=True)
+00007b40: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00007b50: 6964 7829 203c 206c 656e 2864 735b 6469  idx) < len(ds[di
+00007b60: 6d6e 616d 655d 293a 0a20 2020 2020 2020  mname]):.       
+00007b70: 2020 2020 2064 7320 3d20 6473 2e69 7365       ds = ds.ise
+00007b80: 6c28 7b64 696d 6e61 6d65 3a20 6964 787d  l({dimname: idx}
+00007b90: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00007ba0: 6966 2072 6179 5f74 696d 6520 7761 7320  if ray_time was 
+00007bb0: 6572 726f 756e 656f 7573 6c79 2063 7265  errouneously cre
+00007bc0: 6174 6564 2066 726f 6d20 7772 6f6e 6720  ated from wrong 
+00007bd0: 6469 6d65 6e73 696f 6e73 0a20 2020 2020  dimensions.     
+00007be0: 2020 2020 2020 2023 2077 6520 6e65 6564         # we need
+00007bf0: 2074 6f20 7265 6361 6c63 756c 6174 6520   to recalculate 
+00007c00: 6974 0a20 2020 2020 2020 2020 2020 2069  it.            i
+00007c10: 6620 7377 6565 702e 5f6e 6565 645f 7469  f sweep._need_ti
+00007c20: 6d65 5f72 6563 616c 633a 0a20 2020 2020  me_recalc:.     
+00007c30: 2020 2020 2020 2020 2020 2072 6179 5f74             ray_t
+00007c40: 696d 6573 203d 2073 7765 6570 2e5f 6765  imes = sweep._ge
+00007c50: 745f 7261 795f 7469 6d65 7328 6e72 6179  t_ray_times(nray
+00007c60: 733d 6c65 6e28 6964 7829 290a 2020 2020  s=len(idx)).    
+00007c70: 2020 2020 2020 2020 2020 2020 7261 795f              ray_
+00007c80: 7469 6d65 7320 3d20 7377 6565 702e 5f64  times = sweep._d
+00007c90: 6563 6f64 655f 6366 2872 6179 5f74 696d  ecode_cf(ray_tim
+00007ca0: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00007cb0: 2020 2020 6473 203d 2064 732e 6173 7369      ds = ds.assi
+00007cc0: 676e 287b 2272 7469 6d65 223a 2072 6179  gn({"rtime": ray
+00007cd0: 5f74 696d 6573 7d29 0a0a 2020 2020 2020  _times})..      
+00007ce0: 2020 2320 746f 646f 3a20 6368 6563 6b20    # todo: check 
+00007cf0: 6966 2061 7373 756d 7074 696f 6e20 7468  if assumption th
+00007d00: 6174 2062 6561 6d20 6365 6e74 6572 2070  at beam center p
+00007d10: 6f69 6e74 7320 746f 0a20 2020 2020 2020  oints to.       
+00007d20: 2023 2020 2020 2020 206d 756c 7469 706c   #       multipl
+00007d30: 6573 206f 6620 7265 732f 322e 2069 7320  es of res/2. is 
+00007d40: 636f 7272 6563 7420 696e 2061 6e79 2063  correct in any c
+00007d50: 6173 650a 2020 2020 2020 2020 617a 7220  ase.        azr 
+00007d60: 3d20 6e70 2e61 7261 6e67 6528 7265 7320  = np.arange(res 
+00007d70: 2f20 322e 302c 206e 6577 5f72 6179 7320  / 2.0, new_rays 
+00007d80: 2a20 7265 732c 2072 6573 2c20 6474 7970  * res, res, dtyp
+00007d90: 653d 6469 6666 2e64 7479 7065 290a 2020  e=diff.dtype).  
+00007da0: 2020 2020 2020 6473 203d 2064 732e 7265        ds = ds.re
+00007db0: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
+00007dc0: 2020 207b 6469 6d6e 616d 653a 2061 7a72     {dimname: azr
+00007dd0: 7d2c 0a20 2020 2020 2020 2020 2020 206d  },.            m
+00007de0: 6574 686f 643d 226e 6561 7265 7374 222c  ethod="nearest",
+00007df0: 0a20 2020 2020 2020 2020 2020 2074 6f6c  .            tol
+00007e00: 6572 616e 6365 3d72 6573 202f 2034 2e30  erance=res / 4.0
+00007e10: 2c0a 2020 2020 2020 2020 2020 2020 2320  ,.            # 
+00007e20: 6669 6c6c 5f76 616c 7565 3d78 722e 636f  fill_value=xr.co
+00007e30: 7265 2e64 7479 7065 732e 4e41 2c0a 2020  re.dtypes.NA,.  
+00007e40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00007e50: 2320 6368 6563 6b20 6f74 6865 7220 636f  # check other co
+00007e60: 6f72 6469 6e61 7465 730a 2020 2020 2020  ordinates.      
+00007e70: 2020 2320 6368 6563 6b20 7365 636f 6e64    # check second
+00007e80: 6172 7920 616e 676c 6520 636f 6f72 6469  ary angle coordi
+00007e90: 6e61 7465 2028 6e6f 206e 616e 290a 2020  nate (no nan).  
+00007ea0: 2020 2020 2020 2320 7365 7420 6e61 6e20        # set nan 
+00007eb0: 7661 6c75 6573 2074 6f20 7265 6173 6f6e  values to reason
+00007ec0: 6162 6c65 206d 6564 6961 6e0a 2020 2020  able median.    
+00007ed0: 2020 2020 6966 206e 702e 636f 756e 745f      if np.count_
+00007ee0: 6e6f 6e7a 6572 6f28 6e70 2e69 736e 616e  nonzero(np.isnan
+00007ef0: 2864 735b 7365 636e 616d 655d 2929 3a0a  (ds[secname])):.
+00007f00: 2020 2020 2020 2020 2020 2020 6473 5b73              ds[s
+00007f10: 6563 6e61 6d65 5d20 3d20 6473 5b73 6563  ecname] = ds[sec
+00007f20: 6e61 6d65 5d2e 6669 6c6c 6e61 2864 735b  name].fillna(ds[
+00007f30: 7365 636e 616d 655d 2e6d 6564 6961 6e28  secname].median(
+00007f40: 736b 6970 6e61 3d54 7275 6529 290a 2020  skipna=True)).  
+00007f50: 2020 2020 2020 2320 746f 646f 3a20 7274        # todo: rt
+00007f60: 696d 6520 6973 2061 6c73 6f20 6166 6665  ime is also affe
+00007f70: 6374 6564 2c20 6d69 6768 7420 6e65 6564  cted, might need
+00007f80: 2074 6f20 6265 2074 7265 6174 6564 2061   to be treated a
+00007f90: 6363 6f72 6469 6e67 6c79 0a0a 2020 2020  ccordingly..    
+00007fa0: 7265 7475 726e 2064 730a 0a0a 6465 6620  return ds...def 
+00007fb0: 5f66 6978 5f61 6e67 6c65 2864 6129 3a0a  _fix_angle(da):.
+00007fc0: 2020 2020 2320 6669 7820 656c 6576 6174      # fix elevat
+00007fd0: 696f 6e20 6f75 746c 6965 7273 0a20 2020  ion outliers.   
+00007fe0: 2069 6620 6c65 6e28 7365 7428 6461 2e76   if len(set(da.v
+00007ff0: 616c 7565 7329 2920 3e20 313a 0a20 2020  alues)) > 1:.   
+00008000: 2020 2020 206d 6564 203d 2064 612e 6d65       med = da.me
+00008010: 6469 616e 2873 6b69 706e 613d 5472 7565  dian(skipna=True
+00008020: 290a 2020 2020 2020 2020 6461 203d 2064  ).        da = d
+00008030: 612e 7768 6572 6528 6461 203d 3d20 6d65  a.where(da == me
+00008040: 6429 2e66 696c 6c6e 6128 6d65 6429 0a20  d).fillna(med). 
+00008050: 2020 2072 6574 7572 6e20 6461 0a0a 0a64     return da...d
+00008060: 6566 205f 6f70 656e 5f6d 666d 6f6d 656e  ef _open_mfmomen
+00008070: 7473 280a 2020 2020 6d6f 6d65 6e74 732c  ts(.    moments,
+00008080: 0a20 2020 2063 6875 6e6b 733d 4e6f 6e65  .    chunks=None
+00008090: 2c0a 2020 2020 636f 6d70 6174 3d22 6e6f  ,.    compat="no
+000080a0: 5f63 6f6e 666c 6963 7473 222c 0a20 2020  _conflicts",.   
+000080b0: 2070 7265 7072 6f63 6573 733d 4e6f 6e65   preprocess=None
+000080c0: 2c0a 2020 2020 656e 6769 6e65 3d4e 6f6e  ,.    engine=Non
+000080d0: 652c 0a20 2020 206c 6f63 6b3d 4e6f 6e65  e,.    lock=None
+000080e0: 2c0a 2020 2020 6461 7461 5f76 6172 733d  ,.    data_vars=
+000080f0: 2261 6c6c 222c 0a20 2020 2063 6f6f 7264  "all",.    coord
+00008100: 733d 226d 696e 696d 616c 222c 0a20 2020  s="minimal",.   
+00008110: 2070 6172 616c 6c65 6c3d 4661 6c73 652c   parallel=False,
+00008120: 0a20 2020 202a 2a6b 7761 7267 732c 0a29  .    **kwargs,.)
+00008130: 3a0a 2020 2020 2222 224f 7065 6e20 6d75  :.    """Open mu
+00008140: 6c74 6970 6c65 204f 6469 6d48 3520 6d6f  ltiple OdimH5 mo
+00008150: 6d65 6e74 7320 6173 2061 2073 696e 676c  ments as a singl
+00008160: 6520 6461 7461 7365 742e 0a0a 2020 2020  e dataset...    
+00008170: 5468 6973 2069 7320 6465 7269 7665 6420  This is derived 
+00008180: 6672 6f6d 2078 6172 7261 792e 6f70 656e  from xarray.open
+00008190: 5f6d 6664 6174 6173 6574 205b 315d 0a0a  _mfdataset [1]..
+000081a0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000081b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000081c0: 2020 6d6f 6d65 6e74 7320 3a20 7365 7175    moments : sequ
+000081d0: 656e 6365 0a20 2020 2020 2020 204c 6973  ence.        Lis
+000081e0: 7420 6f66 2058 5261 6453 7765 6570 206f  t of XRadSweep o
+000081f0: 626a 6563 7473 2e0a 2020 2020 6368 756e  bjects..    chun
+00008200: 6b73 203a 2069 6e74 206f 7220 6469 6374  ks : int or dict
+00008210: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00008220: 2020 2043 6875 6e6b 2073 697a 650a 2020     Chunk size.  
+00008230: 2020 7072 6570 726f 6365 7373 203a 2063    preprocess : c
+00008240: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
+00008250: 6c0a 2020 2020 2020 2020 4966 2070 726f  l.        If pro
+00008260: 7669 6465 642c 2063 616c 6c20 7468 6973  vided, call this
+00008270: 2066 756e 6374 696f 6e20 6f6e 2065 6163   function on eac
+00008280: 6820 6461 7461 7365 7420 7072 696f 7220  h dataset prior 
+00008290: 746f 2063 6f6e 6361 7465 6e61 7469 6f6e  to concatenation
+000082a0: 2e0a 2020 2020 656e 6769 6e65 203a 207b  ..    engine : {
+000082b0: 276e 6574 6364 6634 272c 2027 6835 6e65  'netcdf4', 'h5ne
+000082c0: 7463 6466 277d 2c20 6f70 7469 6f6e 616c  tcdf'}, optional
+000082d0: 0a20 2020 2020 2020 2045 6e67 696e 6520  .        Engine 
+000082e0: 746f 2075 7365 2077 6865 6e20 7265 6164  to use when read
+000082f0: 696e 6720 6669 6c65 732e 2044 6566 6175  ing files. Defau
+00008300: 6c74 7320 746f 2027 6e65 7463 6466 3427  lts to 'netcdf4'
+00008310: 2e0a 2020 2020 6c6f 636b 203a 2046 616c  ..    lock : Fal
+00008320: 7365 206f 7220 6475 636b 2074 6872 6561  se or duck threa
+00008330: 6469 6e67 2e4c 6f63 6b2c 206f 7074 696f  ding.Lock, optio
+00008340: 6e61 6c0a 2020 2020 2020 2020 5265 736f  nal.        Reso
+00008350: 7572 6365 206c 6f63 6b20 746f 2075 7365  urce lock to use
+00008360: 2077 6865 6e20 7265 6164 696e 6720 6461   when reading da
+00008370: 7461 2066 726f 6d20 6469 736b 2e20 4f6e  ta from disk. On
+00008380: 6c79 2072 656c 6576 616e 7420 7768 656e  ly relevant when
+00008390: 0a20 2020 2020 2020 2075 7369 6e67 2064  .        using d
+000083a0: 6173 6b20 6f72 2061 6e6f 7468 6572 2066  ask or another f
+000083b0: 6f72 6d20 6f66 2070 6172 616c 6c65 6c69  orm of paralleli
+000083c0: 736d 2e20 4279 2064 6566 6175 6c74 2c20  sm. By default, 
+000083d0: 6170 7072 6f70 7269 6174 650a 2020 2020  appropriate.    
+000083e0: 2020 2020 6c6f 636b 7320 6172 6520 6368      locks are ch
+000083f0: 6f73 656e 2074 6f20 7361 6665 6c79 2072  osen to safely r
+00008400: 6561 6420 616e 6420 7772 6974 6520 6669  ead and write fi
+00008410: 6c65 7320 7769 7468 2074 6865 2063 7572  les with the cur
+00008420: 7265 6e74 6c79 0a20 2020 2020 2020 2061  rently.        a
+00008430: 6374 6976 6520 6461 736b 2073 6368 6564  ctive dask sched
+00008440: 756c 6572 2e0a 2020 2020 6461 7461 5f76  uler..    data_v
+00008450: 6172 7320 3a20 7b27 6d69 6e69 6d61 6c27  ars : {'minimal'
+00008460: 2c20 2764 6966 6665 7265 6e74 272c 2027  , 'different', '
+00008470: 616c 6c27 206f 7220 6c69 7374 206f 6620  all' or list of 
+00008480: 7374 727d 2c20 6f70 7469 6f6e 616c 0a20  str}, optional. 
+00008490: 2020 2020 2020 2054 6865 7365 2064 6174         These dat
+000084a0: 6120 7661 7269 6162 6c65 7320 7769 6c6c  a variables will
+000084b0: 2062 6520 636f 6e63 6174 656e 6174 6564   be concatenated
+000084c0: 2074 6f67 6574 6865 723a 0a20 2020 2020   together:.     
+000084d0: 2020 2020 202a 2027 6d69 6e69 6d61 6c27       * 'minimal'
+000084e0: 3a20 4f6e 6c79 2064 6174 6120 7661 7269  : Only data vari
+000084f0: 6162 6c65 7320 696e 2077 6869 6368 2074  ables in which t
+00008500: 6865 2064 696d 656e 7369 6f6e 2061 6c72  he dimension alr
+00008510: 6561 6479 0a20 2020 2020 2020 2020 2020  eady.           
+00008520: 2061 7070 6561 7273 2061 7265 2069 6e63   appears are inc
+00008530: 6c75 6465 642e 0a20 2020 2020 2020 2020  luded..         
+00008540: 202a 2027 6469 6666 6572 656e 7427 3a20   * 'different': 
+00008550: 4461 7461 2076 6172 6961 626c 6573 2077  Data variables w
+00008560: 6869 6368 2061 7265 206e 6f74 2065 7175  hich are not equ
+00008570: 616c 2028 6967 6e6f 7269 6e67 0a20 2020  al (ignoring.   
+00008580: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00008590: 7465 7329 2061 6372 6f73 7320 616c 6c20  tes) across all 
+000085a0: 6461 7461 7365 7473 2061 7265 2061 6c73  datasets are als
+000085b0: 6f20 636f 6e63 6174 656e 6174 6564 2028  o concatenated (
+000085c0: 6173 2077 656c 6c20 6173 0a20 2020 2020  as well as.     
+000085d0: 2020 2020 2020 2061 6c6c 2066 6f72 2077         all for w
+000085e0: 6869 6368 2064 696d 656e 7369 6f6e 2061  hich dimension a
+000085f0: 6c72 6561 6479 2061 7070 6561 7273 292e  lready appears).
+00008600: 2042 6577 6172 653a 2074 6869 7320 6f70   Beware: this op
+00008610: 7469 6f6e 206d 6179 0a20 2020 2020 2020  tion may.       
+00008620: 2020 2020 206c 6f61 6420 7468 6520 6461       load the da
+00008630: 7461 2070 6179 6c6f 6164 206f 6620 6461  ta payload of da
+00008640: 7461 2076 6172 6961 626c 6573 2069 6e74  ta variables int
+00008650: 6f20 6d65 6d6f 7279 2069 6620 7468 6579  o memory if they
+00008660: 2061 7265 206e 6f74 0a20 2020 2020 2020   are not.       
+00008670: 2020 2020 2061 6c72 6561 6479 206c 6f61       already loa
+00008680: 6465 642e 0a20 2020 2020 2020 2020 202a  ded..          *
+00008690: 2027 616c 6c27 3a20 416c 6c20 6461 7461   'all': All data
+000086a0: 2076 6172 6961 626c 6573 2077 696c 6c20   variables will 
+000086b0: 6265 2063 6f6e 6361 7465 6e61 7465 642e  be concatenated.
+000086c0: 0a20 2020 2020 2020 2020 202a 206c 6973  .          * lis
+000086d0: 7420 6f66 2073 7472 3a20 5468 6520 6c69  t of str: The li
+000086e0: 7374 6564 2064 6174 6120 7661 7269 6162  sted data variab
+000086f0: 6c65 7320 7769 6c6c 2062 6520 636f 6e63  les will be conc
+00008700: 6174 656e 6174 6564 2c20 696e 0a20 2020  atenated, in.   
+00008710: 2020 2020 2020 2020 2061 6464 6974 696f           additio
+00008720: 6e20 746f 2074 6865 2027 6d69 6e69 6d61  n to the 'minima
+00008730: 6c27 2064 6174 6120 7661 7269 6162 6c65  l' data variable
+00008740: 732e 0a20 2020 2070 6172 616c 6c65 6c20  s..    parallel 
+00008750: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00008760: 0a20 2020 2020 2020 2049 6620 5472 7565  .        If True
+00008770: 2c20 7468 6520 6f70 656e 2061 6e64 2070  , the open and p
+00008780: 7265 7072 6f63 6573 7320 7374 6570 7320  reprocess steps 
+00008790: 6f66 2074 6869 7320 6675 6e63 7469 6f6e  of this function
+000087a0: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
+000087b0: 2070 6572 666f 726d 6564 2069 6e20 7061   performed in pa
+000087c0: 7261 6c6c 656c 2075 7369 6e67 2060 6064  rallel using ``d
+000087d0: 6173 6b2e 6465 6c61 7965 6460 602e 2044  ask.delayed``. D
+000087e0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+000087f0: 0a20 2020 202a 2a6b 7761 7267 7320 3a20  .    **kwargs : 
+00008800: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00008810: 2041 6464 6974 696f 6e61 6c20 6172 6775   Additional argu
+00008820: 6d65 6e74 7320 7061 7373 6564 206f 6e20  ments passed on 
+00008830: 746f 203a 7079 3a66 756e 633a 6078 6172  to :py:func:`xar
+00008840: 7261 792e 6f70 656e 5f64 6174 6173 6574  ray.open_dataset
+00008850: 602e 0a0a 2020 2020 5265 7475 726e 730a  `...    Returns.
+00008860: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00008870: 7861 7272 6179 2e44 6174 6173 6574 0a0a  xarray.Dataset..
+00008880: 2020 2020 5265 6665 7265 6e63 6573 0a20      References. 
+00008890: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 0a20     ----------.. 
+000088a0: 2020 202e 2e20 5b31 5d20 6874 7470 733a     .. [1] https:
+000088b0: 2f2f 7861 7272 6179 2e70 7964 6174 612e  //xarray.pydata.
+000088c0: 6f72 672f 656e 2f73 7461 626c 652f 6765  org/en/stable/ge
+000088d0: 6e65 7261 7465 642f 7861 7272 6179 2e6f  nerated/xarray.o
+000088e0: 7065 6e5f 6d66 6461 7461 7365 742e 6874  pen_mfdataset.ht
+000088f0: 6d6c 0a0a 2020 2020 2222 2220 2023 206e  ml..    """  # n
+00008900: 6f71 610a 0a20 2020 206f 7065 6e5f 6b77  oqa..    open_kw
+00008910: 6172 6773 203d 2064 6963 7428 6368 756e  args = dict(chun
+00008920: 6b73 3d63 6875 6e6b 732c 202a 2a6b 7761  ks=chunks, **kwa
+00008930: 7267 7329 0a0a 2020 2020 2320 6966 206d  rgs)..    # if m
+00008940: 6f6d 656e 7473 2061 7265 2073 7065 6369  oments are speci
+00008950: 6669 6564 2069 6e20 5852 6164 5469 6d65  fied in XRadTime
+00008960: 7365 7269 6573 206f 6e6c 7920 6c6f 6164  series only load
+00008970: 2074 686f 7365 0a20 2020 2069 6620 6d6f   those.    if mo
+00008980: 6d65 6e74 732e 7061 7265 6e74 2e5f 6d6f  ments.parent._mo
+00008990: 6d65 6e74 7320 6973 206e 6f74 204e 6f6e  ments is not Non
+000089a0: 653a 0a20 2020 2020 2020 206d 6f6d 656e  e:.        momen
+000089b0: 7473 203d 205b 7020 666f 7220 7020 696e  ts = [p for p in
+000089c0: 206d 6f6d 656e 7473 2069 6620 702e 7175   moments if p.qu
+000089d0: 616e 7469 7479 2069 6e20 6d6f 6d65 6e74  antity in moment
+000089e0: 732e 7061 7265 6e74 2e5f 6d6f 6d65 6e74  s.parent._moment
+000089f0: 735d 0a0a 2020 2020 656e 6769 6e65 203d  s]..    engine =
+00008a00: 206d 6f6d 656e 7473 5b30 5d2e 656e 6769   moments[0].engi
+00008a10: 6e65 0a20 2020 2069 6620 656e 6769 6e65  ne.    if engine
+00008a20: 203d 3d20 226e 6574 6364 6634 223a 0a20   == "netcdf4":. 
+00008a30: 2020 2020 2020 206f 7065 6e65 7220 3d20         opener = 
+00008a40: 6e63 2e44 6174 6173 6574 0a20 2020 2020  nc.Dataset.     
+00008a50: 2020 206f 7065 6e65 725f 6b77 6172 6773     opener_kwargs
+00008a60: 203d 207b 7d0a 2020 2020 2020 2020 7374   = {}.        st
+00008a70: 6f72 6520 3d20 7872 2e62 6163 6b65 6e64  ore = xr.backend
+00008a80: 732e 4e65 7443 4446 3444 6174 6153 746f  s.NetCDF4DataSto
+00008a90: 7265 0a20 2020 2065 6c73 653a 0a20 2020  re.    else:.   
+00008aa0: 2020 2020 2069 6620 4c6f 6f73 6556 6572       if LooseVer
+00008ab0: 7369 6f6e 2868 356e 6574 6364 662e 5f5f  sion(h5netcdf.__
+00008ac0: 7665 7273 696f 6e5f 5f29 203c 204c 6f6f  version__) < Loo
+00008ad0: 7365 5665 7273 696f 6e28 2230 2e38 2e30  seVersion("0.8.0
+00008ae0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00008af0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00008b00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00008b10: 2257 5241 444c 4942 3a20 2768 356e 6574  "WRADLIB: 'h5net
+00008b20: 6364 663e 3d30 2e38 2e30 2720 6e65 6564  cdf>=0.8.0' need
+00008b30: 6564 2074 6f20 7065 7266 6f72 6d20 7468  ed to perform th
+00008b40: 6973 2022 0a20 2020 2020 2020 2020 2020  is ".           
+00008b50: 2020 2020 2066 226f 7065 7261 7469 6f6e       f"operation
+00008b60: 2e20 2768 356e 6574 6364 663d 7b68 356e  . 'h5netcdf={h5n
+00008b70: 6574 6364 662e 5f5f 7665 7273 696f 6e5f  etcdf.__version_
+00008b80: 5f7d 2022 0a20 2020 2020 2020 2020 2020  _} ".           
+00008b90: 2020 2020 2066 2261 7661 696c 6162 6c65       f"available
+00008ba0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+00008bb0: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
+00008bc0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00008bd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00008be0: 6e20 4e6f 6e65 0a20 2020 2020 2020 2069  n None.        i
+00008bf0: 6620 4c6f 6f73 6556 6572 7369 6f6e 2878  f LooseVersion(x
+00008c00: 722e 5f5f 7665 7273 696f 6e5f 5f29 203c  r.__version__) <
+00008c10: 204c 6f6f 7365 5665 7273 696f 6e28 2230   LooseVersion("0
+00008c20: 2e31 352e 3022 293a 0a20 2020 2020 2020  .15.0"):.       
+00008c30: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00008c40: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00008c50: 2020 2020 6622 5752 4144 4c49 423a 2027      f"WRADLIB: '
+00008c60: 7861 7272 6179 3e3d 302e 3135 2e30 2720  xarray>=0.15.0' 
+00008c70: 6e65 6564 6564 2074 6f20 7065 7266 6f72  needed to perfor
+00008c80: 6d20 7468 6973 2022 0a20 2020 2020 2020  m this ".       
+00008c90: 2020 2020 2020 2020 2066 226f 7065 7261           f"opera
+00008ca0: 7469 6f6e 2e20 2778 6172 7261 793d 7b78  tion. 'xarray={x
+00008cb0: 722e 5f5f 7665 7273 696f 6e5f 5f7d 2022  r.__version__} "
+00008cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008cd0: 2066 2261 7661 696c 6162 6c65 2e22 2c0a   f"available.",.
+00008ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008cf0: 5573 6572 5761 726e 696e 672c 0a20 2020  UserWarning,.   
+00008d00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00008d10: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00008d20: 6e65 0a20 2020 2020 2020 206f 7065 6e65  ne.        opene
+00008d30: 7220 3d20 6835 6e65 7463 6466 2e46 696c  r = h5netcdf.Fil
+00008d40: 650a 2020 2020 2020 2020 6f70 656e 6572  e.        opener
+00008d50: 5f6b 7761 7267 7320 3d20 6469 6374 2870  _kwargs = dict(p
+00008d60: 686f 6e79 5f64 696d 733d 2261 6363 6573  hony_dims="acces
+00008d70: 7322 290a 2020 2020 2020 2020 7374 6f72  s").        stor
+00008d80: 6520 3d20 7872 2e62 6163 6b65 6e64 732e  e = xr.backends.
+00008d90: 4835 4e65 7443 4446 5374 6f72 650a 0a20  H5NetCDFStore.. 
+00008da0: 2020 2023 2064 6f20 6e6f 7420 7573 6520     # do not use 
+00008db0: 7061 7261 6c6c 656c 2069 6620 616c 6c20  parallel if all 
+00008dc0: 6d6f 6d65 6e74 7320 696e 206f 6e65 2066  moments in one f
+00008dd0: 696c 650a 2020 2020 6966 206c 656e 2873  ile.    if len(s
+00008de0: 6574 285b 702e 6669 6c65 6e61 6d65 2066  et([p.filename f
+00008df0: 6f72 2070 2069 6e20 6d6f 6d65 6e74 735d  or p in moments]
+00008e00: 2929 203d 3d20 313a 0a20 2020 2020 2020  )) == 1:.       
+00008e10: 2073 696e 676c 655f 6669 6c65 203d 2054   single_file = T
+00008e20: 7275 650a 2020 2020 2020 2020 6966 206f  rue.        if o
+00008e30: 732e 7061 7468 2e69 7366 696c 6528 6d6f  s.path.isfile(mo
+00008e40: 6d65 6e74 735b 305d 2e66 696c 656e 616d  ments[0].filenam
+00008e50: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00008e60: 6473 3020 3d20 6f70 656e 6572 286d 6f6d  ds0 = opener(mom
+00008e70: 656e 7473 5b30 5d2e 6669 6c65 6e61 6d65  ents[0].filename
+00008e80: 2c20 2272 222c 202a 2a6f 7065 6e65 725f  , "r", **opener_
+00008e90: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00008ea0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00008eb0: 2020 6473 3020 3d20 6d6f 6d65 6e74 735b    ds0 = moments[
+00008ec0: 305d 2e6e 6366 696c 650a 2020 2020 656c  0].ncfile.    el
+00008ed0: 7365 3a0a 2020 2020 2020 2020 7369 6e67  se:.        sing
+00008ee0: 6c65 5f66 696c 6520 3d20 4661 6c73 650a  le_file = False.
+00008ef0: 0a20 2020 2069 6620 7061 7261 6c6c 656c  .    if parallel
+00008f00: 3a0a 2020 2020 2020 2020 696d 706f 7274  :.        import
+00008f10: 2064 6173 6b0a 0a20 2020 2020 2020 2023   dask..        #
+00008f20: 2077 7261 7020 7468 6520 6f70 656e 5f64   wrap the open_d
+00008f30: 6174 6173 6574 2c20 6765 7461 7474 722c  ataset, getattr,
+00008f40: 2061 6e64 2070 7265 7072 6f63 6573 7320   and preprocess 
+00008f50: 7769 7468 2064 656c 6179 6564 0a20 2020  with delayed.   
+00008f60: 2020 2020 206f 7065 6e5f 203d 2064 6173       open_ = das
+00008f70: 6b2e 6465 6c61 7965 6428 7872 2e6f 7065  k.delayed(xr.ope
+00008f80: 6e5f 6461 7461 7365 7429 0a20 2020 2020  n_dataset).     
+00008f90: 2020 2067 6574 6174 7472 5f20 3d20 6461     getattr_ = da
+00008fa0: 736b 2e64 656c 6179 6564 2867 6574 6174  sk.delayed(getat
+00008fb0: 7472 290a 2020 2020 2020 2020 6966 2070  tr).        if p
+00008fc0: 7265 7072 6f63 6573 7320 6973 206e 6f74  reprocess is not
+00008fd0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00008fe0: 2020 2070 7265 7072 6f63 6573 7320 3d20     preprocess = 
+00008ff0: 6461 736b 2e64 656c 6179 6564 2870 7265  dask.delayed(pre
+00009000: 7072 6f63 6573 7329 0a20 2020 2065 6c73  process).    els
+00009010: 653a 0a20 2020 2020 2020 206f 7065 6e5f  e:.        open_
+00009020: 203d 2078 722e 6f70 656e 5f64 6174 6173   = xr.open_datas
+00009030: 6574 0a20 2020 2020 2020 2067 6574 6174  et.        getat
+00009040: 7472 5f20 3d20 6765 7461 7474 720a 0a20  tr_ = getattr.. 
+00009050: 2020 2069 6620 7369 6e67 6c65 5f66 696c     if single_fil
+00009060: 653a 0a20 2020 2020 2020 2064 6174 6173  e:.        datas
+00009070: 6574 7320 3d20 5b0a 2020 2020 2020 2020  ets = [.        
+00009080: 2020 2020 6f70 656e 5f28 0a20 2020 2020      open_(.     
+00009090: 2020 2020 2020 2020 2020 2073 746f 7265             store
+000090a0: 2864 7330 2c20 6772 6f75 703d 702e 6e63  (ds0, group=p.nc
+000090b0: 7061 7468 2c20 6c6f 636b 3d6c 6f63 6b2c  path, lock=lock,
+000090c0: 2061 7574 6f63 6c6f 7365 3d4e 6f6e 6529   autoclose=None)
+000090d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000090e0: 2020 656e 6769 6e65 3d65 6e67 696e 652c    engine=engine,
+000090f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009100: 202a 2a6f 7065 6e5f 6b77 6172 6773 2c0a   **open_kwargs,.
+00009110: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00009120: 2020 2020 2020 2020 2020 666f 7220 7020            for p 
+00009130: 696e 206d 6f6d 656e 7473 0a20 2020 2020  in moments.     
+00009140: 2020 205d 0a20 2020 2065 6c73 653a 0a20     ].    else:. 
+00009150: 2020 2020 2020 2066 696c 6569 6420 3d20         fileid = 
+00009160: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
+00009170: 2069 6e20 6d6f 6d65 6e74 733a 0a20 2020   in moments:.   
+00009180: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
+00009190: 6174 682e 6973 6669 6c65 2870 2e66 696c  ath.isfile(p.fil
+000091a0: 656e 616d 6529 3a0a 2020 2020 2020 2020  ename):.        
+000091b0: 2020 2020 2020 2020 7020 3d20 6f70 656e          p = open
+000091c0: 6572 2870 2e66 696c 656e 616d 652c 2022  er(p.filename, "
+000091d0: 7222 2c20 2a2a 6f70 656e 6572 5f6b 7761  r", **opener_kwa
+000091e0: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+000091f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00009200: 2020 2020 2020 2070 203d 2070 2e6e 6366         p = p.ncf
+00009210: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
+00009220: 6669 6c65 6964 2e61 7070 656e 6428 7029  fileid.append(p)
+00009230: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
+00009240: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
+00009250: 2020 6f70 656e 5f28 0a20 2020 2020 2020    open_(.       
+00009260: 2020 2020 2020 2020 2073 746f 7265 280a           store(.
+00009270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009280: 2020 2020 662c 0a20 2020 2020 2020 2020      f,.         
+00009290: 2020 2020 2020 2020 2020 2067 726f 7570             group
+000092a0: 3d70 2e6e 6370 6174 682c 0a20 2020 2020  =p.ncpath,.     
+000092b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000092c0: 6f63 6b3d 6c6f 636b 2c0a 2020 2020 2020  ock=lock,.      
+000092d0: 2020 2020 2020 2020 2020 2020 2020 6175                au
+000092e0: 746f 636c 6f73 653d 4e6f 6e65 2c0a 2020  toclose=None,.  
+000092f0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00009300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009310: 2065 6e67 696e 653d 656e 6769 6e65 2c0a   engine=engine,.
+00009320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009330: 2a2a 6f70 656e 5f6b 7761 7267 732c 0a20  **open_kwargs,. 
+00009340: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00009350: 2020 2020 2020 2020 2066 6f72 2066 2c20           for f, 
+00009360: 7020 696e 207a 6970 2866 696c 6569 642c  p in zip(fileid,
+00009370: 206d 6f6d 656e 7473 290a 2020 2020 2020   moments).      
+00009380: 2020 5d0a 2020 2020 6966 204c 6f6f 7365    ].    if Loose
+00009390: 5665 7273 696f 6e28 7872 2e5f 5f76 6572  Version(xr.__ver
+000093a0: 7369 6f6e 5f5f 2920 3c3d 204c 6f6f 7365  sion__) <= Loose
+000093b0: 5665 7273 696f 6e28 2230 2e31 362e 3222  Version("0.16.2"
+000093c0: 293a 0a20 2020 2020 2020 2063 6c6f 7365  ):.        close
+000093d0: 7273 203d 205b 6765 7461 7474 725f 2864  rs = [getattr_(d
+000093e0: 732c 2022 5f66 696c 655f 6f62 6a22 2920  s, "_file_obj") 
+000093f0: 666f 7220 6473 2069 6e20 6461 7461 7365  for ds in datase
+00009400: 7473 5d0a 2020 2020 656c 7365 3a0a 2020  ts].    else:.  
+00009410: 2020 2020 2020 636c 6f73 6572 7320 3d20        closers = 
+00009420: 5b67 6574 6174 7472 5f28 6473 2c20 225f  [getattr_(ds, "_
+00009430: 636c 6f73 6522 2920 666f 7220 6473 2069  close") for ds i
+00009440: 6e20 6461 7461 7365 7473 5d0a 0a20 2020  n datasets]..   
+00009450: 2023 2063 6865 636b 2066 6f72 2064 6966   # check for dif
+00009460: 6665 7265 6e63 6573 2069 6e20 7368 6170  ferences in shap
+00009470: 6520 6f66 206d 6f6d 656e 7473 0a20 2020  e of moments.   
+00009480: 206e 6f6e 5f75 6e69 666f 726d 5f73 6861   non_uniform_sha
+00009490: 7065 203d 206c 656e 2873 6574 285b 7475  pe = len(set([tu
+000094a0: 706c 6528 6473 2e73 697a 6573 2e76 616c  ple(ds.sizes.val
+000094b0: 7565 7328 2929 2066 6f72 2064 7320 696e  ues()) for ds in
+000094c0: 2064 6174 6173 6574 735d 2929 203e 2031   datasets])) > 1
+000094d0: 0a20 2020 2069 6620 7072 6570 726f 6365  .    if preproce
+000094e0: 7373 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ss is not None:.
+000094f0: 2020 2020 2020 2020 6461 7461 7365 7473          datasets
+00009500: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00009510: 2070 7265 7072 6f63 6573 7328 6473 2c20   preprocess(ds, 
+00009520: 6d6f 6d2c 206e 6f6e 5f75 6e69 666f 726d  mom, non_uniform
+00009530: 5f73 6861 7065 2920 666f 7220 6473 2c20  _shape) for ds, 
+00009540: 6d6f 6d20 696e 207a 6970 2864 6174 6173  mom in zip(datas
+00009550: 6574 732c 206d 6f6d 656e 7473 290a 2020  ets, moments).  
+00009560: 2020 2020 2020 5d0a 0a20 2020 2069 6620        ]..    if 
+00009570: 7061 7261 6c6c 656c 3a0a 2020 2020 2020  parallel:.      
+00009580: 2020 2320 6361 6c6c 696e 6720 636f 6d70    # calling comp
+00009590: 7574 6520 6865 7265 2077 696c 6c20 7265  ute here will re
+000095a0: 7475 726e 2074 6865 2064 6174 6173 6574  turn the dataset
+000095b0: 732f 6669 6c65 5f6f 626a 7320 6c69 7374  s/file_objs list
+000095c0: 732c 0a20 2020 2020 2020 2023 2074 6865  s,.        # the
+000095d0: 2075 6e64 6572 6c79 696e 6720 6461 7461   underlying data
+000095e0: 7365 7473 2077 696c 6c20 7374 696c 6c20  sets will still 
+000095f0: 6265 2073 746f 7265 6420 6173 2064 6173  be stored as das
+00009600: 6b20 6172 7261 7973 0a20 2020 2020 2020  k arrays.       
+00009610: 2064 6174 6173 6574 732c 2063 6c6f 7365   datasets, close
+00009620: 7273 203d 2064 6173 6b2e 636f 6d70 7574  rs = dask.comput
+00009630: 6528 6461 7461 7365 7473 2c20 636c 6f73  e(datasets, clos
+00009640: 6572 7329 0a0a 2020 2020 2320 436f 6d62  ers)..    # Comb
+00009650: 696e 6520 616c 6c20 6461 7461 7365 7473  ine all datasets
+00009660: 2c20 636c 6f73 696e 6720 7468 656d 2069  , closing them i
+00009670: 6e20 6361 7365 206f 6620 6120 5661 6c75  n case of a Valu
+00009680: 6545 7272 6f72 0a20 2020 2074 7279 3a0a  eError.    try:.
+00009690: 2020 2020 2020 2020 636f 6d62 696e 6564          combined
+000096a0: 203d 2063 6f6d 6269 6e65 5f62 795f 636f   = combine_by_co
+000096b0: 6f72 6473 280a 2020 2020 2020 2020 2020  ords(.          
+000096c0: 2020 6461 7461 7365 7473 2c20 636f 6d70    datasets, comp
+000096d0: 6174 3d22 6e6f 5f63 6f6e 666c 6963 7473  at="no_conflicts
+000096e0: 222c 2064 6174 615f 7661 7273 3d22 616c  ", data_vars="al
+000096f0: 6c22 2c20 636f 6f72 6473 3d22 6d69 6e69  l", coords="mini
+00009700: 6d61 6c22 0a20 2020 2020 2020 2029 0a20  mal".        ). 
+00009710: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+00009720: 7272 6f72 3a0a 2020 2020 2020 2020 666f  rror:.        fo
+00009730: 7220 6473 2069 6e20 6461 7461 7365 7473  r ds in datasets
+00009740: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+00009750: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+00009760: 2072 6169 7365 0a0a 2020 2020 6966 204c   raise..    if L
+00009770: 6f6f 7365 5665 7273 696f 6e28 7872 2e5f  ooseVersion(xr._
+00009780: 5f76 6572 7369 6f6e 5f5f 2920 3c3d 204c  _version__) <= L
+00009790: 6f6f 7365 5665 7273 696f 6e28 2230 2e31  ooseVersion("0.1
+000097a0: 362e 3222 293a 0a20 2020 2020 2020 2066  6.2"):.        f
+000097b0: 726f 6d20 7861 7272 6179 2e62 6163 6b65  rom xarray.backe
+000097c0: 6e64 732e 6170 6920 696d 706f 7274 205f  nds.api import _
+000097d0: 4d75 6c74 6946 696c 6543 6c6f 7365 720a  MultiFileCloser.
+000097e0: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
+000097f0: 642e 5f66 696c 655f 6f62 6a20 3d20 5f4d  d._file_obj = _M
+00009800: 756c 7469 4669 6c65 436c 6f73 6572 2863  ultiFileCloser(c
+00009810: 6c6f 7365 7273 290a 2020 2020 656c 7365  losers).    else
+00009820: 3a0a 0a20 2020 2020 2020 2064 6566 206d  :..        def m
+00009830: 756c 7469 5f66 696c 655f 636c 6f73 6572  ulti_file_closer
+00009840: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00009850: 666f 7220 636c 6f73 6572 2069 6e20 636c  for closer in cl
+00009860: 6f73 6572 733a 0a20 2020 2020 2020 2020  osers:.         
+00009870: 2020 2020 2020 2063 6c6f 7365 7228 290a         closer().
+00009880: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
+00009890: 642e 7365 745f 636c 6f73 6528 6d75 6c74  d.set_close(mult
+000098a0: 695f 6669 6c65 5f63 6c6f 7365 7229 0a0a  i_file_closer)..
+000098b0: 2020 2020 636f 6d62 696e 6564 2e61 7474      combined.att
+000098c0: 7273 203d 2064 6174 6173 6574 735b 305d  rs = datasets[0]
+000098d0: 2e61 7474 7273 0a20 2020 2072 6574 7572  .attrs.    retur
+000098e0: 6e20 636f 6d62 696e 6564 0a0a 0a63 6c61  n combined...cla
+000098f0: 7373 2058 5261 6442 6173 6528 636f 6c6c  ss XRadBase(coll
+00009900: 6563 7469 6f6e 732e 6162 632e 4d75 7461  ections.abc.Muta
+00009910: 626c 6553 6571 7565 6e63 6529 3a0a 2020  bleSequence):.  
+00009920: 2020 2222 2242 6173 6520 436c 6173 7320    """Base Class 
+00009930: 666f 7220 616c 6c20 5852 6164 2d63 6c61  for all XRad-cla
+00009940: 7373 6573 2e22 2222 0a0a 2020 2020 6465  sses."""..    de
+00009950: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00009960: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00009970: 2020 2020 7375 7065 7228 5852 6164 4261      super(XRadBa
+00009980: 7365 2c20 7365 6c66 292e 5f5f 696e 6974  se, self).__init
+00009990: 5f5f 2829 0a20 2020 2020 2020 2073 656c  __().        sel
+000099a0: 662e 5f73 6571 203d 205b 5d0a 0a20 2020  f._seq = []..   
+000099b0: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
+000099c0: 2873 656c 662c 2069 6e64 6578 293a 0a20  (self, index):. 
+000099d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000099e0: 6c66 2e5f 7365 715b 696e 6465 785d 0a0a  lf._seq[index]..
+000099f0: 2020 2020 6465 6620 5f5f 7365 7469 7465      def __setite
+00009a00: 6d5f 5f28 7365 6c66 2c20 696e 6465 782c  m__(self, index,
+00009a10: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+00009a20: 2073 656c 662e 5f73 6571 5b69 6e64 6578   self._seq[index
+00009a30: 5d20 3d20 7661 6c75 650a 0a20 2020 2064  ] = value..    d
+00009a40: 6566 205f 5f64 656c 6974 656d 5f5f 2873  ef __delitem__(s
+00009a50: 656c 662c 2069 6e64 6578 293a 0a20 2020  elf, index):.   
+00009a60: 2020 2020 2064 656c 2073 656c 662e 5f73       del self._s
+00009a70: 6571 5b69 6e64 6578 5d0a 0a20 2020 2064  eq[index]..    d
+00009a80: 6566 2069 6e73 6572 7428 7365 6c66 2c20  ef insert(self, 
+00009a90: 706f 732c 2076 616c 293a 0a20 2020 2020  pos, val):.     
+00009aa0: 2020 2073 656c 662e 5f73 6571 2e69 6e73     self._seq.ins
+00009ab0: 6572 7428 706f 732c 2076 616c 290a 0a20  ert(pos, val).. 
+00009ac0: 2020 2064 6566 205f 5f69 7465 725f 5f28     def __iter__(
+00009ad0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00009ae0: 6574 7572 6e20 6974 6572 2873 656c 662e  eturn iter(self.
+00009af0: 5f73 6571 290a 0a20 2020 2064 6566 205f  _seq)..    def _
+00009b00: 5f6c 656e 5f5f 2873 656c 6629 3a0a 2020  _len__(self):.  
+00009b10: 2020 2020 2020 7265 7475 726e 206c 656e        return len
+00009b20: 2873 656c 662e 5f73 6571 290a 0a20 2020  (self._seq)..   
+00009b30: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
+00009b40: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00009b50: 7572 6e20 7365 6c66 2e5f 7365 712e 5f5f  urn self._seq.__
+00009b60: 7265 7072 5f5f 2829 0a0a 2020 2020 6465  repr__()..    de
+00009b70: 6620 5f5f 6465 6c5f 5f28 7365 6c66 293a  f __del__(self):
+00009b80: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00009b90: 2e5f 7365 713a 0a20 2020 2020 2020 2020  ._seq:.         
+00009ba0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00009bb0: 6528 6c65 6e28 7365 6c66 2e5f 7365 7129  e(len(self._seq)
+00009bc0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00009bd0: 2020 2064 656c 2073 656c 662e 5f73 6571     del self._seq
+00009be0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00009bf0: 7365 6c66 2e5f 7365 7120 3d20 4e6f 6e65  self._seq = None
+00009c00: 0a0a 2020 2020 6465 6620 736f 7274 2873  ..    def sort(s
+00009c10: 656c 662c 202a 2a6b 7761 7267 7329 3a0a  elf, **kwargs):.
+00009c20: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
+00009c30: 712e 736f 7274 282a 2a6b 7761 7267 7329  q.sort(**kwargs)
+00009c40: 0a0a 0a63 6c61 7373 204f 6469 6d48 3547  ...class OdimH5G
+00009c50: 726f 7570 4174 7472 6962 7574 654d 6978  roupAttributeMix
+00009c60: 696e 3a0a 2020 2020 2222 224d 6978 696e  in:.    """Mixin
+00009c70: 2043 6c61 7373 2066 6f72 204f 6469 6d20   Class for Odim 
+00009c80: 4772 6f75 7020 4174 7472 6962 7574 6520  Group Attribute 
+00009c90: 5265 7472 6965 7661 6c22 2222 0a0a 2020  Retrieval"""..  
+00009ca0: 2020 5f5f 736c 6f74 735f 5f20 3d20 5b22    __slots__ = ["
+00009cb0: 5f61 7474 7273 222c 2022 5f6e 6366 696c  _attrs", "_ncfil
+00009cc0: 6522 2c20 225f 6e63 7061 7468 222c 2022  e", "_ncpath", "
+00009cd0: 5f70 6172 656e 7422 2c20 225f 686f 7722  _parent", "_how"
+00009ce0: 2c20 225f 7768 6174 222c 2022 5f77 6865  , "_what", "_whe
+00009cf0: 7265 225d 0a0a 2020 2020 6465 6620 5f5f  re"]..    def __
+00009d00: 696e 6974 5f5f 2873 656c 662c 206e 6366  init__(self, ncf
+00009d10: 696c 653d 4e6f 6e65 2c20 6e63 7061 7468  ile=None, ncpath
+00009d20: 3d4e 6f6e 652c 2070 6172 656e 743d 4e6f  =None, parent=No
+00009d30: 6e65 293a 0a20 2020 2020 2020 2073 7570  ne):.        sup
+00009d40: 6572 284f 6469 6d48 3547 726f 7570 4174  er(OdimH5GroupAt
+00009d50: 7472 6962 7574 654d 6978 696e 2c20 7365  tributeMixin, se
+00009d60: 6c66 292e 5f5f 696e 6974 5f5f 2829 0a20  lf).__init__(). 
+00009d70: 2020 2020 2020 2073 656c 662e 5f6e 6366         self._ncf
+00009d80: 696c 6520 3d20 6e63 6669 6c65 0a20 2020  ile = ncfile.   
+00009d90: 2020 2020 2073 656c 662e 5f6e 6370 6174       self._ncpat
+00009da0: 6820 3d20 6e63 7061 7468 0a20 2020 2020  h = ncpath.     
+00009db0: 2020 2073 656c 662e 5f70 6172 656e 7420     self._parent 
+00009dc0: 3d20 7061 7265 6e74 0a20 2020 2020 2020  = parent.       
+00009dd0: 2073 656c 662e 5f61 7474 7273 203d 204e   self._attrs = N
+00009de0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+00009df0: 2e5f 686f 7720 3d20 4e6f 6e65 0a20 2020  ._how = None.   
+00009e00: 2020 2020 2073 656c 662e 5f77 6861 7420       self._what 
+00009e10: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00009e20: 656c 662e 5f77 6865 7265 203d 204e 6f6e  elf._where = Non
+00009e30: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+00009e40: 0a20 2020 2064 6566 206e 6370 6174 6828  .    def ncpath(
+00009e50: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00009e60: 2222 5265 7475 726e 7320 7061 7468 2073  ""Returns path s
+00009e70: 7472 696e 6720 696e 7369 6465 2048 4446  tring inside HDF
+00009e80: 3520 4669 6c65 2e22 2222 0a20 2020 2020  5 File.""".     
+00009e90: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00009ea0: 6e63 7061 7468 0a0a 2020 2020 4070 726f  ncpath..    @pro
+00009eb0: 7065 7274 790a 2020 2020 6465 6620 6e63  perty.    def nc
+00009ec0: 6964 2873 656c 6629 3a0a 2020 2020 2020  id(self):.      
+00009ed0: 2020 2222 2252 6574 7572 6e73 2068 616e    """Returns han
+00009ee0: 646c 6520 666f 7220 6375 7272 656e 7420  dle for current 
+00009ef0: 7061 7468 2e22 2222 0a20 2020 2020 2020  path.""".       
+00009f00: 2023 2072 6f6f 742d 6772 6f75 7020 6361   # root-group ca
+00009f10: 6e27 7420 6265 2073 7562 7365 7420 7769  n't be subset wi
+00009f20: 7468 206e 6574 6364 6634 2061 6e64 2068  th netcdf4 and h
+00009f30: 356e 6574 6364 660a 2020 2020 2020 2020  5netcdf.        
+00009f40: 6966 2073 656c 662e 5f6e 6370 6174 6820  if self._ncpath 
+00009f50: 3d3d 2022 2f22 3a0a 2020 2020 2020 2020  == "/":.        
+00009f60: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00009f70: 6528 7365 6c66 2e6e 6366 696c 652c 2028  e(self.ncfile, (
+00009f80: 6e63 2e44 6174 6173 6574 2c20 6835 6e65  nc.Dataset, h5ne
+00009f90: 7463 6466 2e46 696c 6529 293a 0a20 2020  tcdf.File)):.   
+00009fa0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00009fb0: 7572 6e20 7365 6c66 2e5f 6e63 6669 6c65  urn self._ncfile
+00009fc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00009fd0: 7365 6c66 2e5f 6e63 6669 6c65 5b73 656c  self._ncfile[sel
+00009fe0: 662e 6e63 7061 7468 5d0a 0a20 2020 2040  f.ncpath]..    @
+00009ff0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000a000: 206e 6366 696c 6528 7365 6c66 293a 0a20   ncfile(self):. 
+0000a010: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000a020: 7320 6669 6c65 2068 616e 646c 652e 2222  s file handle.""
+0000a030: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000a040: 2073 656c 662e 5f6e 6366 696c 650a 0a20   self._ncfile.. 
+0000a050: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000a060: 2064 6566 2068 6f77 2873 656c 6629 3a0a   def how(self):.
+0000a070: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+0000a080: 6e20 6174 7472 6962 7574 6573 206f 6620  n attributes of 
+0000a090: 6068 6f77 602d 6772 6f75 702e 2222 220a  `how`-group.""".
+0000a0a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000a0b0: 5f68 6f77 2069 7320 4e6f 6e65 3a0a 2020  _how is None:.  
 0000a0c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000a0d0: 7768 6572 6520 3d20 7365 6c66 2e5f 6765  where = self._ge
-0000a0e0: 745f 6174 7472 6962 7574 6573 2822 7768  t_attributes("wh
-0000a0f0: 6572 6522 290a 2020 2020 2020 2020 7265  ere").        re
-0000a100: 7475 726e 2073 656c 662e 5f77 6865 7265  turn self._where
-0000a110: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000a120: 2020 2020 6465 6620 6174 7472 7328 7365      def attrs(se
-0000a130: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000a140: 5265 7475 726e 2067 726f 7570 2061 7474  Return group att
-0000a150: 7269 6275 7465 732e 2222 220a 2020 2020  ributes.""".    
-0000a160: 2020 2020 6966 2073 656c 662e 5f61 7474      if self._att
-0000a170: 7273 2069 7320 4e6f 6e65 3a0a 2020 2020  rs is None:.    
-0000a180: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000a190: 7461 6e63 6528 7365 6c66 2e6e 6366 696c  tance(self.ncfil
-0000a1a0: 652c 206e 632e 4461 7461 7365 7429 3a0a  e, nc.Dataset):.
-0000a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1c0: 7365 6c66 2e5f 6174 7472 7320 3d20 7b6b  self._attrs = {k
-0000a1d0: 3a20 7365 6c66 2e6e 6369 642e 6765 746e  : self.ncid.getn
-0000a1e0: 6361 7474 7228 6b29 2066 6f72 206b 2069  cattr(k) for k i
-0000a1f0: 6e20 7365 6c66 2e6e 6369 642e 6e63 6174  n self.ncid.ncat
-0000a200: 7472 7328 297d 0a20 2020 2020 2020 2020  trs()}.         
-0000a210: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000a220: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
-0000a230: 7474 7273 203d 2073 656c 662e 5f64 6563  ttrs = self._dec
-0000a240: 6f64 6528 7b2a 2a73 656c 662e 6e63 6964  ode({**self.ncid
-0000a250: 2e61 7474 7273 7d29 0a20 2020 2020 2020  .attrs}).       
-0000a260: 2072 6574 7572 6e20 7365 6c66 2e5f 6174   return self._at
-0000a270: 7472 730a 0a20 2020 2040 7072 6f70 6572  trs..    @proper
-0000a280: 7479 0a20 2020 2064 6566 2066 696c 656e  ty.    def filen
-0000a290: 616d 6528 7365 6c66 293a 0a20 2020 2020  ame(self):.     
-0000a2a0: 2020 2022 2222 5265 7475 726e 2066 696c     """Return fil
-0000a2b0: 656e 616d 6520 6772 6f75 7020 6265 6c6f  ename group belo
-0000a2c0: 6e67 7320 746f 2e22 2222 0a20 2020 2020  ngs to.""".     
-0000a2d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0000a2e0: 2873 656c 662e 6e63 6669 6c65 2c20 6e63  (self.ncfile, nc
-0000a2f0: 2e44 6174 6173 6574 293a 0a20 2020 2020  .Dataset):.     
-0000a300: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000a310: 6c66 2e6e 6366 696c 652e 6669 6c65 7061  lf.ncfile.filepa
-0000a320: 7468 2829 0a20 2020 2020 2020 2065 6c73  th().        els
-0000a330: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000a340: 6574 7572 6e20 7365 6c66 2e6e 6366 696c  eturn self.ncfil
-0000a350: 652e 6669 6c65 6e61 6d65 0a0a 2020 2020  e.filename..    
-0000a360: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000a370: 6620 6772 6f75 7073 2873 656c 6629 3a0a  f groups(self):.
-0000a380: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-0000a390: 6e20 6c69 7374 206f 6620 6176 6169 6c61  n list of availa
-0000a3a0: 626c 6520 6772 6f75 7073 2e22 2222 0a20  ble groups.""". 
-0000a3b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000a3c0: 616e 6365 2873 656c 662e 6e63 6669 6c65  ance(self.ncfile
-0000a3d0: 2c20 6e63 2e44 6174 6173 6574 293a 0a20  , nc.Dataset):. 
-0000a3e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000a3f0: 6e20 6c69 7374 2873 656c 662e 6e63 6964  n list(self.ncid
-0000a400: 2e67 726f 7570 7329 0a20 2020 2020 2020  .groups).       
-0000a410: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000a420: 2020 2072 6574 7572 6e20 6c69 7374 2873     return list(s
-0000a430: 656c 662e 6e63 6964 2e6b 6579 7328 2929  elf.ncid.keys())
-0000a440: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000a450: 2020 2020 6465 6620 656e 6769 6e65 2873      def engine(s
-0000a460: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000a470: 2252 6574 7572 6e20 656e 6769 6e65 2075  "Return engine u
-0000a480: 7365 6420 666f 7220 6163 6365 7373 696e  sed for accessin
-0000a490: 6720 6461 7461 2222 220a 2020 2020 2020  g data""".      
-0000a4a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000a4b0: 7365 6c66 2e6e 6366 696c 652c 206e 632e  self.ncfile, nc.
-0000a4c0: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
-0000a4d0: 2020 2020 2020 7265 7475 726e 2022 6e65        return "ne
-0000a4e0: 7463 6466 3422 0a20 2020 2020 2020 2065  tcdf4".        e
-0000a4f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a500: 2072 6574 7572 6e20 2268 356e 6574 6364   return "h5netcd
-0000a510: 6622 0a0a 2020 2020 4070 726f 7065 7274  f"..    @propert
-0000a520: 790a 2020 2020 6465 6620 7061 7265 6e74  y.    def parent
-0000a530: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000a540: 2222 2252 6574 7572 6e20 7061 7265 6e74  """Return parent
-0000a550: 206f 626a 6563 742e 2222 220a 2020 2020   object.""".    
-0000a560: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000a570: 5f70 6172 656e 740a 0a20 2020 2064 6566  _parent..    def
-0000a580: 205f 6765 745f 6174 7472 6962 7574 6573   _get_attributes
-0000a590: 2873 656c 662c 2067 7270 2c20 6e63 6964  (self, grp, ncid
-0000a5a0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0000a5b0: 2222 2252 6574 7572 6e20 6469 6374 2077  """Return dict w
-0000a5c0: 6974 6820 6174 7472 6962 7574 6573 2065  ith attributes e
-0000a5d0: 7874 7261 6374 6564 2066 726f 6d20 6067  xtracted from `g
-0000a5e0: 7270 6022 2222 0a20 2020 2020 2020 2069  rp`""".        i
-0000a5f0: 6620 6e63 6964 2069 7320 4e6f 6e65 3a0a  f ncid is None:.
-0000a600: 2020 2020 2020 2020 2020 2020 6e63 6964              ncid
-0000a610: 203d 2073 656c 662e 6e63 6964 0a20 2020   = self.ncid.   
-0000a620: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0000a630: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000a640: 6e63 6528 7365 6c66 2e6e 6366 696c 652c  nce(self.ncfile,
-0000a650: 206e 632e 4461 7461 7365 7429 3a0a 2020   nc.Dataset):.  
-0000a660: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0000a670: 7472 7320 3d20 7b6b 3a20 6e63 6964 5b67  trs = {k: ncid[g
-0000a680: 7270 5d2e 6765 746e 6361 7474 7228 6b29  rp].getncattr(k)
-0000a690: 2066 6f72 206b 2069 6e20 6e63 6964 5b67   for k in ncid[g
-0000a6a0: 7270 5d2e 6e63 6174 7472 7328 297d 0a20  rp].ncattrs()}. 
-0000a6b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000a6c0: 6574 7572 6e20 6174 7472 730a 2020 2020  eturn attrs.    
-0000a6d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000a6e0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0000a6f0: 7472 7320 3d20 7b2a 2a6e 6369 645b 6772  trs = {**ncid[gr
-0000a700: 705d 2e61 7474 7273 7d0a 2020 2020 2020  p].attrs}.      
-0000a710: 2020 2020 2020 2020 2020 6174 7472 7320            attrs 
-0000a720: 3d20 7365 6c66 2e5f 6465 636f 6465 2861  = self._decode(a
-0000a730: 7474 7273 290a 2020 2020 2020 2020 2020  ttrs).          
-0000a740: 2020 2020 2020 7265 7475 726e 2061 7474        return att
-0000a750: 7273 0a20 2020 2020 2020 2065 7863 6570  rs.        excep
-0000a760: 7420 2849 6e64 6578 4572 726f 722c 204b  t (IndexError, K
-0000a770: 6579 4572 726f 7229 3a0a 2020 2020 2020  eyError):.      
-0000a780: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-0000a790: 650a 0a20 2020 2064 6566 205f 6765 745f  e..    def _get_
-0000a7a0: 6174 7472 6962 7574 6528 7365 6c66 2c20  attribute(self, 
-0000a7b0: 6772 702c 2061 7474 723d 4e6f 6e65 2c20  grp, attr=None, 
-0000a7c0: 6e63 6964 3d4e 6f6e 6529 3a0a 2020 2020  ncid=None):.    
-0000a7d0: 2020 2020 2222 2252 6574 7572 6e20 7369      """Return si
-0000a7e0: 6e67 6c65 2061 7474 7269 6275 7465 2065  ngle attribute e
-0000a7f0: 7874 7261 6374 6564 2066 726f 6d20 6067  xtracted from `g
-0000a800: 7270 6022 2222 0a20 2020 2020 2020 2069  rp`""".        i
-0000a810: 6620 6e63 6964 2069 7320 4e6f 6e65 3a0a  f ncid is None:.
-0000a820: 2020 2020 2020 2020 2020 2020 6e63 6964              ncid
-0000a830: 203d 2073 656c 662e 6e63 6964 0a20 2020   = self.ncid.   
-0000a840: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0000a850: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000a860: 6e63 6528 7365 6c66 2e6e 6366 696c 652c  nce(self.ncfile,
-0000a870: 206e 632e 4461 7461 7365 7429 3a0a 2020   nc.Dataset):.  
-0000a880: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000a890: 7475 726e 206e 6369 645b 6772 705d 2e67  turn ncid[grp].g
-0000a8a0: 6574 6e63 6174 7472 2861 7474 7229 0a20  etncattr(attr). 
-0000a8b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000a8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a8d0: 2076 203d 206e 6369 645b 6772 705d 2e61   v = ncid[grp].a
-0000a8e0: 7474 7273 5b61 7474 725d 0a20 2020 2020  ttrs[attr].     
-0000a8f0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-0000a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a910: 2020 2020 7620 3d20 762e 6974 656d 2829      v = v.item()
-0000a920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a930: 2065 7863 6570 7420 2856 616c 7565 4572   except (ValueEr
-0000a940: 726f 722c 2041 7474 7269 6275 7465 4572  ror, AttributeEr
-0000a950: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-0000a960: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
-0000a970: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000a980: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000a990: 2020 2020 2020 2020 7620 3d20 762e 6465          v = v.de
-0000a9a0: 636f 6465 2829 0a20 2020 2020 2020 2020  code().         
-0000a9b0: 2020 2020 2020 2065 7863 6570 7420 2855         except (U
-0000a9c0: 6e69 636f 6465 4465 636f 6465 4572 726f  nicodeDecodeErro
-0000a9d0: 722c 2041 7474 7269 6275 7465 4572 726f  r, AttributeErro
-0000a9e0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0000a9f0: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0000aa00: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000aa10: 7572 6e20 760a 2020 2020 2020 2020 6578  urn v.        ex
-0000aa20: 6365 7074 2028 496e 6465 7845 7272 6f72  cept (IndexError
-0000aa30: 2c20 4b65 7945 7272 6f72 293a 0a20 2020  , KeyError):.   
-0000aa40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000aa50: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f64  None..    def _d
-0000aa60: 6563 6f64 6528 7365 6c66 2c20 6174 7472  ecode(self, attr
-0000aa70: 7329 3a0a 2020 2020 2020 2020 2222 2244  s):.        """D
-0000aa80: 6563 6f64 6520 7374 7269 6e67 7320 6966  ecode strings if
-0000aa90: 2070 6f73 7369 626c 652e 2222 220a 2020   possible.""".  
-0000aaa0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-0000aab0: 6e20 6174 7472 732e 6974 656d 7328 293a  n attrs.items():
-0000aac0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0000aad0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000aae0: 2020 7620 3d20 762e 6974 656d 2829 0a20    v = v.item(). 
-0000aaf0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0000ab00: 7420 2856 616c 7565 4572 726f 722c 2041  t (ValueError, A
-0000ab10: 7474 7269 6275 7465 4572 726f 7229 3a0a  ttributeError):.
-0000ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab30: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
-0000ab40: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000ab50: 2020 2020 2020 7620 3d20 762e 6465 636f        v = v.deco
-0000ab60: 6465 2829 0a20 2020 2020 2020 2020 2020  de().           
-0000ab70: 2065 7863 6570 7420 2855 6e69 636f 6465   except (Unicode
-0000ab80: 4465 636f 6465 4572 726f 722c 2041 7474  DecodeError, Att
-0000ab90: 7269 6275 7465 4572 726f 7229 3a0a 2020  ributeError):.  
-0000aba0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0000abb0: 7373 0a20 2020 2020 2020 2020 2020 2061  ss.            a
-0000abc0: 7474 7273 5b6b 5d20 3d20 760a 2020 2020  ttrs[k] = v.    
-0000abd0: 2020 2020 7265 7475 726e 2061 7474 7273      return attrs
-0000abe0: 0a0a 0a63 6c61 7373 204f 6469 6d48 3553  ...class OdimH5S
-0000abf0: 7765 6570 4d65 7461 4461 7461 4d69 7869  weepMetaDataMixi
-0000ac00: 6e3a 0a20 2020 2022 2222 4d69 7869 6e20  n:.    """Mixin 
-0000ac10: 436c 6173 7320 666f 7220 4f64 696d 204d  Class for Odim M
-0000ac20: 6574 6144 6174 612e 2222 220a 0a20 2020  etaData."""..   
-0000ac30: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0000ac40: 6c66 293a 0a20 2020 2020 2020 2073 7570  lf):.        sup
-0000ac50: 6572 284f 6469 6d48 3553 7765 6570 4d65  er(OdimH5SweepMe
-0000ac60: 7461 4461 7461 4d69 7869 6e2c 2073 656c  taDataMixin, sel
-0000ac70: 6629 2e5f 5f69 6e69 745f 5f28 290a 2020  f).__init__().  
-0000ac80: 2020 2020 2020 7365 6c66 2e5f 6131 6761        self._a1ga
-0000ac90: 7465 203d 204e 6f6e 650a 2020 2020 2020  te = None.      
-0000aca0: 2020 7365 6c66 2e5f 616e 676c 655f 7265    self._angle_re
-0000acb0: 736f 6c75 7469 6f6e 203d 204e 6f6e 650a  solution = None.
-0000acc0: 2020 2020 2020 2020 7365 6c66 2e5f 617a          self._az
-0000acd0: 696d 7574 6820 3d20 4e6f 6e65 0a20 2020  imuth = None.   
-0000ace0: 2020 2020 2073 656c 662e 5f65 6c65 7661       self._eleva
-0000acf0: 7469 6f6e 203d 204e 6f6e 650a 2020 2020  tion = None.    
-0000ad00: 2020 2020 7365 6c66 2e5f 6669 7865 645f      self._fixed_
-0000ad10: 616e 676c 6520 3d20 4e6f 6e65 0a20 2020  angle = None.   
-0000ad20: 2020 2020 2073 656c 662e 5f6e 7261 7973       self._nrays
-0000ad30: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0000ad40: 7365 6c66 2e5f 6e62 696e 7320 3d20 4e6f  self._nbins = No
-0000ad50: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-0000ad60: 5f74 696d 6520 3d20 4e6f 6e65 0a20 2020  _time = None.   
-0000ad70: 2020 2020 2073 656c 662e 5f65 6e64 7469       self._endti
-0000ad80: 6d65 203d 204e 6f6e 650a 2020 2020 2020  me = None.      
-0000ad90: 2020 7365 6c66 2e5f 7274 696d 6520 3d20    self._rtime = 
-0000ada0: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-0000adb0: 662e 5f72 6e67 203d 204e 6f6e 650a 0a20  f._rng = None.. 
-0000adc0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000add0: 2064 6566 2061 3167 6174 6528 7365 6c66   def a1gate(self
-0000ade0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000adf0: 7475 726e 2061 6e64 2063 6163 6865 2061  turn and cache a
-0000ae00: 3167 6174 652c 2061 7a69 6d75 7468 206f  1gate, azimuth o
-0000ae10: 6620 6669 7273 7420 6d65 6173 7572 6564  f first measured
-0000ae20: 2067 6174 6522 2222 0a20 2020 2020 2020   gate""".       
-0000ae30: 2069 6620 7365 6c66 2e5f 6131 6761 7465   if self._a1gate
-0000ae40: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000ae50: 2020 2020 2020 7365 6c66 2e5f 6131 6761        self._a1ga
-0000ae60: 7465 203d 2073 656c 662e 5f67 6574 5f61  te = self._get_a
-0000ae70: 3167 6174 6528 290a 2020 2020 2020 2020  1gate().        
-0000ae80: 7265 7475 726e 2073 656c 662e 5f61 3167  return self._a1g
-0000ae90: 6174 650a 0a20 2020 2040 7072 6f70 6572  ate..    @proper
-0000aea0: 7479 0a20 2020 2064 6566 2061 6e67 6c65  ty.    def angle
-0000aeb0: 5f72 6573 6f6c 7574 696f 6e28 7365 6c66  _resolution(self
-0000aec0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000aed0: 7475 726e 2061 6e64 2063 6163 6865 2061  turn and cache a
-0000aee0: 6e67 756c 6172 2072 6573 6f6c 7574 696f  ngular resolutio
-0000aef0: 6e20 696e 2064 6567 7265 652e 2222 220a  n in degree.""".
-0000af00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000af10: 5f61 6e67 6c65 5f72 6573 6f6c 7574 696f  _angle_resolutio
-0000af20: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
-0000af30: 2020 2020 2020 2073 656c 662e 5f61 6e67         self._ang
-0000af40: 6c65 5f72 6573 6f6c 7574 696f 6e20 3d20  le_resolution = 
-0000af50: 7365 6c66 2e5f 6765 745f 616e 676c 655f  self._get_angle_
-0000af60: 7265 736f 6c75 7469 6f6e 2829 0a20 2020  resolution().   
-0000af70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000af80: 2e5f 616e 676c 655f 7265 736f 6c75 7469  ._angle_resoluti
-0000af90: 6f6e 0a0a 2020 2020 4070 726f 7065 7274  on..    @propert
-0000afa0: 790a 2020 2020 6465 6620 617a 696d 7574  y.    def azimut
-0000afb0: 6828 7365 6c66 293a 0a20 2020 2020 2020  h(self):.       
-0000afc0: 2022 2222 5265 7475 726e 2061 6e64 2063   """Return and c
-0000afd0: 6163 6865 2061 7a69 6d75 7468 2078 722e  ache azimuth xr.
-0000afe0: 4461 7461 4172 7261 792e 2222 220a 2020  DataArray.""".  
-0000aff0: 2020 2020 2020 6966 2073 656c 662e 5f61        if self._a
-0000b000: 7a69 6d75 7468 2069 7320 4e6f 6e65 3a0a  zimuth is None:.
-0000b010: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b020: 2e5f 617a 696d 7574 6820 3d20 7365 6c66  ._azimuth = self
-0000b030: 2e5f 6765 745f 617a 696d 7574 6828 290a  ._get_azimuth().
-0000b040: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b050: 656c 662e 5f61 7a69 6d75 7468 0a0a 2020  elf._azimuth..  
-0000b060: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000b070: 6465 6620 656c 6576 6174 696f 6e28 7365  def elevation(se
-0000b080: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000b090: 5265 7475 726e 2061 6e64 2063 6163 6865  Return and cache
-0000b0a0: 2065 6c65 7661 7469 6f6e 2078 722e 4461   elevation xr.Da
-0000b0b0: 7461 4172 7261 792e 2222 220a 2020 2020  taArray.""".    
-0000b0c0: 2020 2020 6966 2073 656c 662e 5f65 6c65      if self._ele
-0000b0d0: 7661 7469 6f6e 2069 7320 4e6f 6e65 3a0a  vation is None:.
-0000b0e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b0f0: 2e5f 656c 6576 6174 696f 6e20 3d20 7365  ._elevation = se
-0000b100: 6c66 2e5f 6765 745f 656c 6576 6174 696f  lf._get_elevatio
-0000b110: 6e28 290a 2020 2020 2020 2020 7265 7475  n().        retu
-0000b120: 726e 2073 656c 662e 5f65 6c65 7661 7469  rn self._elevati
-0000b130: 6f6e 0a0a 2020 2020 4070 726f 7065 7274  on..    @propert
-0000b140: 790a 2020 2020 6465 6620 6669 7865 645f  y.    def fixed_
-0000b150: 616e 676c 6528 7365 6c66 293a 0a20 2020  angle(self):.   
-0000b160: 2020 2020 2022 2222 5265 7475 726e 2061       """Return a
-0000b170: 6e64 2063 6163 6865 2065 6c65 7661 7469  nd cache elevati
-0000b180: 6f6e 2061 6e67 6c65 2069 6e20 6465 6772  on angle in degr
-0000b190: 6565 2e22 2222 0a20 2020 2020 2020 2069  ee.""".        i
-0000b1a0: 6620 7365 6c66 2e5f 6669 7865 645f 616e  f self._fixed_an
-0000b1b0: 676c 6520 6973 204e 6f6e 653a 0a20 2020  gle is None:.   
-0000b1c0: 2020 2020 2020 2020 2073 656c 662e 5f66           self._f
-0000b1d0: 6978 6564 5f61 6e67 6c65 203d 2073 656c  ixed_angle = sel
-0000b1e0: 662e 5f67 6574 5f66 6978 6564 5f61 6e67  f._get_fixed_ang
-0000b1f0: 6c65 2829 0a20 2020 2020 2020 2072 6574  le().        ret
-0000b200: 7572 6e20 7365 6c66 2e5f 6669 7865 645f  urn self._fixed_
-0000b210: 616e 676c 650a 0a20 2020 2040 7072 6f70  angle..    @prop
-0000b220: 6572 7479 0a20 2020 2064 6566 206e 7261  erty.    def nra
-0000b230: 7973 2873 656c 6629 3a0a 2020 2020 2020  ys(self):.      
-0000b240: 2020 2222 2252 6574 7572 6e20 616e 6420    """Return and 
-0000b250: 6361 6368 6520 6e75 6d62 6572 206f 6620  cache number of 
-0000b260: 7261 7973 2e22 2222 0a20 2020 2020 2020  rays.""".       
-0000b270: 2069 6620 7365 6c66 2e5f 6e72 6179 7320   if self._nrays 
-0000b280: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000b290: 2020 2020 2073 656c 662e 5f6e 7261 7973       self._nrays
-0000b2a0: 203d 2073 656c 662e 5f67 6574 5f6e 7261   = self._get_nra
-0000b2b0: 7973 2829 0a20 2020 2020 2020 2072 6574  ys().        ret
-0000b2c0: 7572 6e20 7365 6c66 2e5f 6e72 6179 730a  urn self._nrays.
-0000b2d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000b2e0: 2020 2064 6566 206e 6269 6e73 2873 656c     def nbins(sel
-0000b2f0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-0000b300: 6574 7572 6e20 616e 6420 6361 6368 6520  eturn and cache 
-0000b310: 6e75 6d62 6572 206f 6620 6269 6e73 2e22  number of bins."
-0000b320: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-0000b330: 6c66 2e5f 6e62 696e 7320 6973 204e 6f6e  lf._nbins is Non
+0000a0d0: 686f 7720 3d20 7365 6c66 2e5f 6765 745f  how = self._get_
+0000a0e0: 6174 7472 6962 7574 6573 2822 686f 7722  attributes("how"
+0000a0f0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000a100: 2073 656c 662e 5f68 6f77 0a0a 2020 2020   self._how..    
+0000a110: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000a120: 6620 7768 6174 2873 656c 6629 3a0a 2020  f what(self):.  
+0000a130: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0000a140: 6174 7472 6962 7574 6573 206f 6620 6077  attributes of `w
+0000a150: 6861 7460 2d67 726f 7570 2e22 2222 0a20  hat`-group.""". 
+0000a160: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0000a170: 7768 6174 2069 7320 4e6f 6e65 3a0a 2020  what is None:.  
+0000a180: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000a190: 7768 6174 203d 2073 656c 662e 5f67 6574  what = self._get
+0000a1a0: 5f61 7474 7269 6275 7465 7328 2277 6861  _attributes("wha
+0000a1b0: 7422 290a 2020 2020 2020 2020 7265 7475  t").        retu
+0000a1c0: 726e 2073 656c 662e 5f77 6861 740a 0a20  rn self._what.. 
+0000a1d0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000a1e0: 2064 6566 2077 6865 7265 2873 656c 6629   def where(self)
+0000a1f0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000a200: 7572 6e20 6174 7472 6962 7574 6573 206f  urn attributes o
+0000a210: 6620 6077 6865 7265 602d 6772 6f75 702e  f `where`-group.
+0000a220: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+0000a230: 656c 662e 5f77 6865 7265 2069 7320 4e6f  elf._where is No
+0000a240: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000a250: 7365 6c66 2e5f 7768 6572 6520 3d20 7365  self._where = se
+0000a260: 6c66 2e5f 6765 745f 6174 7472 6962 7574  lf._get_attribut
+0000a270: 6573 2822 7768 6572 6522 290a 2020 2020  es("where").    
+0000a280: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000a290: 5f77 6865 7265 0a0a 2020 2020 4070 726f  _where..    @pro
+0000a2a0: 7065 7274 790a 2020 2020 6465 6620 6174  perty.    def at
+0000a2b0: 7472 7328 7365 6c66 293a 0a20 2020 2020  trs(self):.     
+0000a2c0: 2020 2022 2222 5265 7475 726e 2067 726f     """Return gro
+0000a2d0: 7570 2061 7474 7269 6275 7465 732e 2222  up attributes.""
+0000a2e0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0000a2f0: 662e 5f61 7474 7273 2069 7320 4e6f 6e65  f._attrs is None
+0000a300: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000a310: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+0000a320: 2e6e 6366 696c 652c 206e 632e 4461 7461  .ncfile, nc.Data
+0000a330: 7365 7429 3a0a 2020 2020 2020 2020 2020  set):.          
+0000a340: 2020 2020 2020 7365 6c66 2e5f 6174 7472        self._attr
+0000a350: 7320 3d20 7b6b 3a20 7365 6c66 2e6e 6369  s = {k: self.nci
+0000a360: 642e 6765 746e 6361 7474 7228 6b29 2066  d.getncattr(k) f
+0000a370: 6f72 206b 2069 6e20 7365 6c66 2e6e 6369  or k in self.nci
+0000a380: 642e 6e63 6174 7472 7328 297d 0a20 2020  d.ncattrs()}.   
+0000a390: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a3b0: 656c 662e 5f61 7474 7273 203d 2073 656c  elf._attrs = sel
+0000a3c0: 662e 5f64 6563 6f64 6528 7b2a 2a73 656c  f._decode({**sel
+0000a3d0: 662e 6e63 6964 2e61 7474 7273 7d29 0a20  f.ncid.attrs}). 
+0000a3e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000a3f0: 6c66 2e5f 6174 7472 730a 0a20 2020 2040  lf._attrs..    @
+0000a400: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000a410: 2066 696c 656e 616d 6528 7365 6c66 293a   filename(self):
+0000a420: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+0000a430: 726e 2066 696c 656e 616d 6520 6772 6f75  rn filename grou
+0000a440: 7020 6265 6c6f 6e67 7320 746f 2e22 2222  p belongs to."""
+0000a450: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0000a460: 7374 616e 6365 2873 656c 662e 6e63 6669  stance(self.ncfi
+0000a470: 6c65 2c20 6e63 2e44 6174 6173 6574 293a  le, nc.Dataset):
+0000a480: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000a490: 7572 6e20 7365 6c66 2e6e 6366 696c 652e  urn self.ncfile.
+0000a4a0: 6669 6c65 7061 7468 2829 0a20 2020 2020  filepath().     
+0000a4b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a4c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000a4d0: 2e6e 6366 696c 652e 6669 6c65 6e61 6d65  .ncfile.filename
+0000a4e0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000a4f0: 2020 2020 6465 6620 6772 6f75 7073 2873      def groups(s
+0000a500: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000a510: 2252 6574 7572 6e20 6c69 7374 206f 6620  "Return list of 
+0000a520: 6176 6169 6c61 626c 6520 6772 6f75 7073  available groups
+0000a530: 2e22 2222 0a20 2020 2020 2020 2069 6620  .""".        if 
+0000a540: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+0000a550: 6e63 6669 6c65 2c20 6e63 2e44 6174 6173  ncfile, nc.Datas
+0000a560: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
+0000a570: 2072 6574 7572 6e20 6c69 7374 2873 656c   return list(sel
+0000a580: 662e 6e63 6964 2e67 726f 7570 7329 0a20  f.ncid.groups). 
+0000a590: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000a5a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000a5b0: 6c69 7374 2873 656c 662e 6e63 6964 2e6b  list(self.ncid.k
+0000a5c0: 6579 7328 2929 0a0a 2020 2020 4070 726f  eys())..    @pro
+0000a5d0: 7065 7274 790a 2020 2020 6465 6620 656e  perty.    def en
+0000a5e0: 6769 6e65 2873 656c 6629 3a0a 2020 2020  gine(self):.    
+0000a5f0: 2020 2020 2222 2252 6574 7572 6e20 656e      """Return en
+0000a600: 6769 6e65 2075 7365 6420 666f 7220 6163  gine used for ac
+0000a610: 6365 7373 696e 6720 6461 7461 2222 220a  cessing data""".
+0000a620: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000a630: 7461 6e63 6528 7365 6c66 2e6e 6366 696c  tance(self.ncfil
+0000a640: 652c 206e 632e 4461 7461 7365 7429 3a0a  e, nc.Dataset):.
+0000a650: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000a660: 726e 2022 6e65 7463 6466 3422 0a20 2020  rn "netcdf4".   
+0000a670: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000a680: 2020 2020 2020 2072 6574 7572 6e20 2268         return "h
+0000a690: 356e 6574 6364 6622 0a0a 2020 2020 4070  5netcdf"..    @p
+0000a6a0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000a6b0: 7061 7265 6e74 2873 656c 6629 3a0a 2020  parent(self):.  
+0000a6c0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0000a6d0: 7061 7265 6e74 206f 626a 6563 742e 2222  parent object.""
+0000a6e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000a6f0: 2073 656c 662e 5f70 6172 656e 740a 0a20   self._parent.. 
+0000a700: 2020 2064 6566 205f 6765 745f 6174 7472     def _get_attr
+0000a710: 6962 7574 6573 2873 656c 662c 2067 7270  ibutes(self, grp
+0000a720: 2c20 6e63 6964 3d4e 6f6e 6529 3a0a 2020  , ncid=None):.  
+0000a730: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0000a740: 6469 6374 2077 6974 6820 6174 7472 6962  dict with attrib
+0000a750: 7574 6573 2065 7874 7261 6374 6564 2066  utes extracted f
+0000a760: 726f 6d20 6067 7270 6022 2222 0a20 2020  rom `grp`""".   
+0000a770: 2020 2020 2069 6620 6e63 6964 2069 7320       if ncid is 
+0000a780: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000a790: 2020 6e63 6964 203d 2073 656c 662e 6e63    ncid = self.nc
+0000a7a0: 6964 0a20 2020 2020 2020 2074 7279 3a0a  id.        try:.
+0000a7b0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000a7c0: 7369 6e73 7461 6e63 6528 7365 6c66 2e6e  sinstance(self.n
+0000a7d0: 6366 696c 652c 206e 632e 4461 7461 7365  cfile, nc.Datase
+0000a7e0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0000a7f0: 2020 2020 6174 7472 7320 3d20 7b6b 3a20      attrs = {k: 
+0000a800: 6e63 6964 5b67 7270 5d2e 6765 746e 6361  ncid[grp].getnca
+0000a810: 7474 7228 6b29 2066 6f72 206b 2069 6e20  ttr(k) for k in 
+0000a820: 6e63 6964 5b67 7270 5d2e 6e63 6174 7472  ncid[grp].ncattr
+0000a830: 7328 297d 0a20 2020 2020 2020 2020 2020  s()}.           
+0000a840: 2020 2020 2072 6574 7572 6e20 6174 7472       return attr
+0000a850: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+0000a860: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000a870: 2020 2020 6174 7472 7320 3d20 7b2a 2a6e      attrs = {**n
+0000a880: 6369 645b 6772 705d 2e61 7474 7273 7d0a  cid[grp].attrs}.
+0000a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a8a0: 6174 7472 7320 3d20 7365 6c66 2e5f 6465  attrs = self._de
+0000a8b0: 636f 6465 2861 7474 7273 290a 2020 2020  code(attrs).    
+0000a8c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000a8d0: 726e 2061 7474 7273 0a20 2020 2020 2020  rn attrs.       
+0000a8e0: 2065 7863 6570 7420 2849 6e64 6578 4572   except (IndexEr
+0000a8f0: 726f 722c 204b 6579 4572 726f 7229 3a0a  ror, KeyError):.
+0000a900: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000a910: 726e 204e 6f6e 650a 0a20 2020 2064 6566  rn None..    def
+0000a920: 205f 6765 745f 6174 7472 6962 7574 6528   _get_attribute(
+0000a930: 7365 6c66 2c20 6772 702c 2061 7474 723d  self, grp, attr=
+0000a940: 4e6f 6e65 2c20 6e63 6964 3d4e 6f6e 6529  None, ncid=None)
+0000a950: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000a960: 7572 6e20 7369 6e67 6c65 2061 7474 7269  urn single attri
+0000a970: 6275 7465 2065 7874 7261 6374 6564 2066  bute extracted f
+0000a980: 726f 6d20 6067 7270 6022 2222 0a20 2020  rom `grp`""".   
+0000a990: 2020 2020 2069 6620 6e63 6964 2069 7320       if ncid is 
+0000a9a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000a9b0: 2020 6e63 6964 203d 2073 656c 662e 6e63    ncid = self.nc
+0000a9c0: 6964 0a20 2020 2020 2020 2074 7279 3a0a  id.        try:.
+0000a9d0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000a9e0: 7369 6e73 7461 6e63 6528 7365 6c66 2e6e  sinstance(self.n
+0000a9f0: 6366 696c 652c 206e 632e 4461 7461 7365  cfile, nc.Datase
+0000aa00: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0000aa10: 2020 2020 7265 7475 726e 206e 6369 645b      return ncid[
+0000aa20: 6772 705d 2e67 6574 6e63 6174 7472 2861  grp].getncattr(a
+0000aa30: 7474 7229 0a20 2020 2020 2020 2020 2020  ttr).           
+0000aa40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000aa50: 2020 2020 2020 2076 203d 206e 6369 645b         v = ncid[
+0000aa60: 6772 705d 2e61 7474 7273 5b61 7474 725d  grp].attrs[attr]
+0000aa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aa80: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000aa90: 2020 2020 2020 2020 2020 7620 3d20 762e            v = v.
+0000aaa0: 6974 656d 2829 0a20 2020 2020 2020 2020  item().         
+0000aab0: 2020 2020 2020 2065 7863 6570 7420 2856         except (V
+0000aac0: 616c 7565 4572 726f 722c 2041 7474 7269  alueError, Attri
+0000aad0: 6275 7465 4572 726f 7229 3a0a 2020 2020  buteError):.    
+0000aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aaf0: 7061 7373 0a20 2020 2020 2020 2020 2020  pass.           
+0000ab00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0000ab10: 2020 2020 2020 2020 2020 2020 2020 7620                v 
+0000ab20: 3d20 762e 6465 636f 6465 2829 0a20 2020  = v.decode().   
+0000ab30: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0000ab40: 6570 7420 2855 6e69 636f 6465 4465 636f  ept (UnicodeDeco
+0000ab50: 6465 4572 726f 722c 2041 7474 7269 6275  deError, Attribu
+0000ab60: 7465 4572 726f 7229 3a0a 2020 2020 2020  teError):.      
+0000ab70: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000ab80: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
+0000ab90: 2020 2072 6574 7572 6e20 760a 2020 2020     return v.    
+0000aba0: 2020 2020 6578 6365 7074 2028 496e 6465      except (Inde
+0000abb0: 7845 7272 6f72 2c20 4b65 7945 7272 6f72  xError, KeyError
+0000abc0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0000abd0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+0000abe0: 6465 6620 5f64 6563 6f64 6528 7365 6c66  def _decode(self
+0000abf0: 2c20 6174 7472 7329 3a0a 2020 2020 2020  , attrs):.      
+0000ac00: 2020 2222 2244 6563 6f64 6520 7374 7269    """Decode stri
+0000ac10: 6e67 7320 6966 2070 6f73 7369 626c 652e  ngs if possible.
+0000ac20: 2222 220a 2020 2020 2020 2020 666f 7220  """.        for 
+0000ac30: 6b2c 2076 2069 6e20 6174 7472 732e 6974  k, v in attrs.it
+0000ac40: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+0000ac50: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000ac60: 2020 2020 2020 2020 7620 3d20 762e 6974          v = v.it
+0000ac70: 656d 2829 0a20 2020 2020 2020 2020 2020  em().           
+0000ac80: 2065 7863 6570 7420 2856 616c 7565 4572   except (ValueEr
+0000ac90: 726f 722c 2041 7474 7269 6275 7465 4572  ror, AttributeEr
+0000aca0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+0000acb0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
+0000acc0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000acd0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+0000ace0: 762e 6465 636f 6465 2829 0a20 2020 2020  v.decode().     
+0000acf0: 2020 2020 2020 2065 7863 6570 7420 2855         except (U
+0000ad00: 6e69 636f 6465 4465 636f 6465 4572 726f  nicodeDecodeErro
+0000ad10: 722c 2041 7474 7269 6275 7465 4572 726f  r, AttributeErro
+0000ad20: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0000ad30: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+0000ad40: 2020 2020 2061 7474 7273 5b6b 5d20 3d20       attrs[k] = 
+0000ad50: 760a 2020 2020 2020 2020 7265 7475 726e  v.        return
+0000ad60: 2061 7474 7273 0a0a 0a63 6c61 7373 204f   attrs...class O
+0000ad70: 6469 6d48 3553 7765 6570 4d65 7461 4461  dimH5SweepMetaDa
+0000ad80: 7461 4d69 7869 6e3a 0a20 2020 2022 2222  taMixin:.    """
+0000ad90: 4d69 7869 6e20 436c 6173 7320 666f 7220  Mixin Class for 
+0000ada0: 4f64 696d 204d 6574 6144 6174 612e 2222  Odim MetaData.""
+0000adb0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+0000adc0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
+0000add0: 2020 2073 7570 6572 284f 6469 6d48 3553     super(OdimH5S
+0000ade0: 7765 6570 4d65 7461 4461 7461 4d69 7869  weepMetaDataMixi
+0000adf0: 6e2c 2073 656c 6629 2e5f 5f69 6e69 745f  n, self).__init_
+0000ae00: 5f28 290a 2020 2020 2020 2020 7365 6c66  _().        self
+0000ae10: 2e5f 6131 6761 7465 203d 204e 6f6e 650a  ._a1gate = None.
+0000ae20: 2020 2020 2020 2020 7365 6c66 2e5f 616e          self._an
+0000ae30: 676c 655f 7265 736f 6c75 7469 6f6e 203d  gle_resolution =
+0000ae40: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+0000ae50: 6c66 2e5f 617a 696d 7574 6820 3d20 4e6f  lf._azimuth = No
+0000ae60: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+0000ae70: 5f65 6c65 7661 7469 6f6e 203d 204e 6f6e  _elevation = Non
+0000ae80: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+0000ae90: 6669 7865 645f 616e 676c 6520 3d20 4e6f  fixed_angle = No
+0000aea0: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+0000aeb0: 5f6e 7261 7973 203d 204e 6f6e 650a 2020  _nrays = None.  
+0000aec0: 2020 2020 2020 7365 6c66 2e5f 6e62 696e        self._nbin
+0000aed0: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
+0000aee0: 2073 656c 662e 5f74 696d 6520 3d20 4e6f   self._time = No
+0000aef0: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+0000af00: 5f65 6e64 7469 6d65 203d 204e 6f6e 650a  _endtime = None.
+0000af10: 2020 2020 2020 2020 7365 6c66 2e5f 7274          self._rt
+0000af20: 696d 6520 3d20 4e6f 6e65 0a20 2020 2020  ime = None.     
+0000af30: 2020 2073 656c 662e 5f72 6e67 203d 204e     self._rng = N
+0000af40: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
+0000af50: 7479 0a20 2020 2064 6566 2061 3167 6174  ty.    def a1gat
+0000af60: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0000af70: 2022 2222 5265 7475 726e 2061 6e64 2063   """Return and c
+0000af80: 6163 6865 2061 3167 6174 652c 2061 7a69  ache a1gate, azi
+0000af90: 6d75 7468 206f 6620 6669 7273 7420 6d65  muth of first me
+0000afa0: 6173 7572 6564 2067 6174 6522 2222 0a20  asured gate""". 
+0000afb0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0000afc0: 6131 6761 7465 2069 7320 4e6f 6e65 3a0a  a1gate is None:.
+0000afd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000afe0: 2e5f 6131 6761 7465 203d 2073 656c 662e  ._a1gate = self.
+0000aff0: 5f67 6574 5f61 3167 6174 6528 290a 2020  _get_a1gate().  
+0000b000: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000b010: 662e 5f61 3167 6174 650a 0a20 2020 2040  f._a1gate..    @
+0000b020: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000b030: 2061 6e67 6c65 5f72 6573 6f6c 7574 696f   angle_resolutio
+0000b040: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+0000b050: 2022 2222 5265 7475 726e 2061 6e64 2063   """Return and c
+0000b060: 6163 6865 2061 6e67 756c 6172 2072 6573  ache angular res
+0000b070: 6f6c 7574 696f 6e20 696e 2064 6567 7265  olution in degre
+0000b080: 652e 2222 220a 2020 2020 2020 2020 6966  e.""".        if
+0000b090: 2073 656c 662e 5f61 6e67 6c65 5f72 6573   self._angle_res
+0000b0a0: 6f6c 7574 696f 6e20 6973 204e 6f6e 653a  olution is None:
+0000b0b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000b0c0: 662e 5f61 6e67 6c65 5f72 6573 6f6c 7574  f._angle_resolut
+0000b0d0: 696f 6e20 3d20 7365 6c66 2e5f 6765 745f  ion = self._get_
+0000b0e0: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
+0000b0f0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+0000b100: 6e20 7365 6c66 2e5f 616e 676c 655f 7265  n self._angle_re
+0000b110: 736f 6c75 7469 6f6e 0a0a 2020 2020 4070  solution..    @p
+0000b120: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000b130: 617a 696d 7574 6828 7365 6c66 293a 0a20  azimuth(self):. 
+0000b140: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000b150: 2061 6e64 2063 6163 6865 2061 7a69 6d75   and cache azimu
+0000b160: 7468 2078 722e 4461 7461 4172 7261 792e  th xr.DataArray.
+0000b170: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+0000b180: 656c 662e 5f61 7a69 6d75 7468 2069 7320  elf._azimuth is 
+0000b190: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000b1a0: 2020 7365 6c66 2e5f 617a 696d 7574 6820    self._azimuth 
+0000b1b0: 3d20 7365 6c66 2e5f 6765 745f 617a 696d  = self._get_azim
+0000b1c0: 7574 6828 290a 2020 2020 2020 2020 7265  uth().        re
+0000b1d0: 7475 726e 2073 656c 662e 5f61 7a69 6d75  turn self._azimu
+0000b1e0: 7468 0a0a 2020 2020 4070 726f 7065 7274  th..    @propert
+0000b1f0: 790a 2020 2020 6465 6620 656c 6576 6174  y.    def elevat
+0000b200: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
+0000b210: 2020 2022 2222 5265 7475 726e 2061 6e64     """Return and
+0000b220: 2063 6163 6865 2065 6c65 7661 7469 6f6e   cache elevation
+0000b230: 2078 722e 4461 7461 4172 7261 792e 2222   xr.DataArray.""
+0000b240: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0000b250: 662e 5f65 6c65 7661 7469 6f6e 2069 7320  f._elevation is 
+0000b260: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000b270: 2020 7365 6c66 2e5f 656c 6576 6174 696f    self._elevatio
+0000b280: 6e20 3d20 7365 6c66 2e5f 6765 745f 656c  n = self._get_el
+0000b290: 6576 6174 696f 6e28 290a 2020 2020 2020  evation().      
+0000b2a0: 2020 7265 7475 726e 2073 656c 662e 5f65    return self._e
+0000b2b0: 6c65 7661 7469 6f6e 0a0a 2020 2020 4070  levation..    @p
+0000b2c0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000b2d0: 6669 7865 645f 616e 676c 6528 7365 6c66  fixed_angle(self
+0000b2e0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000b2f0: 7475 726e 2061 6e64 2063 6163 6865 2065  turn and cache e
+0000b300: 6c65 7661 7469 6f6e 2061 6e67 6c65 2069  levation angle i
+0000b310: 6e20 6465 6772 6565 2e22 2222 0a20 2020  n degree.""".   
+0000b320: 2020 2020 2069 6620 7365 6c66 2e5f 6669       if self._fi
+0000b330: 7865 645f 616e 676c 6520 6973 204e 6f6e  xed_angle is Non
 0000b340: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000b350: 656c 662e 5f6e 6269 6e73 203d 2073 656c  elf._nbins = sel
-0000b360: 662e 5f67 6574 5f6e 6269 6e73 2829 0a20  f._get_nbins(). 
-0000b370: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000b380: 6c66 2e5f 6e62 696e 730a 0a20 2020 2040  lf._nbins..    @
-0000b390: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000b3a0: 2072 6e67 2873 656c 6629 3a0a 2020 2020   rng(self):.    
-0000b3b0: 2020 2020 2222 2252 6574 7572 6e20 616e      """Return an
-0000b3c0: 6420 6361 6368 6520 7261 6e67 6520 7872  d cache range xr
-0000b3d0: 2e44 6174 6141 7272 6179 2e22 2222 0a20  .DataArray.""". 
-0000b3e0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000b3f0: 726e 6720 6973 204e 6f6e 653a 0a20 2020  rng is None:.   
-0000b400: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-0000b410: 6e67 203d 2073 656c 662e 5f67 6574 5f72  ng = self._get_r
-0000b420: 616e 6765 2829 0a20 2020 2020 2020 2072  ange().        r
-0000b430: 6574 7572 6e20 7365 6c66 2e5f 726e 670a  eturn self._rng.
-0000b440: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000b450: 2020 2064 6566 2072 6179 5f74 696d 6573     def ray_times
-0000b460: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000b470: 2222 2252 6574 7572 6e20 616e 6420 6361  """Return and ca
-0000b480: 6368 6520 7261 795f 7469 6d65 7320 7872  che ray_times xr
-0000b490: 2e44 6174 6141 7272 6179 2e22 2222 0a20  .DataArray.""". 
-0000b4a0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000b4b0: 7274 696d 6520 6973 204e 6f6e 653a 0a20  rtime is None:. 
-0000b4c0: 2020 2020 2020 2020 2020 2064 6120 3d20             da = 
-0000b4d0: 7365 6c66 2e5f 6765 745f 7261 795f 7469  self._get_ray_ti
-0000b4e0: 6d65 7328 290a 2020 2020 2020 2020 2020  mes().          
-0000b4f0: 2020 2320 6465 636f 6465 2c20 6966 206e    # decode, if n
-0000b500: 6563 6573 7361 7279 0a20 2020 2020 2020  ecessary.       
-0000b510: 2020 2020 2069 6620 7365 6c66 2e64 6563       if self.dec
-0000b520: 6f64 655f 7469 6d65 733a 0a20 2020 2020  ode_times:.     
-0000b530: 2020 2020 2020 2020 2020 2064 6120 3d20             da = 
-0000b540: 7365 6c66 2e5f 6465 636f 6465 5f63 6628  self._decode_cf(
-0000b550: 6461 290a 2020 2020 2020 2020 2020 2020  da).            
-0000b560: 7365 6c66 2e5f 7274 696d 6520 3d20 6461  self._rtime = da
-0000b570: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b580: 7365 6c66 2e5f 7274 696d 650a 0a20 2020  self._rtime..   
-0000b590: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000b5a0: 6566 2074 696d 6528 7365 6c66 293a 0a20  ef time(self):. 
-0000b5b0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000b5c0: 2061 6e64 2063 6163 6865 2074 696d 6520   and cache time 
-0000b5d0: 7872 2e44 6174 6141 7272 6179 2e22 2222  xr.DataArray."""
-0000b5e0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000b5f0: 2e5f 7469 6d65 2069 7320 4e6f 6e65 3a0a  ._time is None:.
-0000b600: 2020 2020 2020 2020 2020 2020 6461 203d              da =
-0000b610: 2073 656c 662e 5f67 6574 5f74 696d 6528   self._get_time(
-0000b620: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0000b630: 6465 636f 6465 2c20 6966 206e 6563 6573  decode, if neces
-0000b640: 7361 7279 0a20 2020 2020 2020 2020 2020  sary.           
-0000b650: 2069 6620 7365 6c66 2e64 6563 6f64 655f   if self.decode_
-0000b660: 7469 6d65 733a 0a20 2020 2020 2020 2020  times:.         
-0000b670: 2020 2020 2020 2064 6120 3d20 7365 6c66         da = self
-0000b680: 2e5f 6465 636f 6465 5f63 6628 6461 290a  ._decode_cf(da).
-0000b690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b6a0: 2e5f 7469 6d65 203d 2064 610a 2020 2020  ._time = da.    
-0000b6b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000b6c0: 5f74 696d 650a 0a20 2020 2040 7072 6f70  _time..    @prop
-0000b6d0: 6572 7479 0a20 2020 2064 6566 2073 7461  erty.    def sta
-0000b6e0: 7274 7469 6d65 2873 656c 6629 3a0a 2020  rttime(self):.  
-0000b6f0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0000b700: 7377 6565 7020 7374 6172 7474 696d 6520  sweep starttime 
-0000b710: 7872 2e44 6174 6141 7272 6179 2e22 2222  xr.DataArray."""
-0000b720: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b730: 7365 6c66 2e5f 7469 6d65 0a0a 2020 2020  self._time..    
-0000b740: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000b750: 6620 656e 6474 696d 6528 7365 6c66 293a  f endtime(self):
-0000b760: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-0000b770: 726e 2073 7765 6570 2065 6e64 7469 6d65  rn sweep endtime
-0000b780: 2078 722e 4461 7461 4172 7261 792e 2222   xr.DataArray.""
-0000b790: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-0000b7a0: 662e 5f65 6e64 7469 6d65 2069 7320 4e6f  f._endtime is No
-0000b7b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000b7c0: 6461 203d 2073 656c 662e 5f67 6574 5f74  da = self._get_t
-0000b7d0: 696d 6528 706f 696e 743d 2265 6e64 2229  ime(point="end")
-0000b7e0: 0a20 2020 2020 2020 2020 2020 2023 2064  .            # d
-0000b7f0: 6563 6f64 652c 2069 6620 6e65 6365 7373  ecode, if necess
-0000b800: 6172 790a 2020 2020 2020 2020 2020 2020  ary.            
-0000b810: 6966 2073 656c 662e 6465 636f 6465 5f74  if self.decode_t
-0000b820: 696d 6573 3a0a 2020 2020 2020 2020 2020  imes:.          
-0000b830: 2020 2020 2020 6461 203d 2073 656c 662e        da = self.
-0000b840: 5f64 6563 6f64 655f 6366 2864 6129 0a20  _decode_cf(da). 
-0000b850: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000b860: 5f65 6e64 7469 6d65 203d 2064 610a 2020  _endtime = da.  
-0000b870: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000b880: 662e 5f65 6e64 7469 6d65 0a0a 0a63 6c61  f._endtime...cla
-0000b890: 7373 2058 5261 644d 6f6d 656e 7428 4f64  ss XRadMoment(Od
-0000b8a0: 696d 4835 4772 6f75 7041 7474 7269 6275  imH5GroupAttribu
-0000b8b0: 7465 4d69 7869 6e29 3a0a 2020 2020 2222  teMixin):.    ""
-0000b8c0: 2243 6c61 7373 2066 6f72 2068 6f6c 6469  "Class for holdi
-0000b8d0: 6e67 206f 6e65 2072 6164 6172 206d 6f6d  ng one radar mom
-0000b8e0: 656e 740a 0a20 2020 2050 6172 616d 6574  ent..    Paramet
-0000b8f0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0000b900: 2d2d 0a20 2020 206e 6366 696c 6520 3a20  --.    ncfile : 
-0000b910: 7b6e 6574 4344 4634 2e44 6174 6173 6574  {netCDF4.Dataset
-0000b920: 2c20 6835 7079 2e46 696c 6520 6f72 2068  , h5py.File or h
-0000b930: 356e 6574 6364 662e 4669 6c65 206f 626a  5netcdf.File obj
-0000b940: 6563 747d 0a20 2020 2020 2020 2046 696c  ect}.        Fil
-0000b950: 6520 6861 6e64 6c65 206f 6620 6669 6c65  e handle of file
-0000b960: 2063 6f6e 7461 696e 696e 6720 7261 6461   containing rada
-0000b970: 7220 7377 6565 700a 2020 2020 6e63 7061  r sweep.    ncpa
-0000b980: 7468 203a 2073 7472 0a20 2020 2020 2020  th : str.       
-0000b990: 2070 6174 6820 746f 206d 6f6d 656e 7420   path to moment 
-0000b9a0: 6772 6f75 7020 2864 6174 6173 6574 5829  group (datasetX)
-0000b9b0: 0a20 2020 2070 6172 656e 7420 3a20 5852  .    parent : XR
-0000b9c0: 6164 5377 6565 700a 2020 2020 2020 2020  adSweep.        
-0000b9d0: 7061 7265 6e74 2073 7765 6570 206f 626a  parent sweep obj
-0000b9e0: 6563 740a 2020 2020 2222 220a 0a20 2020  ect.    """..   
-0000b9f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0000ba00: 6c66 2c20 6e63 6669 6c65 2c20 6e63 7061  lf, ncfile, ncpa
-0000ba10: 7468 2c20 7061 7265 6e74 293a 0a20 2020  th, parent):.   
-0000ba20: 2020 2020 2073 7570 6572 2858 5261 644d       super(XRadM
-0000ba30: 6f6d 656e 742c 2073 656c 6629 2e5f 5f69  oment, self).__i
-0000ba40: 6e69 745f 5f28 6e63 6669 6c65 2c20 6e63  nit__(ncfile, nc
-0000ba50: 7061 7468 2c20 7061 7265 6e74 290a 2020  path, parent).  
-0000ba60: 2020 2020 2020 7365 6c66 2e5f 7175 616e        self._quan
-0000ba70: 7469 7479 203d 204e 6f6e 650a 0a20 2020  tity = None..   
-0000ba80: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
-0000ba90: 6c66 293a 0a20 2020 2020 2020 2073 756d  lf):.        sum
-0000baa0: 6d61 7279 203d 205b 223c 7772 6164 6c69  mary = ["<wradli
-0000bab0: 622e 7b7d 3e22 2e66 6f72 6d61 7428 7479  b.{}>".format(ty
-0000bac0: 7065 2873 656c 6629 2e5f 5f6e 616d 655f  pe(self).__name_
-0000bad0: 5f29 5d0a 0a20 2020 2020 2020 2064 696d  _)]..        dim
-0000bae0: 7320 3d20 2244 696d 656e 7369 6f6e 2873  s = "Dimension(s
-0000baf0: 293a 220a 2020 2020 2020 2020 6469 6d73  ):".        dims
-0000bb00: 5f73 756d 6d61 7279 203d 205b 6622 7b73  _summary = [f"{s
-0000bb10: 656c 662e 7061 7265 6e74 2e5f 6469 6d30  elf.parent._dim0
-0000bb20: 5b30 5d7d 3a20 7b73 656c 662e 7061 7265  [0]}: {self.pare
-0000bb30: 6e74 2e6e 7261 7973 7d22 5d0a 2020 2020  nt.nrays}"].    
-0000bb40: 2020 2020 6469 6d73 5f73 756d 6d61 7279      dims_summary
-0000bb50: 2e61 7070 656e 6428 6622 7b73 656c 662e  .append(f"{self.
-0000bb60: 7061 7265 6e74 2e5f 6469 6d31 7d3a 207b  parent._dim1}: {
-0000bb70: 7365 6c66 2e70 6172 656e 742e 6e62 696e  self.parent.nbin
-0000bb80: 737d 2229 0a20 2020 2020 2020 2064 696d  s}").        dim
-0000bb90: 735f 7375 6d6d 6172 7920 3d20 222c 2022  s_summary = ", "
-0000bba0: 2e6a 6f69 6e28 6469 6d73 5f73 756d 6d61  .join(dims_summa
-0000bbb0: 7279 290a 2020 2020 2020 2020 7375 6d6d  ry).        summ
-0000bbc0: 6172 792e 6170 7065 6e64 2822 7b7d 2028  ary.append("{} (
-0000bbd0: 7b7d 2922 2e66 6f72 6d61 7428 6469 6d73  {})".format(dims
-0000bbe0: 2c20 6469 6d73 5f73 756d 6d61 7279 2929  , dims_summary))
-0000bbf0: 0a0a 2020 2020 2020 2020 616e 676c 6520  ..        angle 
-0000bc00: 3d20 2245 6c65 7661 7469 6f6e 2873 293a  = "Elevation(s):
-0000bc10: 220a 2020 2020 2020 2020 616e 676c 655f  ".        angle_
-0000bc20: 7375 6d6d 6172 7920 3d20 6622 7b73 656c  summary = f"{sel
-0000bc30: 662e 7061 7265 6e74 2e66 6978 6564 5f61  f.parent.fixed_a
-0000bc40: 6e67 6c65 3a2e 3166 7d22 0a20 2020 2020  ngle:.1f}".     
-0000bc50: 2020 2073 756d 6d61 7279 2e61 7070 656e     summary.appen
-0000bc60: 6428 227b 7d20 287b 7d29 222e 666f 726d  d("{} ({})".form
-0000bc70: 6174 2861 6e67 6c65 2c20 616e 676c 655f  at(angle, angle_
-0000bc80: 7375 6d6d 6172 7929 290a 0a20 2020 2020  summary))..     
-0000bc90: 2020 206d 6f6d 7320 3d20 224d 6f6d 656e     moms = "Momen
-0000bca0: 743a 220a 2020 2020 2020 2020 6d6f 6d73  t:".        moms
-0000bcb0: 5f73 756d 6d61 7279 203d 2066 227b 7365  _summary = f"{se
-0000bcc0: 6c66 2e71 7561 6e74 6974 797d 220a 2020  lf.quantity}".  
-0000bcd0: 2020 2020 2020 7375 6d6d 6172 792e 6170        summary.ap
-0000bce0: 7065 6e64 2822 7b7d 2028 7b7d 2922 2e66  pend("{} ({})".f
-0000bcf0: 6f72 6d61 7428 6d6f 6d73 2c20 6d6f 6d73  ormat(moms, moms
-0000bd00: 5f73 756d 6d61 7279 2929 0a0a 2020 2020  _summary))..    
-0000bd10: 2020 2020 7265 7475 726e 2022 5c6e 222e      return "\n".
-0000bd20: 6a6f 696e 2873 756d 6d61 7279 290a 0a20  join(summary).. 
-0000bd30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000bd40: 2064 6566 2064 6174 6128 7365 6c66 293a   def data(self):
-0000bd50: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-0000bd60: 726e 206d 6f6d 656e 7420 7872 2e44 6174  rn moment xr.Dat
-0000bd70: 6141 7272 6179 2e22 2222 0a20 2020 2020  aArray.""".     
-0000bd80: 2020 2072 6574 7572 6e20 7365 6c66 2e70     return self.p
-0000bd90: 6172 656e 742e 6461 7461 5b73 656c 662e  arent.data[self.
-0000bda0: 7175 616e 7469 7479 5d0a 0a20 2020 2040  quantity]..    @
-0000bdb0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000bdc0: 2074 696d 6528 7365 6c66 293a 0a20 2020   time(self):.   
-0000bdd0: 2020 2020 2022 2222 5265 7475 726e 2073       """Return s
-0000bde0: 7765 6570 2074 696d 652e 2222 220a 2020  weep time.""".  
-0000bdf0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000be00: 662e 7061 7265 6e74 2e74 696d 650a 0a20  f.parent.time.. 
-0000be10: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000be20: 2064 6566 2071 7561 6e74 6974 7928 7365   def quantity(se
-0000be30: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000be40: 5265 7475 726e 2060 7175 616e 7469 7479  Return `quantity
-0000be50: 6020 616b 6120 6d6f 6d65 6e74 206e 616d  ` aka moment nam
-0000be60: 6522 2222 0a20 2020 2020 2020 2069 6620  e""".        if 
-0000be70: 7365 6c66 2e5f 7175 616e 7469 7479 2069  self._quantity i
-0000be80: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000be90: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000bea0: 6528 7365 6c66 2e70 6172 656e 742c 2058  e(self.parent, X
-0000beb0: 5261 6453 7765 6570 4f64 696d 293a 0a20  RadSweepOdim):. 
-0000bec0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000bed0: 656c 662e 5f71 7561 6e74 6974 7920 3d20  elf._quantity = 
-0000bee0: 7365 6c66 2e77 6861 745b 2271 7561 6e74  self.what["quant
-0000bef0: 6974 7922 5d0a 2020 2020 2020 2020 2020  ity"].          
-0000bf00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000bf10: 2020 2020 2020 2020 7365 6c66 2e5f 7175          self._qu
-0000bf20: 616e 7469 7479 203d 2047 414d 4943 5f4e  antity = GAMIC_N
-0000bf30: 414d 4553 5b73 656c 662e 6174 7472 735b  AMES[self.attrs[
-0000bf40: 226d 6f6d 656e 7422 5d2e 6c6f 7765 7228  "moment"].lower(
-0000bf50: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
-0000bf60: 6e20 7365 6c66 2e5f 7175 616e 7469 7479  n self._quantity
-0000bf70: 0a0a 0a63 6c61 7373 2058 5261 6453 7765  ...class XRadSwe
-0000bf80: 6570 284f 6469 6d48 3547 726f 7570 4174  ep(OdimH5GroupAt
-0000bf90: 7472 6962 7574 654d 6978 696e 2c20 4f64  tributeMixin, Od
-0000bfa0: 696d 4835 5377 6565 704d 6574 6144 6174  imH5SweepMetaDat
-0000bfb0: 614d 6978 696e 2c20 5852 6164 4261 7365  aMixin, XRadBase
-0000bfc0: 293a 0a20 2020 2022 2222 436c 6173 7320  ):.    """Class 
-0000bfd0: 666f 7220 686f 6c64 696e 6720 6f6e 6520  for holding one 
-0000bfe0: 7261 6461 7220 7377 6565 700a 0a20 2020  radar sweep..   
-0000bff0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000c000: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
-0000c010: 6e63 6669 6c65 203a 207b 6e65 7443 4446  ncfile : {netCDF
-0000c020: 342e 4461 7461 7365 742c 2068 3570 792e  4.Dataset, h5py.
-0000c030: 4669 6c65 206f 7220 6835 6e65 7463 6466  File or h5netcdf
-0000c040: 2e46 696c 6520 6f62 6a65 6374 7d0a 2020  .File object}.  
-0000c050: 2020 2020 2020 4669 6c65 2068 616e 646c        File handl
-0000c060: 6520 6f66 2066 696c 6520 636f 6e74 6169  e of file contai
-0000c070: 6e69 6e67 2072 6164 6172 2073 7765 6570  ning radar sweep
-0000c080: 0a20 2020 206e 6370 6174 6820 3a20 7374  .    ncpath : st
-0000c090: 720a 2020 2020 2020 2020 7061 7468 2074  r.        path t
-0000c0a0: 6f20 7377 6565 7020 6772 6f75 700a 2020  o sweep group.  
-0000c0b0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-0000c0c0: 5f69 6e69 745f 5f28 7365 6c66 2c20 6e63  _init__(self, nc
-0000c0d0: 6669 6c65 2c20 6e63 7061 7468 2c20 7061  file, ncpath, pa
-0000c0e0: 7265 6e74 3d4e 6f6e 652c 202a 2a6b 7761  rent=None, **kwa
-0000c0f0: 7267 7329 3a0a 2020 2020 2020 2020 7375  rgs):.        su
-0000c100: 7065 7228 5852 6164 5377 6565 702c 2073  per(XRadSweep, s
-0000c110: 656c 6629 2e5f 5f69 6e69 745f 5f28 6e63  elf).__init__(nc
-0000c120: 6669 6c65 2c20 6e63 7061 7468 2c20 7061  file, ncpath, pa
-0000c130: 7265 6e74 290a 2020 2020 2020 2020 7365  rent).        se
-0000c140: 6c66 2e5f 6461 736b 5f6b 7761 7267 7320  lf._dask_kwargs 
-0000c150: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0000c160: 2263 6875 6e6b 7322 3a20 6b77 6172 6773  "chunks": kwargs
-0000c170: 2e67 6574 2822 6368 756e 6b73 222c 204e  .get("chunks", N
-0000c180: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
-0000c190: 2020 2270 6172 616c 6c65 6c22 3a20 6b77    "parallel": kw
-0000c1a0: 6172 6773 2e67 6574 2822 7061 7261 6c6c  args.get("parall
-0000c1b0: 656c 222c 2046 616c 7365 292c 0a20 2020  el", False),.   
-0000c1c0: 2020 2020 207d 0a20 2020 2020 2020 2073       }.        s
-0000c1d0: 656c 662e 5f63 665f 6b77 6172 6773 203d  elf._cf_kwargs =
-0000c1e0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0000c1f0: 6d61 736b 5f61 6e64 5f73 6361 6c65 223a  mask_and_scale":
-0000c200: 206b 7761 7267 732e 6765 7428 226d 6173   kwargs.get("mas
-0000c210: 6b5f 616e 645f 7363 616c 6522 2c20 5472  k_and_scale", Tr
-0000c220: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
-0000c230: 2022 6465 636f 6465 5f63 6f6f 7264 7322   "decode_coords"
-0000c240: 3a20 6b77 6172 6773 2e67 6574 2822 6465  : kwargs.get("de
-0000c250: 636f 6465 5f63 6f6f 7264 7322 2c20 5472  code_coords", Tr
-0000c260: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
-0000c270: 2022 6465 636f 6465 5f74 696d 6573 223a   "decode_times":
-0000c280: 206b 7761 7267 732e 6765 7428 2264 6563   kwargs.get("dec
-0000c290: 6f64 655f 7469 6d65 7322 2c20 5472 7565  ode_times", True
-0000c2a0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-0000c2b0: 2020 2020 2073 656c 662e 5f6d 6973 635f       self._misc_
-0000c2c0: 6b77 6172 6773 203d 207b 0a20 2020 2020  kwargs = {.     
-0000c2d0: 2020 2020 2020 2022 6b65 6570 5f65 6c65         "keep_ele
-0000c2e0: 7661 7469 6f6e 223a 206b 7761 7267 732e  vation": kwargs.
-0000c2f0: 6765 7428 226b 6565 705f 656c 6576 6174  get("keep_elevat
-0000c300: 696f 6e22 2c20 4661 6c73 6529 2c0a 2020  ion", False),.  
-0000c310: 2020 2020 2020 2020 2020 226b 6565 705f            "keep_
-0000c320: 617a 696d 7574 6822 3a20 6b77 6172 6773  azimuth": kwargs
-0000c330: 2e67 6574 2822 6b65 6570 5f61 7a69 6d75  .get("keep_azimu
-0000c340: 7468 222c 2046 616c 7365 292c 0a20 2020  th", False),.   
-0000c350: 2020 2020 207d 0a20 2020 2020 2020 2073       }.        s
-0000c360: 656c 662e 5f64 6174 6120 3d20 4e6f 6e65  elf._data = None
-0000c370: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-0000c380: 6565 645f 7469 6d65 5f72 6563 616c 6320  eed_time_recalc 
-0000c390: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0000c3a0: 7365 6c66 2e5f 7365 712e 6578 7465 6e64  self._seq.extend
-0000c3b0: 2873 656c 662e 5f67 6574 5f6d 6f6d 656e  (self._get_momen
-0000c3c0: 7473 2829 290a 2020 2020 2020 2020 7365  ts()).        se
-0000c3d0: 6c66 2e5f 6469 6d30 203d 2028 2261 7a69  lf._dim0 = ("azi
-0000c3e0: 6d75 7468 222c 2022 656c 6576 6174 696f  muth", "elevatio
-0000c3f0: 6e22 290a 2020 2020 2020 2020 7365 6c66  n").        self
-0000c400: 2e5f 6469 6d31 203d 2022 7261 6e67 6522  ._dim1 = "range"
-0000c410: 0a20 2020 2020 2020 2073 656c 662e 6669  .        self.fi
-0000c420: 7865 645f 616e 676c 650a 0a20 2020 2064  xed_angle..    d
-0000c430: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
-0000c440: 293a 0a20 2020 2020 2020 2073 756d 6d61  ):.        summa
-0000c450: 7279 203d 205b 223c 7772 6164 6c69 622e  ry = ["<wradlib.
-0000c460: 7b7d 3e22 2e66 6f72 6d61 7428 7479 7065  {}>".format(type
-0000c470: 2873 656c 6629 2e5f 5f6e 616d 655f 5f29  (self).__name__)
-0000c480: 5d0a 0a20 2020 2020 2020 2064 696d 7320  ]..        dims 
-0000c490: 3d20 2244 696d 656e 7369 6f6e 2873 293a  = "Dimension(s):
-0000c4a0: 220a 2020 2020 2020 2020 6469 6d73 5f73  ".        dims_s
-0000c4b0: 756d 6d61 7279 203d 205b 6622 7b73 656c  ummary = [f"{sel
-0000c4c0: 662e 5f64 696d 305b 305d 7d3a 207b 7365  f._dim0[0]}: {se
-0000c4d0: 6c66 2e6e 7261 7973 7d22 5d0a 2020 2020  lf.nrays}"].    
-0000c4e0: 2020 2020 6469 6d73 5f73 756d 6d61 7279      dims_summary
-0000c4f0: 2e61 7070 656e 6428 6622 7b73 656c 662e  .append(f"{self.
-0000c500: 5f64 696d 317d 3a20 7b73 656c 662e 6e62  _dim1}: {self.nb
-0000c510: 696e 737d 2229 0a20 2020 2020 2020 2064  ins}").        d
-0000c520: 696d 735f 7375 6d6d 6172 7920 3d20 222c  ims_summary = ",
-0000c530: 2022 2e6a 6f69 6e28 6469 6d73 5f73 756d   ".join(dims_sum
-0000c540: 6d61 7279 290a 2020 2020 2020 2020 7375  mary).        su
-0000c550: 6d6d 6172 792e 6170 7065 6e64 2822 7b7d  mmary.append("{}
-0000c560: 2028 7b7d 2922 2e66 6f72 6d61 7428 6469   ({})".format(di
-0000c570: 6d73 2c20 6469 6d73 5f73 756d 6d61 7279  ms, dims_summary
-0000c580: 2929 0a0a 2020 2020 2020 2020 616e 676c  ))..        angl
-0000c590: 6520 3d20 6622 7b73 656c 662e 5f64 696d  e = f"{self._dim
-0000c5a0: 305b 315d 2e63 6170 6974 616c 697a 6528  0[1].capitalize(
-0000c5b0: 297d 2873 293a 220a 2020 2020 2020 2020  )}(s):".        
-0000c5c0: 616e 676c 655f 7375 6d6d 6172 7920 3d20  angle_summary = 
-0000c5d0: 6622 7b73 656c 662e 6669 7865 645f 616e  f"{self.fixed_an
-0000c5e0: 676c 653a 302e 3166 7d22 0a20 2020 2020  gle:0.1f}".     
-0000c5f0: 2020 2073 756d 6d61 7279 2e61 7070 656e     summary.appen
-0000c600: 6428 227b 7d20 287b 7d29 222e 666f 726d  d("{} ({})".form
-0000c610: 6174 2861 6e67 6c65 2c20 616e 676c 655f  at(angle, angle_
-0000c620: 7375 6d6d 6172 7929 290a 0a20 2020 2020  summary))..     
-0000c630: 2020 206d 6f6d 7320 3d20 224d 6f6d 656e     moms = "Momen
-0000c640: 7428 7329 3a22 0a20 2020 2020 2020 206d  t(s):".        m
-0000c650: 6f6d 735f 7375 6d6d 6172 7920 3d20 7365  oms_summary = se
-0000c660: 6c66 2e6d 6f6d 656e 7473 0a20 2020 2020  lf.moments.     
-0000c670: 2020 206d 6f6d 735f 7375 6d6d 6172 7920     moms_summary 
-0000c680: 3d20 222c 2022 2e6a 6f69 6e28 6d6f 6d73  = ", ".join(moms
-0000c690: 5f73 756d 6d61 7279 290a 2020 2020 2020  _summary).      
-0000c6a0: 2020 7375 6d6d 6172 792e 6170 7065 6e64    summary.append
-0000c6b0: 2822 7b7d 2028 7b7d 2922 2e66 6f72 6d61  ("{} ({})".forma
-0000c6c0: 7428 6d6f 6d73 2c20 6d6f 6d73 5f73 756d  t(moms, moms_sum
-0000c6d0: 6d61 7279 2929 0a0a 2020 2020 2020 2020  mary))..        
-0000c6e0: 7265 7475 726e 2022 5c6e 222e 6a6f 696e  return "\n".join
-0000c6f0: 2873 756d 6d61 7279 290a 0a20 2020 2064  (summary)..    d
-0000c700: 6566 205f 5f64 656c 5f5f 2873 656c 6629  ef __del__(self)
-0000c710: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-0000c720: 662e 5f64 6174 6120 6973 206e 6f74 204e  f._data is not N
-0000c730: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000c740: 2073 656c 662e 5f64 6174 612e 636c 6f73   self._data.clos
-0000c750: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0000c760: 7365 6c66 2e5f 6461 7461 203d 204e 6f6e  self._data = Non
-0000c770: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-0000c780: 6e63 6669 6c65 203d 204e 6f6e 650a 0a20  ncfile = None.. 
-0000c790: 2020 2064 6566 205f 6465 636f 6465 5f63     def _decode_c
-0000c7a0: 6628 7365 6c66 2c20 6f62 6a29 3a0a 2020  f(self, obj):.  
-0000c7b0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000c7c0: 6e63 6528 6f62 6a2c 2078 722e 4461 7461  nce(obj, xr.Data
-0000c7d0: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
-0000c7e0: 2020 2020 6f75 7420 3d20 7872 2e64 6563      out = xr.dec
-0000c7f0: 6f64 655f 6366 2878 722e 4461 7461 7365  ode_cf(xr.Datase
-0000c800: 7428 7b22 6172 7222 3a20 6f62 6a7d 292c  t({"arr": obj}),
-0000c810: 202a 2a73 656c 662e 5f63 665f 6b77 6172   **self._cf_kwar
-0000c820: 6773 292e 6172 720a 2020 2020 2020 2020  gs).arr.        
-0000c830: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c840: 2020 6f75 7420 3d20 7872 2e64 6563 6f64    out = xr.decod
-0000c850: 655f 6366 286f 626a 2c20 2a2a 7365 6c66  e_cf(obj, **self
-0000c860: 2e5f 6366 5f6b 7761 7267 7329 0a20 2020  ._cf_kwargs).   
-0000c870: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
-0000c880: 0a20 2020 2064 6566 205f 6765 745f 636f  .    def _get_co
-0000c890: 6f72 6473 2873 656c 6629 3a0a 2020 2020  ords(self):.    
-0000c8a0: 2020 2020 6473 203d 2078 722e 4461 7461      ds = xr.Data
-0000c8b0: 7365 7428 0a20 2020 2020 2020 2020 2020  set(.           
-0000c8c0: 2063 6f6f 7264 733d 7b0a 2020 2020 2020   coords={.      
-0000c8d0: 2020 2020 2020 2020 2020 2274 696d 6522            "time"
-0000c8e0: 3a20 7365 6c66 2e74 696d 652c 0a20 2020  : self.time,.   
-0000c8f0: 2020 2020 2020 2020 2020 2020 2022 7274               "rt
-0000c900: 696d 6522 3a20 7365 6c66 2e72 6179 5f74  ime": self.ray_t
-0000c910: 696d 6573 2c0a 2020 2020 2020 2020 2020  imes,.          
-0000c920: 2020 2020 2020 2261 7a69 6d75 7468 223a        "azimuth":
-0000c930: 2073 656c 662e 617a 696d 7574 682c 0a20   self.azimuth,. 
-0000c940: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c950: 656c 6576 6174 696f 6e22 3a20 7365 6c66  elevation": self
-0000c960: 2e65 6c65 7661 7469 6f6e 2c0a 2020 2020  .elevation,.    
-0000c970: 2020 2020 2020 2020 2020 2020 2272 616e              "ran
-0000c980: 6765 223a 2073 656c 662e 726e 672c 0a20  ge": self.rng,. 
-0000c990: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0000c9a0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000c9b0: 6574 7572 6e20 6473 0a0a 2020 2020 6465  eturn ds..    de
-0000c9c0: 6620 5f67 6574 5f6d 6f6d 656e 7473 2873  f _get_moments(s
-0000c9d0: 656c 6629 3a0a 2020 2020 2020 2020 6d64  elf):.        md
-0000c9e0: 6573 6320 3d20 7365 6c66 2e5f 6d64 6573  esc = self._mdes
-0000c9f0: 630a 2020 2020 2020 2020 6d6f 6d65 6e74  c.        moment
-0000ca00: 7320 3d20 5b6b 2066 6f72 206b 2069 6e20  s = [k for k in 
-0000ca10: 7365 6c66 2e67 726f 7570 7320 6966 206d  self.groups if m
-0000ca20: 6465 7363 2069 6e20 6b5d 0a20 2020 2020  desc in k].     
-0000ca30: 2020 206d 6f6d 656e 7473 5f69 6478 203d     moments_idx =
-0000ca40: 206e 702e 6172 6773 6f72 7428 5b69 6e74   np.argsort([int
-0000ca50: 2873 5b6c 656e 286d 6465 7363 2920 3a5d  (s[len(mdesc) :]
-0000ca60: 2920 666f 7220 7320 696e 206d 6f6d 656e  ) for s in momen
-0000ca70: 7473 5d29 0a20 2020 2020 2020 206d 6f6d  ts]).        mom
-0000ca80: 656e 7473 5f6e 616d 6573 203d 206e 702e  ents_names = np.
-0000ca90: 6172 7261 7928 6d6f 6d65 6e74 7329 5b6d  array(moments)[m
-0000caa0: 6f6d 656e 7473 5f69 6478 5d2e 746f 6c69  oments_idx].toli
-0000cab0: 7374 2829 0a20 2020 2020 2020 206d 6f6d  st().        mom
-0000cac0: 656e 7473 203d 205b 0a20 2020 2020 2020  ents = [.       
-0000cad0: 2020 2020 2058 5261 644d 6f6d 656e 7428       XRadMoment(
-0000cae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000caf0: 206e 6366 696c 653d 7365 6c66 2e6e 6366   ncfile=self.ncf
-0000cb00: 696c 652c 206e 6370 6174 683d 222f 222e  ile, ncpath="/".
-0000cb10: 6a6f 696e 285b 7365 6c66 2e6e 6370 6174  join([self.ncpat
-0000cb20: 682c 206d 6f6d 5d29 2c20 7061 7265 6e74  h, mom]), parent
-0000cb30: 3d73 656c 660a 2020 2020 2020 2020 2020  =self.          
-0000cb40: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000cb50: 666f 7220 6d6f 6d20 696e 206d 6f6d 656e  for mom in momen
-0000cb60: 7473 5f6e 616d 6573 0a20 2020 2020 2020  ts_names.       
-0000cb70: 205d 0a20 2020 2020 2020 2072 6574 7572   ].        retur
-0000cb80: 6e20 6d6f 6d65 6e74 730a 0a20 2020 2064  n moments..    d
-0000cb90: 6566 2072 6573 6574 5f64 6174 6128 7365  ef reset_data(se
-0000cba0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000cbb0: 5265 7365 7420 2e64 6174 6120 7872 2e44  Reset .data xr.D
-0000cbc0: 6174 6173 6574 2222 220a 2020 2020 2020  ataset""".      
-0000cbd0: 2020 7365 6c66 2e5f 6461 7461 203d 204e    self._data = N
-0000cbe0: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
-0000cbf0: 7479 0a20 2020 2064 6566 205f 6d64 6573  ty.    def _mdes
-0000cc00: 6328 7365 6c66 293a 0a20 2020 2020 2020  c(self):.       
-0000cc10: 2072 6574 7572 6e20 7365 6c66 2e5f 6765   return self._ge
-0000cc20: 745f 6d64 6573 6328 290a 0a20 2020 2040  t_mdesc()..    @
-0000cc30: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000cc40: 2063 6875 6e6b 7328 7365 6c66 293a 0a20   chunks(self):. 
-0000cc50: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000cc60: 2060 6368 756e 6b73 6020 7365 7474 696e   `chunks` settin
-0000cc70: 672e 2222 220a 2020 2020 2020 2020 7265  g.""".        re
-0000cc80: 7475 726e 2073 656c 662e 5f64 6173 6b5f  turn self._dask_
-0000cc90: 6b77 6172 6773 2e67 6574 2822 6368 756e  kwargs.get("chun
-0000cca0: 6b73 2229 0a0a 2020 2020 4070 726f 7065  ks")..    @prope
-0000ccb0: 7274 790a 2020 2020 6465 6620 7061 7261  rty.    def para
-0000ccc0: 6c6c 656c 2873 656c 6629 3a0a 2020 2020  llel(self):.    
-0000ccd0: 2020 2020 2222 2252 6574 7572 6e20 6070      """Return `p
-0000cce0: 6172 616c 6c65 6c60 2073 6574 7469 6e67  arallel` setting
-0000ccf0: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-0000cd00: 7572 6e20 7365 6c66 2e5f 6461 736b 5f6b  urn self._dask_k
-0000cd10: 7761 7267 732e 6765 7428 2270 6172 616c  wargs.get("paral
-0000cd20: 6c65 6c22 290a 0a20 2020 2040 7072 6f70  lel")..    @prop
-0000cd30: 6572 7479 0a20 2020 2064 6566 206d 6173  erty.    def mas
-0000cd40: 6b5f 616e 645f 7363 616c 6528 7365 6c66  k_and_scale(self
-0000cd50: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000cd60: 7475 726e 2060 6d61 736b 5f61 6e64 5f73  turn `mask_and_s
-0000cd70: 6361 6c65 6020 7365 7474 696e 672e 2222  cale` setting.""
-0000cd80: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-0000cd90: 2073 656c 662e 5f63 665f 6b77 6172 6773   self._cf_kwargs
-0000cda0: 2e67 6574 2822 6d61 736b 5f61 6e64 5f73  .get("mask_and_s
-0000cdb0: 6361 6c65 2229 0a0a 2020 2020 4070 726f  cale")..    @pro
-0000cdc0: 7065 7274 790a 2020 2020 6465 6620 6465  perty.    def de
-0000cdd0: 636f 6465 5f63 6f6f 7264 7328 7365 6c66  code_coords(self
-0000cde0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000cdf0: 7475 726e 2060 6465 636f 6465 5f63 6f6f  turn `decode_coo
-0000ce00: 7264 7360 2073 6574 7469 6e67 2e22 2222  rds` setting."""
-0000ce10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000ce20: 7365 6c66 2e5f 6366 5f6b 7761 7267 732e  self._cf_kwargs.
-0000ce30: 6765 7428 2264 6563 6f64 655f 636f 6f72  get("decode_coor
-0000ce40: 6473 2229 0a0a 2020 2020 4070 726f 7065  ds")..    @prope
-0000ce50: 7274 790a 2020 2020 6465 6620 6465 636f  rty.    def deco
-0000ce60: 6465 5f74 696d 6573 2873 656c 6629 3a0a  de_times(self):.
-0000ce70: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-0000ce80: 6e20 6064 6563 6f64 655f 7469 6d65 7360  n `decode_times`
-0000ce90: 2073 6574 7469 6e67 2e22 2222 0a20 2020   setting.""".   
-0000cea0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000ceb0: 2e5f 6366 5f6b 7761 7267 732e 6765 7428  ._cf_kwargs.get(
-0000cec0: 2264 6563 6f64 655f 7469 6d65 7322 290a  "decode_times").
-0000ced0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000cee0: 2020 2064 6566 2064 6174 6128 7365 6c66     def data(self
-0000cef0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000cf00: 7475 726e 2061 6e64 2063 6163 6865 206d  turn and cache m
-0000cf10: 6f6d 656e 7473 2061 7320 636f 6d62 696e  oments as combin
-0000cf20: 6564 2078 722e 4461 7461 7365 7422 2222  ed xr.Dataset"""
-0000cf30: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000cf40: 2e5f 6461 7461 2069 7320 4e6f 6e65 3a0a  ._data is None:.
-0000cf50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000cf60: 2e5f 6461 7461 203d 2073 656c 662e 5f6d  ._data = self._m
-0000cf70: 6572 6765 5f6d 6f6d 656e 7473 2829 0a0a  erge_moments()..
-0000cf80: 2020 2020 2020 2020 2020 2020 2320 6966              # if
-0000cf90: 2073 656c 662e 5f64 6174 6120 6973 206e   self._data is n
-0000cfa0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000cfb0: 2020 2020 2023 2069 6620 6d65 7461 6461       # if metada
-0000cfc0: 7461 2064 6563 6c61 7265 6420 696e 2058  ta declared in X
-0000cfd0: 5261 6454 696d 6573 6572 6965 732c 206c  RadTimeseries, l
-0000cfe0: 6f61 6420 616e 6420 6173 7369 676e 0a20  oad and assign. 
-0000cff0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0000d000: 6c66 2e70 6172 656e 742e 5f6d 6574 6120  lf.parent._meta 
-0000d010: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000d020: 2020 2020 2020 2020 2020 2020 2076 6172               var
-0000d030: 7320 3d20 6469 6374 2829 0a20 2020 2020  s = dict().     
-0000d040: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0000d050: 2c20 7620 696e 2073 656c 662e 7061 7265  , v in self.pare
-0000d060: 6e74 2e5f 6d65 7461 2e69 7465 6d73 2829  nt._meta.items()
-0000d070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d080: 2020 2020 2020 6174 7472 203d 2073 656c        attr = sel
-0000d090: 662e 5f67 6574 5f61 7474 7269 6275 7465  f._get_attribute
-0000d0a0: 2876 2c20 6174 7472 3d6b 290a 2020 2020  (v, attr=k).    
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0c0: 6966 2068 6173 6174 7472 2861 7474 722c  if hasattr(attr,
-0000d0d0: 2022 6e64 696d 2229 3a0a 2020 2020 2020   "ndim"):.      
-0000d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0f0: 2020 6174 7472 203d 2078 722e 4461 7461    attr = xr.Data
-0000d100: 4172 7261 7928 6174 7472 2c20 6469 6d73  Array(attr, dims
-0000d110: 3d5b 7365 6c66 2e5f 6469 6d30 5b30 5d5d  =[self._dim0[0]]
-0000d120: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000d130: 2020 2020 2020 7661 7273 5b6b 5d20 3d20        vars[k] = 
-0000d140: 6174 7472 0a20 2020 2020 2020 2020 2020  attr.           
-0000d150: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
-0000d160: 3d20 7365 6c66 2e5f 6461 7461 2e61 7373  = self._data.ass
-0000d170: 6967 6e28 7661 7273 290a 0a20 2020 2020  ign(vars)..     
-0000d180: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-0000d190: 6563 6f64 655f 636f 6f72 6473 3a0a 2020  ecode_coords:.  
-0000d1a0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000d1b0: 6f72 6473 203d 2073 656c 662e 5f67 6574  ords = self._get
-0000d1c0: 5f63 6f6f 7264 7328 292e 636f 6f72 6473  _coords().coords
-0000d1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d1e0: 2073 656c 662e 5f64 6174 6120 3d20 7365   self._data = se
-0000d1f0: 6c66 2e5f 6461 7461 2e61 7373 6967 6e5f  lf._data.assign_
-0000d200: 636f 6f72 6473 2863 6f6f 7264 7329 0a20  coords(coords). 
-0000d210: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000d220: 656c 662e 5f64 6174 6120 3d20 7365 6c66  elf._data = self
-0000d230: 2e5f 6461 7461 2e73 6f72 7462 7928 7365  ._data.sortby(se
-0000d240: 6c66 2e5f 6469 6d30 5b30 5d29 0a20 2020  lf._dim0[0]).   
-0000d250: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000d260: 662e 5f64 6174 6120 3d20 7365 6c66 2e5f  f._data = self._
-0000d270: 6461 7461 2e70 6970 6528 5f72 6569 6e64  data.pipe(_reind
-0000d280: 6578 5f61 6e67 6c65 2c20 7365 6c66 290a  ex_angle, self).
-0000d290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2a0: 7377 6565 705f 6d6f 6465 203d 2028 0a20  sweep_mode = (. 
-0000d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2c0: 2020 2022 617a 696d 7574 685f 7375 7276     "azimuth_surv
-0000d2d0: 6569 6c6c 616e 6365 2220 6966 2073 656c  eillance" if sel
-0000d2e0: 662e 5f64 696d 305b 305d 203d 3d20 2261  f._dim0[0] == "a
-0000d2f0: 7a69 6d75 7468 2220 656c 7365 2022 7268  zimuth" else "rh
-0000d300: 6922 0a20 2020 2020 2020 2020 2020 2020  i".             
-0000d310: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000d320: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
-0000d330: 3d20 7365 6c66 2e5f 6461 7461 2e61 7373  = self._data.ass
-0000d340: 6967 6e5f 636f 6f72 6473 287b 2273 7765  ign_coords({"swe
-0000d350: 6570 5f6d 6f64 6522 3a20 7377 6565 705f  ep_mode": sweep_
-0000d360: 6d6f 6465 7d29 0a20 2020 2020 2020 2020  mode}).         
-0000d370: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
-0000d380: 6120 3d20 7365 6c66 2e5f 6461 7461 2e61  a = self._data.a
-0000d390: 7373 6967 6e5f 636f 6f72 6473 2873 656c  ssign_coords(sel
-0000d3a0: 662e 7061 7265 6e74 2e70 6172 656e 742e  f.parent.parent.
-0000d3b0: 7369 7465 2e63 6f6f 7264 7329 0a0a 2020  site.coords)..  
-0000d3c0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0000d3d0: 662e 6d61 736b 5f61 6e64 5f73 6361 6c65  f.mask_and_scale
-0000d3e0: 207c 2073 656c 662e 6465 636f 6465 5f63   | self.decode_c
-0000d3f0: 6f6f 7264 7320 7c20 7365 6c66 2e64 6563  oords | self.dec
-0000d400: 6f64 655f 7469 6d65 733a 0a20 2020 2020  ode_times:.     
-0000d410: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d420: 5f64 6174 6120 3d20 7365 6c66 2e5f 6461  _data = self._da
-0000d430: 7461 2e70 6970 6528 7365 6c66 2e5f 6465  ta.pipe(self._de
-0000d440: 636f 6465 5f63 6629 0a0a 2020 2020 2020  code_cf)..      
-0000d450: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0000d460: 6174 610a 0a20 2020 2040 7072 6f70 6572  ata..    @proper
-0000d470: 7479 0a20 2020 2064 6566 2063 6f6f 7264  ty.    def coord
-0000d480: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0000d490: 2022 2222 5265 7475 726e 7320 7872 2e44   """Returns xr.D
-0000d4a0: 6174 6173 6574 2063 6f6e 7461 696e 696e  ataset containin
-0000d4b0: 6720 636f 6f72 6469 6e61 7465 732e 2222  g coordinates.""
-0000d4c0: 220a 2020 2020 2020 2020 2320 736f 7274  ".        # sort
-0000d4d0: 2063 6f6f 7264 7320 6279 2061 7a69 6d75   coords by azimu
-0000d4e0: 7468 2c20 6f6e 6c79 206e 6563 6573 7361  th, only necessa
-0000d4f0: 7279 2066 6f72 2067 616d 6963 2066 6c61  ry for gamic fla
-0000d500: 766f 7572 0a20 2020 2020 2020 2023 2066  vour.        # f
-0000d510: 6f72 206f 6469 6d20 6973 2061 6c72 6561  or odim is alrea
-0000d520: 6479 2073 6f72 7465 640a 2020 2020 2020  dy sorted.      
-0000d530: 2020 7265 7475 726e 2073 656c 662e 5f67    return self._g
-0000d540: 6574 5f63 6f6f 7264 7328 292e 736f 7274  et_coords().sort
-0000d550: 6279 2873 656c 662e 5f64 696d 305b 305d  by(self._dim0[0]
-0000d560: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000d570: 0a20 2020 2064 6566 206d 6f6d 656e 7473  .    def moments
-0000d580: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000d590: 2222 2252 6574 7572 6e20 6c69 7374 206f  """Return list o
-0000d5a0: 6620 6d6f 6d65 6e74 732e 2222 220a 2020  f moments.""".  
-0000d5b0: 2020 2020 2020 7265 7475 726e 205b 6622        return [f"
-0000d5c0: 7b6b 2e71 7561 6e74 6974 797d 2220 666f  {k.quantity}" fo
-0000d5d0: 7220 6b20 696e 2073 656c 665d 0a0a 0a63  r k in self]...c
-0000d5e0: 6c61 7373 2058 5261 6453 7765 6570 4f64  lass XRadSweepOd
-0000d5f0: 696d 2858 5261 6453 7765 6570 293a 0a20  im(XRadSweep):. 
-0000d600: 2020 2022 2222 436c 6173 7320 666f 7220     """Class for 
-0000d610: 686f 6c64 696e 6720 6f6e 6520 7261 6461  holding one rada
-0000d620: 7220 7377 6565 700a 0a20 2020 2050 6172  r sweep..    Par
-0000d630: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-0000d640: 2d2d 2d2d 2d2d 0a0a 2020 2020 6e63 6669  ------..    ncfi
-0000d650: 6c65 203a 207b 6e65 7443 4446 342e 4461  le : {netCDF4.Da
-0000d660: 7461 7365 742c 2068 3570 792e 4669 6c65  taset, h5py.File
-0000d670: 206f 7220 6835 6e65 7463 6466 2e46 696c   or h5netcdf.Fil
-0000d680: 6520 6f62 6a65 6374 7d0a 2020 2020 2020  e object}.      
-0000d690: 2020 4669 6c65 2068 616e 646c 6520 6f66    File handle of
-0000d6a0: 2066 696c 6520 636f 6e74 6169 6e69 6e67   file containing
-0000d6b0: 2072 6164 6172 2073 7765 6570 0a20 2020   radar sweep.   
-0000d6c0: 206e 6370 6174 6820 3a20 7374 720a 2020   ncpath : str.  
-0000d6d0: 2020 2020 2020 7061 7468 2074 6f20 7377        path to sw
-0000d6e0: 6565 7020 6772 6f75 700a 2020 2020 2222  eep group.    ""
-0000d6f0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-0000d700: 745f 5f28 7365 6c66 2c20 6e63 6669 6c65  t__(self, ncfile
-0000d710: 2c20 6e63 7061 7468 2c20 7061 7265 6e74  , ncpath, parent
-0000d720: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
-0000d730: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
-0000d740: 5852 6164 5377 6565 704f 6469 6d2c 2073  XRadSweepOdim, s
-0000d750: 656c 6629 2e5f 5f69 6e69 745f 5f28 6e63  elf).__init__(nc
-0000d760: 6669 6c65 2c20 6e63 7061 7468 2c20 7061  file, ncpath, pa
-0000d770: 7265 6e74 2c20 2a2a 6b77 6172 6773 290a  rent, **kwargs).
-0000d780: 0a20 2020 2064 6566 205f 6765 745f 6131  .    def _get_a1
-0000d790: 6761 7465 2873 656c 6629 3a0a 2020 2020  gate(self):.    
-0000d7a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000d7b0: 7768 6572 655b 2261 3167 6174 6522 5d0a  where["a1gate"].
-0000d7c0: 0a20 2020 2064 6566 205f 6765 745f 616e  .    def _get_an
-0000d7d0: 676c 655f 7265 736f 6c75 7469 6f6e 2873  gle_resolution(s
-0000d7e0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0000d7f0: 7475 726e 2073 656c 662e 617a 696d 7574  turn self.azimut
-0000d800: 682e 6469 6666 2873 656c 662e 5f64 696d  h.diff(self._dim
-0000d810: 305b 305d 292e 6d65 6469 616e 2873 6b69  0[0]).median(ski
-0000d820: 706e 613d 5472 7565 292e 726f 756e 6428  pna=True).round(
-0000d830: 6465 6369 6d61 6c73 3d31 290a 0a20 2020  decimals=1)..   
-0000d840: 2064 6566 205f 6765 745f 6669 7865 645f   def _get_fixed_
-0000d850: 616e 676c 6528 7365 6c66 293a 0a20 2020  angle(self):.   
-0000d860: 2020 2020 2023 2074 7279 2052 4849 2066       # try RHI f
-0000d870: 6972 7374 0a20 2020 2020 2020 2061 6e67  irst.        ang
-0000d880: 6c65 5f6b 6579 7320 3d20 5b22 617a 5f61  le_keys = ["az_a
-0000d890: 6e67 6c65 222c 2022 617a 616e 676c 6522  ngle", "azangle"
-0000d8a0: 5d0a 2020 2020 2020 2020 666f 7220 616b  ].        for ak
-0000d8b0: 2069 6e20 616e 676c 655f 6b65 7973 3a0a   in angle_keys:.
-0000d8c0: 2020 2020 2020 2020 2020 2020 616e 676c              angl
-0000d8d0: 6520 3d20 7365 6c66 2e77 6865 7265 2e67  e = self.where.g
-0000d8e0: 6574 2861 6b2c 204e 6f6e 6529 0a20 2020  et(ak, None).   
-0000d8f0: 2020 2020 2020 2020 2069 6620 616e 676c           if angl
-0000d900: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0000d910: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000d920: 7265 616b 0a20 2020 2020 2020 2069 6620  reak.        if 
-0000d930: 616e 676c 6520 6973 206e 6f74 204e 6f6e  angle is not Non
-0000d940: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
-0000d950: 6e67 6c65 203d 206e 702e 726f 756e 6428  ngle = np.round(
-0000d960: 616e 676c 652c 2064 6563 696d 616c 733d  angle, decimals=
-0000d970: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
-0000d980: 656c 662e 5f64 696d 3020 3d20 2873 656c  elf._dim0 = (sel
-0000d990: 662e 5f64 696d 305b 315d 2c20 7365 6c66  f._dim0[1], self
-0000d9a0: 2e5f 6469 6d30 5b30 5d29 0a20 2020 2020  ._dim0[0]).     
-0000d9b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000d9c0: 2020 2020 2061 6e67 6c65 203d 206e 702e       angle = np.
-0000d9d0: 726f 756e 6428 7365 6c66 2e77 6865 7265  round(self.where
-0000d9e0: 5b22 656c 616e 676c 6522 5d2c 2064 6563  ["elangle"], dec
-0000d9f0: 696d 616c 733d 3129 0a20 2020 2020 2020  imals=1).       
-0000da00: 2072 6574 7572 6e20 616e 676c 650a 0a20   return angle.. 
-0000da10: 2020 2064 6566 205f 6765 745f 617a 696d     def _get_azim
-0000da20: 7574 685f 686f 7728 7365 6c66 293a 0a20  uth_how(self):. 
-0000da30: 2020 2020 2020 2068 6f77 203d 2073 656c         how = sel
-0000da40: 662e 686f 770a 2020 2020 2020 2020 7374  f.how.        st
-0000da50: 6172 7461 7a20 3d20 686f 775b 2273 7461  artaz = how["sta
-0000da60: 7274 617a 4122 5d0a 2020 2020 2020 2020  rtazA"].        
-0000da70: 7374 6f70 617a 203d 2068 6f77 5b22 7374  stopaz = how["st
-0000da80: 6f70 617a 4122 5d0a 2020 2020 2020 2020  opazA"].        
-0000da90: 7a65 726f 5f69 6e64 6578 203d 206e 702e  zero_index = np.
-0000daa0: 7768 6572 6528 7374 6f70 617a 203c 2073  where(stopaz < s
-0000dab0: 7461 7274 617a 290a 2020 2020 2020 2020  tartaz).        
-0000dac0: 7374 6f70 617a 5b7a 6572 6f5f 696e 6465  stopaz[zero_inde
-0000dad0: 785b 305d 5d20 2b3d 2033 3630 0a20 2020  x[0]] += 360.   
-0000dae0: 2020 2020 2061 7a69 6d75 7468 5f64 6174       azimuth_dat
-0000daf0: 6120 3d20 2873 7461 7274 617a 202b 2073  a = (startaz + s
-0000db00: 746f 7061 7a29 202f 2032 2e30 0a20 2020  topaz) / 2.0.   
-0000db10: 2020 2020 2072 6574 7572 6e20 617a 696d       return azim
-0000db20: 7574 685f 6461 7461 0a0a 2020 2020 6465  uth_data..    de
-0000db30: 6620 5f67 6574 5f61 7a69 6d75 7468 5f77  f _get_azimuth_w
-0000db40: 6865 7265 2873 656c 6629 3a0a 2020 2020  here(self):.    
-0000db50: 2020 2020 6e72 6179 7320 3d20 7365 6c66      nrays = self
-0000db60: 2e77 6865 7265 5b22 6e72 6179 7322 5d0a  .where["nrays"].
-0000db70: 2020 2020 2020 2020 7265 7320 3d20 3336          res = 36
-0000db80: 302e 3020 2f20 6e72 6179 730a 2020 2020  0.0 / nrays.    
-0000db90: 2020 2020 617a 696d 7574 685f 6461 7461      azimuth_data
-0000dba0: 203d 206e 702e 6172 616e 6765 2872 6573   = np.arange(res
-0000dbb0: 202f 2032 2e30 2c20 3336 302e 302c 2072   / 2.0, 360.0, r
-0000dbc0: 6573 2c20 6474 7970 653d 2266 6c6f 6174  es, dtype="float
-0000dbd0: 3332 2229 0a20 2020 2020 2020 2072 6574  32").        ret
-0000dbe0: 7572 6e20 617a 696d 7574 685f 6461 7461  urn azimuth_data
-0000dbf0: 0a0a 2020 2020 6465 6620 5f67 6574 5f65  ..    def _get_e
-0000dc00: 6c65 7661 7469 6f6e 5f68 6f77 2873 656c  levation_how(sel
-0000dc10: 6629 3a0a 2020 2020 2020 2020 686f 7720  f):.        how 
-0000dc20: 3d20 7365 6c66 2e68 6f77 0a20 2020 2020  = self.how.     
-0000dc30: 2020 2073 7461 7274 656c 203d 2068 6f77     startel = how
-0000dc40: 5b22 7374 6172 7465 6c41 225d 0a20 2020  ["startelA"].   
-0000dc50: 2020 2020 2073 746f 7065 6c20 3d20 686f       stopel = ho
-0000dc60: 775b 2273 746f 7065 6c41 225d 0a20 2020  w["stopelA"].   
-0000dc70: 2020 2020 2065 6c65 7661 7469 6f6e 5f64       elevation_d
-0000dc80: 6174 6120 3d20 2873 7461 7274 656c 202b  ata = (startel +
-0000dc90: 2073 746f 7065 6c29 202f 2032 2e30 0a20   stopel) / 2.0. 
-0000dca0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-0000dcb0: 6576 6174 696f 6e5f 6461 7461 0a0a 2020  evation_data..  
-0000dcc0: 2020 6465 6620 5f67 6574 5f65 6c65 7661    def _get_eleva
-0000dcd0: 7469 6f6e 5f77 6865 7265 2873 656c 6629  tion_where(self)
-0000dce0: 3a0a 2020 2020 2020 2020 7768 6572 6520  :.        where 
-0000dcf0: 3d20 7365 6c66 2e77 6865 7265 0a20 2020  = self.where.   
-0000dd00: 2020 2020 206e 7261 7973 203d 2077 6865       nrays = whe
-0000dd10: 7265 5b22 6e72 6179 7322 5d0a 2020 2020  re["nrays"].    
-0000dd20: 2020 2020 656c 616e 676c 6520 3d20 7768      elangle = wh
-0000dd30: 6572 655b 2265 6c61 6e67 6c65 225d 0a20  ere["elangle"]. 
-0000dd40: 2020 2020 2020 2065 6c65 7661 7469 6f6e         elevation
-0000dd50: 5f64 6174 6120 3d20 6e70 2e6f 6e65 7328  _data = np.ones(
-0000dd60: 6e72 6179 732c 2064 7479 7065 3d22 666c  nrays, dtype="fl
-0000dd70: 6f61 7433 3222 2920 2a20 656c 616e 676c  oat32") * elangl
-0000dd80: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-0000dd90: 2065 6c65 7661 7469 6f6e 5f64 6174 610a   elevation_data.
-0000dda0: 0a20 2020 2064 6566 205f 6765 745f 7469  .    def _get_ti
-0000ddb0: 6d65 5f68 6f77 2873 656c 6629 3a0a 2020  me_how(self):.  
-0000ddc0: 2020 2020 2020 686f 7720 3d20 7365 6c66        how = self
-0000ddd0: 2e68 6f77 0a20 2020 2020 2020 2073 7461  .how.        sta
-0000dde0: 7274 5420 3d20 686f 775b 2273 7461 7274  rtT = how["start
-0000ddf0: 617a 5422 5d0a 2020 2020 2020 2020 7374  azT"].        st
-0000de00: 6f70 5420 3d20 686f 775b 2273 746f 7061  opT = how["stopa
-0000de10: 7a54 225d 0a20 2020 2020 2020 2074 696d  zT"].        tim
-0000de20: 655f 6461 7461 203d 2028 7374 6172 7454  e_data = (startT
-0000de30: 202b 2073 746f 7054 2920 2f20 322e 300a   + stopT) / 2.0.
-0000de40: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0000de50: 696d 655f 6461 7461 0a0a 2020 2020 6465  ime_data..    de
-0000de60: 6620 5f67 6574 5f74 696d 655f 7768 6174  f _get_time_what
-0000de70: 2873 656c 662c 206e 7261 7973 3d4e 6f6e  (self, nrays=Non
-0000de80: 6529 3a0a 2020 2020 2020 2020 7768 6174  e):.        what
-0000de90: 203d 2073 656c 662e 7768 6174 0a20 2020   = self.what.   
-0000dea0: 2020 2020 2073 7461 7274 6461 7465 203d       startdate =
-0000deb0: 2077 6861 745b 2273 7461 7274 6461 7465   what["startdate
-0000dec0: 225d 0a20 2020 2020 2020 2073 7461 7274  "].        start
-0000ded0: 7469 6d65 203d 2077 6861 745b 2273 7461  time = what["sta
-0000dee0: 7274 7469 6d65 225d 0a20 2020 2020 2020  rttime"].       
-0000def0: 2065 6e64 6461 7465 203d 2077 6861 745b   enddate = what[
-0000df00: 2265 6e64 6461 7465 225d 0a20 2020 2020  "enddate"].     
-0000df10: 2020 2065 6e64 7469 6d65 203d 2077 6861     endtime = wha
-0000df20: 745b 2265 6e64 7469 6d65 225d 0a20 2020  t["endtime"].   
-0000df30: 2020 2020 2073 7461 7274 203d 2064 742e       start = dt.
-0000df40: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-0000df50: 6528 7374 6172 7464 6174 6520 2b20 7374  e(startdate + st
-0000df60: 6172 7474 696d 652c 2022 2559 256d 2564  arttime, "%Y%m%d
-0000df70: 2548 254d 2553 2229 0a20 2020 2020 2020  %H%M%S").       
-0000df80: 2065 6e64 203d 2064 742e 6461 7465 7469   end = dt.dateti
-0000df90: 6d65 2e73 7472 7074 696d 6528 656e 6464  me.strptime(endd
-0000dfa0: 6174 6520 2b20 656e 6474 696d 652c 2022  ate + endtime, "
-0000dfb0: 2559 256d 2564 2548 254d 2553 2229 0a20  %Y%m%d%H%M%S"). 
-0000dfc0: 2020 2020 2020 2073 7461 7274 203d 2073         start = s
-0000dfd0: 7461 7274 2e72 6570 6c61 6365 2874 7a69  tart.replace(tzi
-0000dfe0: 6e66 6f3d 6474 2e74 696d 657a 6f6e 652e  nfo=dt.timezone.
-0000dff0: 7574 6329 2e74 696d 6573 7461 6d70 2829  utc).timestamp()
-0000e000: 0a20 2020 2020 2020 2065 6e64 203d 2065  .        end = e
-0000e010: 6e64 2e72 6570 6c61 6365 2874 7a69 6e66  nd.replace(tzinf
-0000e020: 6f3d 6474 2e74 696d 657a 6f6e 652e 7574  o=dt.timezone.ut
-0000e030: 6329 2e74 696d 6573 7461 6d70 2829 0a20  c).timestamp(). 
-0000e040: 2020 2020 2020 2069 6620 6e72 6179 7320         if nrays 
-0000e050: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000e060: 2020 2020 206e 7261 7973 203d 2073 656c       nrays = sel
-0000e070: 662e 7768 6572 655b 226e 7261 7973 225d  f.where["nrays"]
-0000e080: 0a20 2020 2020 2020 2069 6620 7374 6172  .        if star
-0000e090: 7420 3d3d 2065 6e64 3a0a 2020 2020 2020  t == end:.      
-0000e0a0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0000e0b0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-0000e0c0: 2020 2020 2022 5752 4144 4c49 423a 2045       "WRADLIB: E
-0000e0d0: 7175 616c 204f 4449 4d20 6073 7461 7274  qual ODIM `start
-0000e0e0: 7469 6d65 6020 616e 6420 6065 6e64 7469  time` and `endti
-0000e0f0: 6d65 6020 220a 2020 2020 2020 2020 2020  me` ".          
-0000e100: 2020 2020 2020 2276 616c 7565 732e 2043        "values. C
-0000e110: 616e 2774 2064 6574 6572 6d69 6e65 2063  an't determine c
-0000e120: 6f72 7265 6374 2073 7765 6570 2073 7461  orrect sweep sta
-0000e130: 7274 2d2c 2022 0a20 2020 2020 2020 2020  rt-, ".         
-0000e140: 2020 2020 2020 2022 656e 642d 2061 6e64         "end- and
-0000e150: 2072 6179 7469 6d65 732e 222c 0a20 2020   raytimes.",.   
-0000e160: 2020 2020 2020 2020 2020 2020 2055 7365               Use
-0000e170: 7257 6172 6e69 6e67 2c0a 2020 2020 2020  rWarning,.      
-0000e180: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000e190: 2020 2020 2074 696d 655f 6461 7461 203d       time_data =
-0000e1a0: 206e 702e 6f6e 6573 286e 7261 7973 2920   np.ones(nrays) 
-0000e1b0: 2a20 7374 6172 740a 2020 2020 2020 2020  * start.        
-0000e1c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000e1d0: 2020 6465 6c74 6120 3d20 2865 6e64 202d    delta = (end -
-0000e1e0: 2073 7461 7274 2920 2f20 6e72 6179 730a   start) / nrays.
-0000e1f0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0000e200: 5f64 6174 6120 3d20 6e70 2e61 7261 6e67  _data = np.arang
-0000e210: 6528 7374 6172 7420 2b20 6465 6c74 6120  e(start + delta 
-0000e220: 2f20 322e 302c 2065 6e64 2c20 6465 6c74  / 2.0, end, delt
-0000e230: 6129 0a20 2020 2020 2020 2020 2020 2074  a).            t
-0000e240: 696d 655f 6461 7461 203d 206e 702e 726f  ime_data = np.ro
-0000e250: 6c6c 2874 696d 655f 6461 7461 2c20 7368  ll(time_data, sh
-0000e260: 6966 743d 2b73 656c 662e 6131 6761 7465  ift=+self.a1gate
-0000e270: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000e280: 2074 696d 655f 6461 7461 0a0a 2020 2020   time_data..    
-0000e290: 6465 6620 5f67 6574 5f72 6179 5f74 696d  def _get_ray_tim
-0000e2a0: 6573 2873 656c 662c 206e 7261 7973 3d4e  es(self, nrays=N
-0000e2b0: 6f6e 6529 3a0a 2020 2020 2020 2020 7472  one):.        tr
-0000e2c0: 793a 0a20 2020 2020 2020 2020 2020 2074  y:.            t
-0000e2d0: 696d 655f 6461 7461 203d 2073 656c 662e  ime_data = self.
-0000e2e0: 5f67 6574 5f74 696d 655f 686f 7728 290a  _get_time_how().
-0000e2f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e300: 2e5f 6e65 6564 5f74 696d 655f 7265 6361  ._need_time_reca
-0000e310: 6c63 203d 2046 616c 7365 0a20 2020 2020  lc = False.     
-0000e320: 2020 2065 7863 6570 7420 2841 7474 7269     except (Attri
-0000e330: 6275 7465 4572 726f 722c 204b 6579 4572  buteError, KeyEr
-0000e340: 726f 722c 2054 7970 6545 7272 6f72 293a  ror, TypeError):
-0000e350: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-0000e360: 655f 6461 7461 203d 2073 656c 662e 5f67  e_data = self._g
-0000e370: 6574 5f74 696d 655f 7768 6174 286e 7261  et_time_what(nra
-0000e380: 7973 3d6e 7261 7973 290a 2020 2020 2020  ys=nrays).      
-0000e390: 2020 2020 2020 7365 6c66 2e5f 6e65 6564        self._need
-0000e3a0: 5f74 696d 655f 7265 6361 6c63 203d 2054  _time_recalc = T
-0000e3b0: 7275 650a 2020 2020 2020 2020 6461 203d  rue.        da =
-0000e3c0: 2078 722e 4461 7461 4172 7261 7928 7469   xr.DataArray(ti
-0000e3d0: 6d65 5f64 6174 612c 2064 696d 733d 5b73  me_data, dims=[s
-0000e3e0: 656c 662e 5f64 696d 305b 305d 5d2c 2061  elf._dim0[0]], a
-0000e3f0: 7474 7273 3d74 696d 655f 6174 7472 7329  ttrs=time_attrs)
-0000e400: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e410: 6461 0a0a 2020 2020 6465 6620 5f67 6574  da..    def _get
-0000e420: 5f61 7a69 6d75 7468 2873 656c 6629 3a0a  _azimuth(self):.
-0000e430: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000e440: 2020 2020 2020 2020 2061 7a69 6d75 7468           azimuth
-0000e450: 5f64 6174 6120 3d20 7365 6c66 2e5f 6765  _data = self._ge
-0000e460: 745f 617a 696d 7574 685f 686f 7728 290a  t_azimuth_how().
-0000e470: 2020 2020 2020 2020 6578 6365 7074 2028          except (
-0000e480: 4174 7472 6962 7574 6545 7272 6f72 2c20  AttributeError, 
-0000e490: 4b65 7945 7272 6f72 2c20 5479 7065 4572  KeyError, TypeEr
-0000e4a0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-0000e4b0: 2020 617a 696d 7574 685f 6461 7461 203d    azimuth_data =
-0000e4c0: 2073 656c 662e 5f67 6574 5f61 7a69 6d75   self._get_azimu
-0000e4d0: 7468 5f77 6865 7265 2829 0a20 2020 2020  th_where().     
-0000e4e0: 2020 2064 6120 3d20 7872 2e44 6174 6141     da = xr.DataA
-0000e4f0: 7272 6179 2861 7a69 6d75 7468 5f64 6174  rray(azimuth_dat
-0000e500: 612c 2064 696d 733d 5b73 656c 662e 5f64  a, dims=[self._d
-0000e510: 696d 305b 305d 5d2c 2061 7474 7273 3d61  im0[0]], attrs=a
-0000e520: 7a5f 6174 7472 7329 0a20 2020 2020 2020  z_attrs).       
-0000e530: 2069 6620 6e6f 7420 7365 6c66 2e5f 6d69   if not self._mi
-0000e540: 7363 5f6b 7761 7267 735b 226b 6565 705f  sc_kwargs["keep_
-0000e550: 617a 696d 7574 6822 5d20 616e 6420 7365  azimuth"] and se
-0000e560: 6c66 2e5f 6469 6d30 5b30 5d20 3d3d 2022  lf._dim0[0] == "
-0000e570: 656c 6576 6174 696f 6e22 3a0a 2020 2020  elevation":.    
-0000e580: 2020 2020 2020 2020 6461 203d 2064 612e          da = da.
-0000e590: 7069 7065 285f 6669 785f 616e 676c 6529  pipe(_fix_angle)
-0000e5a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e5b0: 6461 0a0a 2020 2020 6465 6620 5f67 6574  da..    def _get
-0000e5c0: 5f65 6c65 7661 7469 6f6e 2873 656c 6629  _elevation(self)
-0000e5d0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0000e5e0: 2020 2020 2020 2020 2020 2065 6c65 7661             eleva
-0000e5f0: 7469 6f6e 5f64 6174 6120 3d20 7365 6c66  tion_data = self
-0000e600: 2e5f 6765 745f 656c 6576 6174 696f 6e5f  ._get_elevation_
-0000e610: 686f 7728 290a 2020 2020 2020 2020 6578  how().        ex
-0000e620: 6365 7074 2028 4174 7472 6962 7574 6545  cept (AttributeE
-0000e630: 7272 6f72 2c20 4b65 7945 7272 6f72 2c20  rror, KeyError, 
-0000e640: 5479 7065 4572 726f 7229 3a0a 2020 2020  TypeError):.    
-0000e650: 2020 2020 2020 2020 656c 6576 6174 696f          elevatio
-0000e660: 6e5f 6461 7461 203d 2073 656c 662e 5f67  n_data = self._g
-0000e670: 6574 5f65 6c65 7661 7469 6f6e 5f77 6865  et_elevation_whe
-0000e680: 7265 2829 0a20 2020 2020 2020 2064 6120  re().        da 
-0000e690: 3d20 7872 2e44 6174 6141 7272 6179 2865  = xr.DataArray(e
-0000e6a0: 6c65 7661 7469 6f6e 5f64 6174 612c 2064  levation_data, d
-0000e6b0: 696d 733d 5b73 656c 662e 5f64 696d 305b  ims=[self._dim0[
-0000e6c0: 305d 5d2c 2061 7474 7273 3d65 6c5f 6174  0]], attrs=el_at
-0000e6d0: 7472 7329 0a20 2020 2020 2020 2069 6620  trs).        if 
-0000e6e0: 6e6f 7420 7365 6c66 2e5f 6d69 7363 5f6b  not self._misc_k
-0000e6f0: 7761 7267 735b 226b 6565 705f 656c 6576  wargs["keep_elev
-0000e700: 6174 696f 6e22 5d20 616e 6420 7365 6c66  ation"] and self
-0000e710: 2e5f 6469 6d30 5b30 5d20 3d3d 2022 617a  ._dim0[0] == "az
-0000e720: 696d 7574 6822 3a0a 2020 2020 2020 2020  imuth":.        
-0000e730: 2020 2020 6461 203d 2064 612e 7069 7065      da = da.pipe
-0000e740: 285f 6669 785f 616e 676c 6529 0a20 2020  (_fix_angle).   
-0000e750: 2020 2020 2072 6574 7572 6e20 6461 0a0a       return da..
-0000e760: 2020 2020 6465 6620 5f67 6574 5f6d 6465      def _get_mde
-0000e770: 7363 2873 656c 6629 3a0a 2020 2020 2020  sc(self):.      
-0000e780: 2020 7265 7475 726e 2022 6461 7461 220a    return "data".
-0000e790: 0a20 2020 2064 6566 205f 6765 745f 7261  .    def _get_ra
-0000e7a0: 6e67 6528 7365 6c66 293a 0a20 2020 2020  nge(self):.     
-0000e7b0: 2020 2077 6865 7265 203d 2073 656c 662e     where = self.
-0000e7c0: 7768 6572 650a 2020 2020 2020 2020 6e67  where.        ng
-0000e7d0: 6174 6573 203d 2077 6865 7265 5b22 6e62  ates = where["nb
-0000e7e0: 696e 7322 5d0a 2020 2020 2020 2020 7261  ins"].        ra
-0000e7f0: 6e67 655f 7374 6172 7420 3d20 7768 6572  nge_start = wher
-0000e800: 655b 2272 7374 6172 7422 5d20 2a20 3130  e["rstart"] * 10
-0000e810: 3030 2e30 0a20 2020 2020 2020 2062 696e  00.0.        bin
-0000e820: 5f72 616e 6765 203d 2077 6865 7265 5b22  _range = where["
-0000e830: 7273 6361 6c65 225d 0a20 2020 2020 2020  rscale"].       
-0000e840: 2063 656e 745f 6669 7273 7420 3d20 7261   cent_first = ra
-0000e850: 6e67 655f 7374 6172 7420 2b20 6269 6e5f  nge_start + bin_
-0000e860: 7261 6e67 6520 2f20 322e 300a 2020 2020  range / 2.0.    
-0000e870: 2020 2020 7261 6e67 655f 6461 7461 203d      range_data =
-0000e880: 206e 702e 6172 616e 6765 280a 2020 2020   np.arange(.    
-0000e890: 2020 2020 2020 2020 6365 6e74 5f66 6972          cent_fir
-0000e8a0: 7374 2c20 7261 6e67 655f 7374 6172 7420  st, range_start 
-0000e8b0: 2b20 6269 6e5f 7261 6e67 6520 2a20 6e67  + bin_range * ng
-0000e8c0: 6174 6573 2c20 6269 6e5f 7261 6e67 652c  ates, bin_range,
-0000e8d0: 2064 7479 7065 3d22 666c 6f61 7433 3222   dtype="float32"
-0000e8e0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000e8f0: 2020 2072 616e 6765 5f61 7474 7273 5b22     range_attrs["
-0000e900: 6d65 7465 7273 5f74 6f5f 6365 6e74 6572  meters_to_center
-0000e910: 5f6f 665f 6669 7273 745f 6761 7465 225d  _of_first_gate"]
-0000e920: 203d 2063 656e 745f 6669 7273 740a 2020   = cent_first.  
-0000e930: 2020 2020 2020 7261 6e67 655f 6174 7472        range_attr
-0000e940: 735b 226d 6574 6572 735f 6265 7477 6565  s["meters_betwee
-0000e950: 6e5f 6761 7465 7322 5d20 3d20 6269 6e5f  n_gates"] = bin_
-0000e960: 7261 6e67 650a 2020 2020 2020 2020 6461  range.        da
-0000e970: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
-0000e980: 7261 6e67 655f 6461 7461 2c20 6469 6d73  range_data, dims
-0000e990: 3d5b 7365 6c66 2e5f 6469 6d31 5d2c 2061  =[self._dim1], a
-0000e9a0: 7474 7273 3d72 616e 6765 5f61 7474 7273  ttrs=range_attrs
-0000e9b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000e9c0: 2064 610a 0a20 2020 2064 6566 205f 6d65   da..    def _me
-0000e9d0: 7267 655f 6d6f 6d65 6e74 7328 7365 6c66  rge_moments(self
-0000e9e0: 293a 0a20 2020 2020 2020 2064 7320 3d20  ):.        ds = 
-0000e9f0: 5f6f 7065 6e5f 6d66 6d6f 6d65 6e74 7328  _open_mfmoments(
-0000ea00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000ea10: 662c 0a20 2020 2020 2020 2020 2020 2063  f,.            c
-0000ea20: 6875 6e6b 733d 7365 6c66 2e63 6875 6e6b  hunks=self.chunk
-0000ea30: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-0000ea40: 7265 7072 6f63 6573 733d 5f70 7265 7072  reprocess=_prepr
-0000ea50: 6f63 6573 735f 6d6f 6d65 6e74 2c0a 2020  ocess_moment,.  
-0000ea60: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
-0000ea70: 656c 3d73 656c 662e 7061 7261 6c6c 656c  el=self.parallel
-0000ea80: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-0000ea90: 736b 5f61 6e64 5f73 6361 6c65 3d73 656c  sk_and_scale=sel
-0000eaa0: 662e 6d61 736b 5f61 6e64 5f73 6361 6c65  f.mask_and_scale
-0000eab0: 2c0a 2020 2020 2020 2020 2020 2020 6465  ,.            de
-0000eac0: 636f 6465 5f74 696d 6573 3d73 656c 662e  code_times=self.
-0000ead0: 6465 636f 6465 5f74 696d 6573 2c0a 2020  decode_times,.  
-0000eae0: 2020 2020 2020 2020 2020 6465 636f 6465            decode
-0000eaf0: 5f63 6f6f 7264 733d 7365 6c66 2e64 6563  _coords=self.dec
-0000eb00: 6f64 655f 636f 6f72 6473 2c0a 2020 2020  ode_coords,.    
-0000eb10: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000eb20: 7475 726e 2064 730a 0a20 2020 2064 6566  turn ds..    def
-0000eb30: 205f 6765 745f 6e72 6179 7328 7365 6c66   _get_nrays(self
-0000eb40: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0000eb50: 6e20 7365 6c66 2e77 6865 7265 5b22 6e72  n self.where["nr
-0000eb60: 6179 7322 5d0a 0a20 2020 2064 6566 205f  ays"]..    def _
-0000eb70: 6765 745f 6e62 696e 7328 7365 6c66 293a  get_nbins(self):
-0000eb80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000eb90: 7365 6c66 2e77 6865 7265 5b22 6e62 696e  self.where["nbin
-0000eba0: 7322 5d0a 0a20 2020 2064 6566 205f 6765  s"]..    def _ge
-0000ebb0: 745f 7469 6d65 2873 656c 662c 2070 6f69  t_time(self, poi
-0000ebc0: 6e74 3d22 7374 6172 7422 293a 0a20 2020  nt="start"):.   
-0000ebd0: 2020 2020 2077 6861 7420 3d20 7365 6c66       what = self
-0000ebe0: 2e77 6861 740a 2020 2020 2020 2020 7374  .what.        st
-0000ebf0: 6172 7464 6174 6520 3d20 7768 6174 5b66  artdate = what[f
-0000ec00: 227b 706f 696e 747d 6461 7465 225d 0a20  "{point}date"]. 
-0000ec10: 2020 2020 2020 2073 7461 7274 7469 6d65         starttime
-0000ec20: 203d 2077 6861 745b 6622 7b70 6f69 6e74   = what[f"{point
-0000ec30: 7d74 696d 6522 5d0a 2020 2020 2020 2020  }time"].        
-0000ec40: 7374 6172 7420 3d20 6474 2e64 6174 6574  start = dt.datet
-0000ec50: 696d 652e 7374 7270 7469 6d65 2873 7461  ime.strptime(sta
-0000ec60: 7274 6461 7465 202b 2073 7461 7274 7469  rtdate + startti
-0000ec70: 6d65 2c20 2225 5925 6d25 6425 4825 4d25  me, "%Y%m%d%H%M%
-0000ec80: 5322 290a 2020 2020 2020 2020 7374 6172  S").        star
-0000ec90: 7420 3d20 7374 6172 742e 7265 706c 6163  t = start.replac
-0000eca0: 6528 747a 696e 666f 3d64 742e 7469 6d65  e(tzinfo=dt.time
-0000ecb0: 7a6f 6e65 2e75 7463 292e 7469 6d65 7374  zone.utc).timest
-0000ecc0: 616d 7028 290a 2020 2020 2020 2020 6461  amp().        da
-0000ecd0: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
-0000ece0: 7374 6172 742c 2061 7474 7273 3d74 696d  start, attrs=tim
-0000ecf0: 655f 6174 7472 7329 0a20 2020 2020 2020  e_attrs).       
-0000ed00: 2072 6574 7572 6e20 6461 0a0a 2020 2020   return da..    
-0000ed10: 6465 6620 5f67 6574 5f74 696d 655f 6661  def _get_time_fa
-0000ed20: 7374 2873 656c 6629 3a0a 2020 2020 2020  st(self):.      
-0000ed30: 2020 6e63 6964 203d 2073 656c 662e 6e63    ncid = self.nc
-0000ed40: 6964 0a20 2020 2020 2020 2074 7279 3a0a  id.        try:.
-0000ed50: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000ed60: 7369 6e73 7461 6e63 6528 7365 6c66 2e6e  sinstance(self.n
-0000ed70: 6366 696c 652c 206e 632e 4461 7461 7365  cfile, nc.Datase
-0000ed80: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0000ed90: 2020 2020 7374 6172 7464 6174 6520 3d20      startdate = 
-0000eda0: 6e63 6964 5b22 7768 6174 225d 2e67 6574  ncid["what"].get
-0000edb0: 6e63 6174 7472 2822 7374 6172 7464 6174  ncattr("startdat
-0000edc0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-0000edd0: 2020 2020 7374 6172 7474 696d 6520 3d20      starttime = 
-0000ede0: 6e63 6964 5b22 7768 6174 225d 2e67 6574  ncid["what"].get
-0000edf0: 6e63 6174 7472 2822 7374 6172 7474 696d  ncattr("starttim
-0000ee00: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-0000ee10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000ee20: 2020 2020 2020 7374 6172 7464 6174 6520        startdate 
-0000ee30: 3d20 6e63 6964 5b22 7768 6174 225d 2e61  = ncid["what"].a
-0000ee40: 7474 7273 5b22 7374 6172 7464 6174 6522  ttrs["startdate"
-0000ee50: 5d2e 6974 656d 2829 2e64 6563 6f64 6528  ].item().decode(
-0000ee60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000ee70: 2020 7374 6172 7474 696d 6520 3d20 6e63    starttime = nc
-0000ee80: 6964 5b22 7768 6174 225d 2e61 7474 7273  id["what"].attrs
-0000ee90: 5b22 7374 6172 7474 696d 6522 5d2e 6974  ["starttime"].it
-0000eea0: 656d 2829 2e64 6563 6f64 6528 290a 2020  em().decode().  
-0000eeb0: 2020 2020 2020 6578 6365 7074 2028 496e        except (In
-0000eec0: 6465 7845 7272 6f72 2c20 4b65 7945 7272  dexError, KeyErr
-0000eed0: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-0000eee0: 2072 6574 7572 6e20 4e6f 6e65 0a20 2020   return None.   
-0000eef0: 2020 2020 2073 7461 7274 203d 2064 742e       start = dt.
-0000ef00: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-0000ef10: 6528 7374 6172 7464 6174 6520 2b20 7374  e(startdate + st
-0000ef20: 6172 7474 696d 652c 2022 2559 256d 2564  arttime, "%Y%m%d
-0000ef30: 2548 254d 2553 2229 0a20 2020 2020 2020  %H%M%S").       
-0000ef40: 2073 7461 7274 203d 2073 7461 7274 2e72   start = start.r
-0000ef50: 6570 6c61 6365 2874 7a69 6e66 6f3d 6474  eplace(tzinfo=dt
-0000ef60: 2e74 696d 657a 6f6e 652e 7574 6329 2e74  .timezone.utc).t
-0000ef70: 696d 6573 7461 6d70 2829 0a20 2020 2020  imestamp().     
-0000ef80: 2020 2072 6574 7572 6e20 7374 6172 740a     return start.
-0000ef90: 0a0a 636c 6173 7320 5852 6164 5377 6565  ..class XRadSwee
-0000efa0: 7047 616d 6963 2858 5261 6453 7765 6570  pGamic(XRadSweep
-0000efb0: 293a 0a20 2020 2022 2222 436c 6173 7320  ):.    """Class 
-0000efc0: 666f 7220 686f 6c64 696e 6720 6f6e 6520  for holding one 
-0000efd0: 7261 6461 7220 7377 6565 700a 0a20 2020  radar sweep..   
-0000efe0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000eff0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e  ----------.    n
-0000f000: 6366 696c 6520 3a20 7b6e 6574 4344 4634  cfile : {netCDF4
-0000f010: 2e44 6174 6173 6574 2c20 6835 7079 2e46  .Dataset, h5py.F
-0000f020: 696c 6520 6f72 2068 356e 6574 6364 662e  ile or h5netcdf.
-0000f030: 4669 6c65 206f 626a 6563 747d 0a20 2020  File object}.   
-0000f040: 2020 2020 2046 696c 6520 6861 6e64 6c65       File handle
-0000f050: 206f 6620 6669 6c65 2063 6f6e 7461 696e   of file contain
-0000f060: 696e 6720 7261 6461 7220 7377 6565 700a  ing radar sweep.
-0000f070: 2020 2020 6e63 7061 7468 203a 2073 7472      ncpath : str
-0000f080: 0a20 2020 2020 2020 2070 6174 6820 746f  .        path to
-0000f090: 2073 7765 6570 2067 726f 7570 0a20 2020   sweep group.   
-0000f0a0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-0000f0b0: 696e 6974 5f5f 2873 656c 662c 206e 6366  init__(self, ncf
-0000f0c0: 696c 652c 206e 6370 6174 682c 2070 6172  ile, ncpath, par
-0000f0d0: 656e 743d 4e6f 6e65 2c20 2a2a 6b77 6172  ent=None, **kwar
-0000f0e0: 6773 293a 0a20 2020 2020 2020 2073 7570  gs):.        sup
-0000f0f0: 6572 2858 5261 6453 7765 6570 4761 6d69  er(XRadSweepGami
-0000f100: 632c 2073 656c 6629 2e5f 5f69 6e69 745f  c, self).__init_
-0000f110: 5f28 6e63 6669 6c65 2c20 6e63 7061 7468  _(ncfile, ncpath
-0000f120: 2c20 7061 7265 6e74 2c20 2a2a 6b77 6172  , parent, **kwar
-0000f130: 6773 290a 2020 2020 2020 2020 7365 6c66  gs).        self
-0000f140: 2e5f 7261 795f 6865 6164 6572 203d 204e  ._ray_header = N
-0000f150: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
-0000f160: 7479 0a20 2020 2064 6566 2072 6179 5f68  ty.    def ray_h
-0000f170: 6561 6465 7228 7365 6c66 293a 0a20 2020  eader(self):.   
-0000f180: 2020 2020 2023 2074 6f64 6f3a 2063 6163       # todo: cac
-0000f190: 6869 6e67 2061 6464 7320 746f 206d 656d  hing adds to mem
-0000f1a0: 6f72 7920 666f 6f74 7072 696e 740a 2020  ory footprint.  
-0000f1b0: 2020 2020 2020 6966 2073 656c 662e 5f72        if self._r
-0000f1c0: 6179 5f68 6561 6465 7220 6973 204e 6f6e  ay_header is Non
-0000f1d0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000f1e0: 656c 662e 5f72 6179 5f68 6561 6465 7220  elf._ray_header 
-0000f1f0: 3d20 7365 6c66 2e6e 6369 645b 2272 6179  = self.ncid["ray
-0000f200: 5f68 6561 6465 7222 5d5b 3a5d 0a20 2020  _header"][:].   
-0000f210: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000f220: 2e5f 7261 795f 6865 6164 6572 0a0a 2020  ._ray_header..  
-0000f230: 2020 6465 6620 5f67 6574 5f61 3167 6174    def _get_a1gat
-0000f240: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0000f250: 2072 6574 7572 6e20 6e70 2e61 7267 736f   return np.argso
-0000f260: 7274 2873 656c 662e 636f 6f72 6473 2e72  rt(self.coords.r
-0000f270: 7469 6d65 2e76 616c 7565 7329 5b30 5d0a  time.values)[0].
-0000f280: 0a20 2020 2064 6566 205f 6765 745f 616e  .    def _get_an
-0000f290: 676c 655f 7265 736f 6c75 7469 6f6e 2873  gle_resolution(s
-0000f2a0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0000f2b0: 7475 726e 2073 656c 662e 686f 775b 2261  turn self.how["a
-0000f2c0: 6e67 6c65 5f73 7465 7022 5d0a 0a20 2020  ngle_step"]..   
-0000f2d0: 2064 6566 205f 6765 745f 617a 696d 7574   def _get_azimut
-0000f2e0: 6828 7365 6c66 293a 0a20 2020 2020 2020  h(self):.       
-0000f2f0: 2061 7a73 7461 7274 203d 2073 656c 662e   azstart = self.
-0000f300: 7261 795f 6865 6164 6572 5b22 617a 696d  ray_header["azim
-0000f310: 7574 685f 7374 6172 7422 5d0a 2020 2020  uth_start"].    
-0000f320: 2020 2020 617a 7374 6f70 203d 2073 656c      azstop = sel
-0000f330: 662e 7261 795f 6865 6164 6572 5b22 617a  f.ray_header["az
-0000f340: 696d 7574 685f 7374 6f70 225d 0a20 2020  imuth_stop"].   
-0000f350: 2020 2020 2069 6620 7365 6c66 2e5f 6469       if self._di
-0000f360: 6d30 5b30 5d20 3d3d 2022 617a 696d 7574  m0[0] == "azimut
-0000f370: 6822 3a0a 2020 2020 2020 2020 2020 2020  h":.            
-0000f380: 7a65 726f 5f69 6e64 6578 203d 206e 702e  zero_index = np.
-0000f390: 7768 6572 6528 617a 7374 6f70 203c 2061  where(azstop < a
-0000f3a0: 7a73 7461 7274 290a 2020 2020 2020 2020  zstart).        
-0000f3b0: 2020 2020 617a 7374 6f70 5b7a 6572 6f5f      azstop[zero_
-0000f3c0: 696e 6465 785b 305d 5d20 2b3d 2033 3630  index[0]] += 360
-0000f3d0: 0a20 2020 2020 2020 2061 7a69 6d75 7468  .        azimuth
-0000f3e0: 203d 2028 617a 7374 6172 7420 2b20 617a   = (azstart + az
-0000f3f0: 7374 6f70 2920 2f20 322e 300a 2020 2020  stop) / 2.0.    
-0000f400: 2020 2020 6461 203d 2078 722e 4461 7461      da = xr.Data
-0000f410: 4172 7261 7928 617a 696d 7574 682c 2064  Array(azimuth, d
-0000f420: 696d 733d 5b73 656c 662e 5f64 696d 305b  ims=[self._dim0[
-0000f430: 305d 5d2c 2061 7474 7273 3d61 7a5f 6174  0]], attrs=az_at
-0000f440: 7472 7329 0a20 2020 2020 2020 2069 6620  trs).        if 
-0000f450: 6e6f 7420 7365 6c66 2e5f 6d69 7363 5f6b  not self._misc_k
-0000f460: 7761 7267 735b 226b 6565 705f 617a 696d  wargs["keep_azim
-0000f470: 7574 6822 5d20 616e 6420 7365 6c66 2e5f  uth"] and self._
-0000f480: 6469 6d30 5b30 5d20 3d3d 2022 656c 6576  dim0[0] == "elev
-0000f490: 6174 696f 6e22 3a0a 2020 2020 2020 2020  ation":.        
-0000f4a0: 2020 2020 6461 203d 2064 612e 7069 7065      da = da.pipe
-0000f4b0: 285f 6669 785f 616e 676c 6529 0a20 2020  (_fix_angle).   
-0000f4c0: 2020 2020 2072 6574 7572 6e20 6461 0a0a       return da..
-0000f4d0: 2020 2020 6465 6620 5f67 6574 5f65 6c65      def _get_ele
-0000f4e0: 7661 7469 6f6e 2873 656c 6629 3a0a 2020  vation(self):.  
-0000f4f0: 2020 2020 2020 656c 7374 6172 7420 3d20        elstart = 
-0000f500: 7365 6c66 2e72 6179 5f68 6561 6465 725b  self.ray_header[
-0000f510: 2265 6c65 7661 7469 6f6e 5f73 7461 7274  "elevation_start
-0000f520: 225d 0a20 2020 2020 2020 2065 6c73 746f  "].        elsto
-0000f530: 7020 3d20 7365 6c66 2e72 6179 5f68 6561  p = self.ray_hea
-0000f540: 6465 725b 2265 6c65 7661 7469 6f6e 5f73  der["elevation_s
-0000f550: 746f 7022 5d0a 2020 2020 2020 2020 656c  top"].        el
-0000f560: 6576 6174 696f 6e20 3d20 2865 6c73 7461  evation = (elsta
-0000f570: 7274 202b 2065 6c73 746f 7029 202f 2032  rt + elstop) / 2
-0000f580: 2e30 0a20 2020 2020 2020 2064 6120 3d20  .0.        da = 
-0000f590: 7872 2e44 6174 6141 7272 6179 2865 6c65  xr.DataArray(ele
-0000f5a0: 7661 7469 6f6e 2c20 6469 6d73 3d5b 7365  vation, dims=[se
-0000f5b0: 6c66 2e5f 6469 6d30 5b30 5d5d 2c20 6174  lf._dim0[0]], at
-0000f5c0: 7472 733d 656c 5f61 7474 7273 290a 2020  trs=el_attrs).  
-0000f5d0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0000f5e0: 662e 5f6d 6973 635f 6b77 6172 6773 5b22  f._misc_kwargs["
-0000f5f0: 6b65 6570 5f65 6c65 7661 7469 6f6e 225d  keep_elevation"]
-0000f600: 2061 6e64 2073 656c 662e 5f64 696d 305b   and self._dim0[
-0000f610: 305d 203d 3d20 2261 7a69 6d75 7468 223a  0] == "azimuth":
-0000f620: 0a20 2020 2020 2020 2020 2020 2064 6120  .            da 
-0000f630: 3d20 6461 2e70 6970 6528 5f66 6978 5f61  = da.pipe(_fix_a
-0000f640: 6e67 6c65 290a 2020 2020 2020 2020 7265  ngle).        re
-0000f650: 7475 726e 2064 610a 0a20 2020 2064 6566  turn da..    def
-0000f660: 205f 6765 745f 6d64 6573 6328 7365 6c66   _get_mdesc(self
-0000f670: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0000f680: 6e20 226d 6f6d 656e 745f 220a 0a20 2020  n "moment_"..   
-0000f690: 2064 6566 205f 6765 745f 7261 6e67 6528   def _get_range(
-0000f6a0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0000f6b0: 616e 6765 5f73 616d 706c 6573 203d 2073  ange_samples = s
-0000f6c0: 656c 662e 686f 775b 2272 616e 6765 5f73  elf.how["range_s
-0000f6d0: 616d 706c 6573 225d 0a20 2020 2020 2020  amples"].       
-0000f6e0: 2072 616e 6765 5f73 7465 7020 3d20 7365   range_step = se
-0000f6f0: 6c66 2e68 6f77 5b22 7261 6e67 655f 7374  lf.how["range_st
-0000f700: 6570 225d 0a20 2020 2020 2020 2062 696e  ep"].        bin
-0000f710: 5f72 616e 6765 203d 2072 616e 6765 5f73  _range = range_s
-0000f720: 7465 7020 2a20 7261 6e67 655f 7361 6d70  tep * range_samp
-0000f730: 6c65 730a 2020 2020 2020 2020 7261 6e67  les.        rang
-0000f740: 655f 6461 7461 203d 206e 702e 6172 616e  e_data = np.aran
-0000f750: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-0000f760: 6269 6e5f 7261 6e67 6520 2f20 322e 302c  bin_range / 2.0,
-0000f770: 2062 696e 5f72 616e 6765 202a 2073 656c   bin_range * sel
-0000f780: 662e 6e62 696e 732c 2062 696e 5f72 616e  f.nbins, bin_ran
-0000f790: 6765 2c20 6474 7970 653d 2266 6c6f 6174  ge, dtype="float
-0000f7a0: 3332 220a 2020 2020 2020 2020 290a 2020  32".        ).  
-0000f7b0: 2020 2020 2020 7261 6e67 655f 6174 7472        range_attr
-0000f7c0: 735b 226d 6574 6572 735f 746f 5f63 656e  s["meters_to_cen
-0000f7d0: 7465 725f 6f66 5f66 6972 7374 5f67 6174  ter_of_first_gat
-0000f7e0: 6522 5d20 3d20 6269 6e5f 7261 6e67 6520  e"] = bin_range 
-0000f7f0: 2f20 322e 300a 2020 2020 2020 2020 6461  / 2.0.        da
-0000f800: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
-0000f810: 7261 6e67 655f 6461 7461 2c20 6469 6d73  range_data, dims
-0000f820: 3d5b 7365 6c66 2e5f 6469 6d31 5d2c 2061  =[self._dim1], a
-0000f830: 7474 7273 3d72 616e 6765 5f61 7474 7273  ttrs=range_attrs
-0000f840: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000f850: 2064 610a 0a20 2020 2064 6566 205f 6765   da..    def _ge
-0000f860: 745f 7261 795f 7469 6d65 7328 7365 6c66  t_ray_times(self
-0000f870: 293a 0a20 2020 2020 2020 2074 696d 6573  ):.        times
-0000f880: 203d 2073 656c 662e 7261 795f 6865 6164   = self.ray_head
-0000f890: 6572 5b22 7469 6d65 7374 616d 7022 5d20  er["timestamp"] 
-0000f8a0: 2f20 3165 360a 2020 2020 2020 2020 6174  / 1e6.        at
-0000f8b0: 7472 7320 3d20 7b22 756e 6974 7322 3a20  trs = {"units": 
-0000f8c0: 2273 6563 6f6e 6473 2073 696e 6365 2031  "seconds since 1
-0000f8d0: 3937 302d 3031 2d30 3154 3030 3a30 303a  970-01-01T00:00:
-0000f8e0: 3030 5a22 2c20 2273 7461 6e64 6172 645f  00Z", "standard_
-0000f8f0: 6e61 6d65 223a 2022 7469 6d65 227d 0a20  name": "time"}. 
-0000f900: 2020 2020 2020 2064 6120 3d20 7872 2e44         da = xr.D
-0000f910: 6174 6141 7272 6179 2874 696d 6573 2c20  ataArray(times, 
-0000f920: 6469 6d73 3d5b 7365 6c66 2e5f 6469 6d30  dims=[self._dim0
-0000f930: 5b30 5d5d 2c20 6174 7472 733d 6174 7472  [0]], attrs=attr
-0000f940: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-0000f950: 6e20 6461 0a0a 2020 2020 6465 6620 5f67  n da..    def _g
-0000f960: 6574 5f66 6978 6564 5f61 6e67 6c65 2873  et_fixed_angle(s
-0000f970: 656c 6629 3a0a 2020 2020 2020 2020 7472  elf):.        tr
-0000f980: 793a 0a20 2020 2020 2020 2020 2020 2061  y:.            a
-0000f990: 6e67 6c65 203d 206e 702e 726f 756e 6428  ngle = np.round(
-0000f9a0: 7365 6c66 2e68 6f77 5b73 656c 662e 5f64  self.how[self._d
-0000f9b0: 696d 305b 315d 5d2c 2064 6563 696d 616c  im0[1]], decimal
-0000f9c0: 733d 3129 0a20 2020 2020 2020 2065 7863  s=1).        exc
-0000f9d0: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
-0000f9e0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000f9f0: 6469 6d30 203d 2028 7365 6c66 2e5f 6469  dim0 = (self._di
-0000fa00: 6d30 5b31 5d2c 2073 656c 662e 5f64 696d  m0[1], self._dim
-0000fa10: 305b 305d 290a 2020 2020 2020 2020 2020  0[0]).          
-0000fa20: 2020 616e 676c 6520 3d20 6e70 2e72 6f75    angle = np.rou
-0000fa30: 6e64 2873 656c 662e 686f 775b 7365 6c66  nd(self.how[self
-0000fa40: 2e5f 6469 6d30 5b31 5d5d 2c20 6465 6369  ._dim0[1]], deci
-0000fa50: 6d61 6c73 3d31 290a 0a20 2020 2020 2020  mals=1)..       
-0000fa60: 2072 6574 7572 6e20 616e 676c 650a 0a20   return angle.. 
-0000fa70: 2020 2064 6566 205f 6d65 7267 655f 6d6f     def _merge_mo
-0000fa80: 6d65 6e74 7328 7365 6c66 293a 0a20 2020  ments(self):.   
-0000fa90: 2020 2020 2069 6620 2268 3522 2069 6e20       if "h5" in 
-0000faa0: 7365 6c66 2e65 6e67 696e 653a 0a20 2020  self.engine:.   
-0000fab0: 2020 2020 2020 2020 2069 6620 4c6f 6f73           if Loos
-0000fac0: 6556 6572 7369 6f6e 2868 356e 6574 6364  eVersion(h5netcd
-0000fad0: 662e 5f5f 7665 7273 696f 6e5f 5f29 203c  f.__version__) <
-0000fae0: 204c 6f6f 7365 5665 7273 696f 6e28 2230   LooseVersion("0
-0000faf0: 2e38 2e30 2229 3a0a 2020 2020 2020 2020  .8.0"):.        
-0000fb00: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0000fb10: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0000fb20: 2020 2020 2020 2020 2020 2066 2257 5241             f"WRA
-0000fb30: 444c 4942 3a20 2768 356e 6574 6364 663e  DLIB: 'h5netcdf>
-0000fb40: 3d30 2e38 2e30 2720 6e65 6564 6564 2074  =0.8.0' needed t
-0000fb50: 6f20 7065 7266 6f72 6d20 7468 6973 2022  o perform this "
-0000fb60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fb70: 2020 2020 2066 226f 7065 7261 7469 6f6e       f"operation
-0000fb80: 2e20 2768 356e 6574 6364 663d 7b68 356e  . 'h5netcdf={h5n
-0000fb90: 6574 6364 662e 5f5f 7665 7273 696f 6e5f  etcdf.__version_
-0000fba0: 5f7d 2022 0a20 2020 2020 2020 2020 2020  _} ".           
-0000fbb0: 2020 2020 2020 2020 2066 2261 7661 696c           f"avail
-0000fbc0: 6162 6c65 2e22 2c0a 2020 2020 2020 2020  able.",.        
-0000fbd0: 2020 2020 2020 2020 2020 2020 5573 6572              User
-0000fbe0: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-0000fbf0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000fc00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000fc10: 6e20 4e6f 6e65 0a20 2020 2020 2020 2020  n None.         
-0000fc20: 2020 2069 6620 4c6f 6f73 6556 6572 7369     if LooseVersi
-0000fc30: 6f6e 2878 722e 5f5f 7665 7273 696f 6e5f  on(xr.__version_
-0000fc40: 5f29 203c 204c 6f6f 7365 5665 7273 696f  _) < LooseVersio
-0000fc50: 6e28 2230 2e31 352e 3022 293a 0a20 2020  n("0.15.0"):.   
-0000fc60: 2020 2020 2020 2020 2020 2020 2077 6172               war
-0000fc70: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-0000fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc90: 6622 5752 4144 4c49 423a 2027 7861 7272  f"WRADLIB: 'xarr
-0000fca0: 6179 3e3d 302e 3135 2e30 2720 6e65 6564  ay>=0.15.0' need
-0000fcb0: 6564 2074 6f20 7065 7266 6f72 6d20 7468  ed to perform th
-0000fcc0: 6973 2022 0a20 2020 2020 2020 2020 2020  is ".           
-0000fcd0: 2020 2020 2020 2020 2066 226f 7065 7261           f"opera
-0000fce0: 7469 6f6e 2e20 2778 6172 7261 793d 7b78  tion. 'xarray={x
-0000fcf0: 722e 5f5f 7665 7273 696f 6e5f 5f7d 2022  r.__version__} "
-0000fd00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fd10: 2020 2020 2066 2261 7661 696c 6162 6c65       f"available
-0000fd20: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0000fd30: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
-0000fd40: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-0000fd50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000fd60: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-0000fd70: 6e65 0a20 2020 2020 2020 2020 2020 206f  ne.            o
-0000fd80: 7065 6e65 7220 3d20 6835 6e65 7463 6466  pener = h5netcdf
-0000fd90: 2e46 696c 650a 2020 2020 2020 2020 2020  .File.          
-0000fda0: 2020 6f70 656e 6572 5f6b 7761 7267 7320    opener_kwargs 
-0000fdb0: 3d20 6469 6374 2870 686f 6e79 5f64 696d  = dict(phony_dim
-0000fdc0: 733d 2261 6363 6573 7322 290a 2020 2020  s="access").    
-0000fdd0: 2020 2020 2020 2020 7374 6f72 6520 3d20          store = 
-0000fde0: 7872 2e62 6163 6b65 6e64 732e 4835 4e65  xr.backends.H5Ne
-0000fdf0: 7443 4446 5374 6f72 650a 2020 2020 2020  tCDFStore.      
-0000fe00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000fe10: 2020 2020 6f70 656e 6572 203d 206e 632e      opener = nc.
-0000fe20: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
-0000fe30: 2020 2020 6f70 656e 6572 5f6b 7761 7267      opener_kwarg
-0000fe40: 7320 3d20 6469 6374 2829 0a20 2020 2020  s = dict().     
-0000fe50: 2020 2020 2020 2073 746f 7265 203d 2078         store = x
-0000fe60: 722e 6261 636b 656e 6473 2e4e 6574 4344  r.backends.NetCD
-0000fe70: 4634 4461 7461 5374 6f72 650a 0a20 2020  F4DataStore..   
-0000fe80: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
-0000fe90: 6973 6669 6c65 2873 656c 662e 6669 6c65  isfile(self.file
-0000fea0: 6e61 6d65 293a 0a20 2020 2020 2020 2020  name):.         
-0000feb0: 2020 2064 7330 203d 206f 7065 6e65 7228     ds0 = opener(
-0000fec0: 7365 6c66 2e66 696c 656e 616d 652c 2022  self.filename, "
-0000fed0: 7222 2c20 2a2a 6f70 656e 6572 5f6b 7761  r", **opener_kwa
-0000fee0: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
-0000fef0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0000ff00: 7330 203d 2073 656c 662e 6e63 6669 6c65  s0 = self.ncfile
-0000ff10: 0a0a 2020 2020 2020 2020 6473 203d 2078  ..        ds = x
-0000ff20: 722e 6f70 656e 5f64 6174 6173 6574 280a  r.open_dataset(.
-0000ff30: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
-0000ff40: 6528 6473 302c 2073 656c 662e 6e63 7061  e(ds0, self.ncpa
-0000ff50: 7468 2c20 6c6f 636b 3d4e 6f6e 652c 2061  th, lock=None, a
-0000ff60: 7574 6f63 6c6f 7365 3d4e 6f6e 6529 2c0a  utoclose=None),.
-0000ff70: 2020 2020 2020 2020 2020 2020 656e 6769              engi
-0000ff80: 6e65 3d73 656c 662e 656e 6769 6e65 2c0a  ne=self.engine,.
-0000ff90: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-0000ffa0: 6b73 3d73 656c 662e 6368 756e 6b73 2c0a  ks=self.chunks,.
-0000ffb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000ffc0: 2020 6473 203d 2064 732e 6472 6f70 5f76    ds = ds.drop_v
-0000ffd0: 6172 7328 2272 6179 5f68 6561 6465 7222  ars("ray_header"
-0000ffe0: 2c20 6572 726f 7273 3d22 6967 6e6f 7265  , errors="ignore
-0000fff0: 2229 0a20 2020 2020 2020 2066 6f72 206d  ").        for m
-00010000: 6f6d 2069 6e20 7365 6c66 3a0a 2020 2020  om in self:.    
-00010010: 2020 2020 2020 2020 6d6f 6d5f 6e61 6d65          mom_name
-00010020: 203d 206d 6f6d 2e6e 6370 6174 682e 7370   = mom.ncpath.sp
-00010030: 6c69 7428 222f 2229 5b2d 315d 0a20 2020  lit("/")[-1].   
-00010040: 2020 2020 2020 2020 2064 6d6f 6d20 3d20           dmom = 
-00010050: 6473 5b6d 6f6d 5f6e 616d 655d 0a20 2020  ds[mom_name].   
-00010060: 2020 2020 2020 2020 206e 616d 6520 3d20           name = 
-00010070: 646d 6f6d 2e6d 6f6d 656e 742e 6c6f 7765  dmom.moment.lowe
-00010080: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-00010090: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-000100a0: 2020 2020 206e 616d 6520 3d20 4741 4d49       name = GAMI
-000100b0: 435f 4e41 4d45 535b 6e61 6d65 5d0a 2020  C_NAMES[name].  
-000100c0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-000100d0: 204b 6579 4572 726f 723a 0a20 2020 2020   KeyError:.     
-000100e0: 2020 2020 2020 2020 2020 2064 7320 3d20             ds = 
-000100f0: 6473 2e64 726f 705f 7661 7273 286d 6f6d  ds.drop_vars(mom
-00010100: 5f6e 616d 6529 0a20 2020 2020 2020 2020  _name).         
-00010110: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
-00010120: 0a20 2020 2020 2020 2020 2020 2023 2065  .            # e
-00010130: 7874 7261 6374 2061 6e64 2074 7261 6e73  xtract and trans
-00010140: 6c61 7465 2061 7474 7269 6275 7465 7320  late attributes 
-00010150: 746f 2063 660a 2020 2020 2020 2020 2020  to cf.          
-00010160: 2020 6174 7472 7320 3d20 636f 6c6c 6563    attrs = collec
-00010170: 7469 6f6e 732e 4f72 6465 7265 6444 6963  tions.OrderedDic
-00010180: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00010190: 646d 6178 203d 206e 702e 6969 6e66 6f28  dmax = np.iinfo(
-000101a0: 646d 6f6d 2e64 7479 7065 292e 6d61 780a  dmom.dtype).max.
-000101b0: 2020 2020 2020 2020 2020 2020 646d 696e              dmin
-000101c0: 203d 206e 702e 6969 6e66 6f28 646d 6f6d   = np.iinfo(dmom
-000101d0: 2e64 7479 7065 292e 6d69 6e0a 2020 2020  .dtype).min.    
-000101e0: 2020 2020 2020 2020 6d69 6e76 616c 203d          minval =
-000101f0: 2064 6d6f 6d2e 6479 6e5f 7261 6e67 655f   dmom.dyn_range_
-00010200: 6d69 6e0a 2020 2020 2020 2020 2020 2020  min.            
-00010210: 6d61 7876 616c 203d 2064 6d6f 6d2e 6479  maxval = dmom.dy
-00010220: 6e5f 7261 6e67 655f 6d61 780a 2020 2020  n_range_max.    
-00010230: 2020 2020 2020 2020 6966 206d 6178 7661          if maxva
-00010240: 6c20 213d 206d 696e 7661 6c3a 0a20 2020  l != minval:.   
-00010250: 2020 2020 2020 2020 2020 2020 2067 6169               gai
-00010260: 6e20 3d20 286d 6178 7661 6c20 2d20 6d69  n = (maxval - mi
-00010270: 6e76 616c 2920 2f20 646d 6178 0a20 2020  nval) / dmax.   
-00010280: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00010290: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-000102a0: 6169 6e20 3d20 2864 6d61 7820 2d20 646d  ain = (dmax - dm
-000102b0: 696e 2920 2f20 646d 6178 0a20 2020 2020  in) / dmax.     
-000102c0: 2020 2020 2020 2020 2020 206d 696e 7661             minva
-000102d0: 6c20 3d20 646d 696e 0a20 2020 2020 2020  l = dmin.       
-000102e0: 2020 2020 2075 6e64 6574 6563 7420 3d20       undetect = 
-000102f0: 666c 6f61 7428 646d 696e 290a 2020 2020  float(dmin).    
-00010300: 2020 2020 2020 2020 6174 7472 735b 2273          attrs["s
-00010310: 6361 6c65 5f66 6163 746f 7222 5d20 3d20  cale_factor"] = 
-00010320: 6761 696e 0a20 2020 2020 2020 2020 2020  gain.           
-00010330: 2061 7474 7273 5b22 6164 645f 6f66 6673   attrs["add_offs
-00010340: 6574 225d 203d 206d 696e 7661 6c0a 2020  et"] = minval.  
-00010350: 2020 2020 2020 2020 2020 6174 7472 735b            attrs[
-00010360: 225f 4669 6c6c 5661 6c75 6522 5d20 3d20  "_FillValue"] = 
-00010370: 666c 6f61 7428 646d 6178 290a 2020 2020  float(dmax).    
-00010380: 2020 2020 2020 2020 6174 7472 735b 225f          attrs["_
-00010390: 556e 6465 7465 6374 225d 203d 2075 6e64  Undetect"] = und
-000103a0: 6574 6563 740a 0a20 2020 2020 2020 2020  etect..         
-000103b0: 2020 2069 6620 7365 6c66 2e64 6563 6f64     if self.decod
-000103c0: 655f 636f 6f72 6473 3a0a 2020 2020 2020  e_coords:.      
-000103d0: 2020 2020 2020 2020 2020 6174 7472 735b            attrs[
-000103e0: 2263 6f6f 7264 696e 6174 6573 225d 203d  "coordinates"] =
-000103f0: 2022 656c 6576 6174 696f 6e20 617a 696d   "elevation azim
-00010400: 7574 6820 7261 6e67 6522 0a0a 2020 2020  uth range"..    
-00010410: 2020 2020 2020 2020 6d61 7070 696e 6720          mapping 
-00010420: 3d20 6d6f 6d65 6e74 735f 6d61 7070 696e  = moments_mappin
-00010430: 675b 6e61 6d65 5d0a 2020 2020 2020 2020  g[name].        
-00010440: 2020 2020 6174 7472 732e 7570 6461 7465      attrs.update
-00010450: 287b 6b65 793a 206d 6170 7069 6e67 5b6b  ({key: mapping[k
-00010460: 6579 5d20 666f 7220 6b65 7920 696e 206d  ey] for key in m
-00010470: 6f6d 656e 745f 6174 7472 737d 290a 2020  oment_attrs}).  
-00010480: 2020 2020 2020 2020 2020 2320 6173 7369            # assi
-00010490: 676e 2061 7474 7269 6275 7465 7320 746f  gn attributes to
-000104a0: 206d 6f6d 656e 740a 2020 2020 2020 2020   moment.        
-000104b0: 2020 2020 646d 6f6d 2e61 7474 7273 203d      dmom.attrs =
-000104c0: 2063 6f6c 6c65 6374 696f 6e73 2e4f 7264   collections.Ord
-000104d0: 6572 6564 4469 6374 2829 0a20 2020 2020  eredDict().     
-000104e0: 2020 2020 2020 2064 6d6f 6d2e 6174 7472         dmom.attr
-000104f0: 732e 7570 6461 7465 2861 7474 7273 290a  s.update(attrs).
-00010500: 2020 2020 2020 2020 2020 2020 6473 203d              ds =
-00010510: 2064 732e 7265 6e61 6d65 287b 6d6f 6d5f   ds.rename({mom_
-00010520: 6e61 6d65 3a20 6e61 6d65 2e75 7070 6572  name: name.upper
-00010530: 2829 7d29 0a0a 2020 2020 2020 2020 2320  ()})..        # 
-00010540: 6669 7820 6469 6d65 6e73 696f 6e73 0a20  fix dimensions. 
-00010550: 2020 2020 2020 2064 696d 7320 3d20 736f         dims = so
-00010560: 7274 6564 286c 6973 7428 6473 2e64 696d  rted(list(ds.dim
-00010570: 732e 6b65 7973 2829 292c 206b 6579 3d6c  s.keys()), key=l
-00010580: 616d 6264 6120 783a 2069 6e74 2878 5b6c  ambda x: int(x[l
-00010590: 656e 2822 7068 6f6e 795f 6469 6d5f 2229  en("phony_dim_")
-000105a0: 203a 5d29 290a 2020 2020 2020 2020 6473   :])).        ds
-000105b0: 203d 2064 732e 7265 6e61 6d65 287b 6469   = ds.rename({di
-000105c0: 6d73 5b30 5d3a 2073 656c 662e 5f64 696d  ms[0]: self._dim
-000105d0: 305b 305d 2c20 6469 6d73 5b31 5d3a 2073  0[0], dims[1]: s
-000105e0: 656c 662e 5f64 696d 317d 290a 0a20 2020  elf._dim1})..   
-000105f0: 2020 2020 2023 2074 6f64 6f3a 2074 6869       # todo: thi
-00010600: 7320 736f 7274 7320 616e 6420 7265 696e  s sorts and rein
-00010610: 6465 7865 7320 7468 6520 756e 736f 7274  dexes the unsort
-00010620: 6564 2047 414d 4943 2064 6174 6173 6574  ed GAMIC dataset
-00010630: 2062 7920 617a 696d 7574 680a 2020 2020   by azimuth.    
-00010640: 2020 2020 2320 6f6e 6c79 2069 6620 6064      # only if `d
-00010650: 6563 6f64 655f 636f 6f72 6473 6020 6973  ecode_coords` is
-00010660: 2046 616c 7365 0a20 2020 2020 2020 2023   False.        #
-00010670: 2061 6464 696e 6720 636f 6f72 6420 2d3e   adding coord ->
-00010680: 2020 736f 7274 202d 3e20 7265 696e 6465    sort -> reinde
-00010690: 7820 2d3e 2072 656d 6f76 6520 636f 6f72  x -> remove coor
-000106a0: 640a 2020 2020 2020 2020 6966 206e 6f74  d.        if not
-000106b0: 2073 656c 662e 6465 636f 6465 5f63 6f6f   self.decode_coo
-000106c0: 7264 733a 2020 2320 616e 6420 2873 656c  rds:  # and (sel
-000106d0: 662e 5f64 696d 305b 305d 203d 3d20 2261  f._dim0[0] == "a
-000106e0: 7a69 6d75 7468 2229 3a0a 2020 2020 2020  zimuth"):.      
-000106f0: 2020 2020 2020 6473 203d 2028 0a20 2020        ds = (.   
-00010700: 2020 2020 2020 2020 2020 2020 2064 732e               ds.
-00010710: 6173 7369 676e 5f63 6f6f 7264 7328 7b73  assign_coords({s
-00010720: 656c 662e 5f64 696d 305b 305d 3a20 6765  elf._dim0[0]: ge
-00010730: 7461 7474 7228 7365 6c66 2c20 7365 6c66  tattr(self, self
-00010740: 2e5f 6469 6d30 5b30 5d29 7d29 0a20 2020  ._dim0[0])}).   
-00010750: 2020 2020 2020 2020 2020 2020 202e 736f               .so
-00010760: 7274 6279 2873 656c 662e 5f64 696d 305b  rtby(self._dim0[
-00010770: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00010780: 2020 2020 2e70 6970 6528 5f72 6569 6e64      .pipe(_reind
-00010790: 6578 5f61 6e67 6c65 2c20 7365 6c66 290a  ex_angle, self).
-000107a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107b0: 2e64 726f 705f 7661 7273 2873 656c 662e  .drop_vars(self.
-000107c0: 5f64 696d 305b 305d 290a 2020 2020 2020  _dim0[0]).      
-000107d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000107e0: 7265 7475 726e 2064 730a 0a20 2020 2064  return ds..    d
-000107f0: 6566 205f 6765 745f 6e72 6179 7328 7365  ef _get_nrays(se
-00010800: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00010810: 7572 6e20 7365 6c66 2e68 6f77 5b22 7261  urn self.how["ra
-00010820: 795f 636f 756e 7422 5d0a 0a20 2020 2064  y_count"]..    d
-00010830: 6566 205f 6765 745f 6e62 696e 7328 7365  ef _get_nbins(se
-00010840: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00010850: 7572 6e20 7365 6c66 2e68 6f77 5b22 6269  urn self.how["bi
-00010860: 6e5f 636f 756e 7422 5d0a 0a20 2020 2064  n_count"]..    d
-00010870: 6566 205f 6765 745f 7469 6d65 2873 656c  ef _get_time(sel
-00010880: 6629 3a0a 2020 2020 2020 2020 7374 6172  f):.        star
-00010890: 7420 3d20 7365 6c66 2e68 6f77 5b22 7469  t = self.how["ti
-000108a0: 6d65 7374 616d 7022 5d0a 2020 2020 2020  mestamp"].      
-000108b0: 2020 7374 6172 7420 3d20 6461 7465 7574    start = dateut
-000108c0: 696c 2e70 6172 7365 722e 7061 7273 6528  il.parser.parse(
-000108d0: 7374 6172 7429 0a20 2020 2020 2020 2073  start).        s
-000108e0: 7461 7274 203d 2073 7461 7274 2e72 6570  tart = start.rep
-000108f0: 6c61 6365 2874 7a69 6e66 6f3d 6474 2e74  lace(tzinfo=dt.t
-00010900: 696d 657a 6f6e 652e 7574 6329 2e74 696d  imezone.utc).tim
-00010910: 6573 7461 6d70 2829 0a20 2020 2020 2020  estamp().       
-00010920: 2064 6120 3d20 7872 2e44 6174 6141 7272   da = xr.DataArr
-00010930: 6179 2873 7461 7274 2c20 6174 7472 733d  ay(start, attrs=
-00010940: 7469 6d65 5f61 7474 7273 290a 2020 2020  time_attrs).    
-00010950: 2020 2020 7265 7475 726e 2064 610a 0a20      return da.. 
-00010960: 2020 2064 6566 205f 6765 745f 7469 6d65     def _get_time
-00010970: 5f66 6173 7428 7365 6c66 293a 0a20 2020  _fast(self):.   
-00010980: 2020 2020 206e 6369 6420 3d20 7365 6c66       ncid = self
-00010990: 2e6e 6369 640a 2020 2020 2020 2020 7472  .ncid.        tr
-000109a0: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
-000109b0: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-000109c0: 662e 6e63 6669 6c65 2c20 6e63 2e44 6174  f.ncfile, nc.Dat
-000109d0: 6173 6574 293a 0a20 2020 2020 2020 2020  aset):.         
-000109e0: 2020 2020 2020 2073 7461 7274 203d 206e         start = n
-000109f0: 6369 645b 2268 6f77 225d 2e67 6574 6e63  cid["how"].getnc
-00010a00: 6174 7472 2822 7469 6d65 7374 616d 7022  attr("timestamp"
-00010a10: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00010a20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00010a30: 2020 2020 7374 6172 7420 3d20 6e63 6964      start = ncid
-00010a40: 5b22 686f 7722 5d2e 6174 7472 735b 2274  ["how"].attrs["t
-00010a50: 696d 6573 7461 6d70 225d 0a20 2020 2020  imestamp"].     
-00010a60: 2020 2020 2020 2020 2020 2069 6620 4c6f             if Lo
-00010a70: 6f73 6556 6572 7369 6f6e 2868 3570 792e  oseVersion(h5py.
-00010a80: 5f5f 7665 7273 696f 6e5f 5f29 203c 204c  __version__) < L
-00010a90: 6f6f 7365 5665 7273 696f 6e28 2233 2e30  ooseVersion("3.0
-00010aa0: 2e30 2229 3a0a 2020 2020 2020 2020 2020  .0"):.          
-00010ab0: 2020 2020 2020 2020 2020 7374 6172 7420            start 
-00010ac0: 3d20 7374 6172 742e 6465 636f 6465 2829  = start.decode()
-00010ad0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00010ae0: 2849 6e64 6578 4572 726f 722c 204b 6579  (IndexError, Key
-00010af0: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
-00010b00: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-00010b10: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
-00010b20: 6461 7465 7574 696c 2e70 6172 7365 722e  dateutil.parser.
-00010b30: 7061 7273 6528 7374 6172 7429 0a20 2020  parse(start).   
-00010b40: 2020 2020 2073 7461 7274 203d 2073 7461       start = sta
-00010b50: 7274 2e72 6570 6c61 6365 2874 7a69 6e66  rt.replace(tzinf
-00010b60: 6f3d 6474 2e74 696d 657a 6f6e 652e 7574  o=dt.timezone.ut
-00010b70: 6329 2e74 696d 6573 7461 6d70 2829 0a20  c).timestamp(). 
-00010b80: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
-00010b90: 6172 740a 0a0a 636c 6173 7320 5852 6164  art...class XRad
-00010ba0: 5469 6d65 5365 7269 6573 284f 6469 6d48  TimeSeries(OdimH
-00010bb0: 3547 726f 7570 4174 7472 6962 7574 654d  5GroupAttributeM
-00010bc0: 6978 696e 2c20 5852 6164 4261 7365 293a  ixin, XRadBase):
-00010bd0: 0a20 2020 2022 2222 436c 6173 7320 666f  .    """Class fo
-00010be0: 7220 686f 6c64 696e 6720 6120 7469 6d65  r holding a time
-00010bf0: 7365 7269 6573 206f 6620 7261 6461 7220  series of radar 
-00010c00: 7377 6565 7073 2222 220a 0a20 2020 2064  sweeps"""..    d
-00010c10: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00010c20: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00010c30: 2020 2020 2073 7570 6572 2858 5261 6454       super(XRadT
-00010c40: 696d 6553 6572 6965 732c 2073 656c 6629  imeSeries, self)
-00010c50: 2e5f 5f69 6e69 745f 5f28 290a 2020 2020  .__init__().    
-00010c60: 2020 2020 7365 6c66 2e5f 6461 7461 203d      self._data =
-00010c70: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00010c80: 6c66 2e5f 6d6f 6d65 6e74 7320 3d20 4e6f  lf._moments = No
-00010c90: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00010ca0: 5f6d 6574 6120 3d20 4e6f 6e65 0a0a 2020  _meta = None..  
-00010cb0: 2020 2320 6f76 6572 7269 6465 2061 7070    # override app
-00010cc0: 656e 6420 616e 6420 636c 6169 6d20 6669  end and claim fi
-00010cd0: 6c65 2066 6f72 204f 6469 6d48 3547 726f  le for OdimH5Gro
-00010ce0: 7570 4174 7472 6962 7574 654d 6978 696e  upAttributeMixin
-00010cf0: 0a20 2020 2064 6566 2061 7070 656e 6428  .    def append(
-00010d00: 7365 6c66 2c20 7661 6c75 6529 3a0a 2020  self, value):.  
-00010d10: 2020 2020 2020 2320 646f 206f 6e6c 7920        # do only 
-00010d20: 666f 7220 6669 7273 7420 6669 6c65 2069  for first file i
-00010d30: 6e20 7468 6973 2074 696d 6573 6572 6965  n this timeserie
-00010d40: 730a 2020 2020 2020 2020 7661 6c75 652e  s.        value.
-00010d50: 5f70 6172 656e 7420 3d20 7365 6c66 0a20  _parent = self. 
-00010d60: 2020 2020 2020 2069 6620 6e6f 7420 6c65         if not le
-00010d70: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
-00010d80: 2020 2020 2073 656c 662e 5f6e 6366 696c       self._ncfil
-00010d90: 6520 3d20 7661 6c75 652e 6e63 6669 6c65  e = value.ncfile
-00010da0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00010db0: 662e 5f6e 6370 6174 6820 3d20 7661 6c75  f._ncpath = valu
-00010dc0: 652e 6e63 7061 7468 0a20 2020 2020 2020  e.ncpath.       
-00010dd0: 2072 6574 7572 6e20 7375 7065 7228 5852   return super(XR
-00010de0: 6164 5469 6d65 5365 7269 6573 2c20 7365  adTimeSeries, se
-00010df0: 6c66 292e 6170 7065 6e64 2876 616c 7565  lf).append(value
-00010e00: 290a 0a20 2020 2064 6566 205f 5f72 6570  )..    def __rep
-00010e10: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-00010e20: 2020 2073 756d 6d61 7279 203d 205b 223c     summary = ["<
-00010e30: 7772 6164 6c69 622e 7b7d 3e22 2e66 6f72  wradlib.{}>".for
-00010e40: 6d61 7428 7479 7065 2873 656c 6629 2e5f  mat(type(self)._
-00010e50: 5f6e 616d 655f 5f29 5d0a 2020 2020 2020  _name__)].      
-00010e60: 2020 6469 6d73 203d 2022 4469 6d65 6e73    dims = "Dimens
-00010e70: 696f 6e28 7329 3a22 0a20 2020 2020 2020  ion(s):".       
-00010e80: 2064 696d 735f 7375 6d6d 6172 7920 3d20   dims_summary = 
-00010e90: 5b66 2274 696d 653a 207b 6c65 6e28 7365  [f"time: {len(se
-00010ea0: 6c66 297d 225d 0a20 2020 2020 2020 2064  lf)}"].        d
-00010eb0: 696d 735f 7375 6d6d 6172 792e 6170 7065  ims_summary.appe
-00010ec0: 6e64 2866 227b 7365 6c66 2e5f 7365 715b  nd(f"{self._seq[
-00010ed0: 305d 2e5f 6469 6d30 5b30 5d7d 3a20 7b73  0]._dim0[0]}: {s
-00010ee0: 656c 662e 5f73 6571 5b30 5d2e 6e72 6179  elf._seq[0].nray
-00010ef0: 737d 2229 0a20 2020 2020 2020 2064 696d  s}").        dim
-00010f00: 735f 7375 6d6d 6172 792e 6170 7065 6e64  s_summary.append
-00010f10: 2866 227b 7365 6c66 2e5f 7365 715b 305d  (f"{self._seq[0]
-00010f20: 2e5f 6469 6d31 7d3a 207b 7365 6c66 2e5f  ._dim1}: {self._
-00010f30: 7365 715b 305d 2e6e 6269 6e73 7d22 290a  seq[0].nbins}").
-00010f40: 2020 2020 2020 2020 6469 6d73 5f73 756d          dims_sum
-00010f50: 6d61 7279 203d 2022 2c20 222e 6a6f 696e  mary = ", ".join
-00010f60: 2864 696d 735f 7375 6d6d 6172 7929 0a20  (dims_summary). 
-00010f70: 2020 2020 2020 2073 756d 6d61 7279 2e61         summary.a
-00010f80: 7070 656e 6428 227b 7d20 287b 7d29 222e  ppend("{} ({})".
-00010f90: 666f 726d 6174 2864 696d 732c 2064 696d  format(dims, dim
-00010fa0: 735f 7375 6d6d 6172 7929 290a 2020 2020  s_summary)).    
-00010fb0: 2020 2020 616e 676c 6520 3d20 6622 7b73      angle = f"{s
-00010fc0: 656c 662e 5f73 6571 5b30 5d2e 5f64 696d  elf._seq[0]._dim
-00010fd0: 305b 315d 2e63 6170 6974 616c 697a 6528  0[1].capitalize(
-00010fe0: 297d 2873 293a 220a 2020 2020 2020 2020  )}(s):".        
-00010ff0: 616e 676c 655f 7375 6d6d 6172 7920 3d20  angle_summary = 
-00011000: 7365 6c66 5b30 5d2e 6669 7865 645f 616e  self[0].fixed_an
-00011010: 676c 650a 2020 2020 2020 2020 7375 6d6d  gle.        summ
-00011020: 6172 792e 6170 7065 6e64 2866 227b 616e  ary.append(f"{an
-00011030: 676c 657d 2028 7b61 6e67 6c65 5f73 756d  gle} ({angle_sum
-00011040: 6d61 7279 3a2e 3166 7d29 2229 0a0a 2020  mary:.1f})")..  
-00011050: 2020 2020 2020 7265 7475 726e 2022 5c6e        return "\n
-00011060: 222e 6a6f 696e 2873 756d 6d61 7279 290a  ".join(summary).
-00011070: 0a20 2020 2064 6566 2072 6573 6574 5f64  .    def reset_d
-00011080: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
-00011090: 2020 2073 656c 662e 5f64 6174 6120 3d20     self._data = 
-000110a0: 4e6f 6e65 0a0a 2020 2020 4070 726f 7065  None..    @prope
-000110b0: 7274 790a 2020 2020 6465 6620 6461 7461  rty.    def data
-000110c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000110d0: 6966 2073 656c 662e 5f64 6174 6120 6973  if self._data is
-000110e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000110f0: 2020 2023 206d 6f6d 656e 7473 2068 616e     # moments han
-00011100: 646c 696e 670a 2020 2020 2020 2020 2020  dling.          
-00011110: 2020 2320 636f 6f72 6473 203d 2073 6574    # coords = set
-00011120: 285b 2772 7469 6d65 272c 2027 7261 6e67  (['rtime', 'rang
-00011130: 6527 2c20 2761 7a69 6d75 7468 272c 2027  e', 'azimuth', '
-00011140: 656c 6576 6174 696f 6e27 2c20 2774 696d  elevation', 'tim
-00011150: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00011160: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-00011170: 2761 6c74 6974 7564 6527 2c20 276c 6174  'altitude', 'lat
-00011180: 6974 7564 6527 2c20 276c 6f6e 6769 7475  itude', 'longitu
-00011190: 6465 272c 2027 7377 6565 705f 6d6f 6465  de', 'sweep_mode
-000111a0: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
-000111b0: 2320 6765 7420 696e 7465 7273 6563 7469  # get intersecti
-000111c0: 6f6e 2061 6e64 2075 6e69 6f6e 0a20 2020  on and union.   
-000111d0: 2020 2020 2020 2020 206d 6f6d 656e 745f           moment_
-000111e0: 7365 7420 3d20 5b73 6574 2874 312e 6d6f  set = [set(t1.mo
-000111f0: 6d65 6e74 7329 2066 6f72 2074 3120 696e  ments) for t1 in
-00011200: 2073 656c 665d 0a20 2020 2020 2020 2020   self].         
-00011210: 2020 206d 6f6d 656e 745f 7365 745f 6920     moment_set_i 
-00011220: 3d20 7365 742e 696e 7465 7273 6563 7469  = set.intersecti
-00011230: 6f6e 282a 6d6f 6d65 6e74 5f73 6574 290a  on(*moment_set).
-00011240: 2020 2020 2020 2020 2020 2020 6d6f 6d65              mome
-00011250: 6e74 5f73 6574 5f75 203d 2073 6574 2e75  nt_set_u = set.u
-00011260: 6e69 6f6e 282a 6d6f 6d65 6e74 5f73 6574  nion(*moment_set
-00011270: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-00011280: 6472 6f70 2076 6172 6961 626c 6573 206e  drop variables n
-00011290: 6f74 2061 7661 696c 6162 6c65 2069 6e20  ot available in 
-000112a0: 616c 6c20 6461 7461 7365 7473 0a20 2020  all datasets.   
-000112b0: 2020 2020 2020 2020 2064 726f 7020 3d20           drop = 
-000112c0: 6d6f 6d65 6e74 5f73 6574 5f69 205e 206d  moment_set_i ^ m
-000112d0: 6f6d 656e 745f 7365 745f 750a 2020 2020  oment_set_u.    
-000112e0: 2020 2020 2020 2020 2320 6b65 6570 203d          # keep =
-000112f0: 2028 6d6f 6d65 6e74 5f73 6574 5f69 207c   (moment_set_i |
-00011300: 2063 6f6f 7264 7329 205e 2063 6f6f 7264   coords) ^ coord
-00011310: 730a 2020 2020 2020 2020 2020 2020 6472  s.            dr
-00011320: 6f70 203d 206c 6973 7428 7365 6c66 2e63  op = list(self.c
-00011330: 6865 636b 5f6d 6f6d 656e 7473 2829 2e6b  heck_moments().k
-00011340: 6579 7328 2929 0a20 2020 2020 2020 2020  eys()).         
-00011350: 2020 2069 6620 6472 6f70 3a0a 2020 2020     if drop:.    
-00011360: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00011370: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-00011380: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011390: 7772 6164 6c69 623a 204d 6f6d 656e 7473  wradlib: Moments
-000113a0: 207b 7d20 6172 6520 6e6f 7420 6176 6169   {} are not avai
-000113b0: 6c61 626c 6520 696e 2061 6c6c 2064 6174  lable in all dat
-000113c0: 6173 6574 7320 220a 2020 2020 2020 2020  asets ".        
-000113d0: 2020 2020 2020 2020 2020 2020 2261 6e64              "and
-000113e0: 2077 696c 6c20 6265 2064 726f 7070 6564   will be dropped
-000113f0: 2066 726f 6d20 7468 6520 7265 7375 6c74   from the result
-00011400: 2e5c 6e22 0a20 2020 2020 2020 2020 2020  .\n".           
-00011410: 2020 2020 2020 2020 2022 5468 6973 2077           "This w
-00011420: 696c 6c20 6265 2073 6f6c 7665 6420 696e  ill be solved in
-00011430: 2078 6172 7261 792c 2073 6565 2022 0a20   xarray, see ". 
-00011440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011450: 2020 2022 6874 7470 733a 2f2f 6769 7468     "https://gith
-00011460: 7562 2e63 6f6d 2f70 7964 6174 612f 7861  ub.com/pydata/xa
-00011470: 7272 6179 2f70 756c 6c2f 3335 3435 222e  rray/pull/3545".
-00011480: 666f 726d 6174 2864 726f 7029 0a20 2020  format(drop).   
-00011490: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-000114a0: 2020 2020 2020 2020 2020 2020 2320 746f              # to
-000114b0: 646f 3a20 6361 7463 6820 706f 7373 6962  do: catch possib
-000114c0: 6c65 2065 7272 6f72 2061 6e64 2061 6464  le error and add
-000114d0: 2070 7265 6369 7365 2045 7272 6f72 4d65   precise ErrorMe
-000114e0: 7373 6167 650a 2020 2020 2020 2020 2020  ssage.          
-000114f0: 2020 7365 6c66 2e5f 6461 7461 203d 2078    self._data = x
-00011500: 722e 636f 6e63 6174 280a 2020 2020 2020  r.concat(.      
-00011510: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00011520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011530: 662e 6461 7461 2e64 726f 705f 7661 7273  f.data.drop_vars
-00011540: 2864 726f 702c 2065 7272 6f72 733d 2269  (drop, errors="i
-00011550: 676e 6f72 6522 290a 2020 2020 2020 2020  gnore").        
-00011560: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00011570: 6620 696e 2074 7164 6d28 0a20 2020 2020  f in tqdm(.     
-00011580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011590: 2020 2073 656c 662c 2064 6573 633d 2243     self, desc="C
-000115a0: 6f6c 6c65 6374 696e 6722 2c20 756e 6974  ollecting", unit
-000115b0: 3d22 2054 696d 6573 7465 7073 222c 206c  =" Timesteps", l
-000115c0: 6561 7665 3d4e 6f6e 650a 2020 2020 2020  eave=None.      
-000115d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115f0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00011600: 2020 2023 2064 6174 615f 7661 7273 3d6c     # data_vars=l
-00011610: 6973 7428 6b65 6570 292c 0a20 2020 2020  ist(keep),.     
-00011620: 2020 2020 2020 2020 2020 2064 696d 3d22             dim="
-00011630: 7469 6d65 222c 0a20 2020 2020 2020 2020  time",.         
-00011640: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00011650: 7572 6e20 7365 6c66 2e5f 6461 7461 0a0a  urn self._data..
-00011660: 2020 2020 6465 6620 6368 6563 6b5f 7261      def check_ra
-00011670: 7973 2873 656c 6629 3a0a 2020 2020 2020  ys(self):.      
-00011680: 2020 6e72 6179 7320 3d20 5b73 7770 2e6e    nrays = [swp.n
-00011690: 7261 7973 2066 6f72 2073 7770 2069 6e20  rays for swp in 
-000116a0: 7365 6c66 5d0a 2020 2020 2020 2020 736e  self].        sn
-000116b0: 7261 7973 203d 2073 6574 286e 7261 7973  rays = set(nrays
-000116c0: 290a 2020 2020 2020 2020 6964 7820 3d20  ).        idx = 
-000116d0: 5b5d 0a20 2020 2020 2020 2066 6f72 206e  [].        for n
-000116e0: 7220 696e 2073 6e72 6179 733a 0a20 2020  r in snrays:.   
-000116f0: 2020 2020 2020 2020 2069 6620 6e72 2025           if nr %
-00011700: 2033 3630 3a0a 2020 2020 2020 2020 2020   360:.          
-00011710: 2020 2020 2020 6964 782e 6578 7465 6e64        idx.extend
-00011720: 286e 702e 6172 6777 6865 7265 286e 702e  (np.argwhere(np.
-00011730: 6172 7261 7928 6e72 6179 7329 203d 3d20  array(nrays) == 
-00011740: 6e72 292e 666c 6174 7465 6e28 292e 746f  nr).flatten().to
-00011750: 6c69 7374 2829 290a 0a20 2020 2020 2020  list())..       
-00011760: 2069 6620 6c65 6e28 736e 7261 7973 2920   if len(snrays) 
-00011770: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
-00011780: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00011790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117a0: 6622 7772 6164 6c69 623a 206e 756d 6265  f"wradlib: numbe
-000117b0: 7220 6f66 2072 6179 7320 6469 6666 6572  r of rays differ
-000117c0: 696e 6720 6265 7477 6565 6e20 7377 6565  ing between swee
-000117d0: 7073 2e5c 6e22 2066 227b 736e 7261 7973  ps.\n" f"{snrays
-000117e0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
-000117f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00011800: 736e 7261 7973 2c20 6964 780a 0a20 2020  snrays, idx..   
-00011810: 2064 6566 2063 6865 636b 5f6d 6f6d 656e   def check_momen
-00011820: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-00011830: 2020 6d6f 6d65 6e74 7320 3d20 5b73 6574    moments = [set
-00011840: 285b 6d6f 6d2e 7175 616e 7469 7479 2066  ([mom.quantity f
-00011850: 6f72 206d 6f6d 2069 6e20 7377 705d 2920  or mom in swp]) 
-00011860: 666f 7220 7377 7020 696e 2073 656c 665d  for swp in self]
-00011870: 0a20 2020 2020 2020 206d 6920 3d20 7365  .        mi = se
-00011880: 742e 696e 7465 7273 6563 7469 6f6e 282a  t.intersection(*
-00011890: 6d6f 6d65 6e74 7329 0a20 2020 2020 2020  moments).       
-000118a0: 206d 7520 3d20 7365 742e 756e 696f 6e28   mu = set.union(
-000118b0: 2a6d 6f6d 656e 7473 290a 2020 2020 2020  *moments).      
-000118c0: 2020 6d70 203d 206d 6920 5e20 6d75 0a20    mp = mi ^ mu. 
-000118d0: 2020 2020 2020 206d 6973 7320 3d20 7b7d         miss = {}
-000118e0: 0a20 2020 2020 2020 2066 6f72 206d 6f6d  .        for mom
-000118f0: 2069 6e20 6d75 3a0a 2020 2020 2020 2020   in mu:.        
-00011900: 2020 2020 6964 7820 3d20 5b5d 0a20 2020      idx = [].   
-00011910: 2020 2020 2020 2020 2069 6620 6d6f 6d20           if mom 
-00011920: 696e 206d 703a 0a20 2020 2020 2020 2020  in mp:.         
-00011930: 2020 2020 2020 2066 6f72 2069 2c20 6d73         for i, ms
-00011940: 6574 2069 6e20 656e 756d 6572 6174 6528  et in enumerate(
-00011950: 6d6f 6d65 6e74 7329 3a0a 2020 2020 2020  moments):.      
-00011960: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011970: 206d 6f6d 206e 6f74 2069 6e20 6d73 6574   mom not in mset
-00011980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011990: 2020 2020 2020 2020 2020 6964 782e 6170            idx.ap
-000119a0: 7065 6e64 2869 290a 2020 2020 2020 2020  pend(i).        
-000119b0: 2020 2020 2020 2020 6d69 7373 5b6d 6f6d          miss[mom
-000119c0: 5d20 3d20 6964 780a 2020 2020 2020 2020  ] = idx.        
-000119d0: 7265 7475 726e 206d 6973 730a 0a20 2020  return miss..   
-000119e0: 2064 6566 2073 6574 5f6d 6f6d 656e 7473   def set_moments
-000119f0: 2873 656c 662c 206d 6f6d 656e 7473 293a  (self, moments):
-00011a00: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00011a10: 6973 696e 7374 616e 6365 286d 6f6d 656e  isinstance(momen
-00011a20: 7473 2c20 6c69 7374 293a 0a20 2020 2020  ts, list):.     
-00011a30: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-00011a40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00011a50: 2020 2020 2020 7365 6c66 2e5f 6d6f 6d65        self._mome
-00011a60: 6e74 7320 3d20 6d6f 6d65 6e74 730a 0a20  nts = moments.. 
-00011a70: 2020 2064 6566 2073 6574 5f6d 6574 6164     def set_metad
-00011a80: 6174 6128 7365 6c66 2c20 6d65 7461 6461  ata(self, metada
-00011a90: 7461 293a 0a20 2020 2020 2020 2069 6620  ta):.        if 
-00011aa0: 6e6f 7420 6973 696e 7374 616e 6365 286d  not isinstance(m
-00011ab0: 6574 6164 6174 612c 2064 6963 7429 3a0a  etadata, dict):.
-00011ac0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-00011ad0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00011ae0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011af0: 5f6d 6574 6120 3d20 6d65 7461 6461 7461  _meta = metadata
-00011b00: 0a0a 0a63 6c61 7373 2058 5261 6456 6f6c  ...class XRadVol
-00011b10: 756d 6528 4f64 696d 4835 4772 6f75 7041  ume(OdimH5GroupA
-00011b20: 7474 7269 6275 7465 4d69 7869 6e2c 2058  ttributeMixin, X
-00011b30: 5261 6442 6173 6529 3a0a 2020 2020 2222  RadBase):.    ""
-00011b40: 2243 6c61 7373 2066 6f72 2068 6f6c 6469  "Class for holdi
-00011b50: 6e67 2061 2076 6f6c 756d 6520 6f66 2072  ng a volume of r
-00011b60: 6164 6172 2073 7765 6570 7322 2222 0a0a  adar sweeps"""..
-00011b70: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00011b80: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
-00011b90: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
-00011ba0: 5852 6164 566f 6c75 6d65 2c20 7365 6c66  XRadVolume, self
-00011bb0: 292e 5f5f 696e 6974 5f5f 2829 0a20 2020  ).__init__().   
-00011bc0: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
-00011bd0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00011be0: 656c 662e 5f72 6f6f 7420 3d20 4e6f 6e65  elf._root = None
-00011bf0: 0a0a 2020 2020 6465 6620 5f5f 7265 7072  ..    def __repr
-00011c00: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00011c10: 2020 7375 6d6d 6172 7920 3d20 5b22 3c77    summary = ["<w
-00011c20: 7261 646c 6962 2e7b 7d3e 222e 666f 726d  radlib.{}>".form
-00011c30: 6174 2874 7970 6528 7365 6c66 292e 5f5f  at(type(self).__
-00011c40: 6e61 6d65 5f5f 295d 0a20 2020 2020 2020  name__)].       
-00011c50: 2064 696d 7320 3d20 2244 696d 656e 7369   dims = "Dimensi
-00011c60: 6f6e 2873 293a 220a 2020 2020 2020 2020  on(s):".        
-00011c70: 6469 6d73 5f73 756d 6d61 7279 203d 2066  dims_summary = f
-00011c80: 2273 7765 6570 3a20 7b6c 656e 2873 656c  "sweep: {len(sel
-00011c90: 6629 7d22 0a20 2020 2020 2020 2073 756d  f)}".        sum
-00011ca0: 6d61 7279 2e61 7070 656e 6428 227b 7d20  mary.append("{} 
-00011cb0: 287b 7d29 222e 666f 726d 6174 2864 696d  ({})".format(dim
-00011cc0: 732c 2064 696d 735f 7375 6d6d 6172 7929  s, dims_summary)
-00011cd0: 290a 2020 2020 2020 2020 616e 676c 6520  ).        angle 
-00011ce0: 3d20 6622 7b73 656c 665b 305d 5b30 5d2e  = f"{self[0][0].
-00011cf0: 5f64 696d 305b 315d 2e63 6170 6974 616c  _dim0[1].capital
-00011d00: 697a 6528 297d 2873 293a 220a 2020 2020  ize()}(s):".    
-00011d10: 2020 2020 616e 676c 655f 7375 6d6d 6172      angle_summar
-00011d20: 7920 3d20 5b66 227b 6b5b 305d 2e66 6978  y = [f"{k[0].fix
-00011d30: 6564 5f61 6e67 6c65 3a2e 3166 7d22 2066  ed_angle:.1f}" f
-00011d40: 6f72 206b 2069 6e20 7365 6c66 5d0a 2020  or k in self].  
-00011d50: 2020 2020 2020 616e 676c 655f 7375 6d6d        angle_summ
-00011d60: 6172 7920 3d20 222c 2022 2e6a 6f69 6e28  ary = ", ".join(
-00011d70: 616e 676c 655f 7375 6d6d 6172 7929 0a20  angle_summary). 
-00011d80: 2020 2020 2020 2073 756d 6d61 7279 2e61         summary.a
-00011d90: 7070 656e 6428 227b 7d20 287b 7d29 222e  ppend("{} ({})".
-00011da0: 666f 726d 6174 2861 6e67 6c65 2c20 616e  format(angle, an
-00011db0: 676c 655f 7375 6d6d 6172 7929 290a 0a20  gle_summary)).. 
-00011dc0: 2020 2020 2020 2072 6574 7572 6e20 225c         return "\
-00011dd0: 6e22 2e6a 6f69 6e28 7375 6d6d 6172 7929  n".join(summary)
-00011de0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00011df0: 2020 2020 6465 6620 726f 6f74 2873 656c      def root(sel
-00011e00: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00011e10: 6574 7572 6e20 726f 6f74 206f 626a 6563  eturn root objec
-00011e20: 742e 2222 220a 2020 2020 2020 2020 6966  t.""".        if
-00011e30: 2073 656c 662e 5f72 6f6f 7420 6973 204e   self._root is N
-00011e40: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00011e50: 2073 656c 662e 6173 7369 676e 5f72 6f6f   self.assign_roo
-00011e60: 7428 290a 2020 2020 2020 2020 7265 7475  t().        retu
-00011e70: 726e 2073 656c 662e 5f72 6f6f 740a 0a20  rn self._root.. 
-00011e80: 2020 2064 6566 2061 7373 6967 6e5f 726f     def assign_ro
-00011e90: 6f74 2873 656c 6629 3a0a 2020 2020 2020  ot(self):.      
-00011ea0: 2020 2222 2228 5265 2d29 4372 6561 7465    """(Re-)Create
-00011eb0: 2072 6f6f 7420 6f62 6a65 6374 2061 6363   root object acc
-00011ec0: 6f72 6469 6e67 2043 6652 6164 6961 6c32  ording CfRadial2
-00011ed0: 2073 7461 6e64 6172 6422 2222 0a20 2020   standard""".   
-00011ee0: 2020 2020 2023 2061 7373 6967 6e20 726f       # assign ro
-00011ef0: 6f74 2076 6172 6961 626c 6573 0a20 2020  ot variables.   
-00011f00: 2020 2020 2073 7765 6570 5f67 726f 7570       sweep_group
-00011f10: 5f6e 616d 6573 203d 205b 6622 7377 6565  _names = [f"swee
-00011f20: 705f 7b69 7d22 2066 6f72 2069 2069 6e20  p_{i}" for i in 
-00011f30: 7261 6e67 6528 6c65 6e28 7365 6c66 2929  range(len(self))
-00011f40: 5d0a 0a20 2020 2020 2020 2074 7279 3a0a  ]..        try:.
-00011f50: 2020 2020 2020 2020 2020 2020 7377 6565              swee
-00011f60: 705f 6669 7865 645f 616e 676c 6573 203d  p_fixed_angles =
-00011f70: 205b 7473 5b30 5d2e 6669 7865 645f 616e   [ts[0].fixed_an
-00011f80: 676c 6520 666f 7220 7473 2069 6e20 7365  gle for ts in se
-00011f90: 6c66 5d0a 2020 2020 2020 2020 6578 6365  lf].        exce
-00011fa0: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
-00011fb0: 723a 0a20 2020 2020 2020 2020 2020 2073  r:.            s
-00011fc0: 7765 6570 5f66 6978 6564 5f61 6e67 6c65  weep_fixed_angle
-00011fd0: 7320 3d20 5b74 732e 6669 7865 645f 616e  s = [ts.fixed_an
-00011fe0: 676c 6520 666f 7220 7473 2069 6e20 7365  gle for ts in se
-00011ff0: 6c66 5d0a 0a20 2020 2020 2020 2023 2065  lf]..        # e
-00012000: 7874 7261 6374 2074 696d 6520 636f 7665  xtract time cove
-00012010: 7261 6765 0a20 2020 2020 2020 2074 696d  rage.        tim
-00012020: 6573 203d 206e 702e 6172 7261 7928 0a20  es = np.array(. 
-00012030: 2020 2020 2020 2020 2020 205b 5b74 5b30             [[t[0
-00012040: 5d2e 7261 795f 7469 6d65 732e 7661 6c75  ].ray_times.valu
-00012050: 6573 2e6d 696e 2829 2c20 745b 2d31 5d2e  es.min(), t[-1].
-00012060: 7261 795f 7469 6d65 732e 7661 6c75 6573  ray_times.values
-00012070: 2e6d 6178 2829 5d20 666f 7220 7420 696e  .max()] for t in
-00012080: 2073 656c 665d 0a20 2020 2020 2020 2029   self].        )
-00012090: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
-000120a0: 2020 2074 696d 655f 636f 7665 7261 6765     time_coverage
-000120b0: 5f73 7461 7274 203d 206d 696e 2874 696d  _start = min(tim
-000120c0: 6573 290a 2020 2020 2020 2020 7469 6d65  es).        time
-000120d0: 5f63 6f76 6572 6167 655f 656e 6420 3d20  _coverage_end = 
-000120e0: 6d61 7828 7469 6d65 7329 0a0a 2020 2020  max(times)..    
-000120f0: 2020 2020 7469 6d65 5f63 6f76 6572 6167      time_coverag
-00012100: 655f 7374 6172 745f 7374 7220 3d20 7374  e_start_str = st
-00012110: 7228 7469 6d65 5f63 6f76 6572 6167 655f  r(time_coverage_
-00012120: 7374 6172 7429 5b3a 3139 5d20 2b20 225a  start)[:19] + "Z
-00012130: 220a 2020 2020 2020 2020 7469 6d65 5f63  ".        time_c
-00012140: 6f76 6572 6167 655f 656e 645f 7374 7220  overage_end_str 
-00012150: 3d20 7374 7228 7469 6d65 5f63 6f76 6572  = str(time_cover
-00012160: 6167 655f 656e 6429 5b3a 3139 5d20 2b20  age_end)[:19] + 
-00012170: 225a 220a 0a20 2020 2020 2020 2023 2063  "Z"..        # c
-00012180: 7265 6174 6520 726f 6f74 2067 726f 7570  reate root group
-00012190: 2066 726f 6d20 7363 7261 7463 680a 2020   from scratch.  
-000121a0: 2020 2020 2020 726f 6f74 203d 2078 722e        root = xr.
-000121b0: 4461 7461 7365 7428 2920 2023 2064 6174  Dataset()  # dat
-000121c0: 615f 7661 7273 3d77 726c 2e69 6f2e 7861  a_vars=wrl.io.xa
-000121d0: 7272 6179 2e67 6c6f 6261 6c5f 7661 7269  rray.global_vari
-000121e0: 6162 6c65 732c 0a20 2020 2020 2020 2023  ables,.        #
-000121f0: 2061 7474 7273 3d77 726c 2e69 6f2e 7861   attrs=wrl.io.xa
-00012200: 7272 6179 2e67 6c6f 6261 6c5f 6174 7472  rray.global_attr
-00012210: 7329 0a0a 2020 2020 2020 2020 2320 7461  s)..        # ta
-00012220: 6b65 2066 6972 7374 2064 6174 6173 6574  ke first dataset
-00012230: 2f66 696c 6520 666f 7220 7265 7472 6965  /file for retrie
-00012240: 7661 6c20 6f66 206c 6f63 6174 696f 6e0a  val of location.
-00012250: 2020 2020 2020 2020 7369 7465 203d 2073          site = s
-00012260: 656c 662e 7369 7465 0a0a 2020 2020 2020  elf.site..      
-00012270: 2020 2320 6173 7369 676e 2072 6f6f 7420    # assign root 
-00012280: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
-00012290: 2020 726f 6f74 203d 2072 6f6f 742e 6173    root = root.as
-000122a0: 7369 676e 280a 2020 2020 2020 2020 2020  sign(.          
-000122b0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-000122c0: 2020 2020 2276 6f6c 756d 655f 6e75 6d62      "volume_numb
-000122d0: 6572 223a 2030 2c0a 2020 2020 2020 2020  er": 0,.        
-000122e0: 2020 2020 2020 2020 2270 6c61 7466 6f72          "platfor
-000122f0: 6d5f 7479 7065 223a 2073 7472 2822 6669  m_type": str("fi
-00012300: 7865 6422 292c 0a20 2020 2020 2020 2020  xed"),.         
-00012310: 2020 2020 2020 2022 696e 7374 7275 6d65         "instrume
-00012320: 6e74 5f74 7970 6522 3a20 2272 6164 6172  nt_type": "radar
-00012330: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00012340: 2020 2022 7072 696d 6172 795f 6178 6973     "primary_axis
-00012350: 223a 2022 6178 6973 5f7a 222c 0a20 2020  ": "axis_z",.   
-00012360: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
-00012370: 6d65 5f63 6f76 6572 6167 655f 7374 6172  me_coverage_star
-00012380: 7422 3a20 7469 6d65 5f63 6f76 6572 6167  t": time_coverag
-00012390: 655f 7374 6172 745f 7374 722c 0a20 2020  e_start_str,.   
-000123a0: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
-000123b0: 6d65 5f63 6f76 6572 6167 655f 656e 6422  me_coverage_end"
-000123c0: 3a20 7469 6d65 5f63 6f76 6572 6167 655f  : time_coverage_
-000123d0: 656e 645f 7374 722c 0a20 2020 2020 2020  end_str,.       
-000123e0: 2020 2020 2020 2020 2022 6c61 7469 7475           "latitu
-000123f0: 6465 223a 2073 6974 655b 226c 6174 6974  de": site["latit
-00012400: 7564 6522 5d2e 7661 6c75 6573 2c0a 2020  ude"].values,.  
-00012410: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00012420: 6f6e 6769 7475 6465 223a 2073 6974 655b  ongitude": site[
-00012430: 226c 6f6e 6769 7475 6465 225d 2e76 616c  "longitude"].val
-00012440: 7565 732c 0a20 2020 2020 2020 2020 2020  ues,.           
-00012450: 2020 2020 2022 616c 7469 7475 6465 223a       "altitude":
-00012460: 2073 6974 655b 2261 6c74 6974 7564 6522   site["altitude"
-00012470: 5d2e 7661 6c75 6573 2c0a 2020 2020 2020  ].values,.      
-00012480: 2020 2020 2020 2020 2020 2273 7765 6570            "sweep
-00012490: 5f67 726f 7570 5f6e 616d 6522 3a20 285b  _group_name": ([
-000124a0: 2273 7765 6570 225d 2c20 7377 6565 705f  "sweep"], sweep_
-000124b0: 6772 6f75 705f 6e61 6d65 7329 2c0a 2020  group_names),.  
-000124c0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-000124d0: 7765 6570 5f66 6978 6564 5f61 6e67 6c65  weep_fixed_angle
-000124e0: 223a 2028 5b22 7377 6565 7022 5d2c 2073  ": (["sweep"], s
-000124f0: 7765 6570 5f66 6978 6564 5f61 6e67 6c65  weep_fixed_angle
-00012500: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-00012510: 7d0a 2020 2020 2020 2020 290a 0a20 2020  }.        )..   
-00012520: 2020 2020 2023 2061 7373 6967 6e20 726f       # assign ro
-00012530: 6f74 2061 7474 7269 6275 7465 730a 2020  ot attributes.  
-00012540: 2020 2020 2020 6174 7472 7320 3d20 636f        attrs = co
-00012550: 6c6c 6563 7469 6f6e 732e 4f72 6465 7265  llections.Ordere
-00012560: 6444 6963 7428 290a 2020 2020 2020 2020  dDict().        
-00012570: 6174 7472 732e 7570 6461 7465 280a 2020  attrs.update(.  
-00012580: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00012590: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
-000125a0: 7369 6f6e 223a 2022 4e6f 6e65 222c 0a20  sion": "None",. 
-000125b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000125c0: 7469 746c 6522 3a20 224e 6f6e 6522 2c0a  title": "None",.
-000125d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000125e0: 2269 6e73 7469 7475 7469 6f6e 223a 2022  "institution": "
-000125f0: 4e6f 6e65 222c 0a20 2020 2020 2020 2020  None",.         
-00012600: 2020 2020 2020 2022 7265 6665 7265 6e63         "referenc
-00012610: 6573 223a 2022 4e6f 6e65 222c 0a20 2020  es": "None",.   
-00012620: 2020 2020 2020 2020 2020 2020 2022 736f               "so
-00012630: 7572 6365 223a 2022 4e6f 6e65 222c 0a20  urce": "None",. 
-00012640: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012650: 6869 7374 6f72 7922 3a20 224e 6f6e 6522  history": "None"
-00012660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012670: 2020 2263 6f6d 6d65 6e74 223a 2022 696d    "comment": "im
-00012680: 2f65 7870 6f72 7465 6420 7573 696e 6720  /exported using 
-00012690: 7772 6164 6c69 6222 2c0a 2020 2020 2020  wradlib",.      
-000126a0: 2020 2020 2020 2020 2020 2269 6e73 7472            "instr
-000126b0: 756d 656e 745f 6e61 6d65 223a 2022 4e6f  ument_name": "No
-000126c0: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
-000126d0: 207d 0a20 2020 2020 2020 2029 0a20 2020   }.        ).   
-000126e0: 2020 2020 2061 7474 7273 5b22 7665 7273       attrs["vers
-000126f0: 696f 6e22 5d20 3d20 7365 6c66 2e77 6861  ion"] = self.wha
-00012700: 745b 2276 6572 7369 6f6e 225d 0a20 2020  t["version"].   
-00012710: 2020 2020 2072 6f6f 7420 3d20 726f 6f74       root = root
-00012720: 2e61 7373 6967 6e5f 6174 7472 7328 6174  .assign_attrs(at
-00012730: 7472 7329 0a20 2020 2020 2020 2072 6f6f  trs).        roo
-00012740: 7420 3d20 726f 6f74 2e61 7373 6967 6e5f  t = root.assign_
-00012750: 6174 7472 7328 7365 6c66 2e61 7474 7273  attrs(self.attrs
-00012760: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00012770: 726f 6f74 203d 2072 6f6f 740a 0a20 2020  root = root..   
-00012780: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00012790: 6566 2073 6974 6528 7365 6c66 293a 0a20  ef site(self):. 
-000127a0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000127b0: 2063 6f6f 7264 696e 6174 6573 206f 6620   coordinates of 
-000127c0: 7261 6461 7220 7369 7465 2e22 2222 0a20  radar site.""". 
-000127d0: 2020 2020 2020 2064 7320 3d20 7872 2e44         ds = xr.D
-000127e0: 6174 6173 6574 2863 6f6f 7264 733d 7365  ataset(coords=se
-000127f0: 6c66 2e77 6865 7265 292e 7265 6e61 6d65  lf.where).rename
-00012800: 280a 2020 2020 2020 2020 2020 2020 7b22  (.            {"
-00012810: 6865 6967 6874 223a 2022 616c 7469 7475  height": "altitu
-00012820: 6465 222c 2022 6c6f 6e22 3a20 226c 6f6e  de", "lon": "lon
-00012830: 6769 7475 6465 222c 2022 6c61 7422 3a20  gitude", "lat": 
-00012840: 226c 6174 6974 7564 6522 7d0a 2020 2020  "latitude"}.    
-00012850: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00012860: 7475 726e 2064 730a 0a20 2020 2040 7072  turn ds..    @pr
-00012870: 6f70 6572 7479 0a20 2020 2064 6566 2043  operty.    def C
-00012880: 6f6e 7665 6e74 696f 6e73 2873 656c 6629  onventions(self)
-00012890: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000128a0: 7572 6e20 436f 6e76 656e 7469 6f6e 7320  urn Conventions 
-000128b0: 7374 7269 6e67 2e22 2222 0a20 2020 2020  string.""".     
-000128c0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-000128d0: 2020 2020 636f 6e76 203d 2073 656c 662e      conv = self.
-000128e0: 6e63 6964 2e61 7474 7273 5b22 436f 6e76  ncid.attrs["Conv
-000128f0: 656e 7469 6f6e 7322 5d0a 2020 2020 2020  entions"].      
-00012900: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
-00012910: 723a 0a20 2020 2020 2020 2020 2020 2063  r:.            c
-00012920: 6f6e 7620 3d20 4e6f 6e65 0a20 2020 2020  onv = None.     
-00012930: 2020 2072 6574 7572 6e20 636f 6e76 0a0a     return conv..
-00012940: 2020 2020 6465 6620 746f 5f6f 6469 6d28      def to_odim(
-00012950: 7365 6c66 2c20 6669 6c65 6e61 6d65 2c20  self, filename, 
-00012960: 7469 6d65 7374 6570 3d30 293a 0a20 2020  timestep=0):.   
-00012970: 2020 2020 2022 2222 5361 7665 2076 6f6c       """Save vol
-00012980: 756d 6520 746f 204f 4449 4d5f 4835 2f56  ume to ODIM_H5/V
-00012990: 325f 3220 636f 6d70 6c69 616e 7420 6669  2_2 compliant fi
-000129a0: 6c65 2e0a 0a20 2020 2020 2020 2050 6172  le...        Par
-000129b0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-000129c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000129d0: 2020 2066 696c 656e 616d 6520 3a20 7374     filename : st
-000129e0: 720a 2020 2020 2020 2020 2020 2020 4e61  r.            Na
-000129f0: 6d65 206f 6620 7468 6520 6f75 7470 7574  me of the output
-00012a00: 2066 696c 650a 2020 2020 2020 2020 7469   file.        ti
-00012a10: 6d65 7374 6570 203a 2069 6e74 0a20 2020  mestep : int.   
-00012a20: 2020 2020 2020 2020 2074 696d 6573 7465           timeste
-00012a30: 7020 6f66 2077 616e 7465 6420 766f 6c75  p of wanted volu
-00012a40: 6d65 0a20 2020 2020 2020 2022 2222 0a20  me.        """. 
-00012a50: 2020 2020 2020 2069 6620 7365 6c66 2e72         if self.r
-00012a60: 6f6f 743a 0a20 2020 2020 2020 2020 2020  oot:.           
-00012a70: 2074 6f5f 6f64 696d 2873 656c 662c 2066   to_odim(self, f
-00012a80: 696c 656e 616d 652c 2074 696d 6573 7465  ilename, timeste
-00012a90: 703d 7469 6d65 7374 6570 290a 2020 2020  p=timestep).    
-00012aa0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00012ab0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00012ac0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00012ad0: 2020 2020 2022 5752 4144 4c49 423a 204e       "WRADLIB: N
-00012ae0: 6f20 4f64 696d 4835 2d63 6f6d 706c 6961  o OdimH5-complia
-00012af0: 6e74 2064 6174 6120 7374 7275 6374 7572  nt data structur
-00012b00: 6520 2220 2261 7661 696c 6162 6c65 2e20  e " "available. 
-00012b10: 4e6f 7420 7361 7669 6e67 2e22 2c0a 2020  Not saving.",.  
-00012b20: 2020 2020 2020 2020 2020 2020 2020 5573                Us
-00012b30: 6572 5761 726e 696e 672c 0a20 2020 2020  erWarning,.     
-00012b40: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00012b50: 6620 746f 5f63 6672 6164 6961 6c32 2873  f to_cfradial2(s
-00012b60: 656c 662c 2066 696c 656e 616d 652c 2074  elf, filename, t
-00012b70: 696d 6573 7465 703d 3029 3a0a 2020 2020  imestep=0):.    
-00012b80: 2020 2020 2222 2253 6176 6520 766f 6c75      """Save volu
-00012b90: 6d65 2074 6f20 4366 5261 6469 616c 3220  me to CfRadial2 
-00012ba0: 636f 6d70 6c69 616e 7420 6669 6c65 2e0a  compliant file..
-00012bb0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00012bc0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00012bd0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-00012be0: 696c 656e 616d 6520 3a20 7374 720a 2020  ilename : str.  
-00012bf0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
-00012c00: 6620 7468 6520 6f75 7470 7574 2066 696c  f the output fil
-00012c10: 650a 2020 2020 2020 2020 7469 6d65 7374  e.        timest
-00012c20: 6570 203a 2069 6e74 0a20 2020 2020 2020  ep : int.       
-00012c30: 2020 2020 2074 696d 6573 7465 7020 7761       timestep wa
-00012c40: 6e74 6564 2076 6f6c 756d 650a 2020 2020  nted volume.    
-00012c50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00012c60: 6966 2073 656c 662e 726f 6f74 3a0a 2020  if self.root:.  
-00012c70: 2020 2020 2020 2020 2020 746f 5f63 6672            to_cfr
-00012c80: 6164 6961 6c32 2873 656c 662c 2066 696c  adial2(self, fil
-00012c90: 656e 616d 652c 2074 696d 6573 7465 703d  ename, timestep=
-00012ca0: 7469 6d65 7374 6570 290a 2020 2020 2020  timestep).      
-00012cb0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00012cc0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00012cd0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00012ce0: 2020 2022 5752 4144 4c49 423a 204e 6f20     "WRADLIB: No 
-00012cf0: 4366 5261 6469 616c 322d 636f 6d70 6c69  CfRadial2-compli
-00012d00: 616e 7420 6461 7461 2073 7472 7563 7475  ant data structu
-00012d10: 7265 2022 0a20 2020 2020 2020 2020 2020  re ".           
-00012d20: 2020 2020 2022 6176 6169 6c61 626c 652e       "available.
-00012d30: 204e 6f74 2073 6176 696e 672e 222c 0a20   Not saving.",. 
-00012d40: 2020 2020 2020 2020 2020 2020 2020 2055                 U
-00012d50: 7365 7257 6172 6e69 6e67 2c0a 2020 2020  serWarning,.    
-00012d60: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00012d70: 6566 2074 6f5f 6e65 7463 6466 2873 656c  ef to_netcdf(sel
-00012d80: 662c 2066 696c 656e 616d 652c 2074 696d  f, filename, tim
-00012d90: 6573 7465 703d 4e6f 6e65 2c20 6b65 7973  estep=None, keys
-00012da0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00012db0: 2222 2253 6176 6520 766f 6c75 6d65 2074  """Save volume t
-00012dc0: 6f20 6e65 7463 6466 2063 6f6d 706c 6961  o netcdf complia
-00012dd0: 6e74 2066 696c 652e 0a0a 2020 2020 2020  nt file...      
-00012de0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00012df0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00012e00: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-00012e10: 203a 2073 7472 0a20 2020 2020 2020 2020   : str.         
-00012e20: 2020 204e 616d 6520 6f66 2074 6865 206f     Name of the o
-00012e30: 7574 7075 7420 6669 6c65 0a20 2020 2020  utput file.     
-00012e40: 2020 2074 696d 6573 7465 7020 3a20 696e     timestep : in
-00012e50: 742c 2073 6c69 6365 0a20 2020 2020 2020  t, slice.       
-00012e60: 2020 2020 2074 696d 6573 7465 702f 736c       timestep/sl
-00012e70: 6963 6520 6f66 2077 616e 7465 6420 766f  ice of wanted vo
-00012e80: 6c75 6d65 0a20 2020 2020 2020 206b 6579  lume.        key
-00012e90: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
-00012ea0: 2020 2020 206c 6973 7420 6f66 2073 7765       list of swe
-00012eb0: 6570 5f67 726f 7570 5f6e 616d 6573 2077  ep_group_names w
-00012ec0: 6869 6368 2073 686f 756c 6420 6265 2077  hich should be w
-00012ed0: 7269 7474 656e 2074 6f20 7468 6520 6669  ritten to the fi
-00012ee0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
-00012ef0: 2020 2020 2020 2069 6620 7365 6c66 2e72         if self.r
-00012f00: 6f6f 743a 0a20 2020 2020 2020 2020 2020  oot:.           
-00012f10: 2074 6f5f 6e65 7463 6466 2873 656c 662c   to_netcdf(self,
-00012f20: 2066 696c 656e 616d 652c 206b 6579 733d   filename, keys=
-00012f30: 6b65 7973 2c20 7469 6d65 7374 6570 3d74  keys, timestep=t
-00012f40: 696d 6573 7465 7029 0a20 2020 2020 2020  imestep).       
-00012f50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00012f60: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00012f70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00012f80: 2020 2257 5241 444c 4942 3a20 4e6f 206e    "WRADLIB: No n
-00012f90: 6574 6364 662d 636f 6d70 6c69 616e 7420  etcdf-compliant 
-00012fa0: 6461 7461 2073 7472 7563 7475 7265 2022  data structure "
-00012fb0: 2022 6176 6169 6c61 626c 652e 204e 6f74   "available. Not
-00012fc0: 2073 6176 696e 672e 222c 0a20 2020 2020   saving.",.     
-00012fd0: 2020 2020 2020 2020 2020 2055 7365 7257             UserW
-00012fe0: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00012ff0: 2020 2020 290a 0a0a 6465 6620 636f 6c6c      )...def coll
-00013000: 6563 745f 6279 5f74 696d 6528 6f62 6a29  ect_by_time(obj)
-00013010: 3a0a 2020 2020 2222 2243 6f6c 6c65 6374  :.    """Collect
-00013020: 2058 5261 6453 7765 6570 206f 626a 6563   XRadSweep objec
-00013030: 7473 2068 6176 696e 6720 7361 6d65 2074  ts having same t
-00013040: 696d 650a 0a20 2020 2050 6172 616d 6574  ime..    Paramet
-00013050: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00013060: 2d2d 0a20 2020 206f 626a 203a 206c 6973  --.    obj : lis
-00013070: 740a 2020 2020 2020 2020 6c69 7374 206f  t.        list o
-00013080: 6620 5852 6164 5377 6565 7020 6f62 6a65  f XRadSweep obje
-00013090: 6374 730a 0a20 2020 2052 6574 7572 6e73  cts..    Returns
-000130a0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-000130b0: 206f 7574 203a 2058 5261 6454 696d 6553   out : XRadTimeS
-000130c0: 6572 6965 730a 2020 2020 2020 2020 7772  eries.        wr
-000130d0: 6170 7065 7220 6172 6f75 6e64 206c 6973  apper around lis
-000130e0: 7420 6f66 2058 5261 6453 7765 6570 206f  t of XRadSweep o
-000130f0: 626a 6563 7473 0a20 2020 2022 2222 0a20  bjects.    """. 
-00013100: 2020 206f 7574 203d 2058 5261 6454 696d     out = XRadTim
-00013110: 6553 6572 6965 7328 290a 2020 2020 6966  eSeries().    if
-00013120: 2069 7369 6e73 7461 6e63 6528 6f62 6a2c   isinstance(obj,
-00013130: 2058 5261 6453 7765 6570 293a 0a20 2020   XRadSweep):.   
-00013140: 2020 2020 206f 626a 203d 205b 6f62 6a5d       obj = [obj]
-00013150: 0a20 2020 2074 696d 6573 203d 205b 6473  .    times = [ds
-00013160: 2e5f 6765 745f 7469 6d65 5f66 6173 7428  ._get_time_fast(
-00013170: 2920 666f 7220 6473 2069 6e20 6f62 6a5d  ) for ds in obj]
-00013180: 0a20 2020 2075 6e69 7175 655f 7469 6d65  .    unique_time
-00013190: 7320 3d20 6e70 2e61 7272 6179 2873 6f72  s = np.array(sor
-000131a0: 7465 6428 6c69 7374 2873 6574 2874 696d  ted(list(set(tim
-000131b0: 6573 2929 2929 0a20 2020 2069 6620 6c65  es)))).    if le
-000131c0: 6e28 756e 6971 7565 5f74 696d 6573 2920  n(unique_times) 
-000131d0: 3d3d 206c 656e 286f 626a 293a 0a20 2020  == len(obj):.   
-000131e0: 2020 2020 206f 7574 2e65 7874 656e 6428       out.extend(
-000131f0: 6f62 6a29 0a20 2020 2020 2020 206f 7574  obj).        out
-00013200: 2e73 6f72 7428 6b65 793d 6c61 6d62 6461  .sort(key=lambda
-00013210: 2078 3a20 782e 5f67 6574 5f74 696d 655f   x: x._get_time_
-00013220: 6661 7374 2829 290a 2020 2020 656c 7365  fast()).    else
-00013230: 3a0a 2020 2020 2020 2020 2320 7275 6e73  :.        # runs
-00013240: 206f 6e6c 7920 6966 2073 6576 6572 616c   only if several
-00013250: 2066 696c 6573 2066 6f72 2074 6865 2073   files for the s
-00013260: 616d 6520 7469 6d65 7374 6570 2061 7265  ame timestep are
-00013270: 2061 7661 696c 6162 6c65 0a20 2020 2020   available.     
-00013280: 2020 2023 2065 6720 4457 4427 7320 6f6e     # eg DWD's on
-00013290: 6520 7377 6565 7020 6f6e 6520 6d6f 6d65  e sweep one mome
-000132a0: 6e74 2066 696c 6573 0a20 2020 2020 2020  nt files.       
-000132b0: 2066 6f72 2074 2069 6e20 756e 6971 7565   for t in unique
-000132c0: 5f74 696d 6573 3a0a 2020 2020 2020 2020  _times:.        
-000132d0: 2020 2020 6964 7820 3d20 6e70 2e61 7267      idx = np.arg
-000132e0: 7768 6572 6528 7469 6d65 7320 3d3d 2074  where(times == t
-000132f0: 292e 666c 6174 7465 6e28 290a 2020 2020  ).flatten().    
-00013300: 2020 2020 2020 2020 6f75 7431 203d 206f          out1 = o
-00013310: 626a 5b69 6478 5b30 5d5d 0a20 2020 2020  bj[idx[0]].     
-00013320: 2020 2020 2020 205b 6f75 7431 2e65 7874         [out1.ext
-00013330: 656e 6428 6f62 6a5b 695d 2920 666f 7220  end(obj[i]) for 
-00013340: 6920 696e 2069 6478 5b31 3a5d 5d0a 2020  i in idx[1:]].  
-00013350: 2020 2020 2020 2020 2020 6f75 742e 6170            out.ap
-00013360: 7065 6e64 286f 7574 3129 0a20 2020 2072  pend(out1).    r
-00013370: 6574 7572 6e20 6f75 740a 0a0a 6465 6620  eturn out...def 
-00013380: 636f 6c6c 6563 745f 6279 5f61 6e67 6c65  collect_by_angle
-00013390: 286f 626a 293a 0a20 2020 2022 2222 436f  (obj):.    """Co
-000133a0: 6c6c 6563 7420 5852 6164 5377 6565 7020  llect XRadSweep 
-000133b0: 6f62 6a65 6374 7320 6861 7669 6e67 2073  objects having s
-000133c0: 616d 6520 616e 676c 650a 0a20 2020 2050  ame angle..    P
-000133d0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000133e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206f 626a  --------.    obj
-000133f0: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
-00013400: 6c69 7374 206f 6620 5852 6164 5377 6565  list of XRadSwee
-00013410: 7020 6f62 6a65 6374 730a 0a20 2020 2052  p objects..    R
-00013420: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00013430: 2d2d 0a20 2020 206f 7574 203a 2058 5261  --.    out : XRa
-00013440: 6456 6f6c 756d 650a 2020 2020 2020 2020  dVolume.        
-00013450: 7772 6170 7065 7220 6172 6f75 6e64 206e  wrapper around n
-00013460: 6573 7465 6420 6c69 7374 206f 6620 5852  ested list of XR
-00013470: 6164 5377 6565 7020 6f62 6a65 6374 730a  adSweep objects.
-00013480: 2020 2020 2222 220a 2020 2020 6f75 7420      """.    out 
-00013490: 3d20 5852 6164 566f 6c75 6d65 2829 0a20  = XRadVolume(). 
-000134a0: 2020 2061 6e67 6c65 7320 3d20 5b64 732e     angles = [ds.
-000134b0: 6669 7865 645f 616e 676c 6520 666f 7220  fixed_angle for 
-000134c0: 6473 2069 6e20 6f62 6a5d 0a20 2020 2075  ds in obj].    u
-000134d0: 6e69 7175 655f 616e 676c 6573 203d 206c  nique_angles = l
-000134e0: 6973 7428 7365 7428 616e 676c 6573 2929  ist(set(angles))
-000134f0: 0a20 2020 2069 6620 6c65 6e28 756e 6971  .    if len(uniq
-00013500: 7565 5f61 6e67 6c65 7329 203d 3d20 6c65  ue_angles) == le
-00013510: 6e28 6f62 6a29 3a0a 2020 2020 2020 2020  n(obj):.        
-00013520: 6f75 742e 6578 7465 6e64 286f 626a 290a  out.extend(obj).
-00013530: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00013540: 2020 666f 7220 6120 696e 2075 6e69 7175    for a in uniqu
-00013550: 655f 616e 676c 6573 3a0a 2020 2020 2020  e_angles:.      
-00013560: 2020 2020 2020 6964 7820 3d20 6e70 2e61        idx = np.a
-00013570: 7267 7768 6572 6528 616e 676c 6573 203d  rgwhere(angles =
-00013580: 3d20 6129 2e66 6c61 7474 656e 2829 0a20  = a).flatten(). 
-00013590: 2020 2020 2020 2020 2020 206d 6572 6765             merge
-000135a0: 5f6c 6973 7420 3d20 5b6f 626a 5b69 5d20  _list = [obj[i] 
-000135b0: 666f 7220 6920 696e 2069 6478 5d0a 2020  for i in idx].  
-000135c0: 2020 2020 2020 2020 2020 6f75 742e 6170            out.ap
-000135d0: 7065 6e64 286d 6572 6765 5f6c 6973 7429  pend(merge_list)
-000135e0: 0a20 2020 2072 6574 7572 6e20 6f75 740a  .    return out.
-000135f0: 0a0a 6465 6620 5f6f 7065 6e5f 6f64 696d  ..def _open_odim
-00013600: 5f73 7765 6570 2866 696c 656e 616d 652c  _sweep(filename,
-00013610: 206c 6f61 6465 722c 202a 2a6b 7761 7267   loader, **kwarg
-00013620: 7329 3a0a 2020 2020 2222 2252 6574 7572  s):.    """Retur
-00013630: 6e73 206c 6973 7420 6f66 2058 5261 6453  ns list of XRadS
-00013640: 7765 6570 206f 626a 6563 7473 0a0a 2020  weep objects..  
-00013650: 2020 4576 6572 7920 7377 6565 7020 7769    Every sweep wi
-00013660: 6c6c 2062 6520 7075 7420 696e 746f 2069  ll be put into i
-00013670: 7427 7320 6f77 6e20 636c 6173 7320 696e  t's own class in
-00013680: 7374 616e 6365 2e0a 2020 2020 2222 220a  stance..    """.
-00013690: 2020 2020 6c64 5f6b 7761 7267 7320 3d20      ld_kwargs = 
-000136a0: 6b77 6172 6773 2e67 6574 2822 6c64 5f6b  kwargs.get("ld_k
-000136b0: 7761 7267 7322 2c20 7b7d 290a 2020 2020  wargs", {}).    
-000136c0: 6966 206c 6f61 6465 7220 3d3d 2022 6e65  if loader == "ne
-000136d0: 7463 6466 3422 3a0a 2020 2020 2020 2020  tcdf4":.        
-000136e0: 6f70 656e 6572 203d 206e 632e 4461 7461  opener = nc.Data
-000136f0: 7365 740a 2020 2020 2020 2020 6174 7472  set.        attr
-00013700: 203d 2022 6772 6f75 7073 220a 2020 2020   = "groups".    
-00013710: 656c 6966 206c 6f61 6465 7220 3d3d 2022  elif loader == "
-00013720: 6835 6e65 7463 6466 223a 0a20 2020 2020  h5netcdf":.     
-00013730: 2020 206f 7065 6e65 7220 3d20 6835 6e65     opener = h5ne
-00013740: 7463 6466 2e46 696c 650a 2020 2020 2020  tcdf.File.      
-00013750: 2020 6174 7472 203d 2022 6b65 7973 220a    attr = "keys".
-00013760: 2020 2020 2020 2020 6c64 5f6b 7761 7267          ld_kwarg
-00013770: 735b 2270 686f 6e79 5f64 696d 7322 5d20  s["phony_dims"] 
-00013780: 3d20 2261 6363 6573 7322 0a20 2020 2065  = "access".    e
-00013790: 6c73 653a 0a20 2020 2020 2020 206f 7065  lse:.        ope
-000137a0: 6e65 7220 3d20 6835 7079 2e46 696c 650a  ner = h5py.File.
-000137b0: 2020 2020 2020 2020 6174 7472 203d 2022          attr = "
-000137c0: 6b65 7973 220a 0a20 2020 2064 7364 6573  keys"..    dsdes
-000137d0: 6320 3d20 2264 6174 6173 6574 220a 2020  c = "dataset".  
-000137e0: 2020 7377 6565 705f 636c 7320 3d20 5852    sweep_cls = XR
-000137f0: 6164 5377 6565 704f 6469 6d0a 2020 2020  adSweepOdim.    
-00013800: 6966 2022 4741 4d49 4322 2069 6e20 6b77  if "GAMIC" in kw
-00013810: 6172 6773 2e67 6574 2822 666c 6176 6f75  args.get("flavou
-00013820: 7222 2c20 224f 4449 4d22 293a 0a20 2020  r", "ODIM"):.   
-00013830: 2020 2020 2069 6620 6c6f 6164 6572 203d       if loader =
-00013840: 3d20 226e 6574 6364 6634 223a 0a20 2020  = "netcdf4":.   
-00013850: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00013860: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00013870: 2020 2020 2020 2020 2020 2022 7772 6164             "wrad
-00013880: 6c69 623a 2047 414d 4943 2066 696c 6573  lib: GAMIC files
-00013890: 2063 616e 2774 2062 6520 7265 6164 2075   can't be read u
-000138a0: 7369 6e67 206e 6574 6364 6634 220a 2020  sing netcdf4".  
-000138b0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-000138c0: 6c6f 6164 6572 2e20 5573 6520 6569 7468  loader. Use eith
-000138d0: 6572 2027 6835 7079 2720 6f72 2027 6835  er 'h5py' or 'h5
-000138e0: 6e65 7463 6466 2e22 0a20 2020 2020 2020  netcdf.".       
-000138f0: 2020 2020 2029 0a20 2020 2020 2020 2064       ).        d
-00013900: 7364 6573 6320 3d20 2273 6361 6e22 0a20  sdesc = "scan". 
-00013910: 2020 2020 2020 2073 7765 6570 5f63 6c73         sweep_cls
-00013920: 203d 2058 5261 6453 7765 6570 4761 6d69   = XRadSweepGami
-00013930: 630a 0a20 2020 2023 206f 7065 6e20 6669  c..    # open fi
-00013940: 6c65 0a20 2020 2069 6620 6e6f 7420 6973  le.    if not is
-00013950: 696e 7374 616e 6365 2866 696c 656e 616d  instance(filenam
-00013960: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
-00013970: 2069 6620 6f70 656e 6572 203d 3d20 6835   if opener == h5
-00013980: 7079 2e46 696c 653a 0a20 2020 2020 2020  py.File:.       
-00013990: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000139a0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000139b0: 2020 2020 2020 2022 7772 6164 6c69 623a         "wradlib:
-000139c0: 2066 696c 652d 6c69 6b65 206f 626a 6563   file-like objec
-000139d0: 7473 2063 616e 2774 2062 6520 7265 6164  ts can't be read
-000139e0: 2075 7369 6e67 2068 3570 7920 220a 2020   using h5py ".  
-000139f0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00013a00: 6f61 6465 722e 2055 7365 2065 6974 6865  oader. Use eithe
-00013a10: 7220 276e 6574 6364 6634 2720 6f72 2027  r 'netcdf4' or '
-00013a20: 6835 6e65 7463 6466 272e 220a 2020 2020  h5netcdf'.".    
-00013a30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00013a40: 2020 6966 206f 7065 6e65 7220 3d3d 206e    if opener == n
-00013a50: 632e 4461 7461 7365 743a 0a20 2020 2020  c.Dataset:.     
-00013a60: 2020 2020 2020 2068 616e 646c 6520 3d20         handle = 
-00013a70: 6f70 656e 6572 280a 2020 2020 2020 2020  opener(.        
-00013a80: 2020 2020 2020 2020 6622 7b73 7472 2866          f"{str(f
-00013a90: 696c 656e 616d 6529 7d22 2c20 6d6f 6465  ilename)}", mode
-00013aa0: 3d22 7222 2c20 6d65 6d6f 7279 3d66 696c  ="r", memory=fil
-00013ab0: 656e 616d 652e 7265 6164 2829 2c20 2a2a  ename.read(), **
-00013ac0: 6c64 5f6b 7761 7267 730a 2020 2020 2020  ld_kwargs.      
-00013ad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013ae0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00013af0: 2020 6861 6e64 6c65 203d 206f 7065 6e65    handle = opene
-00013b00: 7228 6669 6c65 6e61 6d65 2c20 2272 222c  r(filename, "r",
-00013b10: 202a 2a6c 645f 6b77 6172 6773 290a 2020   **ld_kwargs).  
-00013b20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00013b30: 6861 6e64 6c65 203d 206f 7065 6e65 7228  handle = opener(
-00013b40: 6669 6c65 6e61 6d65 2c20 2272 222c 202a  filename, "r", *
-00013b50: 2a6c 645f 6b77 6172 6773 290a 0a20 2020  *ld_kwargs)..   
-00013b60: 2023 2067 6574 2067 726f 7570 206e 616d   # get group nam
-00013b70: 6573 0a20 2020 2066 6174 7472 203d 2067  es.    fattr = g
-00013b80: 6574 6174 7472 2868 616e 646c 652c 2061  etattr(handle, a
-00013b90: 7474 7229 0a20 2020 2069 6620 6361 6c6c  ttr).    if call
-00013ba0: 6162 6c65 2866 6174 7472 293a 0a20 2020  able(fattr):.   
-00013bb0: 2020 2020 2067 726f 7570 7320 3d20 6c69       groups = li
-00013bc0: 7374 2866 6174 7472 2829 290a 2020 2020  st(fattr()).    
-00013bd0: 656c 7365 3a0a 2020 2020 2020 2020 6772  else:.        gr
-00013be0: 6f75 7073 203d 206c 6973 7428 6661 7474  oups = list(fatt
-00013bf0: 7229 0a0a 2020 2020 2320 6974 6572 6174  r)..    # iterat
-00013c00: 6520 6f76 6572 2073 696e 676c 6520 7377  e over single sw
-00013c10: 6565 7073 0a20 2020 2023 2074 6f64 6f3a  eeps.    # todo:
-00013c20: 2069 6620 736f 7274 696e 6720 646f 6573   if sorting does
-00013c30: 206e 6f74 206d 6174 7465 722c 2077 6520   not matter, we 
-00013c40: 6361 6e20 736b 6970 2074 6869 730a 2020  can skip this.  
-00013c50: 2020 7377 6565 7073 203d 205b 6b20 666f    sweeps = [k fo
-00013c60: 7220 6b20 696e 2067 726f 7570 7320 6966  r k in groups if
-00013c70: 2064 7364 6573 6320 696e 206b 5d0a 2020   dsdesc in k].  
-00013c80: 2020 7377 6565 7073 5f69 6478 203d 206e    sweeps_idx = n
-00013c90: 702e 6172 6773 6f72 7428 5b69 6e74 2873  p.argsort([int(s
-00013ca0: 5b6c 656e 2864 7364 6573 6329 203a 5d29  [len(dsdesc) :])
-00013cb0: 2066 6f72 2073 2069 6e20 7377 6565 7073   for s in sweeps
-00013cc0: 5d29 0a20 2020 2073 7765 6570 7320 3d20  ]).    sweeps = 
-00013cd0: 6e70 2e61 7272 6179 2873 7765 6570 7329  np.array(sweeps)
-00013ce0: 5b73 7765 6570 735f 6964 785d 2e74 6f6c  [sweeps_idx].tol
-00013cf0: 6973 7428 290a 2020 2020 7265 7475 726e  ist().    return
-00013d00: 205b 7377 6565 705f 636c 7328 6861 6e64   [sweep_cls(hand
-00013d10: 6c65 2c20 6b2c 202a 2a6b 7761 7267 7329  le, k, **kwargs)
-00013d20: 2066 6f72 206b 2069 6e20 7377 6565 7073   for k in sweeps
-00013d30: 5d0a 0a0a 6465 6620 6f70 656e 5f6f 6469  ]...def open_odi
-00013d40: 6d28 7061 7468 732c 206c 6f61 6465 723d  m(paths, loader=
-00013d50: 226e 6574 6364 6634 222c 202a 2a6b 7761  "netcdf4", **kwa
-00013d60: 7267 7329 3a0a 2020 2020 2222 224f 7065  rgs):.    """Ope
-00013d70: 6e20 6d75 6c74 6970 6c65 204f 4449 4d20  n multiple ODIM 
-00013d80: 6669 6c65 7320 6173 2061 2058 5261 6456  files as a XRadV
-00013d90: 6f6c 756d 6520 7374 7275 6374 7572 652e  olume structure.
-00013da0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00013db0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00013dc0: 2020 2020 7061 7468 7320 3a20 7374 7220      paths : str 
-00013dd0: 6f72 2073 6571 7565 6e63 650a 2020 2020  or sequence.    
-00013de0: 2020 2020 4569 7468 6572 2061 2066 696c      Either a fil
-00013df0: 656e 616d 6520 6f72 2073 7472 696e 6720  ename or string 
-00013e00: 676c 6f62 2069 6e20 7468 6520 666f 726d  glob in the form
-00013e10: 2060 2770 6174 682f 746f 2f6d 792f 6669   `'path/to/my/fi
-00013e20: 6c65 732f 2a2e 6835 2760 0a20 2020 2020  les/*.h5'`.     
-00013e30: 2020 206f 7220 616e 2065 7870 6c69 6369     or an explici
-00013e40: 7420 6c69 7374 206f 6620 6669 6c65 7320  t list of files 
-00013e50: 746f 206f 7065 6e2e 0a0a 2020 2020 6c6f  to open...    lo
-00013e60: 6164 6572 203a 207b 276e 6574 6364 6634  ader : {'netcdf4
-00013e70: 272c 2027 6835 7079 272c 2027 6835 6e65  ', 'h5py', 'h5ne
-00013e80: 7463 6466 277d 0a20 2020 2020 2020 204c  tcdf'}.        L
-00013e90: 6f61 6465 7220 7573 6564 2066 6f72 2061  oader used for a
-00013ea0: 6363 6573 7369 6e67 2066 696c 6520 6d65  ccessing file me
-00013eb0: 7461 6461 7461 2c20 6465 6661 756c 7473  tadata, defaults
-00013ec0: 2074 6f20 276e 6574 6364 6634 272e 0a0a   to 'netcdf4'...
-00013ed0: 2020 2020 6b77 6172 6773 203a 206f 7074      kwargs : opt
-00013ee0: 696f 6e61 6c0a 2020 2020 2020 2020 4164  ional.        Ad
-00013ef0: 6469 7469 6f6e 616c 2061 7267 756d 656e  ditional argumen
-00013f00: 7473 2070 6173 7365 6420 6f6e 2074 6f20  ts passed on to 
-00013f10: 3a70 793a 636c 6173 733a 6077 7261 646c  :py:class:`wradl
-00013f20: 6962 2e69 6f2e 5852 6164 5377 6565 7060  ib.io.XRadSweep`
-00013f30: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-00013f40: 2028 6c6f 6164 6572 203d 3d20 2268 356e   (loader == "h5n
-00013f50: 6574 6364 6622 2920 2620 280a 2020 2020  etcdf") & (.    
-00013f60: 2020 2020 4c6f 6f73 6556 6572 7369 6f6e      LooseVersion
-00013f70: 2868 356e 6574 6364 662e 5f5f 7665 7273  (h5netcdf.__vers
-00013f80: 696f 6e5f 5f29 203c 204c 6f6f 7365 5665  ion__) < LooseVe
-00013f90: 7273 696f 6e28 2230 2e38 2e30 2229 0a20  rsion("0.8.0"). 
-00013fa0: 2020 2029 3a0a 2020 2020 2020 2020 7761     ):.        wa
-00013fb0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-00013fc0: 2020 2020 2020 2020 2066 2257 5241 444c           f"WRADL
-00013fd0: 4942 3a20 2768 356e 6574 6364 663e 3d30  IB: 'h5netcdf>=0
-00013fe0: 2e38 2e30 2720 6e65 6564 6564 2074 6f20  .8.0' needed to 
-00013ff0: 7065 7266 6f72 6d20 7468 6973 2022 0a20  perform this ". 
-00014000: 2020 2020 2020 2020 2020 2066 226f 7065             f"ope
-00014010: 7261 7469 6f6e 2e20 2768 356e 6574 6364  ration. 'h5netcd
-00014020: 663d 7b68 356e 6574 6364 662e 5f5f 7665  f={h5netcdf.__ve
-00014030: 7273 696f 6e5f 5f7d 2022 0a20 2020 2020  rsion__} ".     
-00014040: 2020 2020 2020 2066 2261 7661 696c 6162         f"availab
-00014050: 6c65 2e22 2c0a 2020 2020 2020 2020 2020  le.",.          
-00014060: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
-00014070: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
-00014080: 2069 7369 6e73 7461 6e63 6528 7061 7468   isinstance(path
-00014090: 732c 2073 7472 293a 0a20 2020 2020 2020  s, str):.       
-000140a0: 2070 6174 6873 203d 2067 6c6f 622e 676c   paths = glob.gl
-000140b0: 6f62 2870 6174 6873 290a 2020 2020 656c  ob(paths).    el
-000140c0: 7365 3a0a 2020 2020 2020 2020 7061 7468  se:.        path
-000140d0: 7320 3d20 6e70 2e61 7272 6179 2870 6174  s = np.array(pat
-000140e0: 6873 292e 666c 6174 7465 6e28 292e 746f  hs).flatten().to
-000140f0: 6c69 7374 2829 0a0a 2020 2020 6966 206c  list()..    if l
-00014100: 6f61 6465 7220 6e6f 7420 696e 205b 226e  oader not in ["n
-00014110: 6574 6364 6634 222c 2022 6835 6e65 7463  etcdf4", "h5netc
-00014120: 6466 222c 2022 6835 7079 225d 3a0a 2020  df", "h5py"]:.  
-00014130: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00014140: 6545 7272 6f72 2822 7772 6164 6c69 623a  eError("wradlib:
-00014150: 2055 6e6b 6e6f 776e 206c 6f61 6465 723a   Unknown loader:
-00014160: 207b 7d22 2e66 6f72 6d61 7428 6c6f 6164   {}".format(load
-00014170: 6572 2929 0a0a 2020 2020 7377 6565 7073  er))..    sweeps
-00014180: 203d 205b 5d0a 2020 2020 5b0a 2020 2020   = [].    [.    
-00014190: 2020 2020 7377 6565 7073 2e65 7874 656e      sweeps.exten
-000141a0: 6428 5f6f 7065 6e5f 6f64 696d 5f73 7765  d(_open_odim_swe
-000141b0: 6570 2866 2c20 6c6f 6164 6572 2c20 2a2a  ep(f, loader, **
-000141c0: 6b77 6172 6773 2929 0a20 2020 2020 2020  kwargs)).       
-000141d0: 2066 6f72 2066 2069 6e20 7471 646d 2870   for f in tqdm(p
-000141e0: 6174 6873 2c20 6465 7363 3d22 4f70 656e  aths, desc="Open
-000141f0: 222c 2075 6e69 743d 2220 4669 6c65 7322  ", unit=" Files"
-00014200: 2c20 6c65 6176 653d 4e6f 6e65 290a 2020  , leave=None).  
-00014210: 2020 5d0a 2020 2020 616e 676c 6573 203d    ].    angles =
-00014220: 2063 6f6c 6c65 6374 5f62 795f 616e 676c   collect_by_angl
-00014230: 6528 7377 6565 7073 290a 2020 2020 666f  e(sweeps).    fo
-00014240: 7220 6920 696e 2074 7164 6d28 7261 6e67  r i in tqdm(rang
-00014250: 6528 6c65 6e28 616e 676c 6573 2929 2c20  e(len(angles)), 
-00014260: 6465 7363 3d22 436f 6c6c 6563 7469 6e67  desc="Collecting
-00014270: 222c 2075 6e69 743d 2220 416e 676c 6573  ", unit=" Angles
-00014280: 222c 206c 6561 7665 3d4e 6f6e 6529 3a0a  ", leave=None):.
-00014290: 2020 2020 2020 2020 616e 676c 6573 5b69          angles[i
-000142a0: 5d20 3d20 636f 6c6c 6563 745f 6279 5f74  ] = collect_by_t
-000142b0: 696d 6528 616e 676c 6573 5b69 5d29 0a20  ime(angles[i]). 
-000142c0: 2020 2061 6e67 6c65 732e 736f 7274 286b     angles.sort(k
-000142d0: 6579 3d6c 616d 6264 6120 783a 2078 5b30  ey=lambda x: x[0
-000142e0: 5d2e 7469 6d65 290a 2020 2020 666f 7220  ].time).    for 
-000142f0: 6620 696e 2061 6e67 6c65 733a 0a20 2020  f in angles:.   
-00014300: 2020 2020 2066 2e5f 7061 7265 6e74 203d       f._parent =
-00014310: 2061 6e67 6c65 730a 2020 2020 616e 676c   angles.    angl
-00014320: 6573 2e5f 6e63 6669 6c65 203d 2061 6e67  es._ncfile = ang
-00014330: 6c65 735b 305d 2e6e 6366 696c 650a 2020  les[0].ncfile.  
-00014340: 2020 616e 676c 6573 2e5f 6e63 7061 7468    angles._ncpath
-00014350: 203d 2022 2f22 0a20 2020 2072 6574 7572   = "/".    retur
-00014360: 6e20 616e 676c 6573 0a0a 0a63 6c61 7373  n angles...class
-00014370: 2058 5261 6456 6f6c 4669 6c65 286f 626a   XRadVolFile(obj
-00014380: 6563 7429 3a0a 2020 2020 2222 2242 6173  ect):.    """Bas
-00014390: 6543 6c61 7373 2066 6f72 2068 6f6c 6469  eClass for holdi
-000143a0: 6e67 206e 6574 4344 4634 2e44 6174 6173  ng netCDF4.Datas
-000143b0: 6574 2068 616e 646c 6573 2222 220a 0a20  et handles""".. 
-000143c0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-000143d0: 7365 6c66 2c20 6669 6c65 6e61 6d65 3d4e  self, filename=N
-000143e0: 6f6e 652c 2066 6c61 766f 7572 3d4e 6f6e  one, flavour=Non
-000143f0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-00014400: 2020 2020 2020 7365 6c66 2e5f 6669 6c65        self._file
-00014410: 6e61 6d65 203d 2066 696c 656e 616d 650a  name = filename.
-00014420: 2020 2020 2020 2020 7365 6c66 2e5f 6e63          self._nc
-00014430: 6820 3d20 4e6f 6e65 0a20 2020 2020 2020  h = None.       
-00014440: 2073 656c 662e 5f66 6c61 766f 7572 203d   self._flavour =
-00014450: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00014460: 6c66 2e5f 6e63 682c 2073 656c 662e 5f66  lf._nch, self._f
-00014470: 6c61 766f 7572 203d 2073 656c 662e 5f63  lavour = self._c
-00014480: 6865 636b 5f66 696c 6528 6669 6c65 6e61  heck_file(filena
-00014490: 6d65 2c20 666c 6176 6f75 7229 0a0a 2020  me, flavour)..  
-000144a0: 2020 6465 6620 5f63 6865 636b 5f66 696c    def _check_fil
-000144b0: 6528 7365 6c66 2c20 6669 6c65 6e61 6d65  e(self, filename
-000144c0: 2c20 666c 6176 6f75 7229 3a0a 2020 2020  , flavour):.    
-000144d0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-000144e0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
-000144f0: 2020 2064 6566 205f 5f64 656c 5f5f 2873     def __del__(s
-00014500: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-00014510: 2073 656c 662e 5f6e 6368 2069 7320 6e6f   self._nch is no
-00014520: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00014530: 2020 2020 7365 6c66 2e5f 6e63 682e 636c      self._nch.cl
-00014540: 6f73 6528 290a 0a20 2020 2040 7072 6f70  ose()..    @prop
-00014550: 6572 7479 0a20 2020 2064 6566 2066 696c  erty.    def fil
-00014560: 656e 616d 6528 7365 6c66 293a 0a20 2020  ename(self):.   
-00014570: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00014580: 2e5f 6669 6c65 6e61 6d65 0a0a 2020 2020  ._filename..    
-00014590: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000145a0: 6620 6e63 6828 7365 6c66 293a 0a20 2020  f nch(self):.   
-000145b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000145c0: 2e5f 6e63 680a 0a20 2020 2040 7072 6f70  ._nch..    @prop
-000145d0: 6572 7479 0a20 2020 2064 6566 2066 6c61  erty.    def fla
-000145e0: 766f 7572 2873 656c 6629 3a0a 2020 2020  vour(self):.    
-000145f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00014600: 5f66 6c61 766f 7572 0a0a 0a63 6c61 7373  _flavour...class
-00014610: 204f 6469 6d48 3546 696c 6528 5852 6164   OdimH5File(XRad
-00014620: 566f 6c46 696c 6529 3a0a 2020 2020 2222  VolFile):.    ""
-00014630: 2243 6c61 7373 2066 6f72 2068 6f6c 6469  "Class for holdi
-00014640: 6e67 206e 6574 4344 4634 2e44 6174 6173  ng netCDF4.Datas
-00014650: 6574 2068 616e 646c 6573 206f 6620 4f64  et handles of Od
-00014660: 696d 4835 2066 696c 6573 0a0a 2020 2020  imH5 files..    
-00014670: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00014680: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6669  ---------.    fi
-00014690: 6c65 6e61 6d65 203a 2073 7472 0a20 2020  lename : str.   
-000146a0: 2020 2020 2053 6f75 7263 6520 6461 7461       Source data
-000146b0: 2066 696c 6520 6e61 6d65 2e0a 2020 2020   file name..    
-000146c0: 666c 6176 6f75 7220 3a20 7374 720a 2020  flavour : str.  
-000146d0: 2020 2020 2020 4e61 6d65 206f 6620 6864        Name of hd
-000146e0: 6635 2066 6c61 766f 7572 2028 274f 4449  f5 flavour ('ODI
-000146f0: 4d27 206f 7220 2747 414d 4943 2729 2e20  M' or 'GAMIC'). 
-00014700: 4465 6661 756c 7473 2074 6f20 274f 4449  Defaults to 'ODI
-00014710: 4d27 2e0a 2020 2020 2222 220a 0a20 2020  M'..    """..   
-00014720: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00014730: 6c66 2c20 6669 6c65 6e61 6d65 3d4e 6f6e  lf, filename=Non
-00014740: 652c 2066 6c61 766f 7572 3d4e 6f6e 652c  e, flavour=None,
-00014750: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00014760: 2020 2020 7375 7065 7228 4f64 696d 4835      super(OdimH5
-00014770: 4669 6c65 2c20 7365 6c66 292e 5f5f 696e  File, self).__in
-00014780: 6974 5f5f 2866 696c 656e 616d 653d 6669  it__(filename=fi
-00014790: 6c65 6e61 6d65 2c20 666c 6176 6f75 723d  lename, flavour=
-000147a0: 666c 6176 6f75 722c 202a 2a6b 7761 7267  flavour, **kwarg
-000147b0: 7329 0a0a 2020 2020 6465 6620 5f63 6865  s)..    def _che
-000147c0: 636b 5f66 696c 6528 7365 6c66 2c20 6669  ck_file(self, fi
-000147d0: 6c65 6e61 6d65 2c20 666c 6176 6f75 7229  lename, flavour)
-000147e0: 3a0a 2020 2020 2020 2020 6e63 6820 3d20  :.        nch = 
-000147f0: 6e63 2e44 6174 6173 6574 2866 696c 656e  nc.Dataset(filen
-00014800: 616d 652c 2064 6973 6b6c 6573 733d 5472  ame, diskless=Tr
-00014810: 7565 2c20 7065 7273 6973 743d 4661 6c73  ue, persist=Fals
-00014820: 6529 0a20 2020 2020 2020 2069 6620 6e63  e).        if nc
-00014830: 682e 6469 736b 5f66 6f72 6d61 7420 213d  h.disk_format !=
-00014840: 2022 4844 4635 223a 0a20 2020 2020 2020   "HDF5":.       
-00014850: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00014860: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00014870: 2020 2020 2020 2777 7261 646c 6962 3a20        'wradlib: 
-00014880: 4669 6c65 207b 7d20 6973 206e 6569 7468  File {} is neith
-00014890: 6572 2022 4e45 5443 4446 3422 2028 7573  er "NETCDF4" (us
-000148a0: 696e 6720 4844 4635 2067 726f 7570 7329  ing HDF5 groups)
-000148b0: 2027 0a20 2020 2020 2020 2020 2020 2020   '.             
-000148c0: 2020 2027 6e6f 7220 706c 6169 6e20 2248     'nor plain "H
-000148d0: 4446 3522 2e27 2e66 6f72 6d61 7428 6669  DF5".'.format(fi
-000148e0: 6c65 6e61 6d65 290a 2020 2020 2020 2020  lename).        
-000148f0: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-00014900: 2066 6c61 766f 7572 2069 7320 4e6f 6e65   flavour is None
-00014910: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
-00014920: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00014930: 2020 2066 6c61 766f 7572 203d 206e 6368     flavour = nch
-00014940: 2e43 6f6e 7665 6e74 696f 6e73 0a20 2020  .Conventions.   
-00014950: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00014960: 4174 7472 6962 7574 6545 7272 6f72 2061  AttributeError a
-00014970: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-00014980: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
-00014990: 6275 7465 4572 726f 7228 0a20 2020 2020  buteError(.     
-000149a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000149b0: 7772 6164 6c69 623a 204d 6973 7369 6e67  wradlib: Missing
-000149c0: 2022 436f 6e76 656e 7469 6f6e 7322 2061   "Conventions" a
-000149d0: 7474 7269 6275 7465 2069 6e20 7b7d 202e  ttribute in {} .
-000149e0: 2f6e 270a 2020 2020 2020 2020 2020 2020  /n'.            
-000149f0: 2020 2020 2020 2020 2755 7365 2074 6865          'Use the
-00014a00: 2022 666c 6176 6f75 7222 206b 7761 7267   "flavour" kwarg
-00014a10: 2074 6f20 7370 6563 6966 7920 796f 7572   to specify your
-00014a20: 2073 6f75 7263 6520 270a 2020 2020 2020   source '.      
-00014a30: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00014a40: 6174 612e 222e 666f 726d 6174 2866 696c  ata.".format(fil
-00014a50: 656e 616d 6529 0a20 2020 2020 2020 2020  ename).         
-00014a60: 2020 2020 2020 2029 2066 726f 6d20 650a         ) from e.
-00014a70: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00014a80: 4f44 494d 2220 6e6f 7420 696e 2066 6c61  ODIM" not in fla
-00014a90: 766f 7572 3a0a 2020 2020 2020 2020 2020  vour:.          
-00014aa0: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-00014ab0: 6962 7574 6545 7272 6f72 280a 2020 2020  ibuteError(.    
-00014ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ad0: 2777 7261 646c 6962 3a20 2243 6f6e 7665  'wradlib: "Conve
-00014ae0: 6e74 696f 6e73 2220 6174 7472 6962 7574  ntions" attribut
-00014af0: 6520 227b 7d22 2069 6e20 7b7d 2069 7320  e "{}" in {} is 
-00014b00: 756e 6b6e 6f77 6e2e 2f6e 270a 2020 2020  unknown./n'.    
-00014b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b20: 2755 7365 2074 6865 2022 666c 6176 6f75  'Use the "flavou
-00014b30: 7222 206b 7761 7267 2074 6f20 7370 6563  r" kwarg to spec
-00014b40: 6966 7920 796f 7572 2073 6f75 7263 6520  ify your source 
-00014b50: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00014b60: 2020 2020 2020 2264 6174 612e 222e 666f        "data.".fo
-00014b70: 726d 6174 2866 6c61 766f 7572 2c20 6669  rmat(flavour, fi
-00014b80: 6c65 6e61 6d65 290a 2020 2020 2020 2020  lename).        
-00014b90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00014ba0: 2020 2069 6620 224f 4449 4d22 2069 6e20     if "ODIM" in 
-00014bb0: 666c 6176 6f75 723a 0a20 2020 2020 2020  flavour:.       
-00014bc0: 2020 2020 2073 656c 662e 5f64 7364 6573       self._dsdes
-00014bd0: 6320 3d20 2264 6174 6173 6574 220a 2020  c = "dataset".  
-00014be0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00014bf0: 7377 6d6f 6465 203d 2022 7072 6f64 7563  swmode = "produc
-00014c00: 7422 0a20 2020 2020 2020 2020 2020 2073  t".            s
-00014c10: 656c 662e 5f6d 666d 7420 3d20 2264 6174  elf._mfmt = "dat
-00014c20: 6122 0a20 2020 2020 2020 2020 2020 2073  a".            s
-00014c30: 656c 662e 5f6d 7372 6320 3d20 2267 726f  elf._msrc = "gro
-00014c40: 7570 7322 0a20 2020 2020 2020 2065 6c69  ups".        eli
-00014c50: 6620 2247 414d 4943 2220 696e 2066 6c61  f "GAMIC" in fla
-00014c60: 766f 7572 3a0a 2020 2020 2020 2020 2020  vour:.          
-00014c70: 2020 7365 6c66 2e5f 6473 6465 7363 203d    self._dsdesc =
-00014c80: 2022 7363 616e 220a 2020 2020 2020 2020   "scan".        
-00014c90: 2020 2020 7365 6c66 2e5f 7377 6d6f 6465      self._swmode
-00014ca0: 203d 2022 7363 616e 5f74 7970 6522 0a20   = "scan_type". 
-00014cb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014cc0: 5f6d 666d 7420 3d20 226d 6f6d 656e 745f  _mfmt = "moment_
-00014cd0: 220a 2020 2020 2020 2020 2020 2020 7365  ".            se
-00014ce0: 6c66 2e5f 6d73 7263 203d 2022 7661 7269  lf._msrc = "vari
-00014cf0: 6162 6c65 7322 0a20 2020 2020 2020 2065  ables".        e
-00014d00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00014d10: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
-00014d20: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00014d30: 2020 2020 2020 2027 7772 6164 6c69 623a         'wradlib:
-00014d40: 2055 6e6b 6e6f 776e 2022 666c 6176 6f75   Unknown "flavou
-00014d50: 7222 206b 7761 7267 2061 7474 7269 6275  r" kwarg attribu
-00014d60: 7465 3a20 7b7d 202e 2720 2222 2e66 6f72  te: {} .' "".for
-00014d70: 6d61 7428 666c 6176 6f75 7229 0a20 2020  mat(flavour).   
-00014d80: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00014d90: 2020 2020 7265 7475 726e 206e 6368 2c20      return nch, 
-00014da0: 666c 6176 6f75 720a 0a20 2020 2040 7072  flavour..    @pr
-00014db0: 6f70 6572 7479 0a20 2020 2064 6566 2066  operty.    def f
-00014dc0: 6c61 766f 7572 2873 656c 6629 3a0a 2020  lavour(self):.  
-00014dd0: 2020 2020 2020 666c 7620 3d20 5b22 4f44        flv = ["OD
-00014de0: 494d 222c 2022 4741 4d49 4322 5d0a 2020  IM", "GAMIC"].  
-00014df0: 2020 2020 2020 7265 7475 726e 205b 7320        return [s 
-00014e00: 666f 7220 7320 696e 2066 6c76 2069 6620  for s in flv if 
-00014e10: 7320 696e 2073 656c 662e 5f66 6c61 766f  s in self._flavo
-00014e20: 7572 5d5b 305d 0a0a 0a63 6c61 7373 204e  ur][0]...class N
-00014e30: 6574 4344 4634 4669 6c65 2858 5261 6456  etCDF4File(XRadV
-00014e40: 6f6c 4669 6c65 293a 0a20 2020 2022 2222  olFile):.    """
-00014e50: 436c 6173 7320 666f 7220 686f 6c64 696e  Class for holdin
-00014e60: 6720 6e65 7443 4446 342e 4461 7461 7365  g netCDF4.Datase
-00014e70: 7420 6861 6e64 6c65 7320 6f66 2043 662f  t handles of Cf/
-00014e80: 5261 6469 616c 2066 696c 6573 0a0a 2020  Radial files..  
-00014e90: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00014ea0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00014eb0: 6669 6c65 6e61 6d65 203a 2073 7472 0a20  filename : str. 
-00014ec0: 2020 2020 2020 2053 6f75 7263 6520 6461         Source da
-00014ed0: 7461 2066 696c 6520 6e61 6d65 2e0a 2020  ta file name..  
-00014ee0: 2020 666c 6176 6f75 7220 3a20 7374 720a    flavour : str.
-00014ef0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-00014f00: 666c 6176 6f75 7220 2827 4366 2f52 6164  flavour ('Cf/Rad
-00014f10: 6961 6c27 206f 7220 2743 662f 5261 6469  ial' or 'Cf/Radi
-00014f20: 616c 3227 292e 0a20 2020 2022 2222 0a0a  al2')..    """..
-00014f30: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00014f40: 2873 656c 662c 2066 696c 656e 616d 653d  (self, filename=
-00014f50: 4e6f 6e65 2c20 666c 6176 6f75 723d 4e6f  None, flavour=No
-00014f60: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
-00014f70: 2020 2020 2020 2073 7570 6572 284e 6574         super(Net
-00014f80: 4344 4634 4669 6c65 2c20 7365 6c66 292e  CDF4File, self).
-00014f90: 5f5f 696e 6974 5f5f 2866 696c 656e 616d  __init__(filenam
-00014fa0: 653d 6669 6c65 6e61 6d65 2c20 666c 6176  e=filename, flav
-00014fb0: 6f75 723d 666c 6176 6f75 722c 202a 2a6b  our=flavour, **k
-00014fc0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-00014fd0: 5f63 6865 636b 5f66 696c 6528 7365 6c66  _check_file(self
-00014fe0: 2c20 6669 6c65 6e61 6d65 2c20 666c 6176  , filename, flav
-00014ff0: 6f75 7229 3a0a 2020 2020 2020 2020 6e63  our):.        nc
-00015000: 6820 3d20 6e63 2e44 6174 6173 6574 2866  h = nc.Dataset(f
-00015010: 696c 656e 616d 652c 2064 6973 6b6c 6573  ilename, diskles
-00015020: 733d 5472 7565 2c20 7065 7273 6973 743d  s=True, persist=
-00015030: 4661 6c73 6529 0a20 2020 2020 2020 2069  False).        i
-00015040: 6620 666c 6176 6f75 7220 6973 204e 6f6e  f flavour is Non
-00015050: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-00015060: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00015070: 2020 2020 436f 6e76 656e 7469 6f6e 7320      Conventions 
-00015080: 3d20 6e63 682e 436f 6e76 656e 7469 6f6e  = nch.Convention
-00015090: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-000150a0: 2020 7665 7273 696f 6e20 3d20 6e63 682e    version = nch.
-000150b0: 7665 7273 696f 6e0a 2020 2020 2020 2020  version.        
-000150c0: 2020 2020 6578 6365 7074 2041 7474 7269      except Attri
-000150d0: 6275 7465 4572 726f 7220 6173 2065 3a0a  buteError as e:.
-000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150f0: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
-00015100: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00015110: 2020 2020 2020 2020 2020 2777 7261 646c            'wradl
-00015120: 6962 3a20 4d69 7373 696e 6720 2243 6f6e  ib: Missing "Con
-00015130: 7665 6e74 696f 6e73 2220 6174 7472 6962  ventions" attrib
-00015140: 7574 6520 696e 207b 7d20 2e2f 6e27 0a20  ute in {} ./n'. 
-00015150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015160: 2020 2027 5573 6520 7468 6520 2266 6c61     'Use the "fla
-00015170: 766f 7572 2220 6b77 6172 6720 746f 2073  vour" kwarg to s
-00015180: 7065 6369 6679 2079 6f75 7220 736f 7572  pecify your sour
-00015190: 6365 270a 2020 2020 2020 2020 2020 2020  ce'.            
-000151a0: 2020 2020 2020 2020 2264 6174 612e 222e          "data.".
-000151b0: 666f 726d 6174 2866 696c 656e 616d 6529  format(filename)
-000151c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000151d0: 2029 2066 726f 6d20 650a 2020 2020 2020   ) from e.      
-000151e0: 2020 2020 2020 6966 2022 6366 2f72 6164        if "cf/rad
-000151f0: 6961 6c22 2069 6e20 436f 6e76 656e 7469  ial" in Conventi
-00015200: 6f6e 732e 6c6f 7765 7228 293a 0a20 2020  ons.lower():.   
-00015210: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00015220: 7665 7273 696f 6e20 3d3d 2022 322e 3022  version == "2.0"
-00015230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015240: 2020 2020 2020 666c 6176 6f75 7220 3d20        flavour = 
-00015250: 2243 662f 5261 6469 616c 3222 0a20 2020  "Cf/Radial2".   
-00015260: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00015270: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00015280: 2020 2020 2020 2066 6c61 766f 7572 203d         flavour =
-00015290: 2022 4366 2f52 6164 6961 6c22 0a0a 2020   "Cf/Radial"..  
-000152a0: 2020 2020 2020 6966 2066 6c61 766f 7572        if flavour
-000152b0: 206e 6f74 2069 6e20 5b22 4366 2f52 6164   not in ["Cf/Rad
-000152c0: 6961 6c22 2c20 2243 662f 5261 6469 616c  ial", "Cf/Radial
-000152d0: 3222 5d3a 0a20 2020 2020 2020 2020 2020  2"]:.           
-000152e0: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
-000152f0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00015300: 2020 2020 2020 2027 7772 6164 6c69 623a         'wradlib:
-00015310: 2055 6e6b 6e6f 776e 2022 666c 6176 6f75   Unknown "flavou
-00015320: 7222 206b 7761 7267 2061 7474 7269 6275  r" kwarg attribu
-00015330: 7465 3a20 7b7d 202e 2720 2222 2e66 6f72  te: {} .' "".for
-00015340: 6d61 7428 666c 6176 6f75 7229 0a20 2020  mat(flavour).   
-00015350: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00015360: 2020 2020 7265 7475 726e 206e 6368 2c20      return nch, 
-00015370: 666c 6176 6f75 720a 0a0a 636c 6173 7320  flavour...class 
-00015380: 5852 6164 566f 6c28 636f 6c6c 6563 7469  XRadVol(collecti
-00015390: 6f6e 732e 6162 632e 4d75 7461 626c 654d  ons.abc.MutableM
-000153a0: 6170 7069 6e67 293a 0a20 2020 2022 2222  apping):.    """
-000153b0: 4261 7365 436c 6173 7320 666f 7220 7861  BaseClass for xa
-000153c0: 7272 6179 2062 6173 6564 2052 6164 6172  rray based Radar
-000153d0: 566f 6c75 6d65 730a 0a20 2020 2049 6d70  Volumes..    Imp
-000153e0: 6c65 6d65 6e74 7320 6063 6f6c 6c65 6374  lements `collect
-000153f0: 696f 6e73 2e4d 7574 6162 6c65 4d61 7070  ions.MutableMapp
-00015400: 696e 6760 2064 6963 7469 6f6e 6172 792e  ing` dictionary.
-00015410: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-00015420: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00015430: 2069 6e69 745f 726f 6f74 3d46 616c 7365   init_root=False
-00015440: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00015450: 5f73 7765 6570 7320 3d20 6469 6374 2829  _sweeps = dict()
-00015460: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-00015470: 6368 203d 206c 6973 7428 290a 2020 2020  ch = list().    
-00015480: 2020 2020 7365 6c66 2e72 6f6f 7420 3d20      self.root = 
-00015490: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-000154a0: 662e 5f73 7765 6570 5f61 6e67 6c65 7320  f._sweep_angles 
-000154b0: 3d20 6c69 7374 2829 0a20 2020 2020 2020  = list().       
-000154c0: 2073 656c 662e 5f73 7765 6570 5f6e 616d   self._sweep_nam
-000154d0: 6573 203d 206c 6973 7428 290a 2020 2020  es = list().    
-000154e0: 2020 2020 6966 2069 6e69 745f 726f 6f74      if init_root
-000154f0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00015500: 6c66 2e5f 696e 6974 5f72 6f6f 7428 290a  lf._init_root().
-00015510: 0a20 2020 2064 6566 205f 5f67 6574 6974  .    def __getit
-00015520: 656d 5f5f 2873 656c 662c 206b 6579 293a  em__(self, key):
-00015530: 0a20 2020 2020 2020 2069 6620 6b65 7920  .        if key 
-00015540: 3d3d 2022 726f 6f74 223a 0a20 2020 2020  == "root":.     
-00015550: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00015560: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00015570: 2020 2020 2020 2257 5241 444c 4942 3a20        "WRADLIB: 
-00015580: 5573 6520 6f66 2060 6f62 6a5b 2772 6f6f  Use of `obj['roo
-00015590: 7427 5d60 2069 7320 6465 7072 6563 6174  t']` is deprecat
-000155a0: 6564 2c20 220a 2020 2020 2020 2020 2020  ed, ".          
-000155b0: 2020 2020 2020 2270 6c65 6173 6520 7573        "please us
-000155c0: 6520 6f62 6a2e 726f 6f74 2069 6e73 7465  e obj.root inste
-000155d0: 6164 2e22 2c0a 2020 2020 2020 2020 2020  ad.",.          
-000155e0: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-000155f0: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00015600: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00015610: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00015620: 5f72 6f6f 740a 0a20 2020 2020 2020 2072  _root..        r
-00015630: 6574 7572 6e20 7365 6c66 2e5f 7377 6565  eturn self._swee
-00015640: 7073 5b6b 6579 5d0a 0a20 2020 2064 6566  ps[key]..    def
-00015650: 205f 5f73 6574 6974 656d 5f5f 2873 656c   __setitem__(sel
-00015660: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
-00015670: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
-00015680: 6e20 7365 6c66 2e5f 7377 6565 7073 3a0a  n self._sweeps:.
-00015690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000156a0: 2e5f 7377 6565 7073 5b6b 6579 5d20 3d20  ._sweeps[key] = 
-000156b0: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
-000156c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000156d0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-000156e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000156f0: 5752 4144 4c49 423a 2055 7365 2063 6c61  WRADLIB: Use cla
-00015700: 7373 206d 6574 686f 6473 2074 6f20 6164  ss methods to ad
-00015710: 6420 6461 7461 2e20 220a 2020 2020 2020  d data. ".      
-00015720: 2020 2020 2020 2020 2020 2244 6972 6563            "Direc
-00015730: 7420 7365 7474 696e 6720 6973 206e 6f74  t setting is not
-00015740: 2061 6c6c 6f77 6564 2e22 2c0a 2020 2020   allowed.",.    
-00015750: 2020 2020 2020 2020 2020 2020 5573 6572              User
-00015760: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-00015770: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00015780: 5f5f 6465 6c69 7465 6d5f 5f28 7365 6c66  __delitem__(self
-00015790: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-000157a0: 6465 6c20 7365 6c66 2e5f 7377 6565 7073  del self._sweeps
-000157b0: 5b6b 6579 5d0a 0a20 2020 2064 6566 205f  [key]..    def _
-000157c0: 5f69 7465 725f 5f28 7365 6c66 293a 0a20  _iter__(self):. 
-000157d0: 2020 2020 2020 2072 6574 7572 6e20 6974         return it
-000157e0: 6572 2873 656c 662e 5f73 7765 6570 7329  er(self._sweeps)
-000157f0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-00015800: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00015810: 2072 6574 7572 6e20 6c65 6e28 7365 6c66   return len(self
-00015820: 2e5f 7377 6565 7073 290a 0a20 2020 2064  ._sweeps)..    d
-00015830: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
-00015840: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00015850: 6e20 7365 6c66 2e5f 7377 6565 7073 2e5f  n self._sweeps._
-00015860: 5f72 6570 725f 5f28 290a 0a20 2020 2064  _repr__()..    d
-00015870: 6566 205f 5f64 656c 5f5f 2873 656c 6629  ef __del__(self)
-00015880: 3a0a 2020 2020 2020 2020 6465 6c20 7365  :.        del se
-00015890: 6c66 2e5f 726f 6f74 0a20 2020 2020 2020  lf._root.       
-000158a0: 2066 6f72 206b 2069 6e20 6c69 7374 2873   for k in list(s
-000158b0: 656c 662e 5f73 7765 6570 7329 3a0a 2020  elf._sweeps):.  
-000158c0: 2020 2020 2020 2020 2020 6465 6c20 6b0a            del k.
-000158d0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-000158e0: 2073 656c 662e 5f6e 6368 3a0a 2020 2020   self._nch:.    
-000158f0: 2020 2020 2020 2020 6465 6c20 6b0a 0a20          del k.. 
-00015900: 2020 2064 6566 205f 696e 6974 5f72 6f6f     def _init_roo
-00015910: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-00015920: 2073 656c 662e 726f 6f74 203d 2078 722e   self.root = xr.
-00015930: 4461 7461 7365 7428 6461 7461 5f76 6172  Dataset(data_var
-00015940: 733d 676c 6f62 616c 5f76 6172 6961 626c  s=global_variabl
-00015950: 6573 2c20 6174 7472 733d 676c 6f62 616c  es, attrs=global
-00015960: 5f61 7474 7273 290a 0a20 2020 2040 7072  _attrs)..    @pr
-00015970: 6f70 6572 7479 0a20 2020 2064 6566 2072  operty.    def r
-00015980: 6f6f 7428 7365 6c66 293a 0a20 2020 2020  oot(self):.     
-00015990: 2020 2022 2222 5265 7475 726e 2060 726f     """Return `ro
-000159a0: 6f74 6020 6461 7461 7365 742e 2222 220a  ot` dataset.""".
-000159b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000159c0: 656c 662e 5f72 6f6f 740a 0a20 2020 2040  elf._root..    @
-000159d0: 726f 6f74 2e73 6574 7465 720a 2020 2020  root.setter.    
-000159e0: 6465 6620 726f 6f74 2873 656c 662c 2076  def root(self, v
-000159f0: 616c 7565 293a 0a20 2020 2020 2020 2073  alue):.        s
-00015a00: 656c 662e 5f72 6f6f 7420 3d20 7661 6c75  elf._root = valu
-00015a10: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
-00015a20: 0a20 2020 2064 6566 2073 7765 6570 5f61  .    def sweep_a
-00015a30: 6e67 6c65 7328 7365 6c66 293a 0a20 2020  ngles(self):.   
-00015a40: 2020 2020 2069 6620 7365 6c66 2e72 6f6f       if self.roo
-00015a50: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00015a60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00015a70: 6c66 2e5f 7377 6565 705f 616e 676c 6573  lf._sweep_angles
-00015a80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00015a90: 6c69 7374 2873 656c 662e 726f 6f74 2e73  list(self.root.s
-00015aa0: 7765 6570 5f66 6978 6564 5f61 6e67 6c65  weep_fixed_angle
-00015ab0: 2e76 616c 7565 7329 0a0a 2020 2020 4073  .values)..    @s
-00015ac0: 7765 6570 5f61 6e67 6c65 732e 7365 7474  weep_angles.sett
-00015ad0: 6572 0a20 2020 2064 6566 2073 7765 6570  er.    def sweep
-00015ae0: 5f61 6e67 6c65 7328 7365 6c66 2c20 7661  _angles(self, va
-00015af0: 6c75 6529 3a0a 2020 2020 2020 2020 6966  lue):.        if
-00015b00: 2073 656c 662e 726f 6f74 2069 7320 4e6f   self.root is No
-00015b10: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00015b20: 7365 6c66 2e5f 7377 6565 705f 616e 676c  self._sweep_angl
-00015b30: 6573 2e61 7070 656e 6428 7661 6c75 6529  es.append(value)
-00015b40: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00015b50: 2020 2020 6465 6620 7377 6565 705f 6e61      def sweep_na
-00015b60: 6d65 7328 7365 6c66 293a 0a20 2020 2020  mes(self):.     
-00015b70: 2020 2069 6620 7365 6c66 2e72 6f6f 7420     if self.root 
-00015b80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00015b90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00015ba0: 2e5f 7377 6565 705f 6e61 6d65 730a 2020  ._sweep_names.  
-00015bb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00015bc0: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-00015bd0: 6973 7428 7365 6c66 2e72 6f6f 742e 7377  ist(self.root.sw
-00015be0: 6565 705f 6772 6f75 705f 6e61 6d65 2e76  eep_group_name.v
-00015bf0: 616c 7565 7329 0a0a 2020 2020 4073 7765  alues)..    @swe
-00015c00: 6570 5f6e 616d 6573 2e73 6574 7465 720a  ep_names.setter.
-00015c10: 2020 2020 6465 6620 7377 6565 705f 6e61      def sweep_na
-00015c20: 6d65 7328 7365 6c66 2c20 7661 6c75 6529  mes(self, value)
-00015c30: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-00015c40: 662e 726f 6f74 2069 7320 4e6f 6e65 3a0a  f.root is None:.
-00015c50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015c60: 2e5f 7377 6565 705f 6e61 6d65 732e 6170  ._sweep_names.ap
-00015c70: 7065 6e64 2876 616c 7565 290a 0a20 2020  pend(value)..   
-00015c80: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00015c90: 6566 2073 7765 6570 2873 656c 6629 3a0a  ef sweep(self):.
-00015ca0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00015cb0: 6e20 7377 6565 7020 6469 6d65 6e73 696f  n sweep dimensio
-00015cc0: 6e20 636f 756e 742e 2222 220a 2020 2020  n count.""".    
-00015cd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00015ce0: 726f 6f74 2e64 696d 735b 2273 7765 6570  root.dims["sweep
-00015cf0: 225d 0a0a 2020 2020 4070 726f 7065 7274  "]..    @propert
-00015d00: 790a 2020 2020 6465 6620 7377 6565 7073  y.    def sweeps
-00015d10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00015d20: 2222 2252 6574 7572 6e20 7a69 7020 7377  """Return zip sw
-00015d30: 6565 7020 6e61 6d65 732c 2073 7765 6570  eep names, sweep
-00015d40: 5f61 6e67 6c65 7322 2222 0a20 2020 2020  _angles""".     
-00015d50: 2020 2072 6574 7572 6e20 7a69 7028 7365     return zip(se
-00015d60: 6c66 2e73 7765 6570 5f6e 616d 6573 2c20  lf.sweep_names, 
-00015d70: 7365 6c66 2e73 7765 6570 5f61 6e67 6c65  self.sweep_angle
-00015d80: 7329 0a0a 2020 2020 4070 726f 7065 7274  s)..    @propert
-00015d90: 790a 2020 2020 6465 6620 6c6f 6361 7469  y.    def locati
-00015da0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-00015db0: 2020 2222 2252 6574 7572 6e20 6c6f 6361    """Return loca
-00015dc0: 7469 6f6e 206f 6620 6461 7461 2073 6f75  tion of data sou
-00015dd0: 7263 652e 2222 220a 2020 2020 2020 2020  rce.""".        
-00015de0: 7265 7475 726e 2028 0a20 2020 2020 2020  return (.       
-00015df0: 2020 2020 2073 656c 662e 726f 6f74 2e6c       self.root.l
-00015e00: 6f6e 6769 7475 6465 2e76 616c 7565 732e  ongitude.values.
-00015e10: 6974 656d 2829 2c0a 2020 2020 2020 2020  item(),.        
-00015e20: 2020 2020 7365 6c66 2e72 6f6f 742e 6c61      self.root.la
-00015e30: 7469 7475 6465 2e76 616c 7565 732e 6974  titude.values.it
-00015e40: 656d 2829 2c0a 2020 2020 2020 2020 2020  em(),.          
-00015e50: 2020 7365 6c66 2e72 6f6f 742e 616c 7469    self.root.alti
-00015e60: 7475 6465 2e76 616c 7565 732e 6974 656d  tude.values.item
-00015e70: 2829 2c0a 2020 2020 2020 2020 290a 0a20  (),.        ).. 
-00015e80: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00015e90: 2064 6566 2043 6f6e 7665 6e74 696f 6e73   def Conventions
-00015ea0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00015eb0: 2222 2252 6574 7572 6e20 4346 2f4f 4449  """Return CF/ODI
-00015ec0: 4d20 6043 6f6e 7665 6e74 696f 6e73 602e  M `Conventions`.
-00015ed0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00015ee0: 726e 2073 656c 662e 726f 6f74 2e43 6f6e  rn self.root.Con
-00015ef0: 7665 6e74 696f 6e73 0a0a 2020 2020 4070  ventions..    @p
-00015f00: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00015f10: 7665 7273 696f 6e28 7365 6c66 293a 0a20  version(self):. 
-00015f20: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00015f30: 2043 462f 4f44 494d 2076 6572 7369 6f6e   CF/ODIM version
-00015f40: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00015f50: 726e 2073 656c 662e 726f 6f74 2e76 6572  rn self.root.ver
-00015f60: 7369 6f6e 0a0a 2020 2020 6465 6620 746f  sion..    def to
-00015f70: 5f63 6672 6164 6961 6c32 2873 656c 662c  _cfradial2(self,
-00015f80: 2066 696c 656e 616d 6529 3a0a 2020 2020   filename):.    
-00015f90: 2020 2020 2222 2253 6176 6520 766f 6c75      """Save volu
-00015fa0: 6d65 2074 6f20 4366 5261 6469 616c 322e  me to CfRadial2.
-00015fb0: 3020 636f 6d70 6c69 616e 7420 6669 6c65  0 compliant file
-00015fc0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00015fd0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00015fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015ff0: 2066 696c 656e 616d 6520 3a20 7374 720a   filename : str.
-00016000: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00016010: 206f 6620 7468 6520 6f75 7470 7574 2066   of the output f
-00016020: 696c 650a 2020 2020 2020 2020 2222 220a  ile.        """.
-00016030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00016040: 726f 6f74 3a0a 2020 2020 2020 2020 2020  root:.          
-00016050: 2020 746f 5f63 6672 6164 6961 6c32 2873    to_cfradial2(s
-00016060: 656c 662c 2066 696c 656e 616d 6529 0a20  elf, filename). 
-00016070: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00016080: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-00016090: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-000160a0: 2020 2020 2020 2020 2257 5241 444c 4942          "WRADLIB
-000160b0: 3a20 4e6f 2043 6652 6164 6961 6c32 2d63  : No CfRadial2-c
-000160c0: 6f6d 706c 6961 6e74 2064 6174 6120 7374  ompliant data st
-000160d0: 7275 6374 7572 6520 220a 2020 2020 2020  ructure ".      
-000160e0: 2020 2020 2020 2020 2020 2261 7661 696c            "avail
-000160f0: 6162 6c65 2e20 4e6f 7420 7361 7669 6e67  able. Not saving
-00016100: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00016110: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
-00016120: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00016130: 2020 2020 6465 6620 746f 5f6f 6469 6d28      def to_odim(
-00016140: 7365 6c66 2c20 6669 6c65 6e61 6d65 293a  self, filename):
-00016150: 0a20 2020 2020 2020 2022 2222 5361 7665  .        """Save
-00016160: 2076 6f6c 756d 6520 746f 204f 4449 4d5f   volume to ODIM_
-00016170: 4835 2f56 325f 3220 636f 6d70 6c69 616e  H5/V2_2 complian
-00016180: 7420 6669 6c65 2e0a 0a20 2020 2020 2020  t file...       
-00016190: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000161a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000161b0: 2020 2020 2020 2066 696c 656e 616d 6520         filename 
-000161c0: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-000161d0: 2020 4e61 6d65 206f 6620 7468 6520 6f75    Name of the ou
-000161e0: 7470 7574 2066 696c 650a 2020 2020 2020  tput file.      
-000161f0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00016200: 2073 656c 662e 726f 6f74 3a0a 2020 2020   self.root:.    
-00016210: 2020 2020 2020 2020 746f 5f6f 6469 6d28          to_odim(
-00016220: 7365 6c66 2c20 6669 6c65 6e61 6d65 290a  self, filename).
-00016230: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00016240: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00016250: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00016260: 2020 2020 2020 2020 2022 5752 4144 4c49           "WRADLI
-00016270: 423a 204e 6f20 4f64 696d 4835 2d63 6f6d  B: No OdimH5-com
-00016280: 706c 6961 6e74 2064 6174 6120 7374 7275  pliant data stru
-00016290: 6374 7572 6520 2220 2261 7661 696c 6162  cture " "availab
-000162a0: 6c65 2e20 4e6f 7420 7361 7669 6e67 2e22  le. Not saving."
-000162b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000162c0: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
-000162d0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000162e0: 2020 6465 6620 6765 6f72 6566 6572 656e    def georeferen
-000162f0: 6365 2873 656c 662c 2073 7765 6570 733d  ce(self, sweeps=
-00016300: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00016310: 2222 4765 6f72 6566 6572 656e 6365 2073  ""Georeference s
-00016320: 7765 6570 730a 0a20 2020 2020 2020 2050  weeps..        P
-00016330: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00016340: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00016350: 2020 2020 2073 7765 6570 7320 3a20 6c69       sweeps : li
-00016360: 7374 0a20 2020 2020 2020 2020 2020 206c  st.            l
-00016370: 6973 7420 7769 7468 2073 7765 6570 206b  ist with sweep k
-00016380: 6579 7320 746f 2067 656f 7265 6665 7265  eys to georefere
-00016390: 6e63 652c 2064 6566 6175 6c74 7320 746f  nce, defaults to
-000163a0: 2061 6c6c 2073 7765 6570 730a 2020 2020   all sweeps.    
-000163b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000163c0: 6966 2073 7765 6570 7320 6973 204e 6f6e  if sweeps is Non
-000163d0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000163e0: 7765 6570 7320 3d20 7365 6c66 0a0a 2020  weeps = self..  
-000163f0: 2020 2020 2020 666f 7220 7377 7020 696e        for swp in
-00016400: 2073 7765 6570 733a 0a20 2020 2020 2020   sweeps:.       
-00016410: 2020 2020 2073 656c 665b 7377 705d 203d       self[swp] =
-00016420: 2073 656c 665b 7377 705d 2e70 6970 6528   self[swp].pipe(
-00016430: 7861 7272 6179 2e67 656f 7265 6665 7265  xarray.georefere
-00016440: 6e63 655f 6461 7461 7365 7429 0a0a 0a63  nce_dataset)...c
-00016450: 6c61 7373 2043 6652 6164 6961 6c28 5852  lass CfRadial(XR
-00016460: 6164 566f 6c29 3a0a 2020 2020 2222 2243  adVol):.    """C
-00016470: 6c61 7373 2066 6f72 2078 6172 7261 7920  lass for xarray 
-00016480: 6261 7365 6420 7265 7472 6965 7661 6c20  based retrieval 
-00016490: 6f66 2043 6652 6164 6961 6c20 6461 7461  of CfRadial data
-000164a0: 2066 696c 6573 2222 220a 0a20 2020 2064   files"""..    d
-000164b0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-000164c0: 2c20 6669 6c65 6e61 6d65 3d4e 6f6e 652c  , filename=None,
-000164d0: 2066 6c61 766f 7572 3d4e 6f6e 652c 202a   flavour=None, *
-000164e0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-000164f0: 2020 2222 2249 6e69 7469 616c 697a 6520    """Initialize 
-00016500: 7861 7272 6179 2073 7472 7563 7475 7265  xarray structure
-00016510: 2066 726f 6d20 4366 2f52 6164 6961 6c20   from Cf/Radial 
-00016520: 6461 7461 2073 7472 7563 7475 7265 2e0a  data structure..
-00016530: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00016540: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00016550: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-00016560: 696c 656e 616d 6520 3a20 7374 720a 2020  ilename : str.  
-00016570: 2020 2020 2020 2020 2020 536f 7572 6365            Source
-00016580: 2064 6174 6120 6669 6c65 206e 616d 652e   data file name.
-00016590: 0a20 2020 2020 2020 2066 6c61 766f 7572  .        flavour
-000165a0: 203a 2073 7472 0a20 2020 2020 2020 2020   : str.         
-000165b0: 2020 204e 616d 6520 6f66 2066 6c61 766f     Name of flavo
-000165c0: 7572 2028 2743 662f 5261 6469 616c 2720  ur ('Cf/Radial' 
-000165d0: 6f72 2027 4366 2f52 6164 6961 6c32 2729  or 'Cf/Radial2')
-000165e0: 2e0a 0a20 2020 2020 2020 204b 6579 776f  ...        Keywo
-000165f0: 7264 2041 7267 756d 656e 7473 0a20 2020  rd Arguments.   
-00016600: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00016610: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-00016620: 6563 6f64 655f 7469 6d65 7320 3a20 626f  ecode_times : bo
-00016630: 6f6c 0a20 2020 2020 2020 2020 2020 2049  ol.            I
-00016640: 6620 5472 7565 2c20 6465 636f 6465 2063  f True, decode c
-00016650: 6620 7469 6d65 7320 746f 206e 702e 6461  f times to np.da
-00016660: 7465 7469 6d65 3634 2e20 4465 6661 756c  tetime64. Defaul
-00016670: 7473 2074 6f20 5472 7565 2e0a 2020 2020  ts to True..    
-00016680: 2020 2020 6465 636f 6465 5f63 6f6f 7264      decode_coord
-00016690: 7320 3a20 626f 6f6c 0a20 2020 2020 2020  s : bool.       
-000166a0: 2020 2020 2049 6620 5472 7565 2c20 7573       If True, us
-000166b0: 6520 7468 6520 e280 9863 6f6f 7264 696e  e the ...coordin
-000166c0: 6174 6573 e280 9920 6174 7472 6962 7574  ates... attribut
-000166d0: 6520 6f6e 2076 6172 6961 626c 650a 2020  e on variable.  
-000166e0: 2020 2020 2020 2020 2020 746f 2061 7373            to ass
-000166f0: 6967 6e20 636f 6f72 6469 6e61 7465 732e  ign coordinates.
-00016700: 2044 6566 6175 6c74 7320 746f 2054 7275   Defaults to Tru
-00016710: 652e 0a20 2020 2020 2020 206d 6173 6b5f  e..        mask_
-00016720: 616e 645f 7363 616c 6520 3a20 626f 6f6c  and_scale : bool
-00016730: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00016740: 5472 7565 2c20 6c61 7a69 6c79 2073 6361  True, lazily sca
-00016750: 6c65 2028 7573 696e 6720 7363 616c 655f  le (using scale_
-00016760: 6661 6374 6f72 2061 6e64 2061 6464 5f6f  factor and add_o
-00016770: 6666 7365 7429 0a20 2020 2020 2020 2020  ffset).         
-00016780: 2020 2061 6e64 206d 6173 6b20 2875 7369     and mask (usi
-00016790: 6e67 205f 4669 6c6c 5661 6c75 6529 2e20  ng _FillValue). 
-000167a0: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
-000167b0: 2e0a 2020 2020 2020 2020 6368 756e 6b73  ..        chunks
-000167c0: 203a 2069 6e74 207c 2064 6963 742c 206f   : int | dict, o
-000167d0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000167e0: 2020 2020 4966 2063 6875 6e6b 7320 6973      If chunks is
-000167f0: 2070 726f 7669 6465 642c 2069 7420 7573   provided, it us
-00016800: 6564 2074 6f20 6c6f 6164 2074 6865 206e  ed to load the n
-00016810: 6577 2064 6174 6173 6574 2069 6e74 6f20  ew dataset into 
-00016820: 6461 736b 0a20 2020 2020 2020 2020 2020  dask.           
-00016830: 2061 7272 6179 732e 2063 6875 6e6b 733d   arrays. chunks=
-00016840: 7b7d 206c 6f61 6473 2074 6865 2064 6174  {} loads the dat
-00016850: 6173 6574 2077 6974 6820 6461 736b 2075  aset with dask u
-00016860: 7369 6e67 2061 2073 696e 676c 650a 2020  sing a single.  
-00016870: 2020 2020 2020 2020 2020 6368 756e 6b20            chunk 
-00016880: 666f 7220 616c 6c20 6172 7261 7973 2e0a  for all arrays..
-00016890: 2020 2020 2020 2020 6765 6f72 6566 203a          georef :
-000168a0: 2062 6f6f 6c0a 2020 2020 2020 2020 2020   bool.          
-000168b0: 2020 4966 2054 7275 652c 2061 6464 7320    If True, adds 
-000168c0: 3244 2041 4551 4420 782c 792c 7a2d 636f  2D AEQD x,y,z-co
-000168d0: 6f72 6469 6e61 7465 732c 2067 726f 756e  ordinates, groun
-000168e0: 645f 7261 6e67 6520 2867 7229 2061 6e64  d_range (gr) and
-000168f0: 0a20 2020 2020 2020 2020 2020 2032 4420  .            2D 
-00016900: 2872 6179 732c 6269 6e73 292d 636f 6f72  (rays,bins)-coor
-00016910: 6469 6e61 7465 7320 666f 7220 6561 7379  dinates for easy
-00016920: 2067 656f 7265 6665 7265 6e63 696e 6720   georeferencing 
-00016930: 2865 672e 2063 6172 746f 7079 290a 2020  (eg. cartopy).  
-00016940: 2020 2020 2020 6469 6d30 203a 2073 7472        dim0 : str
-00016950: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00016960: 6520 6f66 2074 6865 2072 6179 2d64 696d  e of the ray-dim
-00016970: 656e 7369 6f6e 206f 6620 4461 7461 4172  ension of DataAr
-00016980: 7261 7973 2061 6e64 2044 6174 6173 6574  rays and Dataset
-00016990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000169a0: 2020 2a20 6074 696d 6560 202d 2063 6672    * `time` - cfr
-000169b0: 6164 6961 6c32 2073 7461 6e64 6172 640a  adial2 standard.
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 2a20 6061 7a69 6d75 7468 6020 2d20 6265  * `azimuth` - be
-000169e0: 7474 6572 2066 6f72 2077 6f72 6b69 6e67  tter for working
-000169f0: 2077 6974 6820 7861 7272 6179 0a20 2020   with xarray.   
-00016a00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016a10: 2073 7570 6572 2843 6652 6164 6961 6c2c   super(CfRadial,
-00016a20: 2073 656c 6629 2e5f 5f69 6e69 745f 5f28   self).__init__(
-00016a30: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-00016a40: 2069 7369 6e73 7461 6e63 6528 6669 6c65   isinstance(file
-00016a50: 6e61 6d65 2c20 6c69 7374 293a 0a20 2020  name, list):.   
-00016a60: 2020 2020 2020 2020 2066 696c 656e 616d           filenam
-00016a70: 6520 3d20 5b66 696c 656e 616d 655d 0a20  e = [filename]. 
-00016a80: 2020 2020 2020 2066 6f72 2069 2c20 6620         for i, f 
-00016a90: 696e 2065 6e75 6d65 7261 7465 2866 696c  in enumerate(fil
-00016aa0: 656e 616d 6529 3a0a 2020 2020 2020 2020  ename):.        
-00016ab0: 2020 2020 6e63 6820 3d20 4e65 7443 4446      nch = NetCDF
-00016ac0: 3446 696c 6528 662c 2066 6c61 766f 7572  4File(f, flavour
-00016ad0: 3d66 6c61 766f 7572 290a 2020 2020 2020  =flavour).      
-00016ae0: 2020 2020 2020 7365 6c66 2e5f 6e63 682e        self._nch.
-00016af0: 6170 7065 6e64 286e 6368 290a 2020 2020  append(nch).    
-00016b00: 2020 2020 2020 2020 6966 206e 6368 2e66          if nch.f
-00016b10: 6c61 766f 7572 203d 3d20 2243 662f 5261  lavour == "Cf/Ra
-00016b20: 6469 616c 3222 3a0a 2020 2020 2020 2020  dial2":.        
-00016b30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00016b40: 6967 6e5f 6461 7461 5f72 6164 6961 6c32  ign_data_radial2
-00016b50: 286e 6368 2c20 2a2a 6b77 6172 6773 290a  (nch, **kwargs).
-00016b60: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00016b70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016b80: 2020 7365 6c66 2e61 7373 6967 6e5f 6461    self.assign_da
-00016b90: 7461 5f72 6164 6961 6c28 6e63 682c 202a  ta_radial(nch, *
-00016ba0: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
-00016bb0: 6620 6173 7369 676e 5f64 6174 615f 7261  f assign_data_ra
-00016bc0: 6469 616c 3228 7365 6c66 2c20 6e63 682c  dial2(self, nch,
-00016bd0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00016be0: 2020 2020 2222 2241 7373 6967 6e20 6672      """Assign fr
-00016bf0: 6f6d 2043 6652 6164 6961 6c32 2064 6174  om CfRadial2 dat
-00016c00: 6120 7374 7275 6374 7572 652e 0a0a 2020  a structure...  
-00016c10: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00016c20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00016c30: 2d2d 2d0a 2020 2020 2020 2020 6e63 6820  ---.        nch 
-00016c40: 3a20 4e65 7443 4446 3446 696c 6520 6f62  : NetCDF4File ob
-00016c50: 6a65 6374 0a0a 2020 2020 2020 2020 4b65  ject..        Ke
-00016c60: 7977 6f72 6420 4172 6775 6d65 6e74 730a  yword Arguments.
-00016c70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016c80: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00016c90: 2020 6465 636f 6465 5f74 696d 6573 203a    decode_times :
-00016ca0: 2062 6f6f 6c0a 2020 2020 2020 2020 2020   bool.          
-00016cb0: 2020 4966 2054 7275 652c 2064 6563 6f64    If True, decod
-00016cc0: 6520 6366 2074 696d 6573 2074 6f20 6e70  e cf times to np
-00016cd0: 2e64 6174 6574 696d 6536 342e 2044 6566  .datetime64. Def
-00016ce0: 6175 6c74 7320 746f 2054 7275 652e 0a20  aults to True.. 
-00016cf0: 2020 2020 2020 2064 6563 6f64 655f 636f         decode_co
-00016d00: 6f72 6473 203a 2062 6f6f 6c0a 2020 2020  ords : bool.    
-00016d10: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00016d20: 2075 7365 2074 6865 20e2 8098 636f 6f72   use the ...coor
-00016d30: 6469 6e61 7465 73e2 8099 2061 7474 7269  dinates... attri
-00016d40: 6275 7465 206f 6e20 7661 7269 6162 6c65  bute on variable
-00016d50: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00016d60: 6173 7369 676e 2063 6f6f 7264 696e 6174  assign coordinat
-00016d70: 6573 2e20 4465 6661 756c 7473 2074 6f20  es. Defaults to 
-00016d80: 5472 7565 2e0a 2020 2020 2020 2020 6d61  True..        ma
-00016d90: 736b 5f61 6e64 5f73 6361 6c65 203a 2062  sk_and_scale : b
-00016da0: 6f6f 6c0a 2020 2020 2020 2020 2020 2020  ool.            
-00016db0: 4966 2054 7275 652c 206c 617a 696c 7920  If True, lazily 
-00016dc0: 7363 616c 6520 2875 7369 6e67 2073 6361  scale (using sca
-00016dd0: 6c65 5f66 6163 746f 7220 616e 6420 6164  le_factor and ad
-00016de0: 645f 6f66 6673 6574 290a 2020 2020 2020  d_offset).      
-00016df0: 2020 2020 2020 616e 6420 6d61 736b 2028        and mask (
-00016e00: 7573 696e 6720 5f46 696c 6c56 616c 7565  using _FillValue
-00016e10: 292e 2044 6566 6175 6c74 7320 746f 2054  ). Defaults to T
-00016e20: 7275 652e 0a20 2020 2020 2020 2063 6875  rue..        chu
-00016e30: 6e6b 7320 3a20 696e 7420 7c20 6469 6374  nks : int | dict
-00016e40: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00016e50: 2020 2020 2020 2049 6620 6368 756e 6b73         If chunks
-00016e60: 2069 7320 7072 6f76 6964 6564 2c20 6974   is provided, it
-00016e70: 2075 7365 6420 746f 206c 6f61 6420 7468   used to load th
-00016e80: 6520 6e65 7720 6461 7461 7365 7420 696e  e new dataset in
-00016e90: 746f 2064 6173 6b0a 2020 2020 2020 2020  to dask.        
-00016ea0: 2020 2020 6172 7261 7973 2e20 6368 756e      arrays. chun
-00016eb0: 6b73 3d7b 7d20 6c6f 6164 7320 7468 6520  ks={} loads the 
-00016ec0: 6461 7461 7365 7420 7769 7468 2064 6173  dataset with das
-00016ed0: 6b20 7573 696e 6720 6120 7369 6e67 6c65  k using a single
-00016ee0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00016ef0: 6e6b 2066 6f72 2061 6c6c 2061 7272 6179  nk for all array
-00016f00: 732e 0a20 2020 2020 2020 2067 656f 7265  s..        geore
-00016f10: 6620 3a20 626f 6f6c 0a20 2020 2020 2020  f : bool.       
-00016f20: 2020 2020 2049 6620 5472 7565 2c20 6164       If True, ad
-00016f30: 6473 2032 4420 4145 5144 2078 2c79 2c7a  ds 2D AEQD x,y,z
-00016f40: 2d63 6f6f 7264 696e 6174 6573 2c20 6772  -coordinates, gr
-00016f50: 6f75 6e64 5f72 616e 6765 2028 6772 2920  ound_range (gr) 
-00016f60: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00016f70: 3244 2028 7261 7973 2c62 696e 7329 2d63  2D (rays,bins)-c
-00016f80: 6f6f 7264 696e 6174 6573 2066 6f72 2065  oordinates for e
-00016f90: 6173 7920 6765 6f72 6566 6572 656e 6369  asy georeferenci
-00016fa0: 6e67 2028 6567 2e20 6361 7274 6f70 7929  ng (eg. cartopy)
-00016fb0: 0a20 2020 2020 2020 2064 696d 3020 3a20  .        dim0 : 
-00016fc0: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
-00016fd0: 6e61 6d65 206f 6620 7468 6520 7261 792d  name of the ray-
-00016fe0: 6469 6d65 6e73 696f 6e20 6f66 2044 6174  dimension of Dat
-00016ff0: 6141 7272 6179 7320 616e 6420 4461 7461  aArrays and Data
-00017000: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
-00017010: 2020 2020 202a 2060 7469 6d65 6020 2d20       * `time` - 
-00017020: 6366 7261 6469 616c 3220 7374 616e 6461  cfradial2 standa
-00017030: 7264 0a20 2020 2020 2020 2020 2020 2020  rd.             
-00017040: 2020 202a 2060 617a 696d 7574 6860 202d     * `azimuth` -
-00017050: 2062 6574 7465 7220 666f 7220 776f 726b   better for work
-00017060: 696e 6720 7769 7468 2078 6172 7261 790a  ing with xarray.
-00017070: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00017080: 2020 2020 2320 6b65 7977 6f72 6420 6172      # keyword ar
-00017090: 6775 6d65 6e74 2068 616e 646c 696e 670a  gument handling.
-000170a0: 2020 2020 2020 2020 6765 6f72 6566 203d          georef =
-000170b0: 206b 7761 7267 732e 706f 7028 2267 656f   kwargs.pop("geo
-000170c0: 7265 6622 2c20 4661 6c73 6529 0a20 2020  ref", False).   
-000170d0: 2020 2020 2064 696d 3020 3d20 6b77 6172       dim0 = kwar
-000170e0: 6773 2e70 6f70 2822 6469 6d30 222c 2022  gs.pop("dim0", "
-000170f0: 7469 6d65 2229 0a0a 2020 2020 2020 2020  time")..        
-00017100: 7365 6c66 2e72 6f6f 7420 3d20 5f6f 7065  self.root = _ope
-00017110: 6e5f 6461 7461 7365 7428 6e63 682e 6e63  n_dataset(nch.nc
-00017120: 682c 2067 7270 3d4e 6f6e 652c 202a 2a6b  h, grp=None, **k
-00017130: 7761 7267 7329 0a20 2020 2020 2020 2073  wargs).        s
-00017140: 7765 6570 6e61 6d65 7320 3d20 7365 6c66  weepnames = self
-00017150: 2e72 6f6f 742e 7377 6565 705f 6772 6f75  .root.sweep_grou
-00017160: 705f 6e61 6d65 2e76 616c 7565 730a 2020  p_name.values.  
-00017170: 2020 2020 2020 666f 7220 7377 2069 6e20        for sw in 
-00017180: 7377 6565 706e 616d 6573 3a0a 2020 2020  sweepnames:.    
-00017190: 2020 2020 2020 2020 6473 203d 205f 6f70          ds = _op
-000171a0: 656e 5f64 6174 6173 6574 286e 6368 2e6e  en_dataset(nch.n
-000171b0: 6368 2c20 6772 703d 7377 2c20 2a2a 6b77  ch, grp=sw, **kw
-000171c0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-000171d0: 2020 6473 203d 2064 732e 7377 6170 5f64    ds = ds.swap_d
-000171e0: 696d 7328 7b22 7469 6d65 223a 2064 696d  ims({"time": dim
-000171f0: 307d 290a 2020 2020 2020 2020 2020 2020  0}).            
-00017200: 636f 6f72 6473 203d 207b 0a20 2020 2020  coords = {.     
-00017210: 2020 2020 2020 2020 2020 2022 6c6f 6e67             "long
-00017220: 6974 7564 6522 3a20 7365 6c66 2e72 6f6f  itude": self.roo
-00017230: 742e 6c6f 6e67 6974 7564 652c 0a20 2020  t.longitude,.   
-00017240: 2020 2020 2020 2020 2020 2020 2022 6c61               "la
-00017250: 7469 7475 6465 223a 2073 656c 662e 726f  titude": self.ro
-00017260: 6f74 2e6c 6174 6974 7564 652c 0a20 2020  ot.latitude,.   
-00017270: 2020 2020 2020 2020 2020 2020 2022 616c               "al
-00017280: 7469 7475 6465 223a 2073 656c 662e 726f  titude": self.ro
-00017290: 6f74 2e61 6c74 6974 7564 652c 0a20 2020  ot.altitude,.   
-000172a0: 2020 2020 2020 2020 2020 2020 2022 617a               "az
-000172b0: 696d 7574 6822 3a20 6473 2e61 7a69 6d75  imuth": ds.azimu
-000172c0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-000172d0: 2020 2020 2265 6c65 7661 7469 6f6e 223a      "elevation":
-000172e0: 2064 732e 656c 6576 6174 696f 6e2c 0a20   ds.elevation,. 
-000172f0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00017300: 2020 2020 2020 2020 2064 7320 3d20 6473           ds = ds
-00017310: 2e61 7373 6967 6e5f 636f 6f72 6473 282a  .assign_coords(*
-00017320: 2a63 6f6f 7264 7329 0a0a 2020 2020 2020  *coords)..      
-00017330: 2020 2020 2020 2320 6164 6469 6e67 2078        # adding x
-00017340: 797a 2061 6571 642d 636f 6f72 6469 6e61  yz aeqd-coordina
-00017350: 7465 730a 2020 2020 2020 2020 2020 2020  tes.            
-00017360: 6966 2067 656f 7265 663a 0a20 2020 2020  if georef:.     
-00017370: 2020 2020 2020 2020 2020 2064 7320 3d20             ds = 
-00017380: 7861 7272 6179 2e67 656f 7265 6665 7265  xarray.georefere
-00017390: 6e63 655f 6461 7461 7365 7428 6473 290a  nce_dataset(ds).
-000173a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000173b0: 662e 5f73 7765 6570 735b 7377 5d20 3d20  f._sweeps[sw] = 
-000173c0: 6473 0a0a 2020 2020 6465 6620 6173 7369  ds..    def assi
-000173d0: 676e 5f64 6174 615f 7261 6469 616c 2873  gn_data_radial(s
-000173e0: 656c 662c 206e 6368 2c20 2a2a 6b77 6172  elf, nch, **kwar
-000173f0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00017400: 4173 7369 676e 2066 726f 6d20 4366 5261  Assign from CfRa
-00017410: 6469 616c 3120 6461 7461 2073 7472 7563  dial1 data struc
-00017420: 7475 7265 2e0a 0a20 2020 2020 2020 204b  ture...        K
-00017430: 6579 776f 7264 2041 7267 756d 656e 7473  eyword Arguments
-00017440: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017450: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00017460: 2020 2064 6563 6f64 655f 7469 6d65 7320     decode_times 
-00017470: 3a20 626f 6f6c 0a20 2020 2020 2020 2020  : bool.         
-00017480: 2020 2049 6620 5472 7565 2c20 6465 636f     If True, deco
-00017490: 6465 2063 6620 7469 6d65 7320 746f 206e  de cf times to n
-000174a0: 702e 6461 7465 7469 6d65 3634 2e20 4465  p.datetime64. De
-000174b0: 6661 756c 7473 2074 6f20 5472 7565 2e0a  faults to True..
-000174c0: 2020 2020 2020 2020 6465 636f 6465 5f63          decode_c
-000174d0: 6f6f 7264 7320 3a20 626f 6f6c 0a20 2020  oords : bool.   
-000174e0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
-000174f0: 2c20 7573 6520 7468 6520 e280 9863 6f6f  , use the ...coo
-00017500: 7264 696e 6174 6573 e280 9920 6174 7472  rdinates... attr
-00017510: 6962 7574 6520 6f6e 2076 6172 6961 626c  ibute on variabl
-00017520: 650a 2020 2020 2020 2020 2020 2020 746f  e.            to
-00017530: 2061 7373 6967 6e20 636f 6f72 6469 6e61   assign coordina
-00017540: 7465 732e 2044 6566 6175 6c74 7320 746f  tes. Defaults to
-00017550: 2054 7275 652e 0a20 2020 2020 2020 206d   True..        m
-00017560: 6173 6b5f 616e 645f 7363 616c 6520 3a20  ask_and_scale : 
-00017570: 626f 6f6c 0a20 2020 2020 2020 2020 2020  bool.           
-00017580: 2049 6620 5472 7565 2c20 6c61 7a69 6c79   If True, lazily
-00017590: 2073 6361 6c65 2028 7573 696e 6720 7363   scale (using sc
-000175a0: 616c 655f 6661 6374 6f72 2061 6e64 2061  ale_factor and a
-000175b0: 6464 5f6f 6666 7365 7429 0a20 2020 2020  dd_offset).     
-000175c0: 2020 2020 2020 2061 6e64 206d 6173 6b20         and mask 
-000175d0: 2875 7369 6e67 205f 4669 6c6c 5661 6c75  (using _FillValu
-000175e0: 6529 2e20 4465 6661 756c 7473 2074 6f20  e). Defaults to 
-000175f0: 5472 7565 2e0a 2020 2020 2020 2020 6368  True..        ch
-00017600: 756e 6b73 203a 2069 6e74 207c 2064 6963  unks : int | dic
-00017610: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00017620: 2020 2020 2020 2020 4966 2063 6875 6e6b          If chunk
-00017630: 7320 6973 2070 726f 7669 6465 642c 2069  s is provided, i
-00017640: 7420 7573 6564 2074 6f20 6c6f 6164 2074  t used to load t
-00017650: 6865 206e 6577 2064 6174 6173 6574 2069  he new dataset i
-00017660: 6e74 6f20 6461 736b 0a20 2020 2020 2020  nto dask.       
-00017670: 2020 2020 2061 7272 6179 732e 2063 6875       arrays. chu
-00017680: 6e6b 733d 7b7d 206c 6f61 6473 2074 6865  nks={} loads the
-00017690: 2064 6174 6173 6574 2077 6974 6820 6461   dataset with da
-000176a0: 736b 2075 7369 6e67 2061 2073 696e 676c  sk using a singl
-000176b0: 650a 2020 2020 2020 2020 2020 2020 6368  e.            ch
-000176c0: 756e 6b20 666f 7220 616c 6c20 6172 7261  unk for all arra
-000176d0: 7973 2e0a 2020 2020 2020 2020 6765 6f72  ys..        geor
-000176e0: 6566 203a 2062 6f6f 6c0a 2020 2020 2020  ef : bool.      
-000176f0: 2020 2020 2020 4966 2054 7275 652c 2061        If True, a
-00017700: 6464 7320 3244 2041 4551 4420 782c 792c  dds 2D AEQD x,y,
-00017710: 7a2d 636f 6f72 6469 6e61 7465 732c 2067  z-coordinates, g
-00017720: 726f 756e 645f 7261 6e67 6520 2867 7229  round_range (gr)
-00017730: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00017740: 2032 4420 2872 6179 732c 6269 6e73 292d   2D (rays,bins)-
-00017750: 636f 6f72 6469 6e61 7465 7320 666f 7220  coordinates for 
-00017760: 6561 7379 2067 656f 7265 6665 7265 6e63  easy georeferenc
-00017770: 696e 6720 2865 672e 2063 6172 746f 7079  ing (eg. cartopy
-00017780: 290a 2020 2020 2020 2020 6469 6d30 203a  ).        dim0 :
-00017790: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-000177a0: 206e 616d 6520 6f66 2074 6865 2072 6179   name of the ray
-000177b0: 2d64 696d 656e 7369 6f6e 206f 6620 4461  -dimension of Da
-000177c0: 7461 4172 7261 7973 2061 6e64 2044 6174  taArrays and Dat
-000177d0: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-000177e0: 2020 2020 2020 2a20 6074 696d 6560 202d        * `time` -
-000177f0: 2063 6672 6164 6961 6c32 2073 7461 6e64   cfradial2 stand
-00017800: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
-00017810: 2020 2020 2a20 6061 7a69 6d75 7468 6020      * `azimuth` 
-00017820: 2d20 6265 7474 6572 2066 6f72 2077 6f72  - better for wor
-00017830: 6b69 6e67 2077 6974 6820 7861 7272 6179  king with xarray
-00017840: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00017850: 2020 2020 2023 206b 6579 776f 7264 2061       # keyword a
-00017860: 7267 756d 656e 7420 6861 6e64 6c69 6e67  rgument handling
-00017870: 0a20 2020 2020 2020 2067 656f 7265 6620  .        georef 
-00017880: 3d20 6b77 6172 6773 2e70 6f70 2822 6765  = kwargs.pop("ge
-00017890: 6f72 6566 222c 2046 616c 7365 290a 2020  oref", False).  
-000178a0: 2020 2020 2020 6469 6d30 203d 206b 7761        dim0 = kwa
-000178b0: 7267 732e 706f 7028 2264 696d 3022 2c20  rgs.pop("dim0", 
-000178c0: 2274 696d 6522 290a 0a20 2020 2020 2020  "time")..       
-000178d0: 2072 6f6f 7420 3d20 5f6f 7065 6e5f 6461   root = _open_da
-000178e0: 7461 7365 7428 6e63 682e 6e63 682c 2067  taset(nch.nch, g
-000178f0: 7270 3d4e 6f6e 652c 202a 2a6b 7761 7267  rp=None, **kwarg
-00017900: 7329 0a20 2020 2020 2020 2076 6172 203d  s).        var =
-00017910: 2072 6f6f 742e 7661 7269 6162 6c65 732e   root.variables.
-00017920: 6b65 7973 2829 0a20 2020 2020 2020 2072  keys().        r
-00017930: 656d 6f76 655f 726f 6f74 203d 2076 6172  emove_root = var
-00017940: 205e 2072 6f6f 745f 7661 7273 0a20 2020   ^ root_vars.   
-00017950: 2020 2020 2072 656d 6f76 655f 726f 6f74       remove_root
-00017960: 2026 3d20 7661 720a 2020 2020 2020 2020   &= var.        
-00017970: 726f 6f74 3120 3d20 726f 6f74 2e64 726f  root1 = root.dro
-00017980: 705f 7661 7273 2872 656d 6f76 655f 726f  p_vars(remove_ro
-00017990: 6f74 292e 7265 6e61 6d65 287b 2266 6978  ot).rename({"fix
-000179a0: 6564 5f61 6e67 6c65 223a 2022 7377 6565  ed_angle": "swee
-000179b0: 705f 6669 7865 645f 616e 676c 6522 7d29  p_fixed_angle"})
-000179c0: 0a20 2020 2020 2020 2073 7765 6570 5f67  .        sweep_g
-000179d0: 726f 7570 5f6e 616d 6520 3d20 5b5d 0a20  roup_name = []. 
-000179e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000179f0: 7261 6e67 6528 726f 6f74 312e 6469 6d73  range(root1.dims
-00017a00: 5b22 7377 6565 7022 5d29 3a0a 2020 2020  ["sweep"]):.    
-00017a10: 2020 2020 2020 2020 7377 6565 705f 6772          sweep_gr
-00017a20: 6f75 705f 6e61 6d65 2e61 7070 656e 6428  oup_name.append(
-00017a30: 2273 7765 6570 5f7b 7d22 2e66 6f72 6d61  "sweep_{}".forma
-00017a40: 7428 6920 2b20 3129 290a 2020 2020 2020  t(i + 1)).      
-00017a50: 2020 7365 6c66 2e72 6f6f 7420 3d20 726f    self.root = ro
-00017a60: 6f74 312e 6173 7369 676e 287b 2273 7765  ot1.assign({"swe
-00017a70: 6570 5f67 726f 7570 5f6e 616d 6522 3a20  ep_group_name": 
-00017a80: 285b 2273 7765 6570 225d 2c20 7377 6565  (["sweep"], swee
-00017a90: 705f 6772 6f75 705f 6e61 6d65 297d 290a  p_group_name)}).
-00017aa0: 0a20 2020 2020 2020 206b 6565 705f 7661  .        keep_va
-00017ab0: 7273 203d 2073 7765 6570 5f76 6172 7331  rs = sweep_vars1
-00017ac0: 207c 2073 7765 6570 5f76 6172 7332 207c   | sweep_vars2 |
-00017ad0: 2073 7765 6570 5f76 6172 7333 0a20 2020   sweep_vars3.   
-00017ae0: 2020 2020 2072 656d 6f76 655f 7661 7273       remove_vars
-00017af0: 203d 2076 6172 205e 206b 6565 705f 7661   = var ^ keep_va
-00017b00: 7273 0a20 2020 2020 2020 2072 656d 6f76  rs.        remov
-00017b10: 655f 7661 7273 2026 3d20 7661 720a 2020  e_vars &= var.  
-00017b20: 2020 2020 2020 6461 7461 203d 2072 6f6f        data = roo
-00017b30: 742e 6472 6f70 5f76 6172 7328 7265 6d6f  t.drop_vars(remo
-00017b40: 7665 5f76 6172 7329 0a20 2020 2020 2020  ve_vars).       
-00017b50: 2064 6174 612e 6174 7472 7320 3d20 7b7d   data.attrs = {}
-00017b60: 0a20 2020 2020 2020 2073 7461 7274 5f69  .        start_i
-00017b70: 6478 203d 2064 6174 612e 7377 6565 705f  dx = data.sweep_
-00017b80: 7374 6172 745f 7261 795f 696e 6465 782e  start_ray_index.
-00017b90: 7661 6c75 6573 0a20 2020 2020 2020 2065  values.        e
-00017ba0: 6e64 5f69 6478 203d 2064 6174 612e 7377  nd_idx = data.sw
-00017bb0: 6565 705f 656e 645f 7261 795f 696e 6465  eep_end_ray_inde
-00017bc0: 782e 7661 6c75 6573 0a20 2020 2020 2020  x.values.       
-00017bd0: 2064 6174 6120 3d20 6461 7461 2e64 726f   data = data.dro
-00017be0: 705f 7661 7273 287b 2273 7765 6570 5f73  p_vars({"sweep_s
-00017bf0: 7461 7274 5f72 6179 5f69 6e64 6578 222c  tart_ray_index",
-00017c00: 2022 7377 6565 705f 656e 645f 7261 795f   "sweep_end_ray_
-00017c10: 696e 6465 7822 7d29 0a20 2020 2020 2020  index"}).       
-00017c20: 2066 6f72 2069 2c20 7377 2069 6e20 656e   for i, sw in en
-00017c30: 756d 6572 6174 6528 7377 6565 705f 6772  umerate(sweep_gr
-00017c40: 6f75 705f 6e61 6d65 293a 0a20 2020 2020  oup_name):.     
-00017c50: 2020 2020 2020 2074 736c 6963 6520 3d20         tslice = 
-00017c60: 736c 6963 6528 7374 6172 745f 6964 785b  slice(start_idx[
-00017c70: 695d 2c20 656e 645f 6964 785b 695d 290a  i], end_idx[i]).
-00017c80: 2020 2020 2020 2020 2020 2020 6473 203d              ds =
-00017c90: 2064 6174 612e 6973 656c 2874 696d 653d   data.isel(time=
-00017ca0: 7473 6c69 6365 2c20 7377 6565 703d 736c  tslice, sweep=sl
-00017cb0: 6963 6528 692c 2069 202b 2031 2929 2e73  ice(i, i + 1)).s
-00017cc0: 7175 6565 7a65 2822 7377 6565 7022 290a  queeze("sweep").
-00017cd0: 2020 2020 2020 2020 2020 2020 6473 203d              ds =
-00017ce0: 2064 732e 7377 6170 5f64 696d 7328 7b22   ds.swap_dims({"
-00017cf0: 7469 6d65 223a 2064 696d 307d 290a 2020  time": dim0}).  
-00017d00: 2020 2020 2020 2020 2020 6473 2e73 7765            ds.swe
-00017d10: 6570 5f6d 6f64 652e 6c6f 6164 2829 0a20  ep_mode.load(). 
-00017d20: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00017d30: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00017d40: 2020 2020 2020 226c 6f6e 6769 7475 6465        "longitude
-00017d50: 223a 2073 656c 662e 726f 6f74 2e6c 6f6e  ": self.root.lon
-00017d60: 6769 7475 6465 2c0a 2020 2020 2020 2020  gitude,.        
-00017d70: 2020 2020 2020 2020 226c 6174 6974 7564          "latitud
-00017d80: 6522 3a20 7365 6c66 2e72 6f6f 742e 6c61  e": self.root.la
-00017d90: 7469 7475 6465 2c0a 2020 2020 2020 2020  titude,.        
-00017da0: 2020 2020 2020 2020 2261 6c74 6974 7564          "altitud
-00017db0: 6522 3a20 7365 6c66 2e72 6f6f 742e 616c  e": self.root.al
-00017dc0: 7469 7475 6465 2c0a 2020 2020 2020 2020  titude,.        
-00017dd0: 2020 2020 2020 2020 2261 7a69 6d75 7468          "azimuth
-00017de0: 223a 2064 732e 617a 696d 7574 682c 0a20  ": ds.azimuth,. 
-00017df0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017e00: 656c 6576 6174 696f 6e22 3a20 6473 2e65  elevation": ds.e
-00017e10: 6c65 7661 7469 6f6e 2c0a 2020 2020 2020  levation,.      
-00017e20: 2020 2020 2020 2020 2020 2273 7765 6570            "sweep
-00017e30: 5f6d 6f64 6522 3a20 6473 2e73 7765 6570  _mode": ds.sweep
-00017e40: 5f6d 6f64 652e 6974 656d 2829 2e64 6563  _mode.item().dec
-00017e50: 6f64 6528 292c 0a20 2020 2020 2020 2020  ode(),.         
-00017e60: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00017e70: 2064 7320 3d20 6473 2e61 7373 6967 6e5f   ds = ds.assign_
-00017e80: 636f 6f72 6473 282a 2a63 6f6f 7264 7329  coords(**coords)
-00017e90: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00017ea0: 6164 6469 6e67 2078 797a 2061 6571 642d  adding xyz aeqd-
-00017eb0: 636f 6f72 6469 6e61 7465 730a 2020 2020  coordinates.    
-00017ec0: 2020 2020 2020 2020 6966 2067 656f 7265          if geore
-00017ed0: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
-00017ee0: 2020 2064 7320 3d20 7861 7272 6179 2e67     ds = xarray.g
-00017ef0: 656f 7265 6665 7265 6e63 655f 6461 7461  eoreference_data
-00017f00: 7365 7428 6473 290a 0a20 2020 2020 2020  set(ds)..       
-00017f10: 2020 2020 2073 656c 662e 5f73 7765 6570       self._sweep
-00017f20: 735b 7377 5d20 3d20 6473 0a0a 0a63 6c61  s[sw] = ds...cla
-00017f30: 7373 204f 6469 6d48 3528 5852 6164 566f  ss OdimH5(XRadVo
-00017f40: 6c29 3a0a 2020 2020 2222 2243 6c61 7373  l):.    """Class
-00017f50: 2066 6f72 2078 6172 7261 7920 6261 7365   for xarray base
-00017f60: 6420 7265 7472 6965 7661 6c20 6f66 204f  d retrieval of O
-00017f70: 4449 4d5f 4835 2064 6174 6120 6669 6c65  DIM_H5 data file
-00017f80: 7322 2222 0a0a 2020 2020 6465 6620 5f5f  s"""..    def __
-00017f90: 696e 6974 5f5f 2873 656c 662c 2066 696c  init__(self, fil
-00017fa0: 656e 616d 653d 4e6f 6e65 2c20 666c 6176  ename=None, flav
-00017fb0: 6f75 723d 4e6f 6e65 2c20 2a2a 6b77 6172  our=None, **kwar
-00017fc0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00017fd0: 496e 6974 6961 6c69 7a65 2078 6172 7261  Initialize xarra
-00017fe0: 7920 7374 7275 6374 7572 6520 6672 6f6d  y structure from
-00017ff0: 2068 6466 3520 6461 7461 2073 7472 7563   hdf5 data struc
-00018000: 7475 7265 2e0a 0a20 2020 2020 2020 2050  ture...        P
-00018010: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00018020: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00018030: 2020 2020 2066 696c 656e 616d 6520 3a20       filename : 
-00018040: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
-00018050: 536f 7572 6365 2064 6174 6120 6669 6c65  Source data file
-00018060: 206e 616d 652e 0a20 2020 2020 2020 2066   name..        f
-00018070: 6c61 766f 7572 203a 2073 7472 0a20 2020  lavour : str.   
-00018080: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-00018090: 2068 6466 3520 666c 6176 6f75 7220 2827   hdf5 flavour ('
-000180a0: 4f44 494d 2720 6f72 2027 4741 4d49 4327  ODIM' or 'GAMIC'
-000180b0: 292e 2044 6566 6175 6c74 7320 746f 2027  ). Defaults to '
-000180c0: 4f44 494d 272e 0a0a 2020 2020 2020 2020  ODIM'...        
-000180d0: 4b65 7977 6f72 6420 4172 6775 6d65 6e74  Keyword Argument
-000180e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000180f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00018100: 2020 2020 6465 636f 6465 5f74 696d 6573      decode_times
-00018110: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
-00018120: 2020 2020 4966 2054 7275 652c 2064 6563      If True, dec
-00018130: 6f64 6520 6366 2074 696d 6573 2074 6f20  ode cf times to 
-00018140: 6e70 2e64 6174 6574 696d 6536 342e 2044  np.datetime64. D
-00018150: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
-00018160: 0a20 2020 2020 2020 2064 6563 6f64 655f  .        decode_
-00018170: 636f 6f72 6473 203a 2062 6f6f 6c0a 2020  coords : bool.  
-00018180: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00018190: 652c 2075 7365 2074 6865 20e2 8098 636f  e, use the ...co
-000181a0: 6f72 6469 6e61 7465 73e2 8099 2061 7474  ordinates... att
-000181b0: 7269 6275 7465 206f 6e20 7661 7269 6162  ribute on variab
-000181c0: 6c65 0a20 2020 2020 2020 2020 2020 2074  le.            t
-000181d0: 6f20 6173 7369 676e 2063 6f6f 7264 696e  o assign coordin
-000181e0: 6174 6573 2e20 4465 6661 756c 7473 2074  ates. Defaults t
-000181f0: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
-00018200: 6d61 736b 5f61 6e64 5f73 6361 6c65 203a  mask_and_scale :
-00018210: 2062 6f6f 6c0a 2020 2020 2020 2020 2020   bool.          
-00018220: 2020 4966 2054 7275 652c 206c 617a 696c    If True, lazil
-00018230: 7920 7363 616c 6520 2875 7369 6e67 2073  y scale (using s
-00018240: 6361 6c65 5f66 6163 746f 7220 616e 6420  cale_factor and 
-00018250: 6164 645f 6f66 6673 6574 290a 2020 2020  add_offset).    
-00018260: 2020 2020 2020 2020 616e 6420 6d61 736b          and mask
-00018270: 2028 7573 696e 6720 5f46 696c 6c56 616c   (using _FillVal
-00018280: 7565 292e 2044 6566 6175 6c74 7320 746f  ue). Defaults to
-00018290: 2054 7275 652e 0a20 2020 2020 2020 2063   True..        c
-000182a0: 6875 6e6b 7320 3a20 696e 7420 7c20 6469  hunks : int | di
-000182b0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
-000182c0: 2020 2020 2020 2020 2049 6620 6368 756e           If chun
-000182d0: 6b73 2069 7320 7072 6f76 6964 6564 2c20  ks is provided, 
-000182e0: 6974 2075 7365 6420 746f 206c 6f61 6420  it used to load 
-000182f0: 7468 6520 6e65 7720 6461 7461 7365 7420  the new dataset 
-00018300: 696e 746f 2064 6173 6b0a 2020 2020 2020  into dask.      
-00018310: 2020 2020 2020 6172 7261 7973 2e20 6368        arrays. ch
-00018320: 756e 6b73 3d7b 7d20 6c6f 6164 7320 7468  unks={} loads th
-00018330: 6520 6461 7461 7365 7420 7769 7468 2064  e dataset with d
-00018340: 6173 6b20 7573 696e 6720 6120 7369 6e67  ask using a sing
-00018350: 6c65 0a20 2020 2020 2020 2020 2020 2063  le.            c
-00018360: 6875 6e6b 2066 6f72 2061 6c6c 2061 7272  hunk for all arr
-00018370: 6179 732e 0a20 2020 2020 2020 2067 656f  ays..        geo
-00018380: 7265 6620 3a20 626f 6f6c 0a20 2020 2020  ref : bool.     
-00018390: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-000183a0: 6164 6473 2032 4420 4145 5144 2078 2c79  adds 2D AEQD x,y
-000183b0: 2c7a 2d63 6f6f 7264 696e 6174 6573 2c20  ,z-coordinates, 
-000183c0: 6772 6f75 6e64 5f72 616e 6765 2028 6772  ground_range (gr
-000183d0: 2920 616e 640a 2020 2020 2020 2020 2020  ) and.          
-000183e0: 2020 3244 2028 7261 7973 2c62 696e 7329    2D (rays,bins)
-000183f0: 2d63 6f6f 7264 696e 6174 6573 2066 6f72  -coordinates for
-00018400: 2065 6173 7920 6765 6f72 6566 6572 656e   easy georeferen
-00018410: 6369 6e67 2028 6567 2e20 6361 7274 6f70  cing (eg. cartop
-00018420: 7929 0a20 2020 2020 2020 2073 7461 6e64  y).        stand
-00018430: 6172 6420 3a20 7374 720a 2020 2020 2020  ard : str.      
-00018440: 2020 2020 2020 2a20 606e 6f6e 6560 202d        * `none` -
-00018450: 2064 6174 6120 6973 2072 6561 6420 6173   data is read as
-00018460: 2076 6572 6261 7469 6d20 6173 2070 6f73   verbatim as pos
-00018470: 7369 626c 652c 206e 6f20 6d65 7461 6461  sible, no metada
-00018480: 7461 0a20 2020 2020 2020 2020 2020 202a  ta.            *
-00018490: 2060 6f64 696d 6020 2d20 6461 7461 2069   `odim` - data i
-000184a0: 7320 7265 6164 2c20 6f64 696d 206d 6574  s read, odim met
-000184b0: 6164 6174 6120 6164 6465 6420 746f 2064  adata added to d
-000184c0: 6174 6173 6574 730a 2020 2020 2020 2020  atasets.        
-000184d0: 2020 2020 2a20 6063 662d 6d61 6e64 6174      * `cf-mandat
-000184e0: 6f72 7960 202d 2064 6174 6120 6973 2072  ory` - data is r
-000184f0: 6561 6420 6163 636f 7264 696e 6720 746f  ead according to
-00018500: 2063 6672 6164 6961 6c32 2073 7461 6e64   cfradial2 stand
-00018510: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
-00018520: 2020 696d 706f 7274 696e 6720 6d61 6e64    importing mand
-00018530: 6174 6f72 7920 6d65 7461 6461 7461 0a20  atory metadata. 
-00018540: 2020 2020 2020 2020 2020 202a 2060 6366             * `cf
-00018550: 2d66 756c 6c60 202d 2064 6174 6120 6973  -full` - data is
-00018560: 2072 6561 6420 6163 636f 7264 696e 6720   read according 
-00018570: 746f 2063 6672 6164 6961 6c32 2073 7461  to cfradial2 sta
-00018580: 6e64 6172 640a 2020 2020 2020 2020 2020  ndard.          
-00018590: 2020 2020 696d 706f 7274 696e 6720 616c      importing al
-000185a0: 6c20 6176 6169 6c61 626c 6520 6366 7261  l available cfra
-000185b0: 6469 616c 3220 6d65 7461 6461 7461 2028  dial2 metadata (
-000185c0: 6e6f 7420 6675 6c6c 790a 2020 2020 2020  not fully.      
-000185d0: 2020 2020 2020 2020 696d 706c 656d 656e          implemen
-000185e0: 7465 6429 0a20 2020 2020 2020 2064 696d  ted).        dim
-000185f0: 3020 3a20 7374 720a 2020 2020 2020 2020  0 : str.        
-00018600: 2020 2020 6e61 6d65 206f 6620 7468 6520      name of the 
-00018610: 7261 792d 6469 6d65 6e73 696f 6e20 6f66  ray-dimension of
-00018620: 2044 6174 6141 7272 6179 7320 616e 6420   DataArrays and 
-00018630: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-00018640: 2020 2020 2020 2020 202a 2060 7469 6d65           * `time
-00018650: 6020 2d20 6366 7261 6469 616c 3220 7374  ` - cfradial2 st
-00018660: 616e 6461 7264 0a20 2020 2020 2020 2020  andard.         
-00018670: 2020 2020 2020 202a 2060 617a 696d 7574         * `azimut
-00018680: 6860 202d 2062 6574 7465 7220 666f 7220  h` - better for 
-00018690: 776f 726b 696e 6720 7769 7468 2078 6172  working with xar
-000186a0: 7261 790a 2020 2020 2020 2020 2222 220a  ray.        """.
-000186b0: 2020 2020 2020 2020 7375 7065 7228 4f64          super(Od
-000186c0: 696d 4835 2c20 7365 6c66 292e 5f5f 696e  imH5, self).__in
-000186d0: 6974 5f5f 2829 0a0a 2020 2020 2020 2020  it__()..        
-000186e0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-000186f0: 6528 6669 6c65 6e61 6d65 2c20 6c69 7374  e(filename, list
-00018700: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-00018710: 696c 656e 616d 6520 3d20 5b66 696c 656e  ilename = [filen
-00018720: 616d 655d 0a0a 2020 2020 2020 2020 6966  ame]..        if
-00018730: 206c 656e 2866 696c 656e 616d 6529 203d   len(filename) =
-00018740: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00018750: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00018760: 7228 2246 696c 6520 6c69 7374 2065 6d70  r("File list emp
-00018770: 7479 2229 0a0a 2020 2020 2020 2020 666f  ty")..        fo
-00018780: 7220 6620 696e 2066 696c 656e 616d 653a  r f in filename:
-00018790: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000187a0: 662e 6173 7369 676e 5f64 6174 6128 662c  f.assign_data(f,
-000187b0: 2066 6c61 766f 7572 3d66 6c61 766f 7572   flavour=flavour
-000187c0: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-000187d0: 2020 2020 2069 6620 2263 6622 2069 6e20       if "cf" in 
-000187e0: 6b77 6172 6773 2e67 6574 2822 7374 616e  kwargs.get("stan
-000187f0: 6461 7264 222c 2022 6366 2d6d 616e 6461  dard", "cf-manda
-00018800: 746f 7279 2229 3a0a 2020 2020 2020 2020  tory"):.        
-00018810: 2020 2020 7365 6c66 2e61 7373 6967 6e5f      self.assign_
-00018820: 726f 6f74 2829 0a0a 2020 2020 6465 6620  root()..    def 
-00018830: 6173 7369 676e 5f64 6174 6128 7365 6c66  assign_data(self
-00018840: 2c20 6669 6c65 6e61 6d65 2c20 666c 6176  , filename, flav
-00018850: 6f75 723d 4e6f 6e65 2c20 2a2a 6b77 6172  our=None, **kwar
-00018860: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00018870: 4173 7369 676e 2078 6172 7261 7920 6461  Assign xarray da
-00018880: 7461 7365 7420 6672 6f6d 2068 6466 3520  taset from hdf5 
-00018890: 6461 7461 2073 7472 7563 7475 7265 2e0a  data structure..
-000188a0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000188b0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-000188c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-000188d0: 696c 656e 616d 6520 3a20 7374 720a 2020  ilename : str.  
-000188e0: 2020 2020 2020 2020 2020 536f 7572 6365            Source
-000188f0: 2064 6174 6120 6669 6c65 206e 616d 652e   data file name.
-00018900: 0a20 2020 2020 2020 2066 6c61 766f 7572  .        flavour
-00018910: 203a 2073 7472 0a20 2020 2020 2020 2020   : str.         
-00018920: 2020 204e 616d 6520 6f66 2068 6466 3520     Name of hdf5 
-00018930: 666c 6176 6f75 7220 2827 4f44 494d 2720  flavour ('ODIM' 
-00018940: 6f72 2027 4741 4d49 4327 292e 2044 6566  or 'GAMIC'). Def
-00018950: 6175 6c74 7320 746f 2027 4f44 494d 272e  aults to 'ODIM'.
-00018960: 0a0a 2020 2020 2020 2020 4b65 7977 6f72  ..        Keywor
-00018970: 6420 4172 6775 6d65 6e74 730a 2020 2020  d Arguments.    
-00018980: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00018990: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6465  -----.        de
-000189a0: 636f 6465 5f74 696d 6573 203a 2062 6f6f  code_times : boo
-000189b0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-000189c0: 2054 7275 652c 2064 6563 6f64 6520 6366   True, decode cf
-000189d0: 2074 696d 6573 2074 6f20 6e70 2e64 6174   times to np.dat
-000189e0: 6574 696d 6536 342e 2044 6566 6175 6c74  etime64. Default
-000189f0: 7320 746f 2054 7275 652e 0a20 2020 2020  s to True..     
-00018a00: 2020 2064 6563 6f64 655f 636f 6f72 6473     decode_coords
-00018a10: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
-00018a20: 2020 2020 4966 2054 7275 652c 2075 7365      If True, use
-00018a30: 2074 6865 20e2 8098 636f 6f72 6469 6e61   the ...coordina
-00018a40: 7465 73e2 8099 2061 7474 7269 6275 7465  tes... attribute
-00018a50: 206f 6e20 7661 7269 6162 6c65 0a20 2020   on variable.   
-00018a60: 2020 2020 2020 2020 2074 6f20 6173 7369           to assi
-00018a70: 676e 2063 6f6f 7264 696e 6174 6573 2e20  gn coordinates. 
-00018a80: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
-00018a90: 2e0a 2020 2020 2020 2020 6d61 736b 5f61  ..        mask_a
-00018aa0: 6e64 5f73 6361 6c65 203a 2062 6f6f 6c0a  nd_scale : bool.
-00018ab0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00018ac0: 7275 652c 206c 617a 696c 7920 7363 616c  rue, lazily scal
-00018ad0: 6520 2875 7369 6e67 2073 6361 6c65 5f66  e (using scale_f
-00018ae0: 6163 746f 7220 616e 6420 6164 645f 6f66  actor and add_of
-00018af0: 6673 6574 290a 2020 2020 2020 2020 2020  fset).          
-00018b00: 2020 616e 6420 6d61 736b 2028 7573 696e    and mask (usin
-00018b10: 6720 5f46 696c 6c56 616c 7565 292e 2044  g _FillValue). D
-00018b20: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
-00018b30: 0a20 2020 2020 2020 2063 6875 6e6b 7320  .        chunks 
-00018b40: 3a20 696e 7420 7c20 6469 6374 2c20 6f70  : int | dict, op
-00018b50: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00018b60: 2020 2049 6620 6368 756e 6b73 2069 7320     If chunks is 
-00018b70: 7072 6f76 6964 6564 2c20 6974 2075 7365  provided, it use
-00018b80: 6420 746f 206c 6f61 6420 7468 6520 6e65  d to load the ne
-00018b90: 7720 6461 7461 7365 7420 696e 746f 2064  w dataset into d
-00018ba0: 6173 6b0a 2020 2020 2020 2020 2020 2020  ask.            
-00018bb0: 6172 7261 7973 2e20 6368 756e 6b73 3d7b  arrays. chunks={
-00018bc0: 7d20 6c6f 6164 7320 7468 6520 6461 7461  } loads the data
-00018bd0: 7365 7420 7769 7468 2064 6173 6b20 7573  set with dask us
-00018be0: 696e 6720 6120 7369 6e67 6c65 0a20 2020  ing a single.   
-00018bf0: 2020 2020 2020 2020 2063 6875 6e6b 2066           chunk f
-00018c00: 6f72 2061 6c6c 2061 7272 6179 732e 0a20  or all arrays.. 
-00018c10: 2020 2020 2020 2067 656f 7265 6620 3a20         georef : 
-00018c20: 626f 6f6c 0a20 2020 2020 2020 2020 2020  bool.           
-00018c30: 2049 6620 5472 7565 2c20 6164 6473 2032   If True, adds 2
-00018c40: 4420 4145 5144 2078 2c79 2c7a 2d63 6f6f  D AEQD x,y,z-coo
-00018c50: 7264 696e 6174 6573 2c20 6772 6f75 6e64  rdinates, ground
-00018c60: 5f72 616e 6765 2028 6772 2920 616e 640a  _range (gr) and.
-00018c70: 2020 2020 2020 2020 2020 2020 3244 2028              2D (
-00018c80: 7261 7973 2c62 696e 7329 2d63 6f6f 7264  rays,bins)-coord
-00018c90: 696e 6174 6573 2066 6f72 2065 6173 7920  inates for easy 
-00018ca0: 6765 6f72 6566 6572 656e 6369 6e67 2028  georeferencing (
-00018cb0: 6567 2e20 6361 7274 6f70 7929 2e0a 2020  eg. cartopy)..  
-00018cc0: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
-00018cd0: 7473 2074 6f20 4661 6c73 652e 0a20 2020  ts to False..   
-00018ce0: 2020 2020 2073 7461 6e64 6172 6420 3a20       standard : 
-00018cf0: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
-00018d00: 2a20 606e 6f6e 6560 202d 2064 6174 6120  * `none` - data 
-00018d10: 6973 2072 6561 6420 6173 2076 6572 6261  is read as verba
-00018d20: 7469 6d20 6173 2070 6f73 7369 626c 652c  tim as possible,
-00018d30: 206e 6f20 6d65 7461 6461 7461 0a20 2020   no metadata.   
-00018d40: 2020 2020 2020 2020 202a 2060 6f64 696d           * `odim
-00018d50: 6020 2d20 6461 7461 2069 7320 7265 6164  ` - data is read
-00018d60: 2c20 6f64 696d 206d 6574 6164 6174 6120  , odim metadata 
-00018d70: 6164 6465 6420 746f 2064 6174 6173 6574  added to dataset
-00018d80: 730a 2020 2020 2020 2020 2020 2020 2a20  s.            * 
-00018d90: 6063 662d 6d61 6e64 6174 6f72 7960 202d  `cf-mandatory` -
-00018da0: 2064 6174 6120 6973 2072 6561 6420 6163   data is read ac
-00018db0: 636f 7264 696e 6720 746f 2063 6672 6164  cording to cfrad
-00018dc0: 6961 6c32 2073 7461 6e64 6172 640a 2020  ial2 standard.  
-00018dd0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00018de0: 7274 696e 6720 6d61 6e64 6174 6f72 7920  rting mandatory 
-00018df0: 6d65 7461 6461 7461 2c20 6465 6661 756c  metadata, defaul
-00018e00: 7420 7661 6c75 650a 2020 2020 2020 2020  t value.        
-00018e10: 2020 2020 2a20 6063 662d 6675 6c6c 6020      * `cf-full` 
-00018e20: 2d20 6461 7461 2069 7320 7265 6164 2061  - data is read a
-00018e30: 6363 6f72 6469 6e67 2074 6f20 6366 7261  ccording to cfra
-00018e40: 6469 616c 3220 7374 616e 6461 7264 0a20  dial2 standard. 
-00018e50: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
-00018e60: 6f72 7469 6e67 2061 6c6c 2061 7661 696c  orting all avail
-00018e70: 6162 6c65 2063 6672 6164 6961 6c32 206d  able cfradial2 m
-00018e80: 6574 6164 6174 6120 286e 6f74 2066 756c  etadata (not ful
-00018e90: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
-00018ea0: 2069 6d70 6c65 6d65 6e74 6564 290a 2020   implemented).  
-00018eb0: 2020 2020 2020 6469 6d30 203a 2073 7472        dim0 : str
-00018ec0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00018ed0: 6520 6f66 2074 6865 2072 6179 2d64 696d  e of the ray-dim
-00018ee0: 656e 7369 6f6e 206f 6620 4461 7461 4172  ension of DataAr
-00018ef0: 7261 7973 2061 6e64 2044 6174 6173 6574  rays and Dataset
-00018f00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018f10: 2020 2a20 6074 696d 6560 202d 2063 6672    * `time` - cfr
-00018f20: 6164 6961 6c32 2073 7461 6e64 6172 642c  adial2 standard,
-00018f30: 2064 6566 6175 6c74 2076 616c 7565 0a20   default value. 
-00018f40: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-00018f50: 2060 617a 696d 7574 6860 202d 2062 6574   `azimuth` - bet
-00018f60: 7465 7220 666f 7220 776f 726b 696e 6720  ter for working 
-00018f70: 7769 7468 2078 6172 7261 790a 2020 2020  with xarray.    
-00018f80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00018f90: 6e63 6820 3d20 4f64 696d 4835 4669 6c65  nch = OdimH5File
-00018fa0: 2866 696c 656e 616d 652c 2066 6c61 766f  (filename, flavo
-00018fb0: 7572 3d66 6c61 766f 7572 290a 2020 2020  ur=flavour).    
-00018fc0: 2020 2020 7365 6c66 2e5f 6e63 682e 6170      self._nch.ap
-00018fd0: 7065 6e64 286e 6368 290a 0a20 2020 2020  pend(nch)..     
-00018fe0: 2020 2023 206b 6579 776f 7264 2061 7267     # keyword arg
-00018ff0: 756d 656e 7420 6861 6e64 6c69 6e67 0a20  ument handling. 
-00019000: 2020 2020 2020 2064 6563 6f64 655f 7469         decode_ti
-00019010: 6d65 7320 3d20 6b77 6172 6773 2e67 6574  mes = kwargs.get
-00019020: 2822 6465 636f 6465 5f74 696d 6573 222c  ("decode_times",
-00019030: 2054 7275 6529 0a20 2020 2020 2020 2064   True).        d
-00019040: 6563 6f64 655f 636f 6f72 6473 203d 206b  ecode_coords = k
-00019050: 7761 7267 732e 6765 7428 2264 6563 6f64  wargs.get("decod
-00019060: 655f 636f 6f72 6473 222c 2054 7275 6529  e_coords", True)
-00019070: 0a20 2020 2020 2020 206d 6173 6b5f 616e  .        mask_an
-00019080: 645f 7363 616c 6520 3d20 6b77 6172 6773  d_scale = kwargs
-00019090: 2e67 6574 2822 6d61 736b 5f61 6e64 5f73  .get("mask_and_s
-000190a0: 6361 6c65 222c 2054 7275 6529 0a20 2020  cale", True).   
-000190b0: 2020 2020 2067 656f 7265 6620 3d20 6b77       georef = kw
-000190c0: 6172 6773 2e67 6574 2822 6765 6f72 6566  args.get("georef
-000190d0: 222c 2046 616c 7365 290a 2020 2020 2020  ", False).      
-000190e0: 2020 7374 616e 6461 7264 203d 206b 7761    standard = kwa
-000190f0: 7267 732e 6765 7428 2273 7461 6e64 6172  rgs.get("standar
-00019100: 6422 2c20 2263 662d 6d61 6e64 6174 6f72  d", "cf-mandator
-00019110: 7922 290a 2020 2020 2020 2020 6469 6d30  y").        dim0
-00019120: 203d 206b 7761 7267 732e 6765 7428 2264   = kwargs.get("d
-00019130: 696d 3022 2c20 2274 696d 6522 290a 0a20  im0", "time").. 
-00019140: 2020 2020 2020 2023 2072 6574 7269 6576         # retriev
-00019150: 6520 616e 6420 6173 7369 676e 2067 6c6f  e and assign glo
-00019160: 6261 6c20 6772 6f75 7073 202f 686f 772c  bal groups /how,
-00019170: 202f 7768 6174 2c20 2f77 6865 7265 0a20   /what, /where. 
-00019180: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
-00019190: 5b22 686f 7722 2c20 2277 6861 7422 2c20  ["how", "what", 
-000191a0: 2277 6865 7265 225d 0a20 2020 2020 2020  "where"].       
-000191b0: 2068 6f77 2c20 7768 6174 2c20 7768 6572   how, what, wher
-000191c0: 6520 3d20 5f67 6574 5f6f 6469 6d5f 6772  e = _get_odim_gr
-000191d0: 6f75 7073 286e 6368 2e6e 6368 2c20 6772  oups(nch.nch, gr
-000191e0: 6f75 7073 290a 2020 2020 2020 2020 7274  oups).        rt
-000191f0: 5f67 7270 7320 3d20 7b22 686f 7722 3a20  _grps = {"how": 
-00019200: 686f 772c 2022 7768 6174 223a 2077 6861  how, "what": wha
-00019210: 742c 2022 7768 6572 6522 3a20 7768 6572  t, "where": wher
-00019220: 657d 0a0a 2020 2020 2020 2020 2320 7377  e}..        # sw
-00019230: 6565 7020 6772 6f75 7020 6861 6e64 6c69  eep group handli
-00019240: 6e67 0a20 2020 2020 2020 2028 7372 635f  ng.        (src_
-00019250: 7377 705f 6772 705f 6e61 6d65 2c20 7377  swp_grp_name, sw
-00019260: 705f 6772 705f 6e61 6d65 2920 3d20 5f67  p_grp_name) = _g
-00019270: 6574 5f6f 6469 6d5f 7377 6565 705f 6772  et_odim_sweep_gr
-00019280: 6f75 705f 6e61 6d65 7328 0a20 2020 2020  oup_names(.     
-00019290: 2020 2020 2020 206e 6368 2e6e 6368 2c20         nch.nch, 
-000192a0: 6e63 682e 5f64 7364 6573 630a 2020 2020  nch._dsdesc.    
-000192b0: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-000192c0: 2069 7465 7261 7465 2073 7765 6570 7320   iterate sweeps 
-000192d0: 696e 2066 696c 650a 2020 2020 2020 2020  in file.        
-000192e0: 666f 7220 692c 2073 7765 6570 2069 6e20  for i, sweep in 
-000192f0: 656e 756d 6572 6174 6528 7372 635f 7377  enumerate(src_sw
-00019300: 705f 6772 705f 6e61 6d65 293a 0a20 2020  p_grp_name):.   
-00019310: 2020 2020 2020 2020 2023 2072 6574 7269           # retri
-00019320: 6576 6520 6473 2061 6e64 2061 7373 6967  eve ds and assig
-00019330: 6e20 6461 7461 7365 7458 2068 6f77 2f77  n datasetX how/w
-00019340: 6861 742f 7768 6572 6520 6772 6f75 7020  hat/where group 
-00019350: 6174 7472 6962 7574 6573 0a20 2020 2020  attributes.     
-00019360: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
-00019370: 5b4e 6f6e 652c 2022 686f 7722 2c20 2277  [None, "how", "w
-00019380: 6861 7422 2c20 2277 6865 7265 225d 0a20  hat", "where"]. 
-00019390: 2020 2020 2020 2020 2020 2064 732c 2064             ds, d
-000193a0: 735f 686f 772c 2064 735f 7768 6174 2c20  s_how, ds_what, 
-000193b0: 6473 5f77 6865 7265 203d 205f 6765 745f  ds_where = _get_
-000193c0: 6f64 696d 5f67 726f 7570 7328 6e63 682e  odim_groups(nch.
-000193d0: 6e63 685b 7377 6565 705d 2c20 6772 6f75  nch[sweep], grou
-000193e0: 7073 290a 2020 2020 2020 2020 2020 2020  ps).            
-000193f0: 6473 5f67 7270 7320 3d20 7b22 686f 7722  ds_grps = {"how"
-00019400: 3a20 6473 5f68 6f77 2c20 2277 6861 7422  : ds_how, "what"
-00019410: 3a20 6473 5f77 6861 742c 2022 7768 6572  : ds_what, "wher
-00019420: 6522 3a20 6473 5f77 6865 7265 7d0a 0a20  e": ds_where}.. 
-00019430: 2020 2020 2020 2020 2020 2023 206d 6f6d             # mom
-00019440: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-00019450: 2064 7320 3d20 5f61 7373 6967 6e5f 6f64   ds = _assign_od
-00019460: 696d 5f6d 6f6d 656e 7473 2864 732c 206e  im_moments(ds, n
-00019470: 6368 2c20 7377 6565 702c 202a 2a6b 7761  ch, sweep, **kwa
-00019480: 7267 7329 0a0a 2020 2020 2020 2020 2020  rgs)..          
-00019490: 2020 2320 7265 7472 6965 7665 2061 6e64    # retrieve and
-000194a0: 2061 7373 6967 6e20 6761 6d69 6320 7261   assign gamic ra
-000194b0: 795f 6865 6164 6572 0a20 2020 2020 2020  y_header.       
-000194c0: 2020 2020 2069 6620 6e63 682e 666c 6176       if nch.flav
-000194d0: 6f75 7220 3d3d 2022 4741 4d49 4322 3a0a  our == "GAMIC":.
-000194e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194f0: 7268 203d 205f 6765 745f 6761 6d69 635f  rh = _get_gamic_
-00019500: 7261 795f 6865 6164 6572 286e 6368 2e66  ray_header(nch.f
-00019510: 696c 656e 616d 652c 2069 290a 2020 2020  ilename, i).    
-00019520: 2020 2020 2020 2020 2020 2020 6473 5f67              ds_g
-00019530: 7270 735b 2277 6861 7422 5d20 3d20 6473  rps["what"] = ds
-00019540: 5f67 7270 735b 2277 6861 7422 5d2e 6173  _grps["what"].as
-00019550: 7369 676e 2872 6829 0a0a 2020 2020 2020  sign(rh)..      
-00019560: 2020 2020 2020 2320 636f 6f72 6469 6e61        # coordina
-00019570: 7465 7320 7772 6170 2d75 700a 2020 2020  tes wrap-up.    
-00019580: 2020 2020 2020 2020 7661 7273 203d 2063          vars = c
-00019590: 6f6c 6c65 6374 696f 6e73 2e4f 7264 6572  ollections.Order
-000195a0: 6564 4469 6374 2829 0a20 2020 2020 2020  edDict().       
-000195b0: 2020 2020 2063 6f6f 7264 7320 3d20 636f       coords = co
-000195c0: 6c6c 6563 7469 6f6e 732e 4f72 6465 7265  llections.Ordere
-000195d0: 6444 6963 7428 290a 2020 2020 2020 2020  dDict().        
-000195e0: 2020 2020 6966 2022 6366 2220 696e 2073      if "cf" in s
-000195f0: 7461 6e64 6172 6420 6f72 2067 656f 7265  tandard or geore
-00019600: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
-00019610: 2020 2063 6f6f 7264 735b 226c 6f6e 6769     coords["longi
-00019620: 7475 6465 225d 203d 2072 745f 6772 7073  tude"] = rt_grps
-00019630: 5b22 7768 6572 6522 5d2e 6174 7472 735b  ["where"].attrs[
-00019640: 226c 6f6e 225d 0a20 2020 2020 2020 2020  "lon"].         
-00019650: 2020 2020 2020 2063 6f6f 7264 735b 226c         coords["l
-00019660: 6174 6974 7564 6522 5d20 3d20 7274 5f67  atitude"] = rt_g
-00019670: 7270 735b 2277 6865 7265 225d 2e61 7474  rps["where"].att
-00019680: 7273 5b22 6c61 7422 5d0a 2020 2020 2020  rs["lat"].      
-00019690: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
-000196a0: 5b22 616c 7469 7475 6465 225d 203d 2072  ["altitude"] = r
-000196b0: 745f 6772 7073 5b22 7768 6572 6522 5d2e  t_grps["where"].
-000196c0: 6174 7472 735b 2268 6569 6768 7422 5d0a  attrs["height"].
-000196d0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-000196e0: 6366 2220 696e 2073 7461 6e64 6172 6420  cf" in standard 
-000196f0: 6f72 2067 656f 7265 663a 0a20 2020 2020  or georef:.     
-00019700: 2020 2020 2020 2020 2020 2073 7765 6570             sweep
-00019710: 5f6d 6f64 6520 3d20 5f67 6574 5f6f 6469  _mode = _get_odi
-00019720: 6d5f 7377 6565 705f 6d6f 6465 286e 6368  m_sweep_mode(nch
-00019730: 2c20 6473 5f67 7270 7329 0a20 2020 2020  , ds_grps).     
-00019740: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00019750: 735b 2273 7765 6570 5f6d 6f64 6522 5d20  s["sweep_mode"] 
-00019760: 3d20 7377 6565 705f 6d6f 6465 0a20 2020  = sweep_mode.   
-00019770: 2020 2020 2020 2020 2069 6620 2263 6622           if "cf"
-00019780: 2069 6e20 7374 616e 6461 7264 206f 7220   in standard or 
-00019790: 6465 636f 6465 5f63 6f6f 7264 7320 6f72  decode_coords or
-000197a0: 2067 656f 7265 663a 0a20 2020 2020 2020   georef:.       
-000197b0: 2020 2020 2020 2020 2063 6f6f 7264 732e           coords.
-000197c0: 7570 6461 7465 285f 6765 745f 6f64 696d  update(_get_odim
-000197d0: 5f63 6f6f 7264 696e 6174 6573 286e 6368  _coordinates(nch
-000197e0: 2c20 6473 5f67 7270 7329 290a 2020 2020  , ds_grps)).    
-000197f0: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
-00019800: 6f72 6566 6572 656e 6365 206e 6565 6473  oreference needs
-00019810: 2063 6f6f 7264 696e 6174 6520 7661 7269   coordinate vari
-00019820: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
-00019830: 2020 2020 2020 6966 2067 656f 7265 663a        if georef:
-00019840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019850: 2020 2020 2067 656f 6473 203d 2078 722e       geods = xr.
-00019860: 4461 7461 7365 7428 7661 7273 2c20 636f  Dataset(vars, co
-00019870: 6f72 6473 290a 2020 2020 2020 2020 2020  ords).          
-00019880: 2020 2020 2020 2020 2020 6765 6f64 7320            geods 
-00019890: 3d20 7861 7272 6179 2e67 656f 7265 6665  = xarray.georefe
-000198a0: 7265 6e63 655f 6461 7461 7365 7428 6765  rence_dataset(ge
-000198b0: 6f64 7329 0a20 2020 2020 2020 2020 2020  ods).           
-000198c0: 2020 2020 2020 2020 2063 6f6f 7264 732e           coords.
-000198d0: 7570 6461 7465 2867 656f 6473 2e63 6f6f  update(geods.coo
-000198e0: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
-000198f0: 2023 2074 696d 6520 636f 6f72 6469 6e61   # time coordina
-00019900: 7465 0a20 2020 2020 2020 2020 2020 2069  te.            i
-00019910: 6620 2263 6622 2069 6e20 7374 616e 6461  f "cf" in standa
-00019920: 7264 206f 7220 6465 636f 6465 5f74 696d  rd or decode_tim
-00019930: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00019940: 2020 2020 7469 6d65 7661 6c73 203d 205f      timevals = _
-00019950: 6765 745f 6f64 696d 5f74 696d 6576 616c  get_odim_timeval
-00019960: 7565 7328 6e63 682c 2064 735f 6772 7073  ues(nch, ds_grps
+0000b350: 656c 662e 5f66 6978 6564 5f61 6e67 6c65  elf._fixed_angle
+0000b360: 203d 2073 656c 662e 5f67 6574 5f66 6978   = self._get_fix
+0000b370: 6564 5f61 6e67 6c65 2829 0a20 2020 2020  ed_angle().     
+0000b380: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000b390: 6669 7865 645f 616e 676c 650a 0a20 2020  fixed_angle..   
+0000b3a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000b3b0: 6566 206e 7261 7973 2873 656c 6629 3a0a  ef nrays(self):.
+0000b3c0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+0000b3d0: 6e20 616e 6420 6361 6368 6520 6e75 6d62  n and cache numb
+0000b3e0: 6572 206f 6620 7261 7973 2e22 2222 0a20  er of rays.""". 
+0000b3f0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0000b400: 6e72 6179 7320 6973 204e 6f6e 653a 0a20  nrays is None:. 
+0000b410: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b420: 5f6e 7261 7973 203d 2073 656c 662e 5f67  _nrays = self._g
+0000b430: 6574 5f6e 7261 7973 2829 0a20 2020 2020  et_nrays().     
+0000b440: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000b450: 6e72 6179 730a 0a20 2020 2040 7072 6f70  nrays..    @prop
+0000b460: 6572 7479 0a20 2020 2064 6566 206e 6269  erty.    def nbi
+0000b470: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+0000b480: 2020 2222 2252 6574 7572 6e20 616e 6420    """Return and 
+0000b490: 6361 6368 6520 6e75 6d62 6572 206f 6620  cache number of 
+0000b4a0: 6269 6e73 2e22 2222 0a20 2020 2020 2020  bins.""".       
+0000b4b0: 2069 6620 7365 6c66 2e5f 6e62 696e 7320   if self._nbins 
+0000b4c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000b4d0: 2020 2020 2073 656c 662e 5f6e 6269 6e73       self._nbins
+0000b4e0: 203d 2073 656c 662e 5f67 6574 5f6e 6269   = self._get_nbi
+0000b4f0: 6e73 2829 0a20 2020 2020 2020 2072 6574  ns().        ret
+0000b500: 7572 6e20 7365 6c66 2e5f 6e62 696e 730a  urn self._nbins.
+0000b510: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000b520: 2020 2064 6566 2072 6e67 2873 656c 6629     def rng(self)
+0000b530: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000b540: 7572 6e20 616e 6420 6361 6368 6520 7261  urn and cache ra
+0000b550: 6e67 6520 7872 2e44 6174 6141 7272 6179  nge xr.DataArray
+0000b560: 2e22 2222 0a20 2020 2020 2020 2069 6620  .""".        if 
+0000b570: 7365 6c66 2e5f 726e 6720 6973 204e 6f6e  self._rng is Non
+0000b580: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0000b590: 656c 662e 5f72 6e67 203d 2073 656c 662e  elf._rng = self.
+0000b5a0: 5f67 6574 5f72 616e 6765 2829 0a20 2020  _get_range().   
+0000b5b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000b5c0: 2e5f 726e 670a 0a20 2020 2040 7072 6f70  ._rng..    @prop
+0000b5d0: 6572 7479 0a20 2020 2064 6566 2072 6179  erty.    def ray
+0000b5e0: 5f74 696d 6573 2873 656c 6629 3a0a 2020  _times(self):.  
+0000b5f0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0000b600: 616e 6420 6361 6368 6520 7261 795f 7469  and cache ray_ti
+0000b610: 6d65 7320 7872 2e44 6174 6141 7272 6179  mes xr.DataArray
+0000b620: 2e22 2222 0a20 2020 2020 2020 2069 6620  .""".        if 
+0000b630: 7365 6c66 2e5f 7274 696d 6520 6973 204e  self._rtime is N
+0000b640: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000b650: 2064 6120 3d20 7365 6c66 2e5f 6765 745f   da = self._get_
+0000b660: 7261 795f 7469 6d65 7328 290a 2020 2020  ray_times().    
+0000b670: 2020 2020 2020 2020 2320 6465 636f 6465          # decode
+0000b680: 2c20 6966 206e 6563 6573 7361 7279 0a20  , if necessary. 
+0000b690: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000b6a0: 6c66 2e64 6563 6f64 655f 7469 6d65 733a  lf.decode_times:
+0000b6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b6c0: 2064 6120 3d20 7365 6c66 2e5f 6465 636f   da = self._deco
+0000b6d0: 6465 5f63 6628 6461 290a 2020 2020 2020  de_cf(da).      
+0000b6e0: 2020 2020 2020 7365 6c66 2e5f 7274 696d        self._rtim
+0000b6f0: 6520 3d20 6461 0a20 2020 2020 2020 2072  e = da.        r
+0000b700: 6574 7572 6e20 7365 6c66 2e5f 7274 696d  eturn self._rtim
+0000b710: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+0000b720: 0a20 2020 2064 6566 2074 696d 6528 7365  .    def time(se
+0000b730: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000b740: 5265 7475 726e 2061 6e64 2063 6163 6865  Return and cache
+0000b750: 2074 696d 6520 7872 2e44 6174 6141 7272   time xr.DataArr
+0000b760: 6179 2e22 2222 0a20 2020 2020 2020 2069  ay.""".        i
+0000b770: 6620 7365 6c66 2e5f 7469 6d65 2069 7320  f self._time is 
+0000b780: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000b790: 2020 6461 203d 2073 656c 662e 5f67 6574    da = self._get
+0000b7a0: 5f74 696d 6528 290a 2020 2020 2020 2020  _time().        
+0000b7b0: 2020 2020 2320 6465 636f 6465 2c20 6966      # decode, if
+0000b7c0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
+0000b7d0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+0000b7e0: 6563 6f64 655f 7469 6d65 733a 0a20 2020  ecode_times:.   
+0000b7f0: 2020 2020 2020 2020 2020 2020 2064 6120               da 
+0000b800: 3d20 7365 6c66 2e5f 6465 636f 6465 5f63  = self._decode_c
+0000b810: 6628 6461 290a 2020 2020 2020 2020 2020  f(da).          
+0000b820: 2020 7365 6c66 2e5f 7469 6d65 203d 2064    self._time = d
+0000b830: 610a 2020 2020 2020 2020 7265 7475 726e  a.        return
+0000b840: 2073 656c 662e 5f74 696d 650a 0a20 2020   self._time..   
+0000b850: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000b860: 6566 2073 7461 7274 7469 6d65 2873 656c  ef starttime(sel
+0000b870: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+0000b880: 6574 7572 6e20 7377 6565 7020 7374 6172  eturn sweep star
+0000b890: 7474 696d 6520 7872 2e44 6174 6141 7272  ttime xr.DataArr
+0000b8a0: 6179 2e22 2222 0a20 2020 2020 2020 2072  ay.""".        r
+0000b8b0: 6574 7572 6e20 7365 6c66 2e5f 7469 6d65  eturn self._time
+0000b8c0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000b8d0: 2020 2020 6465 6620 656e 6474 696d 6528      def endtime(
+0000b8e0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000b8f0: 2222 5265 7475 726e 2073 7765 6570 2065  ""Return sweep e
+0000b900: 6e64 7469 6d65 2078 722e 4461 7461 4172  ndtime xr.DataAr
+0000b910: 7261 792e 2222 220a 2020 2020 2020 2020  ray.""".        
+0000b920: 6966 2073 656c 662e 5f65 6e64 7469 6d65  if self._endtime
+0000b930: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0000b940: 2020 2020 2020 6461 203d 2073 656c 662e        da = self.
+0000b950: 5f67 6574 5f74 696d 6528 706f 696e 743d  _get_time(point=
+0000b960: 2265 6e64 2229 0a20 2020 2020 2020 2020  "end").         
+0000b970: 2020 2023 2064 6563 6f64 652c 2069 6620     # decode, if 
+0000b980: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
+0000b990: 2020 2020 2020 6966 2073 656c 662e 6465        if self.de
+0000b9a0: 636f 6465 5f74 696d 6573 3a0a 2020 2020  code_times:.    
+0000b9b0: 2020 2020 2020 2020 2020 2020 6461 203d              da =
+0000b9c0: 2073 656c 662e 5f64 6563 6f64 655f 6366   self._decode_cf
+0000b9d0: 2864 6129 0a20 2020 2020 2020 2020 2020  (da).           
+0000b9e0: 2073 656c 662e 5f65 6e64 7469 6d65 203d   self._endtime =
+0000b9f0: 2064 610a 2020 2020 2020 2020 7265 7475   da.        retu
+0000ba00: 726e 2073 656c 662e 5f65 6e64 7469 6d65  rn self._endtime
+0000ba10: 0a0a 0a63 6c61 7373 2058 5261 644d 6f6d  ...class XRadMom
+0000ba20: 656e 7428 4f64 696d 4835 4772 6f75 7041  ent(OdimH5GroupA
+0000ba30: 7474 7269 6275 7465 4d69 7869 6e29 3a0a  ttributeMixin):.
+0000ba40: 2020 2020 2222 2243 6c61 7373 2066 6f72      """Class for
+0000ba50: 2068 6f6c 6469 6e67 206f 6e65 2072 6164   holding one rad
+0000ba60: 6172 206d 6f6d 656e 740a 0a20 2020 2050  ar moment..    P
+0000ba70: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+0000ba80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e 6366  --------.    ncf
+0000ba90: 696c 6520 3a20 7b6e 6574 4344 4634 2e44  ile : {netCDF4.D
+0000baa0: 6174 6173 6574 2c20 6835 7079 2e46 696c  ataset, h5py.Fil
+0000bab0: 6520 6f72 2068 356e 6574 6364 662e 4669  e or h5netcdf.Fi
+0000bac0: 6c65 206f 626a 6563 747d 0a20 2020 2020  le object}.     
+0000bad0: 2020 2046 696c 6520 6861 6e64 6c65 206f     File handle o
+0000bae0: 6620 6669 6c65 2063 6f6e 7461 696e 696e  f file containin
+0000baf0: 6720 7261 6461 7220 7377 6565 700a 2020  g radar sweep.  
+0000bb00: 2020 6e63 7061 7468 203a 2073 7472 0a20    ncpath : str. 
+0000bb10: 2020 2020 2020 2070 6174 6820 746f 206d         path to m
+0000bb20: 6f6d 656e 7420 6772 6f75 7020 2864 6174  oment group (dat
+0000bb30: 6173 6574 5829 0a20 2020 2070 6172 656e  asetX).    paren
+0000bb40: 7420 3a20 5852 6164 5377 6565 700a 2020  t : XRadSweep.  
+0000bb50: 2020 2020 2020 7061 7265 6e74 2073 7765        parent swe
+0000bb60: 6570 206f 626a 6563 740a 2020 2020 2222  ep object.    ""
+0000bb70: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+0000bb80: 745f 5f28 7365 6c66 2c20 6e63 6669 6c65  t__(self, ncfile
+0000bb90: 2c20 6e63 7061 7468 2c20 7061 7265 6e74  , ncpath, parent
+0000bba0: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+0000bbb0: 2858 5261 644d 6f6d 656e 742c 2073 656c  (XRadMoment, sel
+0000bbc0: 6629 2e5f 5f69 6e69 745f 5f28 6e63 6669  f).__init__(ncfi
+0000bbd0: 6c65 2c20 6e63 7061 7468 2c20 7061 7265  le, ncpath, pare
+0000bbe0: 6e74 290a 2020 2020 2020 2020 7365 6c66  nt).        self
+0000bbf0: 2e5f 7175 616e 7469 7479 203d 204e 6f6e  ._quantity = Non
+0000bc00: 650a 0a20 2020 2064 6566 205f 5f72 6570  e..    def __rep
+0000bc10: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+0000bc20: 2020 2073 756d 6d61 7279 203d 205b 223c     summary = ["<
+0000bc30: 7772 6164 6c69 622e 7b7d 3e22 2e66 6f72  wradlib.{}>".for
+0000bc40: 6d61 7428 7479 7065 2873 656c 6629 2e5f  mat(type(self)._
+0000bc50: 5f6e 616d 655f 5f29 5d0a 0a20 2020 2020  _name__)]..     
+0000bc60: 2020 2064 696d 7320 3d20 2244 696d 656e     dims = "Dimen
+0000bc70: 7369 6f6e 2873 293a 220a 2020 2020 2020  sion(s):".      
+0000bc80: 2020 6469 6d73 5f73 756d 6d61 7279 203d    dims_summary =
+0000bc90: 205b 6622 7b73 656c 662e 7061 7265 6e74   [f"{self.parent
+0000bca0: 2e5f 6469 6d30 5b30 5d7d 3a20 7b73 656c  ._dim0[0]}: {sel
+0000bcb0: 662e 7061 7265 6e74 2e6e 7261 7973 7d22  f.parent.nrays}"
+0000bcc0: 5d0a 2020 2020 2020 2020 6469 6d73 5f73  ].        dims_s
+0000bcd0: 756d 6d61 7279 2e61 7070 656e 6428 6622  ummary.append(f"
+0000bce0: 7b73 656c 662e 7061 7265 6e74 2e5f 6469  {self.parent._di
+0000bcf0: 6d31 7d3a 207b 7365 6c66 2e70 6172 656e  m1}: {self.paren
+0000bd00: 742e 6e62 696e 737d 2229 0a20 2020 2020  t.nbins}").     
+0000bd10: 2020 2064 696d 735f 7375 6d6d 6172 7920     dims_summary 
+0000bd20: 3d20 222c 2022 2e6a 6f69 6e28 6469 6d73  = ", ".join(dims
+0000bd30: 5f73 756d 6d61 7279 290a 2020 2020 2020  _summary).      
+0000bd40: 2020 7375 6d6d 6172 792e 6170 7065 6e64    summary.append
+0000bd50: 2822 7b7d 2028 7b7d 2922 2e66 6f72 6d61  ("{} ({})".forma
+0000bd60: 7428 6469 6d73 2c20 6469 6d73 5f73 756d  t(dims, dims_sum
+0000bd70: 6d61 7279 2929 0a0a 2020 2020 2020 2020  mary))..        
+0000bd80: 616e 676c 6520 3d20 2245 6c65 7661 7469  angle = "Elevati
+0000bd90: 6f6e 2873 293a 220a 2020 2020 2020 2020  on(s):".        
+0000bda0: 616e 676c 655f 7375 6d6d 6172 7920 3d20  angle_summary = 
+0000bdb0: 6622 7b73 656c 662e 7061 7265 6e74 2e66  f"{self.parent.f
+0000bdc0: 6978 6564 5f61 6e67 6c65 3a2e 3166 7d22  ixed_angle:.1f}"
+0000bdd0: 0a20 2020 2020 2020 2073 756d 6d61 7279  .        summary
+0000bde0: 2e61 7070 656e 6428 227b 7d20 287b 7d29  .append("{} ({})
+0000bdf0: 222e 666f 726d 6174 2861 6e67 6c65 2c20  ".format(angle, 
+0000be00: 616e 676c 655f 7375 6d6d 6172 7929 290a  angle_summary)).
+0000be10: 0a20 2020 2020 2020 206d 6f6d 7320 3d20  .        moms = 
+0000be20: 224d 6f6d 656e 743a 220a 2020 2020 2020  "Moment:".      
+0000be30: 2020 6d6f 6d73 5f73 756d 6d61 7279 203d    moms_summary =
+0000be40: 2066 227b 7365 6c66 2e71 7561 6e74 6974   f"{self.quantit
+0000be50: 797d 220a 2020 2020 2020 2020 7375 6d6d  y}".        summ
+0000be60: 6172 792e 6170 7065 6e64 2822 7b7d 2028  ary.append("{} (
+0000be70: 7b7d 2922 2e66 6f72 6d61 7428 6d6f 6d73  {})".format(moms
+0000be80: 2c20 6d6f 6d73 5f73 756d 6d61 7279 2929  , moms_summary))
+0000be90: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000bea0: 2022 5c6e 222e 6a6f 696e 2873 756d 6d61   "\n".join(summa
+0000beb0: 7279 290a 0a20 2020 2040 7072 6f70 6572  ry)..    @proper
+0000bec0: 7479 0a20 2020 2064 6566 2064 6174 6128  ty.    def data(
+0000bed0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000bee0: 2222 5265 7475 726e 206d 6f6d 656e 7420  ""Return moment 
+0000bef0: 7872 2e44 6174 6141 7272 6179 2e22 2222  xr.DataArray."""
+0000bf00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000bf10: 7365 6c66 2e70 6172 656e 742e 6461 7461  self.parent.data
+0000bf20: 5b73 656c 662e 7175 616e 7469 7479 5d0a  [self.quantity].
+0000bf30: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000bf40: 2020 2064 6566 2074 696d 6528 7365 6c66     def time(self
+0000bf50: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000bf60: 7475 726e 2073 7765 6570 2074 696d 652e  turn sweep time.
+0000bf70: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000bf80: 726e 2073 656c 662e 7061 7265 6e74 2e74  rn self.parent.t
+0000bf90: 696d 650a 0a20 2020 2040 7072 6f70 6572  ime..    @proper
+0000bfa0: 7479 0a20 2020 2064 6566 2071 7561 6e74  ty.    def quant
+0000bfb0: 6974 7928 7365 6c66 293a 0a20 2020 2020  ity(self):.     
+0000bfc0: 2020 2022 2222 5265 7475 726e 2060 7175     """Return `qu
+0000bfd0: 616e 7469 7479 6020 616b 6120 6d6f 6d65  antity` aka mome
+0000bfe0: 6e74 206e 616d 6522 2222 0a20 2020 2020  nt name""".     
+0000bff0: 2020 2069 6620 7365 6c66 2e5f 7175 616e     if self._quan
+0000c000: 7469 7479 2069 7320 4e6f 6e65 3a0a 2020  tity is None:.  
+0000c010: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0000c020: 6e73 7461 6e63 6528 7365 6c66 2e70 6172  nstance(self.par
+0000c030: 656e 742c 2058 5261 6453 7765 6570 4f64  ent, XRadSweepOd
+0000c040: 696d 293a 0a20 2020 2020 2020 2020 2020  im):.           
+0000c050: 2020 2020 2073 656c 662e 5f71 7561 6e74       self._quant
+0000c060: 6974 7920 3d20 7365 6c66 2e77 6861 745b  ity = self.what[
+0000c070: 2271 7561 6e74 6974 7922 5d0a 2020 2020  "quantity"].    
+0000c080: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000c090: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000c0a0: 6c66 2e5f 7175 616e 7469 7479 203d 2047  lf._quantity = G
+0000c0b0: 414d 4943 5f4e 414d 4553 5b73 656c 662e  AMIC_NAMES[self.
+0000c0c0: 6174 7472 735b 226d 6f6d 656e 7422 5d2e  attrs["moment"].
+0000c0d0: 6c6f 7765 7228 295d 0a20 2020 2020 2020  lower()].       
+0000c0e0: 2072 6574 7572 6e20 7365 6c66 2e5f 7175   return self._qu
+0000c0f0: 616e 7469 7479 0a0a 0a63 6c61 7373 2058  antity...class X
+0000c100: 5261 6453 7765 6570 284f 6469 6d48 3547  RadSweep(OdimH5G
+0000c110: 726f 7570 4174 7472 6962 7574 654d 6978  roupAttributeMix
+0000c120: 696e 2c20 4f64 696d 4835 5377 6565 704d  in, OdimH5SweepM
+0000c130: 6574 6144 6174 614d 6978 696e 2c20 5852  etaDataMixin, XR
+0000c140: 6164 4261 7365 293a 0a20 2020 2022 2222  adBase):.    """
+0000c150: 436c 6173 7320 666f 7220 686f 6c64 696e  Class for holdin
+0000c160: 6720 6f6e 6520 7261 6461 7220 7377 6565  g one radar swee
+0000c170: 700a 0a20 2020 2050 6172 616d 6574 6572  p..    Parameter
+0000c180: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0000c190: 0a0a 2020 2020 6e63 6669 6c65 203a 207b  ..    ncfile : {
+0000c1a0: 6e65 7443 4446 342e 4461 7461 7365 742c  netCDF4.Dataset,
+0000c1b0: 2068 3570 792e 4669 6c65 206f 7220 6835   h5py.File or h5
+0000c1c0: 6e65 7463 6466 2e46 696c 6520 6f62 6a65  netcdf.File obje
+0000c1d0: 6374 7d0a 2020 2020 2020 2020 4669 6c65  ct}.        File
+0000c1e0: 2068 616e 646c 6520 6f66 2066 696c 6520   handle of file 
+0000c1f0: 636f 6e74 6169 6e69 6e67 2072 6164 6172  containing radar
+0000c200: 2073 7765 6570 0a20 2020 206e 6370 6174   sweep.    ncpat
+0000c210: 6820 3a20 7374 720a 2020 2020 2020 2020  h : str.        
+0000c220: 7061 7468 2074 6f20 7377 6565 7020 6772  path to sweep gr
+0000c230: 6f75 700a 2020 2020 2222 220a 0a20 2020  oup.    """..   
+0000c240: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+0000c250: 6c66 2c20 6e63 6669 6c65 2c20 6e63 7061  lf, ncfile, ncpa
+0000c260: 7468 2c20 7061 7265 6e74 3d4e 6f6e 652c  th, parent=None,
+0000c270: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0000c280: 2020 2020 7375 7065 7228 5852 6164 5377      super(XRadSw
+0000c290: 6565 702c 2073 656c 6629 2e5f 5f69 6e69  eep, self).__ini
+0000c2a0: 745f 5f28 6e63 6669 6c65 2c20 6e63 7061  t__(ncfile, ncpa
+0000c2b0: 7468 2c20 7061 7265 6e74 290a 2020 2020  th, parent).    
+0000c2c0: 2020 2020 7365 6c66 2e5f 6461 736b 5f6b      self._dask_k
+0000c2d0: 7761 7267 7320 3d20 7b0a 2020 2020 2020  wargs = {.      
+0000c2e0: 2020 2020 2020 2263 6875 6e6b 7322 3a20        "chunks": 
+0000c2f0: 6b77 6172 6773 2e67 6574 2822 6368 756e  kwargs.get("chun
+0000c300: 6b73 222c 204e 6f6e 6529 2c0a 2020 2020  ks", None),.    
+0000c310: 2020 2020 2020 2020 2270 6172 616c 6c65          "paralle
+0000c320: 6c22 3a20 6b77 6172 6773 2e67 6574 2822  l": kwargs.get("
+0000c330: 7061 7261 6c6c 656c 222c 2046 616c 7365  parallel", False
+0000c340: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+0000c350: 2020 2020 2073 656c 662e 5f63 665f 6b77       self._cf_kw
+0000c360: 6172 6773 203d 207b 0a20 2020 2020 2020  args = {.       
+0000c370: 2020 2020 2022 6d61 736b 5f61 6e64 5f73       "mask_and_s
+0000c380: 6361 6c65 223a 206b 7761 7267 732e 6765  cale": kwargs.ge
+0000c390: 7428 226d 6173 6b5f 616e 645f 7363 616c  t("mask_and_scal
+0000c3a0: 6522 2c20 5472 7565 292c 0a20 2020 2020  e", True),.     
+0000c3b0: 2020 2020 2020 2022 6465 636f 6465 5f63         "decode_c
+0000c3c0: 6f6f 7264 7322 3a20 6b77 6172 6773 2e67  oords": kwargs.g
+0000c3d0: 6574 2822 6465 636f 6465 5f63 6f6f 7264  et("decode_coord
+0000c3e0: 7322 2c20 5472 7565 292c 0a20 2020 2020  s", True),.     
+0000c3f0: 2020 2020 2020 2022 6465 636f 6465 5f74         "decode_t
+0000c400: 696d 6573 223a 206b 7761 7267 732e 6765  imes": kwargs.ge
+0000c410: 7428 2264 6563 6f64 655f 7469 6d65 7322  t("decode_times"
+0000c420: 2c20 5472 7565 292c 0a20 2020 2020 2020  , True),.       
+0000c430: 207d 0a20 2020 2020 2020 2073 656c 662e   }.        self.
+0000c440: 5f6d 6973 635f 6b77 6172 6773 203d 207b  _misc_kwargs = {
+0000c450: 0a20 2020 2020 2020 2020 2020 2022 6b65  .            "ke
+0000c460: 6570 5f65 6c65 7661 7469 6f6e 223a 206b  ep_elevation": k
+0000c470: 7761 7267 732e 6765 7428 226b 6565 705f  wargs.get("keep_
+0000c480: 656c 6576 6174 696f 6e22 2c20 4661 6c73  elevation", Fals
+0000c490: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+0000c4a0: 226b 6565 705f 617a 696d 7574 6822 3a20  "keep_azimuth": 
+0000c4b0: 6b77 6172 6773 2e67 6574 2822 6b65 6570  kwargs.get("keep
+0000c4c0: 5f61 7a69 6d75 7468 222c 2046 616c 7365  _azimuth", False
+0000c4d0: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
+0000c4e0: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
+0000c4f0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+0000c500: 656c 662e 5f6e 6565 645f 7469 6d65 5f72  elf._need_time_r
+0000c510: 6563 616c 6320 3d20 4661 6c73 650a 2020  ecalc = False.  
+0000c520: 2020 2020 2020 7365 6c66 2e5f 7365 712e        self._seq.
+0000c530: 6578 7465 6e64 2873 656c 662e 5f67 6574  extend(self._get
+0000c540: 5f6d 6f6d 656e 7473 2829 290a 2020 2020  _moments()).    
+0000c550: 2020 2020 7365 6c66 2e5f 6469 6d30 203d      self._dim0 =
+0000c560: 2028 2261 7a69 6d75 7468 222c 2022 656c   ("azimuth", "el
+0000c570: 6576 6174 696f 6e22 290a 2020 2020 2020  evation").      
+0000c580: 2020 7365 6c66 2e5f 6469 6d31 203d 2022    self._dim1 = "
+0000c590: 7261 6e67 6522 0a20 2020 2020 2020 2073  range".        s
+0000c5a0: 656c 662e 6669 7865 645f 616e 676c 650a  elf.fixed_angle.
+0000c5b0: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
+0000c5c0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0000c5d0: 2073 756d 6d61 7279 203d 205b 223c 7772   summary = ["<wr
+0000c5e0: 6164 6c69 622e 7b7d 3e22 2e66 6f72 6d61  adlib.{}>".forma
+0000c5f0: 7428 7479 7065 2873 656c 6629 2e5f 5f6e  t(type(self).__n
+0000c600: 616d 655f 5f29 5d0a 0a20 2020 2020 2020  ame__)]..       
+0000c610: 2064 696d 7320 3d20 2244 696d 656e 7369   dims = "Dimensi
+0000c620: 6f6e 2873 293a 220a 2020 2020 2020 2020  on(s):".        
+0000c630: 6469 6d73 5f73 756d 6d61 7279 203d 205b  dims_summary = [
+0000c640: 6622 7b73 656c 662e 5f64 696d 305b 305d  f"{self._dim0[0]
+0000c650: 7d3a 207b 7365 6c66 2e6e 7261 7973 7d22  }: {self.nrays}"
+0000c660: 5d0a 2020 2020 2020 2020 6469 6d73 5f73  ].        dims_s
+0000c670: 756d 6d61 7279 2e61 7070 656e 6428 6622  ummary.append(f"
+0000c680: 7b73 656c 662e 5f64 696d 317d 3a20 7b73  {self._dim1}: {s
+0000c690: 656c 662e 6e62 696e 737d 2229 0a20 2020  elf.nbins}").   
+0000c6a0: 2020 2020 2064 696d 735f 7375 6d6d 6172       dims_summar
+0000c6b0: 7920 3d20 222c 2022 2e6a 6f69 6e28 6469  y = ", ".join(di
+0000c6c0: 6d73 5f73 756d 6d61 7279 290a 2020 2020  ms_summary).    
+0000c6d0: 2020 2020 7375 6d6d 6172 792e 6170 7065      summary.appe
+0000c6e0: 6e64 2822 7b7d 2028 7b7d 2922 2e66 6f72  nd("{} ({})".for
+0000c6f0: 6d61 7428 6469 6d73 2c20 6469 6d73 5f73  mat(dims, dims_s
+0000c700: 756d 6d61 7279 2929 0a0a 2020 2020 2020  ummary))..      
+0000c710: 2020 616e 676c 6520 3d20 6622 7b73 656c    angle = f"{sel
+0000c720: 662e 5f64 696d 305b 315d 2e63 6170 6974  f._dim0[1].capit
+0000c730: 616c 697a 6528 297d 2873 293a 220a 2020  alize()}(s):".  
+0000c740: 2020 2020 2020 616e 676c 655f 7375 6d6d        angle_summ
+0000c750: 6172 7920 3d20 6622 7b73 656c 662e 6669  ary = f"{self.fi
+0000c760: 7865 645f 616e 676c 653a 302e 3166 7d22  xed_angle:0.1f}"
+0000c770: 0a20 2020 2020 2020 2073 756d 6d61 7279  .        summary
+0000c780: 2e61 7070 656e 6428 227b 7d20 287b 7d29  .append("{} ({})
+0000c790: 222e 666f 726d 6174 2861 6e67 6c65 2c20  ".format(angle, 
+0000c7a0: 616e 676c 655f 7375 6d6d 6172 7929 290a  angle_summary)).
+0000c7b0: 0a20 2020 2020 2020 206d 6f6d 7320 3d20  .        moms = 
+0000c7c0: 224d 6f6d 656e 7428 7329 3a22 0a20 2020  "Moment(s):".   
+0000c7d0: 2020 2020 206d 6f6d 735f 7375 6d6d 6172       moms_summar
+0000c7e0: 7920 3d20 7365 6c66 2e6d 6f6d 656e 7473  y = self.moments
+0000c7f0: 0a20 2020 2020 2020 206d 6f6d 735f 7375  .        moms_su
+0000c800: 6d6d 6172 7920 3d20 222c 2022 2e6a 6f69  mmary = ", ".joi
+0000c810: 6e28 6d6f 6d73 5f73 756d 6d61 7279 290a  n(moms_summary).
+0000c820: 2020 2020 2020 2020 7375 6d6d 6172 792e          summary.
+0000c830: 6170 7065 6e64 2822 7b7d 2028 7b7d 2922  append("{} ({})"
+0000c840: 2e66 6f72 6d61 7428 6d6f 6d73 2c20 6d6f  .format(moms, mo
+0000c850: 6d73 5f73 756d 6d61 7279 2929 0a0a 2020  ms_summary))..  
+0000c860: 2020 2020 2020 7265 7475 726e 2022 5c6e        return "\n
+0000c870: 222e 6a6f 696e 2873 756d 6d61 7279 290a  ".join(summary).
+0000c880: 0a20 2020 2064 6566 205f 5f64 656c 5f5f  .    def __del__
+0000c890: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000c8a0: 6966 2073 656c 662e 5f64 6174 6120 6973  if self._data is
+0000c8b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000c8c0: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+0000c8d0: 612e 636c 6f73 6528 290a 2020 2020 2020  a.close().      
+0000c8e0: 2020 2020 2020 7365 6c66 2e5f 6461 7461        self._data
+0000c8f0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000c900: 7365 6c66 2e5f 6e63 6669 6c65 203d 204e  self._ncfile = N
+0000c910: 6f6e 650a 0a20 2020 2064 6566 205f 6465  one..    def _de
+0000c920: 636f 6465 5f63 6628 7365 6c66 2c20 6f62  code_cf(self, ob
+0000c930: 6a29 3a0a 2020 2020 2020 2020 6966 2069  j):.        if i
+0000c940: 7369 6e73 7461 6e63 6528 6f62 6a2c 2078  sinstance(obj, x
+0000c950: 722e 4461 7461 4172 7261 7929 3a0a 2020  r.DataArray):.  
+0000c960: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+0000c970: 7872 2e64 6563 6f64 655f 6366 2878 722e  xr.decode_cf(xr.
+0000c980: 4461 7461 7365 7428 7b22 6172 7222 3a20  Dataset({"arr": 
+0000c990: 6f62 6a7d 292c 202a 2a73 656c 662e 5f63  obj}), **self._c
+0000c9a0: 665f 6b77 6172 6773 292e 6172 720a 2020  f_kwargs).arr.  
+0000c9b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000c9c0: 2020 2020 2020 2020 6f75 7420 3d20 7872          out = xr
+0000c9d0: 2e64 6563 6f64 655f 6366 286f 626a 2c20  .decode_cf(obj, 
+0000c9e0: 2a2a 7365 6c66 2e5f 6366 5f6b 7761 7267  **self._cf_kwarg
+0000c9f0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+0000ca00: 6e20 6f75 740a 0a20 2020 2064 6566 205f  n out..    def _
+0000ca10: 6765 745f 636f 6f72 6473 2873 656c 6629  get_coords(self)
+0000ca20: 3a0a 2020 2020 2020 2020 6473 203d 2078  :.        ds = x
+0000ca30: 722e 4461 7461 7365 7428 0a20 2020 2020  r.Dataset(.     
+0000ca40: 2020 2020 2020 2063 6f6f 7264 733d 7b0a         coords={.
+0000ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca60: 2274 696d 6522 3a20 7365 6c66 2e74 696d  "time": self.tim
+0000ca70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000ca80: 2020 2022 7274 696d 6522 3a20 7365 6c66     "rtime": self
+0000ca90: 2e72 6179 5f74 696d 6573 2c0a 2020 2020  .ray_times,.    
+0000caa0: 2020 2020 2020 2020 2020 2020 2261 7a69              "azi
+0000cab0: 6d75 7468 223a 2073 656c 662e 617a 696d  muth": self.azim
+0000cac0: 7574 682c 0a20 2020 2020 2020 2020 2020  uth,.           
+0000cad0: 2020 2020 2022 656c 6576 6174 696f 6e22       "elevation"
+0000cae0: 3a20 7365 6c66 2e65 6c65 7661 7469 6f6e  : self.elevation
+0000caf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000cb00: 2020 2272 616e 6765 223a 2073 656c 662e    "range": self.
+0000cb10: 726e 672c 0a20 2020 2020 2020 2020 2020  rng,.           
+0000cb20: 207d 0a20 2020 2020 2020 2029 0a20 2020   }.        ).   
+0000cb30: 2020 2020 2072 6574 7572 6e20 6473 0a0a       return ds..
+0000cb40: 2020 2020 6465 6620 5f67 6574 5f6d 6f6d      def _get_mom
+0000cb50: 656e 7473 2873 656c 6629 3a0a 2020 2020  ents(self):.    
+0000cb60: 2020 2020 6d64 6573 6320 3d20 7365 6c66      mdesc = self
+0000cb70: 2e5f 6d64 6573 630a 2020 2020 2020 2020  ._mdesc.        
+0000cb80: 6d6f 6d65 6e74 7320 3d20 5b6b 2066 6f72  moments = [k for
+0000cb90: 206b 2069 6e20 7365 6c66 2e67 726f 7570   k in self.group
+0000cba0: 7320 6966 206d 6465 7363 2069 6e20 6b5d  s if mdesc in k]
+0000cbb0: 0a20 2020 2020 2020 206d 6f6d 656e 7473  .        moments
+0000cbc0: 5f69 6478 203d 206e 702e 6172 6773 6f72  _idx = np.argsor
+0000cbd0: 7428 5b69 6e74 2873 5b6c 656e 286d 6465  t([int(s[len(mde
+0000cbe0: 7363 2920 3a5d 2920 666f 7220 7320 696e  sc) :]) for s in
+0000cbf0: 206d 6f6d 656e 7473 5d29 0a20 2020 2020   moments]).     
+0000cc00: 2020 206d 6f6d 656e 7473 5f6e 616d 6573     moments_names
+0000cc10: 203d 206e 702e 6172 7261 7928 6d6f 6d65   = np.array(mome
+0000cc20: 6e74 7329 5b6d 6f6d 656e 7473 5f69 6478  nts)[moments_idx
+0000cc30: 5d2e 746f 6c69 7374 2829 0a20 2020 2020  ].tolist().     
+0000cc40: 2020 206d 6f6d 656e 7473 203d 205b 0a20     moments = [. 
+0000cc50: 2020 2020 2020 2020 2020 2058 5261 644d             XRadM
+0000cc60: 6f6d 656e 7428 0a20 2020 2020 2020 2020  oment(.         
+0000cc70: 2020 2020 2020 206e 6366 696c 653d 7365         ncfile=se
+0000cc80: 6c66 2e6e 6366 696c 652c 206e 6370 6174  lf.ncfile, ncpat
+0000cc90: 683d 222f 222e 6a6f 696e 285b 7365 6c66  h="/".join([self
+0000cca0: 2e6e 6370 6174 682c 206d 6f6d 5d29 2c20  .ncpath, mom]), 
+0000ccb0: 7061 7265 6e74 3d73 656c 660a 2020 2020  parent=self.    
+0000ccc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ccd0: 2020 2020 2020 666f 7220 6d6f 6d20 696e        for mom in
+0000cce0: 206d 6f6d 656e 7473 5f6e 616d 6573 0a20   moments_names. 
+0000ccf0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0000cd00: 2072 6574 7572 6e20 6d6f 6d65 6e74 730a   return moments.
+0000cd10: 0a20 2020 2064 6566 2072 6573 6574 5f64  .    def reset_d
+0000cd20: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
+0000cd30: 2020 2022 2222 5265 7365 7420 2e64 6174     """Reset .dat
+0000cd40: 6120 7872 2e44 6174 6173 6574 2222 220a  a xr.Dataset""".
+0000cd50: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
+0000cd60: 7461 203d 204e 6f6e 650a 0a20 2020 2040  ta = None..    @
+0000cd70: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000cd80: 205f 6d64 6573 6328 7365 6c66 293a 0a20   _mdesc(self):. 
+0000cd90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000cda0: 6c66 2e5f 6765 745f 6d64 6573 6328 290a  lf._get_mdesc().
+0000cdb0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000cdc0: 2020 2064 6566 2063 6875 6e6b 7328 7365     def chunks(se
+0000cdd0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000cde0: 5265 7475 726e 2060 6368 756e 6b73 6020  Return `chunks` 
+0000cdf0: 7365 7474 696e 672e 2222 220a 2020 2020  setting.""".    
+0000ce00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000ce10: 5f64 6173 6b5f 6b77 6172 6773 2e67 6574  _dask_kwargs.get
+0000ce20: 2822 6368 756e 6b73 2229 0a0a 2020 2020  ("chunks")..    
+0000ce30: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000ce40: 6620 7061 7261 6c6c 656c 2873 656c 6629  f parallel(self)
+0000ce50: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000ce60: 7572 6e20 6070 6172 616c 6c65 6c60 2073  urn `parallel` s
+0000ce70: 6574 7469 6e67 2e22 2222 0a20 2020 2020  etting.""".     
+0000ce80: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000ce90: 6461 736b 5f6b 7761 7267 732e 6765 7428  dask_kwargs.get(
+0000cea0: 2270 6172 616c 6c65 6c22 290a 0a20 2020  "parallel")..   
+0000ceb0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000cec0: 6566 206d 6173 6b5f 616e 645f 7363 616c  ef mask_and_scal
+0000ced0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0000cee0: 2022 2222 5265 7475 726e 2060 6d61 736b   """Return `mask
+0000cef0: 5f61 6e64 5f73 6361 6c65 6020 7365 7474  _and_scale` sett
+0000cf00: 696e 672e 2222 220a 2020 2020 2020 2020  ing.""".        
+0000cf10: 7265 7475 726e 2073 656c 662e 5f63 665f  return self._cf_
+0000cf20: 6b77 6172 6773 2e67 6574 2822 6d61 736b  kwargs.get("mask
+0000cf30: 5f61 6e64 5f73 6361 6c65 2229 0a0a 2020  _and_scale")..  
+0000cf40: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000cf50: 6465 6620 6465 636f 6465 5f63 6f6f 7264  def decode_coord
+0000cf60: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000cf70: 2022 2222 5265 7475 726e 2060 6465 636f   """Return `deco
+0000cf80: 6465 5f63 6f6f 7264 7360 2073 6574 7469  de_coords` setti
+0000cf90: 6e67 2e22 2222 0a20 2020 2020 2020 2072  ng.""".        r
+0000cfa0: 6574 7572 6e20 7365 6c66 2e5f 6366 5f6b  eturn self._cf_k
+0000cfb0: 7761 7267 732e 6765 7428 2264 6563 6f64  wargs.get("decod
+0000cfc0: 655f 636f 6f72 6473 2229 0a0a 2020 2020  e_coords")..    
+0000cfd0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000cfe0: 6620 6465 636f 6465 5f74 696d 6573 2873  f decode_times(s
+0000cff0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000d000: 2252 6574 7572 6e20 6064 6563 6f64 655f  "Return `decode_
+0000d010: 7469 6d65 7360 2073 6574 7469 6e67 2e22  times` setting."
+0000d020: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000d030: 6e20 7365 6c66 2e5f 6366 5f6b 7761 7267  n self._cf_kwarg
+0000d040: 732e 6765 7428 2264 6563 6f64 655f 7469  s.get("decode_ti
+0000d050: 6d65 7322 290a 0a20 2020 2040 7072 6f70  mes")..    @prop
+0000d060: 6572 7479 0a20 2020 2064 6566 2064 6174  erty.    def dat
+0000d070: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
+0000d080: 2022 2222 5265 7475 726e 2061 6e64 2063   """Return and c
+0000d090: 6163 6865 206d 6f6d 656e 7473 2061 7320  ache moments as 
+0000d0a0: 636f 6d62 696e 6564 2078 722e 4461 7461  combined xr.Data
+0000d0b0: 7365 7422 2222 0a20 2020 2020 2020 2069  set""".        i
+0000d0c0: 6620 7365 6c66 2e5f 6461 7461 2069 7320  f self._data is 
+0000d0d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000d0e0: 2020 7365 6c66 2e5f 6461 7461 203d 2073    self._data = s
+0000d0f0: 656c 662e 5f6d 6572 6765 5f6d 6f6d 656e  elf._merge_momen
+0000d100: 7473 2829 0a0a 2020 2020 2020 2020 2020  ts()..          
+0000d110: 2020 2320 6966 2073 656c 662e 5f64 6174    # if self._dat
+0000d120: 6120 6973 206e 6f74 204e 6f6e 653a 0a20  a is not None:. 
+0000d130: 2020 2020 2020 2020 2020 2023 2069 6620             # if 
+0000d140: 6d65 7461 6461 7461 2064 6563 6c61 7265  metadata declare
+0000d150: 6420 696e 2058 5261 6454 696d 6573 6572  d in XRadTimeser
+0000d160: 6965 732c 206c 6f61 6420 616e 6420 6173  ies, load and as
+0000d170: 7369 676e 0a20 2020 2020 2020 2020 2020  sign.           
+0000d180: 2069 6620 7365 6c66 2e70 6172 656e 742e   if self.parent.
+0000d190: 5f6d 6574 6120 6973 206e 6f74 204e 6f6e  _meta is not Non
+0000d1a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000d1b0: 2020 2076 6172 7320 3d20 6469 6374 2829     vars = dict()
+0000d1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d1d0: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+0000d1e0: 662e 7061 7265 6e74 2e5f 6d65 7461 2e69  f.parent._meta.i
+0000d1f0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0000d200: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0000d210: 203d 2073 656c 662e 5f67 6574 5f61 7474   = self._get_att
+0000d220: 7269 6275 7465 2876 2c20 6174 7472 3d6b  ribute(v, attr=k
+0000d230: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000d240: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+0000d250: 2861 7474 722c 2022 6e64 696d 2229 3a0a  (attr, "ndim"):.
+0000d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d270: 2020 2020 2020 2020 6174 7472 203d 2078          attr = x
+0000d280: 722e 4461 7461 4172 7261 7928 6174 7472  r.DataArray(attr
+0000d290: 2c20 6469 6d73 3d5b 7365 6c66 2e5f 6469  , dims=[self._di
+0000d2a0: 6d30 5b30 5d5d 290a 2020 2020 2020 2020  m0[0]]).        
+0000d2b0: 2020 2020 2020 2020 2020 2020 7661 7273              vars
+0000d2c0: 5b6b 5d20 3d20 6174 7472 0a20 2020 2020  [k] = attr.     
+0000d2d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d2e0: 5f64 6174 6120 3d20 7365 6c66 2e5f 6461  _data = self._da
+0000d2f0: 7461 2e61 7373 6967 6e28 7661 7273 290a  ta.assign(vars).
+0000d300: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000d310: 7365 6c66 2e64 6563 6f64 655f 636f 6f72  self.decode_coor
+0000d320: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+0000d330: 2020 2020 636f 6f72 6473 203d 2073 656c      coords = sel
+0000d340: 662e 5f67 6574 5f63 6f6f 7264 7328 292e  f._get_coords().
+0000d350: 636f 6f72 6473 0a20 2020 2020 2020 2020  coords.         
+0000d360: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+0000d370: 6120 3d20 7365 6c66 2e5f 6461 7461 2e61  a = self._data.a
+0000d380: 7373 6967 6e5f 636f 6f72 6473 2863 6f6f  ssign_coords(coo
+0000d390: 7264 7329 0a20 2020 2020 2020 2020 2020  rds).           
+0000d3a0: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
+0000d3b0: 3d20 7365 6c66 2e5f 6461 7461 2e73 6f72  = self._data.sor
+0000d3c0: 7462 7928 7365 6c66 2e5f 6469 6d30 5b30  tby(self._dim0[0
+0000d3d0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0000d3e0: 2020 2073 656c 662e 5f64 6174 6120 3d20     self._data = 
+0000d3f0: 7365 6c66 2e5f 6461 7461 2e70 6970 6528  self._data.pipe(
+0000d400: 5f72 6569 6e64 6578 5f61 6e67 6c65 2c20  _reindex_angle, 
+0000d410: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
+0000d420: 2020 2020 2020 7377 6565 705f 6d6f 6465        sweep_mode
+0000d430: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0000d440: 2020 2020 2020 2020 2022 617a 696d 7574           "azimut
+0000d450: 685f 7375 7276 6569 6c6c 616e 6365 2220  h_surveillance" 
+0000d460: 6966 2073 656c 662e 5f64 696d 305b 305d  if self._dim0[0]
+0000d470: 203d 3d20 2261 7a69 6d75 7468 2220 656c   == "azimuth" el
+0000d480: 7365 2022 7268 6922 0a20 2020 2020 2020  se "rhi".       
+0000d490: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000d4a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d4b0: 5f64 6174 6120 3d20 7365 6c66 2e5f 6461  _data = self._da
+0000d4c0: 7461 2e61 7373 6967 6e5f 636f 6f72 6473  ta.assign_coords
+0000d4d0: 287b 2273 7765 6570 5f6d 6f64 6522 3a20  ({"sweep_mode": 
+0000d4e0: 7377 6565 705f 6d6f 6465 7d29 0a20 2020  sweep_mode}).   
+0000d4f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000d500: 662e 5f64 6174 6120 3d20 7365 6c66 2e5f  f._data = self._
+0000d510: 6461 7461 2e61 7373 6967 6e5f 636f 6f72  data.assign_coor
+0000d520: 6473 2873 656c 662e 7061 7265 6e74 2e70  ds(self.parent.p
+0000d530: 6172 656e 742e 7369 7465 2e63 6f6f 7264  arent.site.coord
+0000d540: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
+0000d550: 6966 2073 656c 662e 6d61 736b 5f61 6e64  if self.mask_and
+0000d560: 5f73 6361 6c65 207c 2073 656c 662e 6465  _scale | self.de
+0000d570: 636f 6465 5f63 6f6f 7264 7320 7c20 7365  code_coords | se
+0000d580: 6c66 2e64 6563 6f64 655f 7469 6d65 733a  lf.decode_times:
+0000d590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d5a0: 2073 656c 662e 5f64 6174 6120 3d20 7365   self._data = se
+0000d5b0: 6c66 2e5f 6461 7461 2e70 6970 6528 7365  lf._data.pipe(se
+0000d5c0: 6c66 2e5f 6465 636f 6465 5f63 6629 0a0a  lf._decode_cf)..
+0000d5d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000d5e0: 656c 662e 5f64 6174 610a 0a20 2020 2040  elf._data..    @
+0000d5f0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000d600: 2063 6f6f 7264 7328 7365 6c66 293a 0a20   coords(self):. 
+0000d610: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000d620: 7320 7872 2e44 6174 6173 6574 2063 6f6e  s xr.Dataset con
+0000d630: 7461 696e 696e 6720 636f 6f72 6469 6e61  taining coordina
+0000d640: 7465 732e 2222 220a 2020 2020 2020 2020  tes.""".        
+0000d650: 2320 736f 7274 2063 6f6f 7264 7320 6279  # sort coords by
+0000d660: 2061 7a69 6d75 7468 2c20 6f6e 6c79 206e   azimuth, only n
+0000d670: 6563 6573 7361 7279 2066 6f72 2067 616d  ecessary for gam
+0000d680: 6963 2066 6c61 766f 7572 0a20 2020 2020  ic flavour.     
+0000d690: 2020 2023 2066 6f72 206f 6469 6d20 6973     # for odim is
+0000d6a0: 2061 6c72 6561 6479 2073 6f72 7465 640a   already sorted.
+0000d6b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000d6c0: 656c 662e 5f67 6574 5f63 6f6f 7264 7328  elf._get_coords(
+0000d6d0: 292e 736f 7274 6279 2873 656c 662e 5f64  ).sortby(self._d
+0000d6e0: 696d 305b 305d 290a 0a20 2020 2040 7072  im0[0])..    @pr
+0000d6f0: 6f70 6572 7479 0a20 2020 2064 6566 206d  operty.    def m
+0000d700: 6f6d 656e 7473 2873 656c 6629 3a0a 2020  oments(self):.  
+0000d710: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0000d720: 6c69 7374 206f 6620 6d6f 6d65 6e74 732e  list of moments.
+0000d730: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000d740: 726e 205b 6622 7b6b 2e71 7561 6e74 6974  rn [f"{k.quantit
+0000d750: 797d 2220 666f 7220 6b20 696e 2073 656c  y}" for k in sel
+0000d760: 665d 0a0a 0a63 6c61 7373 2058 5261 6453  f]...class XRadS
+0000d770: 7765 6570 4f64 696d 2858 5261 6453 7765  weepOdim(XRadSwe
+0000d780: 6570 293a 0a20 2020 2022 2222 436c 6173  ep):.    """Clas
+0000d790: 7320 666f 7220 686f 6c64 696e 6720 6f6e  s for holding on
+0000d7a0: 6520 7261 6461 7220 7377 6565 700a 0a20  e radar sweep.. 
+0000d7b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0000d7c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020    ----------..  
+0000d7d0: 2020 6e63 6669 6c65 203a 207b 6e65 7443    ncfile : {netC
+0000d7e0: 4446 342e 4461 7461 7365 742c 2068 3570  DF4.Dataset, h5p
+0000d7f0: 792e 4669 6c65 206f 7220 6835 6e65 7463  y.File or h5netc
+0000d800: 6466 2e46 696c 6520 6f62 6a65 6374 7d0a  df.File object}.
+0000d810: 2020 2020 2020 2020 4669 6c65 2068 616e          File han
+0000d820: 646c 6520 6f66 2066 696c 6520 636f 6e74  dle of file cont
+0000d830: 6169 6e69 6e67 2072 6164 6172 2073 7765  aining radar swe
+0000d840: 6570 0a20 2020 206e 6370 6174 6820 3a20  ep.    ncpath : 
+0000d850: 7374 720a 2020 2020 2020 2020 7061 7468  str.        path
+0000d860: 2074 6f20 7377 6565 7020 6772 6f75 700a   to sweep group.
+0000d870: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+0000d880: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+0000d890: 6e63 6669 6c65 2c20 6e63 7061 7468 2c20  ncfile, ncpath, 
+0000d8a0: 7061 7265 6e74 3d4e 6f6e 652c 202a 2a6b  parent=None, **k
+0000d8b0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+0000d8c0: 7375 7065 7228 5852 6164 5377 6565 704f  super(XRadSweepO
+0000d8d0: 6469 6d2c 2073 656c 6629 2e5f 5f69 6e69  dim, self).__ini
+0000d8e0: 745f 5f28 6e63 6669 6c65 2c20 6e63 7061  t__(ncfile, ncpa
+0000d8f0: 7468 2c20 7061 7265 6e74 2c20 2a2a 6b77  th, parent, **kw
+0000d900: 6172 6773 290a 0a20 2020 2064 6566 205f  args)..    def _
+0000d910: 6765 745f 6131 6761 7465 2873 656c 6629  get_a1gate(self)
+0000d920: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000d930: 2073 656c 662e 7768 6572 655b 2261 3167   self.where["a1g
+0000d940: 6174 6522 5d0a 0a20 2020 2064 6566 205f  ate"]..    def _
+0000d950: 6765 745f 616e 676c 655f 7265 736f 6c75  get_angle_resolu
+0000d960: 7469 6f6e 2873 656c 6629 3a0a 2020 2020  tion(self):.    
+0000d970: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d980: 617a 696d 7574 682e 6469 6666 2873 656c  azimuth.diff(sel
+0000d990: 662e 5f64 696d 305b 305d 292e 6d65 6469  f._dim0[0]).medi
+0000d9a0: 616e 2873 6b69 706e 613d 5472 7565 292e  an(skipna=True).
+0000d9b0: 726f 756e 6428 6465 6369 6d61 6c73 3d31  round(decimals=1
+0000d9c0: 290a 0a20 2020 2064 6566 205f 6765 745f  )..    def _get_
+0000d9d0: 6669 7865 645f 616e 676c 6528 7365 6c66  fixed_angle(self
+0000d9e0: 293a 0a20 2020 2020 2020 2023 2074 7279  ):.        # try
+0000d9f0: 2052 4849 2066 6972 7374 0a20 2020 2020   RHI first.     
+0000da00: 2020 2061 6e67 6c65 5f6b 6579 7320 3d20     angle_keys = 
+0000da10: 5b22 617a 5f61 6e67 6c65 222c 2022 617a  ["az_angle", "az
+0000da20: 616e 676c 6522 5d0a 2020 2020 2020 2020  angle"].        
+0000da30: 666f 7220 616b 2069 6e20 616e 676c 655f  for ak in angle_
+0000da40: 6b65 7973 3a0a 2020 2020 2020 2020 2020  keys:.          
+0000da50: 2020 616e 676c 6520 3d20 7365 6c66 2e77    angle = self.w
+0000da60: 6865 7265 2e67 6574 2861 6b2c 204e 6f6e  here.get(ak, Non
+0000da70: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+0000da80: 6620 616e 676c 6520 6973 206e 6f74 204e  f angle is not N
+0000da90: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000daa0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0000dab0: 2020 2069 6620 616e 676c 6520 6973 206e     if angle is n
+0000dac0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000dad0: 2020 2020 2061 6e67 6c65 203d 206e 702e       angle = np.
+0000dae0: 726f 756e 6428 616e 676c 652c 2064 6563  round(angle, dec
+0000daf0: 696d 616c 733d 3129 0a20 2020 2020 2020  imals=1).       
+0000db00: 2020 2020 2073 656c 662e 5f64 696d 3020       self._dim0 
+0000db10: 3d20 2873 656c 662e 5f64 696d 305b 315d  = (self._dim0[1]
+0000db20: 2c20 7365 6c66 2e5f 6469 6d30 5b30 5d29  , self._dim0[0])
+0000db30: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000db40: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
+0000db50: 203d 206e 702e 726f 756e 6428 7365 6c66   = np.round(self
+0000db60: 2e77 6865 7265 5b22 656c 616e 676c 6522  .where["elangle"
+0000db70: 5d2c 2064 6563 696d 616c 733d 3129 0a20  ], decimals=1). 
+0000db80: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
+0000db90: 676c 650a 0a20 2020 2064 6566 205f 6765  gle..    def _ge
+0000dba0: 745f 617a 696d 7574 685f 686f 7728 7365  t_azimuth_how(se
+0000dbb0: 6c66 293a 0a20 2020 2020 2020 2068 6f77  lf):.        how
+0000dbc0: 203d 2073 656c 662e 686f 770a 2020 2020   = self.how.    
+0000dbd0: 2020 2020 7374 6172 7461 7a20 3d20 686f      startaz = ho
+0000dbe0: 775b 2273 7461 7274 617a 4122 5d0a 2020  w["startazA"].  
+0000dbf0: 2020 2020 2020 7374 6f70 617a 203d 2068        stopaz = h
+0000dc00: 6f77 5b22 7374 6f70 617a 4122 5d0a 2020  ow["stopazA"].  
+0000dc10: 2020 2020 2020 7a65 726f 5f69 6e64 6578        zero_index
+0000dc20: 203d 206e 702e 7768 6572 6528 7374 6f70   = np.where(stop
+0000dc30: 617a 203c 2073 7461 7274 617a 290a 2020  az < startaz).  
+0000dc40: 2020 2020 2020 7374 6f70 617a 5b7a 6572        stopaz[zer
+0000dc50: 6f5f 696e 6465 785b 305d 5d20 2b3d 2033  o_index[0]] += 3
+0000dc60: 3630 0a20 2020 2020 2020 2061 7a69 6d75  60.        azimu
+0000dc70: 7468 5f64 6174 6120 3d20 2873 7461 7274  th_data = (start
+0000dc80: 617a 202b 2073 746f 7061 7a29 202f 2032  az + stopaz) / 2
+0000dc90: 2e30 0a20 2020 2020 2020 2072 6574 7572  .0.        retur
+0000dca0: 6e20 617a 696d 7574 685f 6461 7461 0a0a  n azimuth_data..
+0000dcb0: 2020 2020 6465 6620 5f67 6574 5f61 7a69      def _get_azi
+0000dcc0: 6d75 7468 5f77 6865 7265 2873 656c 6629  muth_where(self)
+0000dcd0: 3a0a 2020 2020 2020 2020 6e72 6179 7320  :.        nrays 
+0000dce0: 3d20 7365 6c66 2e77 6865 7265 5b22 6e72  = self.where["nr
+0000dcf0: 6179 7322 5d0a 2020 2020 2020 2020 7265  ays"].        re
+0000dd00: 7320 3d20 3336 302e 3020 2f20 6e72 6179  s = 360.0 / nray
+0000dd10: 730a 2020 2020 2020 2020 617a 696d 7574  s.        azimut
+0000dd20: 685f 6461 7461 203d 206e 702e 6172 616e  h_data = np.aran
+0000dd30: 6765 2872 6573 202f 2032 2e30 2c20 3336  ge(res / 2.0, 36
+0000dd40: 302e 302c 2072 6573 2c20 6474 7970 653d  0.0, res, dtype=
+0000dd50: 2266 6c6f 6174 3332 2229 0a20 2020 2020  "float32").     
+0000dd60: 2020 2072 6574 7572 6e20 617a 696d 7574     return azimut
+0000dd70: 685f 6461 7461 0a0a 2020 2020 6465 6620  h_data..    def 
+0000dd80: 5f67 6574 5f65 6c65 7661 7469 6f6e 5f68  _get_elevation_h
+0000dd90: 6f77 2873 656c 6629 3a0a 2020 2020 2020  ow(self):.      
+0000dda0: 2020 686f 7720 3d20 7365 6c66 2e68 6f77    how = self.how
+0000ddb0: 0a20 2020 2020 2020 2073 7461 7274 656c  .        startel
+0000ddc0: 203d 2068 6f77 5b22 7374 6172 7465 6c41   = how["startelA
+0000ddd0: 225d 0a20 2020 2020 2020 2073 746f 7065  "].        stope
+0000dde0: 6c20 3d20 686f 775b 2273 746f 7065 6c41  l = how["stopelA
+0000ddf0: 225d 0a20 2020 2020 2020 2065 6c65 7661  "].        eleva
+0000de00: 7469 6f6e 5f64 6174 6120 3d20 2873 7461  tion_data = (sta
+0000de10: 7274 656c 202b 2073 746f 7065 6c29 202f  rtel + stopel) /
+0000de20: 2032 2e30 0a20 2020 2020 2020 2072 6574   2.0.        ret
+0000de30: 7572 6e20 656c 6576 6174 696f 6e5f 6461  urn elevation_da
+0000de40: 7461 0a0a 2020 2020 6465 6620 5f67 6574  ta..    def _get
+0000de50: 5f65 6c65 7661 7469 6f6e 5f77 6865 7265  _elevation_where
+0000de60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000de70: 7768 6572 6520 3d20 7365 6c66 2e77 6865  where = self.whe
+0000de80: 7265 0a20 2020 2020 2020 206e 7261 7973  re.        nrays
+0000de90: 203d 2077 6865 7265 5b22 6e72 6179 7322   = where["nrays"
+0000dea0: 5d0a 2020 2020 2020 2020 656c 616e 676c  ].        elangl
+0000deb0: 6520 3d20 7768 6572 655b 2265 6c61 6e67  e = where["elang
+0000dec0: 6c65 225d 0a20 2020 2020 2020 2065 6c65  le"].        ele
+0000ded0: 7661 7469 6f6e 5f64 6174 6120 3d20 6e70  vation_data = np
+0000dee0: 2e6f 6e65 7328 6e72 6179 732c 2064 7479  .ones(nrays, dty
+0000def0: 7065 3d22 666c 6f61 7433 3222 2920 2a20  pe="float32") * 
+0000df00: 656c 616e 676c 650a 2020 2020 2020 2020  elangle.        
+0000df10: 7265 7475 726e 2065 6c65 7661 7469 6f6e  return elevation
+0000df20: 5f64 6174 610a 0a20 2020 2064 6566 205f  _data..    def _
+0000df30: 6765 745f 7469 6d65 5f68 6f77 2873 656c  get_time_how(sel
+0000df40: 6629 3a0a 2020 2020 2020 2020 686f 7720  f):.        how 
+0000df50: 3d20 7365 6c66 2e68 6f77 0a20 2020 2020  = self.how.     
+0000df60: 2020 2073 7461 7274 5420 3d20 686f 775b     startT = how[
+0000df70: 2273 7461 7274 617a 5422 5d0a 2020 2020  "startazT"].    
+0000df80: 2020 2020 7374 6f70 5420 3d20 686f 775b      stopT = how[
+0000df90: 2273 746f 7061 7a54 225d 0a20 2020 2020  "stopazT"].     
+0000dfa0: 2020 2074 696d 655f 6461 7461 203d 2028     time_data = (
+0000dfb0: 7374 6172 7454 202b 2073 746f 7054 2920  startT + stopT) 
+0000dfc0: 2f20 322e 300a 2020 2020 2020 2020 7265  / 2.0.        re
+0000dfd0: 7475 726e 2074 696d 655f 6461 7461 0a0a  turn time_data..
+0000dfe0: 2020 2020 6465 6620 5f67 6574 5f74 696d      def _get_tim
+0000dff0: 655f 7768 6174 2873 656c 662c 206e 7261  e_what(self, nra
+0000e000: 7973 3d4e 6f6e 6529 3a0a 2020 2020 2020  ys=None):.      
+0000e010: 2020 7768 6174 203d 2073 656c 662e 7768    what = self.wh
+0000e020: 6174 0a20 2020 2020 2020 2073 7461 7274  at.        start
+0000e030: 6461 7465 203d 2077 6861 745b 2273 7461  date = what["sta
+0000e040: 7274 6461 7465 225d 0a20 2020 2020 2020  rtdate"].       
+0000e050: 2073 7461 7274 7469 6d65 203d 2077 6861   starttime = wha
+0000e060: 745b 2273 7461 7274 7469 6d65 225d 0a20  t["starttime"]. 
+0000e070: 2020 2020 2020 2065 6e64 6461 7465 203d         enddate =
+0000e080: 2077 6861 745b 2265 6e64 6461 7465 225d   what["enddate"]
+0000e090: 0a20 2020 2020 2020 2065 6e64 7469 6d65  .        endtime
+0000e0a0: 203d 2077 6861 745b 2265 6e64 7469 6d65   = what["endtime
+0000e0b0: 225d 0a20 2020 2020 2020 2073 7461 7274  "].        start
+0000e0c0: 203d 2064 742e 6461 7465 7469 6d65 2e73   = dt.datetime.s
+0000e0d0: 7472 7074 696d 6528 7374 6172 7464 6174  trptime(startdat
+0000e0e0: 6520 2b20 7374 6172 7474 696d 652c 2022  e + starttime, "
+0000e0f0: 2559 256d 2564 2548 254d 2553 2229 0a20  %Y%m%d%H%M%S"). 
+0000e100: 2020 2020 2020 2065 6e64 203d 2064 742e         end = dt.
+0000e110: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
+0000e120: 6528 656e 6464 6174 6520 2b20 656e 6474  e(enddate + endt
+0000e130: 696d 652c 2022 2559 256d 2564 2548 254d  ime, "%Y%m%d%H%M
+0000e140: 2553 2229 0a20 2020 2020 2020 2073 7461  %S").        sta
+0000e150: 7274 203d 2073 7461 7274 2e72 6570 6c61  rt = start.repla
+0000e160: 6365 2874 7a69 6e66 6f3d 6474 2e74 696d  ce(tzinfo=dt.tim
+0000e170: 657a 6f6e 652e 7574 6329 2e74 696d 6573  ezone.utc).times
+0000e180: 7461 6d70 2829 0a20 2020 2020 2020 2065  tamp().        e
+0000e190: 6e64 203d 2065 6e64 2e72 6570 6c61 6365  nd = end.replace
+0000e1a0: 2874 7a69 6e66 6f3d 6474 2e74 696d 657a  (tzinfo=dt.timez
+0000e1b0: 6f6e 652e 7574 6329 2e74 696d 6573 7461  one.utc).timesta
+0000e1c0: 6d70 2829 0a20 2020 2020 2020 2069 6620  mp().        if 
+0000e1d0: 6e72 6179 7320 6973 204e 6f6e 653a 0a20  nrays is None:. 
+0000e1e0: 2020 2020 2020 2020 2020 206e 7261 7973             nrays
+0000e1f0: 203d 2073 656c 662e 7768 6572 655b 226e   = self.where["n
+0000e200: 7261 7973 225d 0a20 2020 2020 2020 2069  rays"].        i
+0000e210: 6620 7374 6172 7420 3d3d 2065 6e64 3a0a  f start == end:.
+0000e220: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0000e230: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+0000e240: 2020 2020 2020 2020 2020 2022 5752 4144             "WRAD
+0000e250: 4c49 423a 2045 7175 616c 204f 4449 4d20  LIB: Equal ODIM 
+0000e260: 6073 7461 7274 7469 6d65 6020 616e 6420  `starttime` and 
+0000e270: 6065 6e64 7469 6d65 6020 220a 2020 2020  `endtime` ".    
+0000e280: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+0000e290: 7565 732e 2043 616e 2774 2064 6574 6572  ues. Can't deter
+0000e2a0: 6d69 6e65 2063 6f72 7265 6374 2073 7765  mine correct swe
+0000e2b0: 6570 2073 7461 7274 2d2c 2022 0a20 2020  ep start-, ".   
+0000e2c0: 2020 2020 2020 2020 2020 2020 2022 656e               "en
+0000e2d0: 642d 2061 6e64 2072 6179 7469 6d65 732e  d- and raytimes.
+0000e2e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000e2f0: 2020 2055 7365 7257 6172 6e69 6e67 2c0a     UserWarning,.
+0000e300: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000e310: 2020 2020 2020 2020 2020 2074 696d 655f             time_
+0000e320: 6461 7461 203d 206e 702e 6f6e 6573 286e  data = np.ones(n
+0000e330: 7261 7973 2920 2a20 7374 6172 740a 2020  rays) * start.  
+0000e340: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000e350: 2020 2020 2020 2020 6465 6c74 6120 3d20          delta = 
+0000e360: 2865 6e64 202d 2073 7461 7274 2920 2f20  (end - start) / 
+0000e370: 6e72 6179 730a 2020 2020 2020 2020 2020  nrays.          
+0000e380: 2020 7469 6d65 5f64 6174 6120 3d20 6e70    time_data = np
+0000e390: 2e61 7261 6e67 6528 7374 6172 7420 2b20  .arange(start + 
+0000e3a0: 6465 6c74 6120 2f20 322e 302c 2065 6e64  delta / 2.0, end
+0000e3b0: 2c20 6465 6c74 6129 0a20 2020 2020 2020  , delta).       
+0000e3c0: 2020 2020 2074 696d 655f 6461 7461 203d       time_data =
+0000e3d0: 206e 702e 726f 6c6c 2874 696d 655f 6461   np.roll(time_da
+0000e3e0: 7461 2c20 7368 6966 743d 2b73 656c 662e  ta, shift=+self.
+0000e3f0: 6131 6761 7465 290a 2020 2020 2020 2020  a1gate).        
+0000e400: 7265 7475 726e 2074 696d 655f 6461 7461  return time_data
+0000e410: 0a0a 2020 2020 6465 6620 5f67 6574 5f72  ..    def _get_r
+0000e420: 6179 5f74 696d 6573 2873 656c 662c 206e  ay_times(self, n
+0000e430: 7261 7973 3d4e 6f6e 6529 3a0a 2020 2020  rays=None):.    
+0000e440: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000e450: 2020 2020 2074 696d 655f 6461 7461 203d       time_data =
+0000e460: 2073 656c 662e 5f67 6574 5f74 696d 655f   self._get_time_
+0000e470: 686f 7728 290a 2020 2020 2020 2020 2020  how().          
+0000e480: 2020 7365 6c66 2e5f 6e65 6564 5f74 696d    self._need_tim
+0000e490: 655f 7265 6361 6c63 203d 2046 616c 7365  e_recalc = False
+0000e4a0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000e4b0: 2841 7474 7269 6275 7465 4572 726f 722c  (AttributeError,
+0000e4c0: 204b 6579 4572 726f 722c 2054 7970 6545   KeyError, TypeE
+0000e4d0: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
+0000e4e0: 2020 2074 696d 655f 6461 7461 203d 2073     time_data = s
+0000e4f0: 656c 662e 5f67 6574 5f74 696d 655f 7768  elf._get_time_wh
+0000e500: 6174 286e 7261 7973 3d6e 7261 7973 290a  at(nrays=nrays).
+0000e510: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e520: 2e5f 6e65 6564 5f74 696d 655f 7265 6361  ._need_time_reca
+0000e530: 6c63 203d 2054 7275 650a 2020 2020 2020  lc = True.      
+0000e540: 2020 6461 203d 2078 722e 4461 7461 4172    da = xr.DataAr
+0000e550: 7261 7928 7469 6d65 5f64 6174 612c 2064  ray(time_data, d
+0000e560: 696d 733d 5b73 656c 662e 5f64 696d 305b  ims=[self._dim0[
+0000e570: 305d 5d2c 2061 7474 7273 3d74 696d 655f  0]], attrs=time_
+0000e580: 6174 7472 7329 0a20 2020 2020 2020 2072  attrs).        r
+0000e590: 6574 7572 6e20 6461 0a0a 2020 2020 6465  eturn da..    de
+0000e5a0: 6620 5f67 6574 5f61 7a69 6d75 7468 2873  f _get_azimuth(s
+0000e5b0: 656c 6629 3a0a 2020 2020 2020 2020 7472  elf):.        tr
+0000e5c0: 793a 0a20 2020 2020 2020 2020 2020 2061  y:.            a
+0000e5d0: 7a69 6d75 7468 5f64 6174 6120 3d20 7365  zimuth_data = se
+0000e5e0: 6c66 2e5f 6765 745f 617a 696d 7574 685f  lf._get_azimuth_
+0000e5f0: 686f 7728 290a 2020 2020 2020 2020 6578  how().        ex
+0000e600: 6365 7074 2028 4174 7472 6962 7574 6545  cept (AttributeE
+0000e610: 7272 6f72 2c20 4b65 7945 7272 6f72 2c20  rror, KeyError, 
+0000e620: 5479 7065 4572 726f 7229 3a0a 2020 2020  TypeError):.    
+0000e630: 2020 2020 2020 2020 617a 696d 7574 685f          azimuth_
+0000e640: 6461 7461 203d 2073 656c 662e 5f67 6574  data = self._get
+0000e650: 5f61 7a69 6d75 7468 5f77 6865 7265 2829  _azimuth_where()
+0000e660: 0a20 2020 2020 2020 2064 6120 3d20 7872  .        da = xr
+0000e670: 2e44 6174 6141 7272 6179 2861 7a69 6d75  .DataArray(azimu
+0000e680: 7468 5f64 6174 612c 2064 696d 733d 5b73  th_data, dims=[s
+0000e690: 656c 662e 5f64 696d 305b 305d 5d2c 2061  elf._dim0[0]], a
+0000e6a0: 7474 7273 3d61 7a5f 6174 7472 7329 0a20  ttrs=az_attrs). 
+0000e6b0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+0000e6c0: 6c66 2e5f 6d69 7363 5f6b 7761 7267 735b  lf._misc_kwargs[
+0000e6d0: 226b 6565 705f 617a 696d 7574 6822 5d20  "keep_azimuth"] 
+0000e6e0: 616e 6420 7365 6c66 2e5f 6469 6d30 5b30  and self._dim0[0
+0000e6f0: 5d20 3d3d 2022 656c 6576 6174 696f 6e22  ] == "elevation"
+0000e700: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+0000e710: 203d 2064 612e 7069 7065 285f 6669 785f   = da.pipe(_fix_
+0000e720: 616e 676c 6529 0a20 2020 2020 2020 2072  angle).        r
+0000e730: 6574 7572 6e20 6461 0a0a 2020 2020 6465  eturn da..    de
+0000e740: 6620 5f67 6574 5f65 6c65 7661 7469 6f6e  f _get_elevation
+0000e750: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000e760: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0000e770: 2065 6c65 7661 7469 6f6e 5f64 6174 6120   elevation_data 
+0000e780: 3d20 7365 6c66 2e5f 6765 745f 656c 6576  = self._get_elev
+0000e790: 6174 696f 6e5f 686f 7728 290a 2020 2020  ation_how().    
+0000e7a0: 2020 2020 6578 6365 7074 2028 4174 7472      except (Attr
+0000e7b0: 6962 7574 6545 7272 6f72 2c20 4b65 7945  ibuteError, KeyE
+0000e7c0: 7272 6f72 2c20 5479 7065 4572 726f 7229  rror, TypeError)
+0000e7d0: 3a0a 2020 2020 2020 2020 2020 2020 656c  :.            el
+0000e7e0: 6576 6174 696f 6e5f 6461 7461 203d 2073  evation_data = s
+0000e7f0: 656c 662e 5f67 6574 5f65 6c65 7661 7469  elf._get_elevati
+0000e800: 6f6e 5f77 6865 7265 2829 0a20 2020 2020  on_where().     
+0000e810: 2020 2064 6120 3d20 7872 2e44 6174 6141     da = xr.DataA
+0000e820: 7272 6179 2865 6c65 7661 7469 6f6e 5f64  rray(elevation_d
+0000e830: 6174 612c 2064 696d 733d 5b73 656c 662e  ata, dims=[self.
+0000e840: 5f64 696d 305b 305d 5d2c 2061 7474 7273  _dim0[0]], attrs
+0000e850: 3d65 6c5f 6174 7472 7329 0a20 2020 2020  =el_attrs).     
+0000e860: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+0000e870: 6d69 7363 5f6b 7761 7267 735b 226b 6565  misc_kwargs["kee
+0000e880: 705f 656c 6576 6174 696f 6e22 5d20 616e  p_elevation"] an
+0000e890: 6420 7365 6c66 2e5f 6469 6d30 5b30 5d20  d self._dim0[0] 
+0000e8a0: 3d3d 2022 617a 696d 7574 6822 3a0a 2020  == "azimuth":.  
+0000e8b0: 2020 2020 2020 2020 2020 6461 203d 2064            da = d
+0000e8c0: 612e 7069 7065 285f 6669 785f 616e 676c  a.pipe(_fix_angl
+0000e8d0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+0000e8e0: 6e20 6461 0a0a 2020 2020 6465 6620 5f67  n da..    def _g
+0000e8f0: 6574 5f6d 6465 7363 2873 656c 6629 3a0a  et_mdesc(self):.
+0000e900: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+0000e910: 6461 7461 220a 0a20 2020 2064 6566 205f  data"..    def _
+0000e920: 6765 745f 7261 6e67 6528 7365 6c66 293a  get_range(self):
+0000e930: 0a20 2020 2020 2020 2077 6865 7265 203d  .        where =
+0000e940: 2073 656c 662e 7768 6572 650a 2020 2020   self.where.    
+0000e950: 2020 2020 6e67 6174 6573 203d 2077 6865      ngates = whe
+0000e960: 7265 5b22 6e62 696e 7322 5d0a 2020 2020  re["nbins"].    
+0000e970: 2020 2020 7261 6e67 655f 7374 6172 7420      range_start 
+0000e980: 3d20 7768 6572 655b 2272 7374 6172 7422  = where["rstart"
+0000e990: 5d20 2a20 3130 3030 2e30 0a20 2020 2020  ] * 1000.0.     
+0000e9a0: 2020 2062 696e 5f72 616e 6765 203d 2077     bin_range = w
+0000e9b0: 6865 7265 5b22 7273 6361 6c65 225d 0a20  here["rscale"]. 
+0000e9c0: 2020 2020 2020 2063 656e 745f 6669 7273         cent_firs
+0000e9d0: 7420 3d20 7261 6e67 655f 7374 6172 7420  t = range_start 
+0000e9e0: 2b20 6269 6e5f 7261 6e67 6520 2f20 322e  + bin_range / 2.
+0000e9f0: 300a 2020 2020 2020 2020 7261 6e67 655f  0.        range_
+0000ea00: 6461 7461 203d 206e 702e 6172 616e 6765  data = np.arange
+0000ea10: 280a 2020 2020 2020 2020 2020 2020 6365  (.            ce
+0000ea20: 6e74 5f66 6972 7374 2c20 7261 6e67 655f  nt_first, range_
+0000ea30: 7374 6172 7420 2b20 6269 6e5f 7261 6e67  start + bin_rang
+0000ea40: 6520 2a20 6e67 6174 6573 2c20 6269 6e5f  e * ngates, bin_
+0000ea50: 7261 6e67 652c 2064 7479 7065 3d22 666c  range, dtype="fl
+0000ea60: 6f61 7433 3222 0a20 2020 2020 2020 2029  oat32".        )
+0000ea70: 0a20 2020 2020 2020 2072 616e 6765 5f61  .        range_a
+0000ea80: 7474 7273 5b22 6d65 7465 7273 5f74 6f5f  ttrs["meters_to_
+0000ea90: 6365 6e74 6572 5f6f 665f 6669 7273 745f  center_of_first_
+0000eaa0: 6761 7465 225d 203d 2063 656e 745f 6669  gate"] = cent_fi
+0000eab0: 7273 740a 2020 2020 2020 2020 7261 6e67  rst.        rang
+0000eac0: 655f 6174 7472 735b 226d 6574 6572 735f  e_attrs["meters_
+0000ead0: 6265 7477 6565 6e5f 6761 7465 7322 5d20  between_gates"] 
+0000eae0: 3d20 6269 6e5f 7261 6e67 650a 2020 2020  = bin_range.    
+0000eaf0: 2020 2020 6461 203d 2078 722e 4461 7461      da = xr.Data
+0000eb00: 4172 7261 7928 7261 6e67 655f 6461 7461  Array(range_data
+0000eb10: 2c20 6469 6d73 3d5b 7365 6c66 2e5f 6469  , dims=[self._di
+0000eb20: 6d31 5d2c 2061 7474 7273 3d72 616e 6765  m1], attrs=range
+0000eb30: 5f61 7474 7273 290a 2020 2020 2020 2020  _attrs).        
+0000eb40: 7265 7475 726e 2064 610a 0a20 2020 2064  return da..    d
+0000eb50: 6566 205f 6d65 7267 655f 6d6f 6d65 6e74  ef _merge_moment
+0000eb60: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000eb70: 2064 7320 3d20 5f6f 7065 6e5f 6d66 6d6f   ds = _open_mfmo
+0000eb80: 6d65 6e74 7328 0a20 2020 2020 2020 2020  ments(.         
+0000eb90: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000eba0: 2020 2020 2063 6875 6e6b 733d 7365 6c66       chunks=self
+0000ebb0: 2e63 6875 6e6b 732c 0a20 2020 2020 2020  .chunks,.       
+0000ebc0: 2020 2020 2070 7265 7072 6f63 6573 733d       preprocess=
+0000ebd0: 5f70 7265 7072 6f63 6573 735f 6d6f 6d65  _preprocess_mome
+0000ebe0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+0000ebf0: 7061 7261 6c6c 656c 3d73 656c 662e 7061  parallel=self.pa
+0000ec00: 7261 6c6c 656c 2c0a 2020 2020 2020 2020  rallel,.        
+0000ec10: 2020 2020 6d61 736b 5f61 6e64 5f73 6361      mask_and_sca
+0000ec20: 6c65 3d73 656c 662e 6d61 736b 5f61 6e64  le=self.mask_and
+0000ec30: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
+0000ec40: 2020 2020 6465 636f 6465 5f74 696d 6573      decode_times
+0000ec50: 3d73 656c 662e 6465 636f 6465 5f74 696d  =self.decode_tim
+0000ec60: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0000ec70: 6465 636f 6465 5f63 6f6f 7264 733d 7365  decode_coords=se
+0000ec80: 6c66 2e64 6563 6f64 655f 636f 6f72 6473  lf.decode_coords
+0000ec90: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000eca0: 2020 2020 7265 7475 726e 2064 730a 0a20      return ds.. 
+0000ecb0: 2020 2064 6566 205f 6765 745f 6e72 6179     def _get_nray
+0000ecc0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000ecd0: 2072 6574 7572 6e20 7365 6c66 2e77 6865   return self.whe
+0000ece0: 7265 5b22 6e72 6179 7322 5d0a 0a20 2020  re["nrays"]..   
+0000ecf0: 2064 6566 205f 6765 745f 6e62 696e 7328   def _get_nbins(
+0000ed00: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000ed10: 6574 7572 6e20 7365 6c66 2e77 6865 7265  eturn self.where
+0000ed20: 5b22 6e62 696e 7322 5d0a 0a20 2020 2064  ["nbins"]..    d
+0000ed30: 6566 205f 6765 745f 7469 6d65 2873 656c  ef _get_time(sel
+0000ed40: 662c 2070 6f69 6e74 3d22 7374 6172 7422  f, point="start"
+0000ed50: 293a 0a20 2020 2020 2020 2077 6861 7420  ):.        what 
+0000ed60: 3d20 7365 6c66 2e77 6861 740a 2020 2020  = self.what.    
+0000ed70: 2020 2020 7374 6172 7464 6174 6520 3d20      startdate = 
+0000ed80: 7768 6174 5b66 227b 706f 696e 747d 6461  what[f"{point}da
+0000ed90: 7465 225d 0a20 2020 2020 2020 2073 7461  te"].        sta
+0000eda0: 7274 7469 6d65 203d 2077 6861 745b 6622  rttime = what[f"
+0000edb0: 7b70 6f69 6e74 7d74 696d 6522 5d0a 2020  {point}time"].  
+0000edc0: 2020 2020 2020 7374 6172 7420 3d20 6474        start = dt
+0000edd0: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
+0000ede0: 6d65 2873 7461 7274 6461 7465 202b 2073  me(startdate + s
+0000edf0: 7461 7274 7469 6d65 2c20 2225 5925 6d25  tarttime, "%Y%m%
+0000ee00: 6425 4825 4d25 5322 290a 2020 2020 2020  d%H%M%S").      
+0000ee10: 2020 7374 6172 7420 3d20 7374 6172 742e    start = start.
+0000ee20: 7265 706c 6163 6528 747a 696e 666f 3d64  replace(tzinfo=d
+0000ee30: 742e 7469 6d65 7a6f 6e65 2e75 7463 292e  t.timezone.utc).
+0000ee40: 7469 6d65 7374 616d 7028 290a 2020 2020  timestamp().    
+0000ee50: 2020 2020 6461 203d 2078 722e 4461 7461      da = xr.Data
+0000ee60: 4172 7261 7928 7374 6172 742c 2061 7474  Array(start, att
+0000ee70: 7273 3d74 696d 655f 6174 7472 7329 0a20  rs=time_attrs). 
+0000ee80: 2020 2020 2020 2072 6574 7572 6e20 6461         return da
+0000ee90: 0a0a 2020 2020 6465 6620 5f67 6574 5f74  ..    def _get_t
+0000eea0: 696d 655f 6661 7374 2873 656c 6629 3a0a  ime_fast(self):.
+0000eeb0: 2020 2020 2020 2020 6e63 6964 203d 2073          ncid = s
+0000eec0: 656c 662e 6e63 6964 0a20 2020 2020 2020  elf.ncid.       
+0000eed0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000eee0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000eef0: 7365 6c66 2e6e 6366 696c 652c 206e 632e  self.ncfile, nc.
+0000ef00: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
+0000ef10: 2020 2020 2020 2020 2020 7374 6172 7464            startd
+0000ef20: 6174 6520 3d20 6e63 6964 5b22 7768 6174  ate = ncid["what
+0000ef30: 225d 2e67 6574 6e63 6174 7472 2822 7374  "].getncattr("st
+0000ef40: 6172 7464 6174 6522 290a 2020 2020 2020  artdate").      
+0000ef50: 2020 2020 2020 2020 2020 7374 6172 7474            startt
+0000ef60: 696d 6520 3d20 6e63 6964 5b22 7768 6174  ime = ncid["what
+0000ef70: 225d 2e67 6574 6e63 6174 7472 2822 7374  "].getncattr("st
+0000ef80: 6172 7474 696d 6522 290a 2020 2020 2020  arttime").      
+0000ef90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000efa0: 2020 2020 2020 2020 2020 2020 7374 6172              star
+0000efb0: 7464 6174 6520 3d20 6e63 6964 5b22 7768  tdate = ncid["wh
+0000efc0: 6174 225d 2e61 7474 7273 5b22 7374 6172  at"].attrs["star
+0000efd0: 7464 6174 6522 5d2e 6974 656d 2829 2e64  tdate"].item().d
+0000efe0: 6563 6f64 6528 290a 2020 2020 2020 2020  ecode().        
+0000eff0: 2020 2020 2020 2020 7374 6172 7474 696d          starttim
+0000f000: 6520 3d20 6e63 6964 5b22 7768 6174 225d  e = ncid["what"]
+0000f010: 2e61 7474 7273 5b22 7374 6172 7474 696d  .attrs["starttim
+0000f020: 6522 5d2e 6974 656d 2829 2e64 6563 6f64  e"].item().decod
+0000f030: 6528 290a 2020 2020 2020 2020 6578 6365  e().        exce
+0000f040: 7074 2028 496e 6465 7845 7272 6f72 2c20  pt (IndexError, 
+0000f050: 4b65 7945 7272 6f72 293a 0a20 2020 2020  KeyError):.     
+0000f060: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0000f070: 6e65 0a20 2020 2020 2020 2073 7461 7274  ne.        start
+0000f080: 203d 2064 742e 6461 7465 7469 6d65 2e73   = dt.datetime.s
+0000f090: 7472 7074 696d 6528 7374 6172 7464 6174  trptime(startdat
+0000f0a0: 6520 2b20 7374 6172 7474 696d 652c 2022  e + starttime, "
+0000f0b0: 2559 256d 2564 2548 254d 2553 2229 0a20  %Y%m%d%H%M%S"). 
+0000f0c0: 2020 2020 2020 2073 7461 7274 203d 2073         start = s
+0000f0d0: 7461 7274 2e72 6570 6c61 6365 2874 7a69  tart.replace(tzi
+0000f0e0: 6e66 6f3d 6474 2e74 696d 657a 6f6e 652e  nfo=dt.timezone.
+0000f0f0: 7574 6329 2e74 696d 6573 7461 6d70 2829  utc).timestamp()
+0000f100: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000f110: 7374 6172 740a 0a0a 636c 6173 7320 5852  start...class XR
+0000f120: 6164 5377 6565 7047 616d 6963 2858 5261  adSweepGamic(XRa
+0000f130: 6453 7765 6570 293a 0a20 2020 2022 2222  dSweep):.    """
+0000f140: 436c 6173 7320 666f 7220 686f 6c64 696e  Class for holdin
+0000f150: 6720 6f6e 6520 7261 6461 7220 7377 6565  g one radar swee
+0000f160: 700a 0a20 2020 2050 6172 616d 6574 6572  p..    Parameter
+0000f170: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0000f180: 0a20 2020 206e 6366 696c 6520 3a20 7b6e  .    ncfile : {n
+0000f190: 6574 4344 4634 2e44 6174 6173 6574 2c20  etCDF4.Dataset, 
+0000f1a0: 6835 7079 2e46 696c 6520 6f72 2068 356e  h5py.File or h5n
+0000f1b0: 6574 6364 662e 4669 6c65 206f 626a 6563  etcdf.File objec
+0000f1c0: 747d 0a20 2020 2020 2020 2046 696c 6520  t}.        File 
+0000f1d0: 6861 6e64 6c65 206f 6620 6669 6c65 2063  handle of file c
+0000f1e0: 6f6e 7461 696e 696e 6720 7261 6461 7220  ontaining radar 
+0000f1f0: 7377 6565 700a 2020 2020 6e63 7061 7468  sweep.    ncpath
+0000f200: 203a 2073 7472 0a20 2020 2020 2020 2070   : str.        p
+0000f210: 6174 6820 746f 2073 7765 6570 2067 726f  ath to sweep gro
+0000f220: 7570 0a20 2020 2022 2222 0a0a 2020 2020  up.    """..    
+0000f230: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0000f240: 662c 206e 6366 696c 652c 206e 6370 6174  f, ncfile, ncpat
+0000f250: 682c 2070 6172 656e 743d 4e6f 6e65 2c20  h, parent=None, 
+0000f260: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0000f270: 2020 2073 7570 6572 2858 5261 6453 7765     super(XRadSwe
+0000f280: 6570 4761 6d69 632c 2073 656c 6629 2e5f  epGamic, self)._
+0000f290: 5f69 6e69 745f 5f28 6e63 6669 6c65 2c20  _init__(ncfile, 
+0000f2a0: 6e63 7061 7468 2c20 7061 7265 6e74 2c20  ncpath, parent, 
+0000f2b0: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
+0000f2c0: 2020 7365 6c66 2e5f 7261 795f 6865 6164    self._ray_head
+0000f2d0: 6572 203d 204e 6f6e 650a 0a20 2020 2040  er = None..    @
+0000f2e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0000f2f0: 2072 6179 5f68 6561 6465 7228 7365 6c66   ray_header(self
+0000f300: 293a 0a20 2020 2020 2020 2023 2074 6f64  ):.        # tod
+0000f310: 6f3a 2063 6163 6869 6e67 2061 6464 7320  o: caching adds 
+0000f320: 746f 206d 656d 6f72 7920 666f 6f74 7072  to memory footpr
+0000f330: 696e 740a 2020 2020 2020 2020 6966 2073  int.        if s
+0000f340: 656c 662e 5f72 6179 5f68 6561 6465 7220  elf._ray_header 
+0000f350: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000f360: 2020 2020 2073 656c 662e 5f72 6179 5f68       self._ray_h
+0000f370: 6561 6465 7220 3d20 7365 6c66 2e6e 6369  eader = self.nci
+0000f380: 645b 2272 6179 5f68 6561 6465 7222 5d5b  d["ray_header"][
+0000f390: 3a5d 0a20 2020 2020 2020 2072 6574 7572  :].        retur
+0000f3a0: 6e20 7365 6c66 2e5f 7261 795f 6865 6164  n self._ray_head
+0000f3b0: 6572 0a0a 2020 2020 6465 6620 5f67 6574  er..    def _get
+0000f3c0: 5f61 3167 6174 6528 7365 6c66 293a 0a20  _a1gate(self):. 
+0000f3d0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
+0000f3e0: 2e61 7267 736f 7274 2873 656c 662e 636f  .argsort(self.co
+0000f3f0: 6f72 6473 2e72 7469 6d65 2e76 616c 7565  ords.rtime.value
+0000f400: 7329 5b30 5d0a 0a20 2020 2064 6566 205f  s)[0]..    def _
+0000f410: 6765 745f 616e 676c 655f 7265 736f 6c75  get_angle_resolu
+0000f420: 7469 6f6e 2873 656c 6629 3a0a 2020 2020  tion(self):.    
+0000f430: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f440: 686f 775b 2261 6e67 6c65 5f73 7465 7022  how["angle_step"
+0000f450: 5d0a 0a20 2020 2064 6566 205f 6765 745f  ]..    def _get_
+0000f460: 617a 696d 7574 6828 7365 6c66 293a 0a20  azimuth(self):. 
+0000f470: 2020 2020 2020 2061 7a73 7461 7274 203d         azstart =
+0000f480: 2073 656c 662e 7261 795f 6865 6164 6572   self.ray_header
+0000f490: 5b22 617a 696d 7574 685f 7374 6172 7422  ["azimuth_start"
+0000f4a0: 5d0a 2020 2020 2020 2020 617a 7374 6f70  ].        azstop
+0000f4b0: 203d 2073 656c 662e 7261 795f 6865 6164   = self.ray_head
+0000f4c0: 6572 5b22 617a 696d 7574 685f 7374 6f70  er["azimuth_stop
+0000f4d0: 225d 0a20 2020 2020 2020 2069 6620 7365  "].        if se
+0000f4e0: 6c66 2e5f 6469 6d30 5b30 5d20 3d3d 2022  lf._dim0[0] == "
+0000f4f0: 617a 696d 7574 6822 3a0a 2020 2020 2020  azimuth":.      
+0000f500: 2020 2020 2020 7a65 726f 5f69 6e64 6578        zero_index
+0000f510: 203d 206e 702e 7768 6572 6528 617a 7374   = np.where(azst
+0000f520: 6f70 203c 2061 7a73 7461 7274 290a 2020  op < azstart).  
+0000f530: 2020 2020 2020 2020 2020 617a 7374 6f70            azstop
+0000f540: 5b7a 6572 6f5f 696e 6465 785b 305d 5d20  [zero_index[0]] 
+0000f550: 2b3d 2033 3630 0a20 2020 2020 2020 2061  += 360.        a
+0000f560: 7a69 6d75 7468 203d 2028 617a 7374 6172  zimuth = (azstar
+0000f570: 7420 2b20 617a 7374 6f70 2920 2f20 322e  t + azstop) / 2.
+0000f580: 300a 2020 2020 2020 2020 6461 203d 2078  0.        da = x
+0000f590: 722e 4461 7461 4172 7261 7928 617a 696d  r.DataArray(azim
+0000f5a0: 7574 682c 2064 696d 733d 5b73 656c 662e  uth, dims=[self.
+0000f5b0: 5f64 696d 305b 305d 5d2c 2061 7474 7273  _dim0[0]], attrs
+0000f5c0: 3d61 7a5f 6174 7472 7329 0a20 2020 2020  =az_attrs).     
+0000f5d0: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+0000f5e0: 6d69 7363 5f6b 7761 7267 735b 226b 6565  misc_kwargs["kee
+0000f5f0: 705f 617a 696d 7574 6822 5d20 616e 6420  p_azimuth"] and 
+0000f600: 7365 6c66 2e5f 6469 6d30 5b30 5d20 3d3d  self._dim0[0] ==
+0000f610: 2022 656c 6576 6174 696f 6e22 3a0a 2020   "elevation":.  
+0000f620: 2020 2020 2020 2020 2020 6461 203d 2064            da = d
+0000f630: 612e 7069 7065 285f 6669 785f 616e 676c  a.pipe(_fix_angl
+0000f640: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+0000f650: 6e20 6461 0a0a 2020 2020 6465 6620 5f67  n da..    def _g
+0000f660: 6574 5f65 6c65 7661 7469 6f6e 2873 656c  et_elevation(sel
+0000f670: 6629 3a0a 2020 2020 2020 2020 656c 7374  f):.        elst
+0000f680: 6172 7420 3d20 7365 6c66 2e72 6179 5f68  art = self.ray_h
+0000f690: 6561 6465 725b 2265 6c65 7661 7469 6f6e  eader["elevation
+0000f6a0: 5f73 7461 7274 225d 0a20 2020 2020 2020  _start"].       
+0000f6b0: 2065 6c73 746f 7020 3d20 7365 6c66 2e72   elstop = self.r
+0000f6c0: 6179 5f68 6561 6465 725b 2265 6c65 7661  ay_header["eleva
+0000f6d0: 7469 6f6e 5f73 746f 7022 5d0a 2020 2020  tion_stop"].    
+0000f6e0: 2020 2020 656c 6576 6174 696f 6e20 3d20      elevation = 
+0000f6f0: 2865 6c73 7461 7274 202b 2065 6c73 746f  (elstart + elsto
+0000f700: 7029 202f 2032 2e30 0a20 2020 2020 2020  p) / 2.0.       
+0000f710: 2064 6120 3d20 7872 2e44 6174 6141 7272   da = xr.DataArr
+0000f720: 6179 2865 6c65 7661 7469 6f6e 2c20 6469  ay(elevation, di
+0000f730: 6d73 3d5b 7365 6c66 2e5f 6469 6d30 5b30  ms=[self._dim0[0
+0000f740: 5d5d 2c20 6174 7472 733d 656c 5f61 7474  ]], attrs=el_att
+0000f750: 7273 290a 2020 2020 2020 2020 6966 206e  rs).        if n
+0000f760: 6f74 2073 656c 662e 5f6d 6973 635f 6b77  ot self._misc_kw
+0000f770: 6172 6773 5b22 6b65 6570 5f65 6c65 7661  args["keep_eleva
+0000f780: 7469 6f6e 225d 2061 6e64 2073 656c 662e  tion"] and self.
+0000f790: 5f64 696d 305b 305d 203d 3d20 2261 7a69  _dim0[0] == "azi
+0000f7a0: 6d75 7468 223a 0a20 2020 2020 2020 2020  muth":.         
+0000f7b0: 2020 2064 6120 3d20 6461 2e70 6970 6528     da = da.pipe(
+0000f7c0: 5f66 6978 5f61 6e67 6c65 290a 2020 2020  _fix_angle).    
+0000f7d0: 2020 2020 7265 7475 726e 2064 610a 0a20      return da.. 
+0000f7e0: 2020 2064 6566 205f 6765 745f 6d64 6573     def _get_mdes
+0000f7f0: 6328 7365 6c66 293a 0a20 2020 2020 2020  c(self):.       
+0000f800: 2072 6574 7572 6e20 226d 6f6d 656e 745f   return "moment_
+0000f810: 220a 0a20 2020 2064 6566 205f 6765 745f  "..    def _get_
+0000f820: 7261 6e67 6528 7365 6c66 293a 0a20 2020  range(self):.   
+0000f830: 2020 2020 2072 616e 6765 5f73 616d 706c       range_sampl
+0000f840: 6573 203d 2073 656c 662e 686f 775b 2272  es = self.how["r
+0000f850: 616e 6765 5f73 616d 706c 6573 225d 0a20  ange_samples"]. 
+0000f860: 2020 2020 2020 2072 616e 6765 5f73 7465         range_ste
+0000f870: 7020 3d20 7365 6c66 2e68 6f77 5b22 7261  p = self.how["ra
+0000f880: 6e67 655f 7374 6570 225d 0a20 2020 2020  nge_step"].     
+0000f890: 2020 2062 696e 5f72 616e 6765 203d 2072     bin_range = r
+0000f8a0: 616e 6765 5f73 7465 7020 2a20 7261 6e67  ange_step * rang
+0000f8b0: 655f 7361 6d70 6c65 730a 2020 2020 2020  e_samples.      
+0000f8c0: 2020 7261 6e67 655f 6461 7461 203d 206e    range_data = n
+0000f8d0: 702e 6172 616e 6765 280a 2020 2020 2020  p.arange(.      
+0000f8e0: 2020 2020 2020 6269 6e5f 7261 6e67 6520        bin_range 
+0000f8f0: 2f20 322e 302c 2062 696e 5f72 616e 6765  / 2.0, bin_range
+0000f900: 202a 2073 656c 662e 6e62 696e 732c 2062   * self.nbins, b
+0000f910: 696e 5f72 616e 6765 2c20 6474 7970 653d  in_range, dtype=
+0000f920: 2266 6c6f 6174 3332 220a 2020 2020 2020  "float32".      
+0000f930: 2020 290a 2020 2020 2020 2020 7261 6e67    ).        rang
+0000f940: 655f 6174 7472 735b 226d 6574 6572 735f  e_attrs["meters_
+0000f950: 746f 5f63 656e 7465 725f 6f66 5f66 6972  to_center_of_fir
+0000f960: 7374 5f67 6174 6522 5d20 3d20 6269 6e5f  st_gate"] = bin_
+0000f970: 7261 6e67 6520 2f20 322e 300a 2020 2020  range / 2.0.    
+0000f980: 2020 2020 6461 203d 2078 722e 4461 7461      da = xr.Data
+0000f990: 4172 7261 7928 7261 6e67 655f 6461 7461  Array(range_data
+0000f9a0: 2c20 6469 6d73 3d5b 7365 6c66 2e5f 6469  , dims=[self._di
+0000f9b0: 6d31 5d2c 2061 7474 7273 3d72 616e 6765  m1], attrs=range
+0000f9c0: 5f61 7474 7273 290a 2020 2020 2020 2020  _attrs).        
+0000f9d0: 7265 7475 726e 2064 610a 0a20 2020 2064  return da..    d
+0000f9e0: 6566 205f 6765 745f 7261 795f 7469 6d65  ef _get_ray_time
+0000f9f0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+0000fa00: 2074 696d 6573 203d 2073 656c 662e 7261   times = self.ra
+0000fa10: 795f 6865 6164 6572 5b22 7469 6d65 7374  y_header["timest
+0000fa20: 616d 7022 5d20 2f20 3165 360a 2020 2020  amp"] / 1e6.    
+0000fa30: 2020 2020 6174 7472 7320 3d20 7b22 756e      attrs = {"un
+0000fa40: 6974 7322 3a20 2273 6563 6f6e 6473 2073  its": "seconds s
+0000fa50: 696e 6365 2031 3937 302d 3031 2d30 3154  ince 1970-01-01T
+0000fa60: 3030 3a30 303a 3030 5a22 2c20 2273 7461  00:00:00Z", "sta
+0000fa70: 6e64 6172 645f 6e61 6d65 223a 2022 7469  ndard_name": "ti
+0000fa80: 6d65 227d 0a20 2020 2020 2020 2064 6120  me"}.        da 
+0000fa90: 3d20 7872 2e44 6174 6141 7272 6179 2874  = xr.DataArray(t
+0000faa0: 696d 6573 2c20 6469 6d73 3d5b 7365 6c66  imes, dims=[self
+0000fab0: 2e5f 6469 6d30 5b30 5d5d 2c20 6174 7472  ._dim0[0]], attr
+0000fac0: 733d 6174 7472 7329 0a20 2020 2020 2020  s=attrs).       
+0000fad0: 2072 6574 7572 6e20 6461 0a0a 2020 2020   return da..    
+0000fae0: 6465 6620 5f67 6574 5f66 6978 6564 5f61  def _get_fixed_a
+0000faf0: 6e67 6c65 2873 656c 6629 3a0a 2020 2020  ngle(self):.    
+0000fb00: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000fb10: 2020 2020 2061 6e67 6c65 203d 206e 702e       angle = np.
+0000fb20: 726f 756e 6428 7365 6c66 2e68 6f77 5b73  round(self.how[s
+0000fb30: 656c 662e 5f64 696d 305b 315d 5d2c 2064  elf._dim0[1]], d
+0000fb40: 6563 696d 616c 733d 3129 0a20 2020 2020  ecimals=1).     
+0000fb50: 2020 2065 7863 6570 7420 4b65 7945 7272     except KeyErr
+0000fb60: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0000fb70: 7365 6c66 2e5f 6469 6d30 203d 2028 7365  self._dim0 = (se
+0000fb80: 6c66 2e5f 6469 6d30 5b31 5d2c 2073 656c  lf._dim0[1], sel
+0000fb90: 662e 5f64 696d 305b 305d 290a 2020 2020  f._dim0[0]).    
+0000fba0: 2020 2020 2020 2020 616e 676c 6520 3d20          angle = 
+0000fbb0: 6e70 2e72 6f75 6e64 2873 656c 662e 686f  np.round(self.ho
+0000fbc0: 775b 7365 6c66 2e5f 6469 6d30 5b31 5d5d  w[self._dim0[1]]
+0000fbd0: 2c20 6465 6369 6d61 6c73 3d31 290a 0a20  , decimals=1).. 
+0000fbe0: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
+0000fbf0: 676c 650a 0a20 2020 2064 6566 205f 6d65  gle..    def _me
+0000fc00: 7267 655f 6d6f 6d65 6e74 7328 7365 6c66  rge_moments(self
+0000fc10: 293a 0a20 2020 2020 2020 2069 6620 2268  ):.        if "h
+0000fc20: 3522 2069 6e20 7365 6c66 2e65 6e67 696e  5" in self.engin
+0000fc30: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+0000fc40: 6620 4c6f 6f73 6556 6572 7369 6f6e 2868  f LooseVersion(h
+0000fc50: 356e 6574 6364 662e 5f5f 7665 7273 696f  5netcdf.__versio
+0000fc60: 6e5f 5f29 203c 204c 6f6f 7365 5665 7273  n__) < LooseVers
+0000fc70: 696f 6e28 2230 2e38 2e30 2229 3a0a 2020  ion("0.8.0"):.  
+0000fc80: 2020 2020 2020 2020 2020 2020 2020 7761                wa
+0000fc90: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+0000fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fcb0: 2066 2257 5241 444c 4942 3a20 2768 356e   f"WRADLIB: 'h5n
+0000fcc0: 6574 6364 663e 3d30 2e38 2e30 2720 6e65  etcdf>=0.8.0' ne
+0000fcd0: 6564 6564 2074 6f20 7065 7266 6f72 6d20  eded to perform 
+0000fce0: 7468 6973 2022 0a20 2020 2020 2020 2020  this ".         
+0000fcf0: 2020 2020 2020 2020 2020 2066 226f 7065             f"ope
+0000fd00: 7261 7469 6f6e 2e20 2768 356e 6574 6364  ration. 'h5netcd
+0000fd10: 663d 7b68 356e 6574 6364 662e 5f5f 7665  f={h5netcdf.__ve
+0000fd20: 7273 696f 6e5f 5f7d 2022 0a20 2020 2020  rsion__} ".     
+0000fd30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000fd40: 2261 7661 696c 6162 6c65 2e22 2c0a 2020  "available.",.  
+0000fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd60: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
+0000fd70: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000fd80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fd90: 2072 6574 7572 6e20 4e6f 6e65 0a20 2020   return None.   
+0000fda0: 2020 2020 2020 2020 2069 6620 4c6f 6f73           if Loos
+0000fdb0: 6556 6572 7369 6f6e 2878 722e 5f5f 7665  eVersion(xr.__ve
+0000fdc0: 7273 696f 6e5f 5f29 203c 204c 6f6f 7365  rsion__) < Loose
+0000fdd0: 5665 7273 696f 6e28 2230 2e31 352e 3022  Version("0.15.0"
+0000fde0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000fdf0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0000fe00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000fe10: 2020 2020 2020 6622 5752 4144 4c49 423a        f"WRADLIB:
+0000fe20: 2027 7861 7272 6179 3e3d 302e 3135 2e30   'xarray>=0.15.0
+0000fe30: 2720 6e65 6564 6564 2074 6f20 7065 7266  ' needed to perf
+0000fe40: 6f72 6d20 7468 6973 2022 0a20 2020 2020  orm this ".     
+0000fe50: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000fe60: 226f 7065 7261 7469 6f6e 2e20 2778 6172  "operation. 'xar
+0000fe70: 7261 793d 7b78 722e 5f5f 7665 7273 696f  ray={xr.__versio
+0000fe80: 6e5f 5f7d 2022 0a20 2020 2020 2020 2020  n__} ".         
+0000fe90: 2020 2020 2020 2020 2020 2066 2261 7661             f"ava
+0000fea0: 696c 6162 6c65 2e22 2c0a 2020 2020 2020  ilable.",.      
+0000feb0: 2020 2020 2020 2020 2020 2020 2020 5573                Us
+0000fec0: 6572 5761 726e 696e 672c 0a20 2020 2020  erWarning,.     
+0000fed0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000fee0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000fef0: 7572 6e20 4e6f 6e65 0a20 2020 2020 2020  urn None.       
+0000ff00: 2020 2020 206f 7065 6e65 7220 3d20 6835       opener = h5
+0000ff10: 6e65 7463 6466 2e46 696c 650a 2020 2020  netcdf.File.    
+0000ff20: 2020 2020 2020 2020 6f70 656e 6572 5f6b          opener_k
+0000ff30: 7761 7267 7320 3d20 6469 6374 2870 686f  wargs = dict(pho
+0000ff40: 6e79 5f64 696d 733d 2261 6363 6573 7322  ny_dims="access"
+0000ff50: 290a 2020 2020 2020 2020 2020 2020 7374  ).            st
+0000ff60: 6f72 6520 3d20 7872 2e62 6163 6b65 6e64  ore = xr.backend
+0000ff70: 732e 4835 4e65 7443 4446 5374 6f72 650a  s.H5NetCDFStore.
+0000ff80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000ff90: 2020 2020 2020 2020 2020 6f70 656e 6572            opener
+0000ffa0: 203d 206e 632e 4461 7461 7365 740a 2020   = nc.Dataset.  
+0000ffb0: 2020 2020 2020 2020 2020 6f70 656e 6572            opener
+0000ffc0: 5f6b 7761 7267 7320 3d20 6469 6374 2829  _kwargs = dict()
+0000ffd0: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+0000ffe0: 7265 203d 2078 722e 6261 636b 656e 6473  re = xr.backends
+0000fff0: 2e4e 6574 4344 4634 4461 7461 5374 6f72  .NetCDF4DataStor
+00010000: 650a 0a20 2020 2020 2020 2069 6620 6f73  e..        if os
+00010010: 2e70 6174 682e 6973 6669 6c65 2873 656c  .path.isfile(sel
+00010020: 662e 6669 6c65 6e61 6d65 293a 0a20 2020  f.filename):.   
+00010030: 2020 2020 2020 2020 2064 7330 203d 206f           ds0 = o
+00010040: 7065 6e65 7228 7365 6c66 2e66 696c 656e  pener(self.filen
+00010050: 616d 652c 2022 7222 2c20 2a2a 6f70 656e  ame, "r", **open
+00010060: 6572 5f6b 7761 7267 7329 0a20 2020 2020  er_kwargs).     
+00010070: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00010080: 2020 2020 2064 7330 203d 2073 656c 662e       ds0 = self.
+00010090: 6e63 6669 6c65 0a0a 2020 2020 2020 2020  ncfile..        
+000100a0: 6473 203d 2078 722e 6f70 656e 5f64 6174  ds = xr.open_dat
+000100b0: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
+000100c0: 2020 7374 6f72 6528 6473 302c 2073 656c    store(ds0, sel
+000100d0: 662e 6e63 7061 7468 2c20 6c6f 636b 3d4e  f.ncpath, lock=N
+000100e0: 6f6e 652c 2061 7574 6f63 6c6f 7365 3d4e  one, autoclose=N
+000100f0: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
+00010100: 2020 656e 6769 6e65 3d73 656c 662e 656e    engine=self.en
+00010110: 6769 6e65 2c0a 2020 2020 2020 2020 2020  gine,.          
+00010120: 2020 6368 756e 6b73 3d73 656c 662e 6368    chunks=self.ch
+00010130: 756e 6b73 2c0a 2020 2020 2020 2020 290a  unks,.        ).
+00010140: 2020 2020 2020 2020 6473 203d 2064 732e          ds = ds.
+00010150: 6472 6f70 5f76 6172 7328 2272 6179 5f68  drop_vars("ray_h
+00010160: 6561 6465 7222 2c20 6572 726f 7273 3d22  eader", errors="
+00010170: 6967 6e6f 7265 2229 0a20 2020 2020 2020  ignore").       
+00010180: 2066 6f72 206d 6f6d 2069 6e20 7365 6c66   for mom in self
+00010190: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
+000101a0: 6d5f 6e61 6d65 203d 206d 6f6d 2e6e 6370  m_name = mom.ncp
+000101b0: 6174 682e 7370 6c69 7428 222f 2229 5b2d  ath.split("/")[-
+000101c0: 315d 0a20 2020 2020 2020 2020 2020 2064  1].            d
+000101d0: 6d6f 6d20 3d20 6473 5b6d 6f6d 5f6e 616d  mom = ds[mom_nam
+000101e0: 655d 0a20 2020 2020 2020 2020 2020 206e  e].            n
+000101f0: 616d 6520 3d20 646d 6f6d 2e6d 6f6d 656e  ame = dmom.momen
+00010200: 742e 6c6f 7765 7228 290a 2020 2020 2020  t.lower().      
+00010210: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00010220: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+00010230: 3d20 4741 4d49 435f 4e41 4d45 535b 6e61  = GAMIC_NAMES[na
+00010240: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
+00010250: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
+00010260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010270: 2064 7320 3d20 6473 2e64 726f 705f 7661   ds = ds.drop_va
+00010280: 7273 286d 6f6d 5f6e 616d 6529 0a20 2020  rs(mom_name).   
+00010290: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+000102a0: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
+000102b0: 2020 2023 2065 7874 7261 6374 2061 6e64     # extract and
+000102c0: 2074 7261 6e73 6c61 7465 2061 7474 7269   translate attri
+000102d0: 6275 7465 7320 746f 2063 660a 2020 2020  butes to cf.    
+000102e0: 2020 2020 2020 2020 6174 7472 7320 3d20          attrs = 
+000102f0: 636f 6c6c 6563 7469 6f6e 732e 4f72 6465  collections.Orde
+00010300: 7265 6444 6963 7428 290a 2020 2020 2020  redDict().      
+00010310: 2020 2020 2020 646d 6178 203d 206e 702e        dmax = np.
+00010320: 6969 6e66 6f28 646d 6f6d 2e64 7479 7065  iinfo(dmom.dtype
+00010330: 292e 6d61 780a 2020 2020 2020 2020 2020  ).max.          
+00010340: 2020 646d 696e 203d 206e 702e 6969 6e66    dmin = np.iinf
+00010350: 6f28 646d 6f6d 2e64 7479 7065 292e 6d69  o(dmom.dtype).mi
+00010360: 6e0a 2020 2020 2020 2020 2020 2020 6d69  n.            mi
+00010370: 6e76 616c 203d 2064 6d6f 6d2e 6479 6e5f  nval = dmom.dyn_
+00010380: 7261 6e67 655f 6d69 6e0a 2020 2020 2020  range_min.      
+00010390: 2020 2020 2020 6d61 7876 616c 203d 2064        maxval = d
+000103a0: 6d6f 6d2e 6479 6e5f 7261 6e67 655f 6d61  mom.dyn_range_ma
+000103b0: 780a 2020 2020 2020 2020 2020 2020 6966  x.            if
+000103c0: 206d 6178 7661 6c20 213d 206d 696e 7661   maxval != minva
+000103d0: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
+000103e0: 2020 2067 6169 6e20 3d20 286d 6178 7661     gain = (maxva
+000103f0: 6c20 2d20 6d69 6e76 616c 2920 2f20 646d  l - minval) / dm
+00010400: 6178 0a20 2020 2020 2020 2020 2020 2065  ax.            e
+00010410: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00010420: 2020 2020 2067 6169 6e20 3d20 2864 6d61       gain = (dma
+00010430: 7820 2d20 646d 696e 2920 2f20 646d 6178  x - dmin) / dmax
+00010440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010450: 206d 696e 7661 6c20 3d20 646d 696e 0a20   minval = dmin. 
+00010460: 2020 2020 2020 2020 2020 2075 6e64 6574             undet
+00010470: 6563 7420 3d20 666c 6f61 7428 646d 696e  ect = float(dmin
+00010480: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
+00010490: 7472 735b 2273 6361 6c65 5f66 6163 746f  trs["scale_facto
+000104a0: 7222 5d20 3d20 6761 696e 0a20 2020 2020  r"] = gain.     
+000104b0: 2020 2020 2020 2061 7474 7273 5b22 6164         attrs["ad
+000104c0: 645f 6f66 6673 6574 225d 203d 206d 696e  d_offset"] = min
+000104d0: 7661 6c0a 2020 2020 2020 2020 2020 2020  val.            
+000104e0: 6174 7472 735b 225f 4669 6c6c 5661 6c75  attrs["_FillValu
+000104f0: 6522 5d20 3d20 666c 6f61 7428 646d 6178  e"] = float(dmax
+00010500: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
+00010510: 7472 735b 225f 556e 6465 7465 6374 225d  trs["_Undetect"]
+00010520: 203d 2075 6e64 6574 6563 740a 0a20 2020   = undetect..   
+00010530: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00010540: 2e64 6563 6f64 655f 636f 6f72 6473 3a0a  .decode_coords:.
+00010550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010560: 6174 7472 735b 2263 6f6f 7264 696e 6174  attrs["coordinat
+00010570: 6573 225d 203d 2022 656c 6576 6174 696f  es"] = "elevatio
+00010580: 6e20 617a 696d 7574 6820 7261 6e67 6522  n azimuth range"
+00010590: 0a0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+000105a0: 7070 696e 6720 3d20 6d6f 6d65 6e74 735f  pping = moments_
+000105b0: 6d61 7070 696e 675b 6e61 6d65 5d0a 2020  mapping[name].  
+000105c0: 2020 2020 2020 2020 2020 6174 7472 732e            attrs.
+000105d0: 7570 6461 7465 287b 6b65 793a 206d 6170  update({key: map
+000105e0: 7069 6e67 5b6b 6579 5d20 666f 7220 6b65  ping[key] for ke
+000105f0: 7920 696e 206d 6f6d 656e 745f 6174 7472  y in moment_attr
+00010600: 737d 290a 2020 2020 2020 2020 2020 2020  s}).            
+00010610: 2320 6173 7369 676e 2061 7474 7269 6275  # assign attribu
+00010620: 7465 7320 746f 206d 6f6d 656e 740a 2020  tes to moment.  
+00010630: 2020 2020 2020 2020 2020 646d 6f6d 2e61            dmom.a
+00010640: 7474 7273 203d 2063 6f6c 6c65 6374 696f  ttrs = collectio
+00010650: 6e73 2e4f 7264 6572 6564 4469 6374 2829  ns.OrderedDict()
+00010660: 0a20 2020 2020 2020 2020 2020 2064 6d6f  .            dmo
+00010670: 6d2e 6174 7472 732e 7570 6461 7465 2861  m.attrs.update(a
+00010680: 7474 7273 290a 2020 2020 2020 2020 2020  ttrs).          
+00010690: 2020 6473 203d 2064 732e 7265 6e61 6d65    ds = ds.rename
+000106a0: 287b 6d6f 6d5f 6e61 6d65 3a20 6e61 6d65  ({mom_name: name
+000106b0: 2e75 7070 6572 2829 7d29 0a0a 2020 2020  .upper()})..    
+000106c0: 2020 2020 2320 6669 7820 6469 6d65 6e73      # fix dimens
+000106d0: 696f 6e73 0a20 2020 2020 2020 2064 696d  ions.        dim
+000106e0: 7320 3d20 736f 7274 6564 286c 6973 7428  s = sorted(list(
+000106f0: 6473 2e64 696d 732e 6b65 7973 2829 292c  ds.dims.keys()),
+00010700: 206b 6579 3d6c 616d 6264 6120 783a 2069   key=lambda x: i
+00010710: 6e74 2878 5b6c 656e 2822 7068 6f6e 795f  nt(x[len("phony_
+00010720: 6469 6d5f 2229 203a 5d29 290a 2020 2020  dim_") :])).    
+00010730: 2020 2020 6473 203d 2064 732e 7265 6e61      ds = ds.rena
+00010740: 6d65 287b 6469 6d73 5b30 5d3a 2073 656c  me({dims[0]: sel
+00010750: 662e 5f64 696d 305b 305d 2c20 6469 6d73  f._dim0[0], dims
+00010760: 5b31 5d3a 2073 656c 662e 5f64 696d 317d  [1]: self._dim1}
+00010770: 290a 0a20 2020 2020 2020 2023 2074 6f64  )..        # tod
+00010780: 6f3a 2074 6869 7320 736f 7274 7320 616e  o: this sorts an
+00010790: 6420 7265 696e 6465 7865 7320 7468 6520  d reindexes the 
+000107a0: 756e 736f 7274 6564 2047 414d 4943 2064  unsorted GAMIC d
+000107b0: 6174 6173 6574 2062 7920 617a 696d 7574  ataset by azimut
+000107c0: 680a 2020 2020 2020 2020 2320 6f6e 6c79  h.        # only
+000107d0: 2069 6620 6064 6563 6f64 655f 636f 6f72   if `decode_coor
+000107e0: 6473 6020 6973 2046 616c 7365 0a20 2020  ds` is False.   
+000107f0: 2020 2020 2023 2061 6464 696e 6720 636f       # adding co
+00010800: 6f72 6420 2d3e 2020 736f 7274 202d 3e20  ord ->  sort -> 
+00010810: 7265 696e 6465 7820 2d3e 2072 656d 6f76  reindex -> remov
+00010820: 6520 636f 6f72 640a 2020 2020 2020 2020  e coord.        
+00010830: 6966 206e 6f74 2073 656c 662e 6465 636f  if not self.deco
+00010840: 6465 5f63 6f6f 7264 733a 2020 2320 616e  de_coords:  # an
+00010850: 6420 2873 656c 662e 5f64 696d 305b 305d  d (self._dim0[0]
+00010860: 203d 3d20 2261 7a69 6d75 7468 2229 3a0a   == "azimuth"):.
+00010870: 2020 2020 2020 2020 2020 2020 6473 203d              ds =
+00010880: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00010890: 2020 2064 732e 6173 7369 676e 5f63 6f6f     ds.assign_coo
+000108a0: 7264 7328 7b73 656c 662e 5f64 696d 305b  rds({self._dim0[
+000108b0: 305d 3a20 6765 7461 7474 7228 7365 6c66  0]: getattr(self
+000108c0: 2c20 7365 6c66 2e5f 6469 6d30 5b30 5d29  , self._dim0[0])
+000108d0: 7d29 0a20 2020 2020 2020 2020 2020 2020  }).             
+000108e0: 2020 202e 736f 7274 6279 2873 656c 662e     .sortby(self.
+000108f0: 5f64 696d 305b 305d 290a 2020 2020 2020  _dim0[0]).      
+00010900: 2020 2020 2020 2020 2020 2e70 6970 6528            .pipe(
+00010910: 5f72 6569 6e64 6578 5f61 6e67 6c65 2c20  _reindex_angle, 
+00010920: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
+00010930: 2020 2020 2020 2e64 726f 705f 7661 7273        .drop_vars
+00010940: 2873 656c 662e 5f64 696d 305b 305d 290a  (self._dim0[0]).
+00010950: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00010960: 2020 2020 2020 7265 7475 726e 2064 730a        return ds.
+00010970: 0a20 2020 2064 6566 205f 6765 745f 6e72  .    def _get_nr
+00010980: 6179 7328 7365 6c66 293a 0a20 2020 2020  ays(self):.     
+00010990: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+000109a0: 6f77 5b22 7261 795f 636f 756e 7422 5d0a  ow["ray_count"].
+000109b0: 0a20 2020 2064 6566 205f 6765 745f 6e62  .    def _get_nb
+000109c0: 696e 7328 7365 6c66 293a 0a20 2020 2020  ins(self):.     
+000109d0: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+000109e0: 6f77 5b22 6269 6e5f 636f 756e 7422 5d0a  ow["bin_count"].
+000109f0: 0a20 2020 2064 6566 205f 6765 745f 7469  .    def _get_ti
+00010a00: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
+00010a10: 2020 7374 6172 7420 3d20 7365 6c66 2e68    start = self.h
+00010a20: 6f77 5b22 7469 6d65 7374 616d 7022 5d0a  ow["timestamp"].
+00010a30: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
+00010a40: 6461 7465 7574 696c 2e70 6172 7365 722e  dateutil.parser.
+00010a50: 7061 7273 6528 7374 6172 7429 0a20 2020  parse(start).   
+00010a60: 2020 2020 2073 7461 7274 203d 2073 7461       start = sta
+00010a70: 7274 2e72 6570 6c61 6365 2874 7a69 6e66  rt.replace(tzinf
+00010a80: 6f3d 6474 2e74 696d 657a 6f6e 652e 7574  o=dt.timezone.ut
+00010a90: 6329 2e74 696d 6573 7461 6d70 2829 0a20  c).timestamp(). 
+00010aa0: 2020 2020 2020 2064 6120 3d20 7872 2e44         da = xr.D
+00010ab0: 6174 6141 7272 6179 2873 7461 7274 2c20  ataArray(start, 
+00010ac0: 6174 7472 733d 7469 6d65 5f61 7474 7273  attrs=time_attrs
+00010ad0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00010ae0: 2064 610a 0a20 2020 2064 6566 205f 6765   da..    def _ge
+00010af0: 745f 7469 6d65 5f66 6173 7428 7365 6c66  t_time_fast(self
+00010b00: 293a 0a20 2020 2020 2020 206e 6369 6420  ):.        ncid 
+00010b10: 3d20 7365 6c66 2e6e 6369 640a 2020 2020  = self.ncid.    
+00010b20: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00010b30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00010b40: 6365 2873 656c 662e 6e63 6669 6c65 2c20  ce(self.ncfile, 
+00010b50: 6e63 2e44 6174 6173 6574 293a 0a20 2020  nc.Dataset):.   
+00010b60: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00010b70: 7274 203d 206e 6369 645b 2268 6f77 225d  rt = ncid["how"]
+00010b80: 2e67 6574 6e63 6174 7472 2822 7469 6d65  .getncattr("time
+00010b90: 7374 616d 7022 290a 2020 2020 2020 2020  stamp").        
+00010ba0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00010bb0: 2020 2020 2020 2020 2020 7374 6172 7420            start 
+00010bc0: 3d20 6e63 6964 5b22 686f 7722 5d2e 6174  = ncid["how"].at
+00010bd0: 7472 735b 2274 696d 6573 7461 6d70 225d  trs["timestamp"]
+00010be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010bf0: 2069 6620 4c6f 6f73 6556 6572 7369 6f6e   if LooseVersion
+00010c00: 2868 3570 792e 5f5f 7665 7273 696f 6e5f  (h5py.__version_
+00010c10: 5f29 203c 204c 6f6f 7365 5665 7273 696f  _) < LooseVersio
+00010c20: 6e28 2233 2e30 2e30 2229 3a0a 2020 2020  n("3.0.0"):.    
+00010c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c40: 7374 6172 7420 3d20 7374 6172 742e 6465  start = start.de
+00010c50: 636f 6465 2829 0a20 2020 2020 2020 2065  code().        e
+00010c60: 7863 6570 7420 2849 6e64 6578 4572 726f  xcept (IndexErro
+00010c70: 722c 204b 6579 4572 726f 7229 3a0a 2020  r, KeyError):.  
+00010c80: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00010c90: 204e 6f6e 650a 2020 2020 2020 2020 7374   None.        st
+00010ca0: 6172 7420 3d20 6461 7465 7574 696c 2e70  art = dateutil.p
+00010cb0: 6172 7365 722e 7061 7273 6528 7374 6172  arser.parse(star
+00010cc0: 7429 0a20 2020 2020 2020 2073 7461 7274  t).        start
+00010cd0: 203d 2073 7461 7274 2e72 6570 6c61 6365   = start.replace
+00010ce0: 2874 7a69 6e66 6f3d 6474 2e74 696d 657a  (tzinfo=dt.timez
+00010cf0: 6f6e 652e 7574 6329 2e74 696d 6573 7461  one.utc).timesta
+00010d00: 6d70 2829 0a20 2020 2020 2020 2072 6574  mp().        ret
+00010d10: 7572 6e20 7374 6172 740a 0a0a 636c 6173  urn start...clas
+00010d20: 7320 5852 6164 5469 6d65 5365 7269 6573  s XRadTimeSeries
+00010d30: 284f 6469 6d48 3547 726f 7570 4174 7472  (OdimH5GroupAttr
+00010d40: 6962 7574 654d 6978 696e 2c20 5852 6164  ibuteMixin, XRad
+00010d50: 4261 7365 293a 0a20 2020 2022 2222 436c  Base):.    """Cl
+00010d60: 6173 7320 666f 7220 686f 6c64 696e 6720  ass for holding 
+00010d70: 6120 7469 6d65 7365 7269 6573 206f 6620  a timeseries of 
+00010d80: 7261 6461 7220 7377 6565 7073 2222 220a  radar sweeps""".
+00010d90: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00010da0: 5f28 7365 6c66 2c20 2a2a 6b77 6172 6773  _(self, **kwargs
+00010db0: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+00010dc0: 2858 5261 6454 696d 6553 6572 6965 732c  (XRadTimeSeries,
+00010dd0: 2073 656c 6629 2e5f 5f69 6e69 745f 5f28   self).__init__(
+00010de0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00010df0: 6461 7461 203d 204e 6f6e 650a 2020 2020  data = None.    
+00010e00: 2020 2020 7365 6c66 2e5f 6d6f 6d65 6e74      self._moment
+00010e10: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
+00010e20: 2073 656c 662e 5f6d 6574 6120 3d20 4e6f   self._meta = No
+00010e30: 6e65 0a0a 2020 2020 2320 6f76 6572 7269  ne..    # overri
+00010e40: 6465 2061 7070 656e 6420 616e 6420 636c  de append and cl
+00010e50: 6169 6d20 6669 6c65 2066 6f72 204f 6469  aim file for Odi
+00010e60: 6d48 3547 726f 7570 4174 7472 6962 7574  mH5GroupAttribut
+00010e70: 654d 6978 696e 0a20 2020 2064 6566 2061  eMixin.    def a
+00010e80: 7070 656e 6428 7365 6c66 2c20 7661 6c75  ppend(self, valu
+00010e90: 6529 3a0a 2020 2020 2020 2020 2320 646f  e):.        # do
+00010ea0: 206f 6e6c 7920 666f 7220 6669 7273 7420   only for first 
+00010eb0: 6669 6c65 2069 6e20 7468 6973 2074 696d  file in this tim
+00010ec0: 6573 6572 6965 730a 2020 2020 2020 2020  eseries.        
+00010ed0: 7661 6c75 652e 5f70 6172 656e 7420 3d20  value._parent = 
+00010ee0: 7365 6c66 0a20 2020 2020 2020 2069 6620  self.        if 
+00010ef0: 6e6f 7420 6c65 6e28 7365 6c66 293a 0a20  not len(self):. 
+00010f00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010f10: 5f6e 6366 696c 6520 3d20 7661 6c75 652e  _ncfile = value.
+00010f20: 6e63 6669 6c65 0a20 2020 2020 2020 2020  ncfile.         
+00010f30: 2020 2073 656c 662e 5f6e 6370 6174 6820     self._ncpath 
+00010f40: 3d20 7661 6c75 652e 6e63 7061 7468 0a20  = value.ncpath. 
+00010f50: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00010f60: 7065 7228 5852 6164 5469 6d65 5365 7269  per(XRadTimeSeri
+00010f70: 6573 2c20 7365 6c66 292e 6170 7065 6e64  es, self).append
+00010f80: 2876 616c 7565 290a 0a20 2020 2064 6566  (value)..    def
+00010f90: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
+00010fa0: 0a20 2020 2020 2020 2073 756d 6d61 7279  .        summary
+00010fb0: 203d 205b 223c 7772 6164 6c69 622e 7b7d   = ["<wradlib.{}
+00010fc0: 3e22 2e66 6f72 6d61 7428 7479 7065 2873  >".format(type(s
+00010fd0: 656c 6629 2e5f 5f6e 616d 655f 5f29 5d0a  elf).__name__)].
+00010fe0: 2020 2020 2020 2020 6469 6d73 203d 2022          dims = "
+00010ff0: 4469 6d65 6e73 696f 6e28 7329 3a22 0a20  Dimension(s):". 
+00011000: 2020 2020 2020 2064 696d 735f 7375 6d6d         dims_summ
+00011010: 6172 7920 3d20 5b66 2274 696d 653a 207b  ary = [f"time: {
+00011020: 6c65 6e28 7365 6c66 297d 225d 0a20 2020  len(self)}"].   
+00011030: 2020 2020 2064 696d 735f 7375 6d6d 6172       dims_summar
+00011040: 792e 6170 7065 6e64 2866 227b 7365 6c66  y.append(f"{self
+00011050: 2e5f 7365 715b 305d 2e5f 6469 6d30 5b30  ._seq[0]._dim0[0
+00011060: 5d7d 3a20 7b73 656c 662e 5f73 6571 5b30  ]}: {self._seq[0
+00011070: 5d2e 6e72 6179 737d 2229 0a20 2020 2020  ].nrays}").     
+00011080: 2020 2064 696d 735f 7375 6d6d 6172 792e     dims_summary.
+00011090: 6170 7065 6e64 2866 227b 7365 6c66 2e5f  append(f"{self._
+000110a0: 7365 715b 305d 2e5f 6469 6d31 7d3a 207b  seq[0]._dim1}: {
+000110b0: 7365 6c66 2e5f 7365 715b 305d 2e6e 6269  self._seq[0].nbi
+000110c0: 6e73 7d22 290a 2020 2020 2020 2020 6469  ns}").        di
+000110d0: 6d73 5f73 756d 6d61 7279 203d 2022 2c20  ms_summary = ", 
+000110e0: 222e 6a6f 696e 2864 696d 735f 7375 6d6d  ".join(dims_summ
+000110f0: 6172 7929 0a20 2020 2020 2020 2073 756d  ary).        sum
+00011100: 6d61 7279 2e61 7070 656e 6428 227b 7d20  mary.append("{} 
+00011110: 287b 7d29 222e 666f 726d 6174 2864 696d  ({})".format(dim
+00011120: 732c 2064 696d 735f 7375 6d6d 6172 7929  s, dims_summary)
+00011130: 290a 2020 2020 2020 2020 616e 676c 6520  ).        angle 
+00011140: 3d20 6622 7b73 656c 662e 5f73 6571 5b30  = f"{self._seq[0
+00011150: 5d2e 5f64 696d 305b 315d 2e63 6170 6974  ]._dim0[1].capit
+00011160: 616c 697a 6528 297d 2873 293a 220a 2020  alize()}(s):".  
+00011170: 2020 2020 2020 616e 676c 655f 7375 6d6d        angle_summ
+00011180: 6172 7920 3d20 7365 6c66 5b30 5d2e 6669  ary = self[0].fi
+00011190: 7865 645f 616e 676c 650a 2020 2020 2020  xed_angle.      
+000111a0: 2020 7375 6d6d 6172 792e 6170 7065 6e64    summary.append
+000111b0: 2866 227b 616e 676c 657d 2028 7b61 6e67  (f"{angle} ({ang
+000111c0: 6c65 5f73 756d 6d61 7279 3a2e 3166 7d29  le_summary:.1f})
+000111d0: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+000111e0: 726e 2022 5c6e 222e 6a6f 696e 2873 756d  rn "\n".join(sum
+000111f0: 6d61 7279 290a 0a20 2020 2064 6566 2072  mary)..    def r
+00011200: 6573 6574 5f64 6174 6128 7365 6c66 293a  eset_data(self):
+00011210: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00011220: 6174 6120 3d20 4e6f 6e65 0a0a 2020 2020  ata = None..    
+00011230: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00011240: 6620 6461 7461 2873 656c 6629 3a0a 2020  f data(self):.  
+00011250: 2020 2020 2020 6966 2073 656c 662e 5f64        if self._d
+00011260: 6174 6120 6973 204e 6f6e 653a 0a20 2020  ata is None:.   
+00011270: 2020 2020 2020 2020 2023 206d 6f6d 656e           # momen
+00011280: 7473 2068 616e 646c 696e 670a 2020 2020  ts handling.    
+00011290: 2020 2020 2020 2020 2320 636f 6f72 6473          # coords
+000112a0: 203d 2073 6574 285b 2772 7469 6d65 272c   = set(['rtime',
+000112b0: 2027 7261 6e67 6527 2c20 2761 7a69 6d75   'range', 'azimu
+000112c0: 7468 272c 2027 656c 6576 6174 696f 6e27  th', 'elevation'
+000112d0: 2c20 2774 696d 6527 2c0a 2020 2020 2020  , 'time',.      
+000112e0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+000112f0: 2020 2020 2020 2761 6c74 6974 7564 6527        'altitude'
+00011300: 2c20 276c 6174 6974 7564 6527 2c20 276c  , 'latitude', 'l
+00011310: 6f6e 6769 7475 6465 272c 2027 7377 6565  ongitude', 'swee
+00011320: 705f 6d6f 6465 275d 290a 2020 2020 2020  p_mode']).      
+00011330: 2020 2020 2020 2320 6765 7420 696e 7465        # get inte
+00011340: 7273 6563 7469 6f6e 2061 6e64 2075 6e69  rsection and uni
+00011350: 6f6e 0a20 2020 2020 2020 2020 2020 206d  on.            m
+00011360: 6f6d 656e 745f 7365 7420 3d20 5b73 6574  oment_set = [set
+00011370: 2874 312e 6d6f 6d65 6e74 7329 2066 6f72  (t1.moments) for
+00011380: 2074 3120 696e 2073 656c 665d 0a20 2020   t1 in self].   
+00011390: 2020 2020 2020 2020 206d 6f6d 656e 745f           moment_
+000113a0: 7365 745f 6920 3d20 7365 742e 696e 7465  set_i = set.inte
+000113b0: 7273 6563 7469 6f6e 282a 6d6f 6d65 6e74  rsection(*moment
+000113c0: 5f73 6574 290a 2020 2020 2020 2020 2020  _set).          
+000113d0: 2020 6d6f 6d65 6e74 5f73 6574 5f75 203d    moment_set_u =
+000113e0: 2073 6574 2e75 6e69 6f6e 282a 6d6f 6d65   set.union(*mome
+000113f0: 6e74 5f73 6574 290a 2020 2020 2020 2020  nt_set).        
+00011400: 2020 2020 2320 6472 6f70 2076 6172 6961      # drop varia
+00011410: 626c 6573 206e 6f74 2061 7661 696c 6162  bles not availab
+00011420: 6c65 2069 6e20 616c 6c20 6461 7461 7365  le in all datase
+00011430: 7473 0a20 2020 2020 2020 2020 2020 2064  ts.            d
+00011440: 726f 7020 3d20 6d6f 6d65 6e74 5f73 6574  rop = moment_set
+00011450: 5f69 205e 206d 6f6d 656e 745f 7365 745f  _i ^ moment_set_
+00011460: 750a 2020 2020 2020 2020 2020 2020 2320  u.            # 
+00011470: 6b65 6570 203d 2028 6d6f 6d65 6e74 5f73  keep = (moment_s
+00011480: 6574 5f69 207c 2063 6f6f 7264 7329 205e  et_i | coords) ^
+00011490: 2063 6f6f 7264 730a 2020 2020 2020 2020   coords.        
+000114a0: 2020 2020 6472 6f70 203d 206c 6973 7428      drop = list(
+000114b0: 7365 6c66 2e63 6865 636b 5f6d 6f6d 656e  self.check_momen
+000114c0: 7473 2829 2e6b 6579 7328 2929 0a20 2020  ts().keys()).   
+000114d0: 2020 2020 2020 2020 2069 6620 6472 6f70           if drop
+000114e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000114f0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00011500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011510: 2020 2020 2022 7772 6164 6c69 623a 204d       "wradlib: M
+00011520: 6f6d 656e 7473 207b 7d20 6172 6520 6e6f  oments {} are no
+00011530: 7420 6176 6169 6c61 626c 6520 696e 2061  t available in a
+00011540: 6c6c 2064 6174 6173 6574 7320 220a 2020  ll datasets ".  
+00011550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011560: 2020 2261 6e64 2077 696c 6c20 6265 2064    "and will be d
+00011570: 726f 7070 6564 2066 726f 6d20 7468 6520  ropped from the 
+00011580: 7265 7375 6c74 2e5c 6e22 0a20 2020 2020  result.\n".     
+00011590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000115a0: 5468 6973 2077 696c 6c20 6265 2073 6f6c  This will be sol
+000115b0: 7665 6420 696e 2078 6172 7261 792c 2073  ved in xarray, s
+000115c0: 6565 2022 0a20 2020 2020 2020 2020 2020  ee ".           
+000115d0: 2020 2020 2020 2020 2022 6874 7470 733a           "https:
+000115e0: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7964  //github.com/pyd
+000115f0: 6174 612f 7861 7272 6179 2f70 756c 6c2f  ata/xarray/pull/
+00011600: 3335 3435 222e 666f 726d 6174 2864 726f  3545".format(dro
+00011610: 7029 0a20 2020 2020 2020 2020 2020 2020  p).             
+00011620: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00011630: 2020 2320 746f 646f 3a20 6361 7463 6820    # todo: catch 
+00011640: 706f 7373 6962 6c65 2065 7272 6f72 2061  possible error a
+00011650: 6e64 2061 6464 2070 7265 6369 7365 2045  nd add precise E
+00011660: 7272 6f72 4d65 7373 6167 650a 2020 2020  rrorMessage.    
+00011670: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
+00011680: 7461 203d 2078 722e 636f 6e63 6174 280a  ta = xr.concat(.
+00011690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000116b0: 2020 2020 2020 662e 6461 7461 2e64 726f        f.data.dro
+000116c0: 705f 7661 7273 2864 726f 702c 2065 7272  p_vars(drop, err
+000116d0: 6f72 733d 2269 676e 6f72 6522 290a 2020  ors="ignore").  
+000116e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116f0: 2020 666f 7220 6620 696e 2074 7164 6d28    for f in tqdm(
+00011700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011710: 2020 2020 2020 2020 2073 656c 662c 2064           self, d
+00011720: 6573 633d 2243 6f6c 6c65 6374 696e 6722  esc="Collecting"
+00011730: 2c20 756e 6974 3d22 2054 696d 6573 7465  , unit=" Timeste
+00011740: 7073 222c 206c 6561 7665 3d4e 6f6e 650a  ps", leave=None.
+00011750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011760: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00011770: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+00011780: 2020 2020 2020 2020 2023 2064 6174 615f           # data_
+00011790: 7661 7273 3d6c 6973 7428 6b65 6570 292c  vars=list(keep),
+000117a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000117b0: 2064 696d 3d22 7469 6d65 222c 0a20 2020   dim="time",.   
+000117c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000117d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000117e0: 6461 7461 0a0a 2020 2020 6465 6620 6368  data..    def ch
+000117f0: 6563 6b5f 7261 7973 2873 656c 6629 3a0a  eck_rays(self):.
+00011800: 2020 2020 2020 2020 6e72 6179 7320 3d20          nrays = 
+00011810: 5b73 7770 2e6e 7261 7973 2066 6f72 2073  [swp.nrays for s
+00011820: 7770 2069 6e20 7365 6c66 5d0a 2020 2020  wp in self].    
+00011830: 2020 2020 736e 7261 7973 203d 2073 6574      snrays = set
+00011840: 286e 7261 7973 290a 2020 2020 2020 2020  (nrays).        
+00011850: 6964 7820 3d20 5b5d 0a20 2020 2020 2020  idx = [].       
+00011860: 2066 6f72 206e 7220 696e 2073 6e72 6179   for nr in snray
+00011870: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
+00011880: 6620 6e72 2025 2033 3630 3a0a 2020 2020  f nr % 360:.    
+00011890: 2020 2020 2020 2020 2020 2020 6964 782e              idx.
+000118a0: 6578 7465 6e64 286e 702e 6172 6777 6865  extend(np.argwhe
+000118b0: 7265 286e 702e 6172 7261 7928 6e72 6179  re(np.array(nray
+000118c0: 7329 203d 3d20 6e72 292e 666c 6174 7465  s) == nr).flatte
+000118d0: 6e28 292e 746f 6c69 7374 2829 290a 0a20  n().tolist()).. 
+000118e0: 2020 2020 2020 2069 6620 6c65 6e28 736e         if len(sn
+000118f0: 7261 7973 2920 3e20 313a 0a20 2020 2020  rays) > 1:.     
+00011900: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00011910: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00011920: 2020 2020 2020 6622 7772 6164 6c69 623a        f"wradlib:
+00011930: 206e 756d 6265 7220 6f66 2072 6179 7320   number of rays 
+00011940: 6469 6666 6572 696e 6720 6265 7477 6565  differing betwee
+00011950: 6e20 7377 6565 7073 2e5c 6e22 2066 227b  n sweeps.\n" f"{
+00011960: 736e 7261 7973 7d22 0a20 2020 2020 2020  snrays}".       
+00011970: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00011980: 6574 7572 6e20 736e 7261 7973 2c20 6964  eturn snrays, id
+00011990: 780a 0a20 2020 2064 6566 2063 6865 636b  x..    def check
+000119a0: 5f6d 6f6d 656e 7473 2873 656c 6629 3a0a  _moments(self):.
+000119b0: 2020 2020 2020 2020 6d6f 6d65 6e74 7320          moments 
+000119c0: 3d20 5b73 6574 285b 6d6f 6d2e 7175 616e  = [set([mom.quan
+000119d0: 7469 7479 2066 6f72 206d 6f6d 2069 6e20  tity for mom in 
+000119e0: 7377 705d 2920 666f 7220 7377 7020 696e  swp]) for swp in
+000119f0: 2073 656c 665d 0a20 2020 2020 2020 206d   self].        m
+00011a00: 6920 3d20 7365 742e 696e 7465 7273 6563  i = set.intersec
+00011a10: 7469 6f6e 282a 6d6f 6d65 6e74 7329 0a20  tion(*moments). 
+00011a20: 2020 2020 2020 206d 7520 3d20 7365 742e         mu = set.
+00011a30: 756e 696f 6e28 2a6d 6f6d 656e 7473 290a  union(*moments).
+00011a40: 2020 2020 2020 2020 6d70 203d 206d 6920          mp = mi 
+00011a50: 5e20 6d75 0a20 2020 2020 2020 206d 6973  ^ mu.        mis
+00011a60: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
+00011a70: 6f72 206d 6f6d 2069 6e20 6d75 3a0a 2020  or mom in mu:.  
+00011a80: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
+00011a90: 5b5d 0a20 2020 2020 2020 2020 2020 2069  [].            i
+00011aa0: 6620 6d6f 6d20 696e 206d 703a 0a20 2020  f mom in mp:.   
+00011ab0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00011ac0: 2069 2c20 6d73 6574 2069 6e20 656e 756d   i, mset in enum
+00011ad0: 6572 6174 6528 6d6f 6d65 6e74 7329 3a0a  erate(moments):.
+00011ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011af0: 2020 2020 6966 206d 6f6d 206e 6f74 2069      if mom not i
+00011b00: 6e20 6d73 6574 3a0a 2020 2020 2020 2020  n mset:.        
+00011b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b20: 6964 782e 6170 7065 6e64 2869 290a 2020  idx.append(i).  
+00011b30: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+00011b40: 7373 5b6d 6f6d 5d20 3d20 6964 780a 2020  ss[mom] = idx.  
+00011b50: 2020 2020 2020 7265 7475 726e 206d 6973        return mis
+00011b60: 730a 0a20 2020 2064 6566 2073 6574 5f6d  s..    def set_m
+00011b70: 6f6d 656e 7473 2873 656c 662c 206d 6f6d  oments(self, mom
+00011b80: 656e 7473 293a 0a20 2020 2020 2020 2069  ents):.        i
+00011b90: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00011ba0: 286d 6f6d 656e 7473 2c20 6c69 7374 293a  (moments, list):
+00011bb0: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00011bc0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+00011bd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011be0: 2e5f 6d6f 6d65 6e74 7320 3d20 6d6f 6d65  ._moments = mome
+00011bf0: 6e74 730a 0a20 2020 2064 6566 2073 6574  nts..    def set
+00011c00: 5f6d 6574 6164 6174 6128 7365 6c66 2c20  _metadata(self, 
+00011c10: 6d65 7461 6461 7461 293a 0a20 2020 2020  metadata):.     
+00011c20: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00011c30: 616e 6365 286d 6574 6164 6174 612c 2064  ance(metadata, d
+00011c40: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+00011c50: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
+00011c60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00011c70: 2073 656c 662e 5f6d 6574 6120 3d20 6d65   self._meta = me
+00011c80: 7461 6461 7461 0a0a 0a63 6c61 7373 2058  tadata...class X
+00011c90: 5261 6456 6f6c 756d 6528 4f64 696d 4835  RadVolume(OdimH5
+00011ca0: 4772 6f75 7041 7474 7269 6275 7465 4d69  GroupAttributeMi
+00011cb0: 7869 6e2c 2058 5261 6442 6173 6529 3a0a  xin, XRadBase):.
+00011cc0: 2020 2020 2222 2243 6c61 7373 2066 6f72      """Class for
+00011cd0: 2068 6f6c 6469 6e67 2061 2076 6f6c 756d   holding a volum
+00011ce0: 6520 6f66 2072 6164 6172 2073 7765 6570  e of radar sweep
+00011cf0: 7322 2222 0a0a 2020 2020 6465 6620 5f5f  s"""..    def __
+00011d00: 696e 6974 5f5f 2873 656c 662c 202a 2a6b  init__(self, **k
+00011d10: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00011d20: 7375 7065 7228 5852 6164 566f 6c75 6d65  super(XRadVolume
+00011d30: 2c20 7365 6c66 292e 5f5f 696e 6974 5f5f  , self).__init__
+00011d40: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00011d50: 5f64 6174 6120 3d20 4e6f 6e65 0a20 2020  _data = None.   
+00011d60: 2020 2020 2073 656c 662e 5f72 6f6f 7420       self._root 
+00011d70: 3d20 4e6f 6e65 0a0a 2020 2020 6465 6620  = None..    def 
+00011d80: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0a  __repr__(self):.
+00011d90: 2020 2020 2020 2020 7375 6d6d 6172 7920          summary 
+00011da0: 3d20 5b22 3c77 7261 646c 6962 2e7b 7d3e  = ["<wradlib.{}>
+00011db0: 222e 666f 726d 6174 2874 7970 6528 7365  ".format(type(se
+00011dc0: 6c66 292e 5f5f 6e61 6d65 5f5f 295d 0a20  lf).__name__)]. 
+00011dd0: 2020 2020 2020 2064 696d 7320 3d20 2244         dims = "D
+00011de0: 696d 656e 7369 6f6e 2873 293a 220a 2020  imension(s):".  
+00011df0: 2020 2020 2020 6469 6d73 5f73 756d 6d61        dims_summa
+00011e00: 7279 203d 2066 2273 7765 6570 3a20 7b6c  ry = f"sweep: {l
+00011e10: 656e 2873 656c 6629 7d22 0a20 2020 2020  en(self)}".     
+00011e20: 2020 2073 756d 6d61 7279 2e61 7070 656e     summary.appen
+00011e30: 6428 227b 7d20 287b 7d29 222e 666f 726d  d("{} ({})".form
+00011e40: 6174 2864 696d 732c 2064 696d 735f 7375  at(dims, dims_su
+00011e50: 6d6d 6172 7929 290a 2020 2020 2020 2020  mmary)).        
+00011e60: 616e 676c 6520 3d20 6622 7b73 656c 665b  angle = f"{self[
+00011e70: 305d 5b30 5d2e 5f64 696d 305b 315d 2e63  0][0]._dim0[1].c
+00011e80: 6170 6974 616c 697a 6528 297d 2873 293a  apitalize()}(s):
+00011e90: 220a 2020 2020 2020 2020 616e 676c 655f  ".        angle_
+00011ea0: 7375 6d6d 6172 7920 3d20 5b66 227b 6b5b  summary = [f"{k[
+00011eb0: 305d 2e66 6978 6564 5f61 6e67 6c65 3a2e  0].fixed_angle:.
+00011ec0: 3166 7d22 2066 6f72 206b 2069 6e20 7365  1f}" for k in se
+00011ed0: 6c66 5d0a 2020 2020 2020 2020 616e 676c  lf].        angl
+00011ee0: 655f 7375 6d6d 6172 7920 3d20 222c 2022  e_summary = ", "
+00011ef0: 2e6a 6f69 6e28 616e 676c 655f 7375 6d6d  .join(angle_summ
+00011f00: 6172 7929 0a20 2020 2020 2020 2073 756d  ary).        sum
+00011f10: 6d61 7279 2e61 7070 656e 6428 227b 7d20  mary.append("{} 
+00011f20: 287b 7d29 222e 666f 726d 6174 2861 6e67  ({})".format(ang
+00011f30: 6c65 2c20 616e 676c 655f 7375 6d6d 6172  le, angle_summar
+00011f40: 7929 290a 0a20 2020 2020 2020 2072 6574  y))..        ret
+00011f50: 7572 6e20 225c 6e22 2e6a 6f69 6e28 7375  urn "\n".join(su
+00011f60: 6d6d 6172 7929 0a0a 2020 2020 4070 726f  mmary)..    @pro
+00011f70: 7065 7274 790a 2020 2020 6465 6620 726f  perty.    def ro
+00011f80: 6f74 2873 656c 6629 3a0a 2020 2020 2020  ot(self):.      
+00011f90: 2020 2222 2252 6574 7572 6e20 726f 6f74    """Return root
+00011fa0: 206f 626a 6563 742e 2222 220a 2020 2020   object.""".    
+00011fb0: 2020 2020 6966 2073 656c 662e 5f72 6f6f      if self._roo
+00011fc0: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+00011fd0: 2020 2020 2020 2073 656c 662e 6173 7369         self.assi
+00011fe0: 676e 5f72 6f6f 7428 290a 2020 2020 2020  gn_root().      
+00011ff0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+00012000: 6f6f 740a 0a20 2020 2064 6566 2061 7373  oot..    def ass
+00012010: 6967 6e5f 726f 6f74 2873 656c 6629 3a0a  ign_root(self):.
+00012020: 2020 2020 2020 2020 2222 2228 5265 2d29          """(Re-)
+00012030: 4372 6561 7465 2072 6f6f 7420 6f62 6a65  Create root obje
+00012040: 6374 2061 6363 6f72 6469 6e67 2043 6652  ct according CfR
+00012050: 6164 6961 6c32 2073 7461 6e64 6172 6422  adial2 standard"
+00012060: 2222 0a20 2020 2020 2020 2023 2061 7373  "".        # ass
+00012070: 6967 6e20 726f 6f74 2076 6172 6961 626c  ign root variabl
+00012080: 6573 0a20 2020 2020 2020 2073 7765 6570  es.        sweep
+00012090: 5f67 726f 7570 5f6e 616d 6573 203d 205b  _group_names = [
+000120a0: 6622 7377 6565 705f 7b69 7d22 2066 6f72  f"sweep_{i}" for
+000120b0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+000120c0: 7365 6c66 2929 5d0a 0a20 2020 2020 2020  self))]..       
+000120d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+000120e0: 2020 7377 6565 705f 6669 7865 645f 616e    sweep_fixed_an
+000120f0: 676c 6573 203d 205b 7473 5b30 5d2e 6669  gles = [ts[0].fi
+00012100: 7865 645f 616e 676c 6520 666f 7220 7473  xed_angle for ts
+00012110: 2069 6e20 7365 6c66 5d0a 2020 2020 2020   in self].      
+00012120: 2020 6578 6365 7074 2041 7474 7269 6275    except Attribu
+00012130: 7465 4572 726f 723a 0a20 2020 2020 2020  teError:.       
+00012140: 2020 2020 2073 7765 6570 5f66 6978 6564       sweep_fixed
+00012150: 5f61 6e67 6c65 7320 3d20 5b74 732e 6669  _angles = [ts.fi
+00012160: 7865 645f 616e 676c 6520 666f 7220 7473  xed_angle for ts
+00012170: 2069 6e20 7365 6c66 5d0a 0a20 2020 2020   in self]..     
+00012180: 2020 2023 2065 7874 7261 6374 2074 696d     # extract tim
+00012190: 6520 636f 7665 7261 6765 0a20 2020 2020  e coverage.     
+000121a0: 2020 2074 696d 6573 203d 206e 702e 6172     times = np.ar
+000121b0: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+000121c0: 205b 5b74 5b30 5d2e 7261 795f 7469 6d65   [[t[0].ray_time
+000121d0: 732e 7661 6c75 6573 2e6d 696e 2829 2c20  s.values.min(), 
+000121e0: 745b 2d31 5d2e 7261 795f 7469 6d65 732e  t[-1].ray_times.
+000121f0: 7661 6c75 6573 2e6d 6178 2829 5d20 666f  values.max()] fo
+00012200: 7220 7420 696e 2073 656c 665d 0a20 2020  r t in self].   
+00012210: 2020 2020 2029 2e66 6c61 7474 656e 2829       ).flatten()
+00012220: 0a20 2020 2020 2020 2074 696d 655f 636f  .        time_co
+00012230: 7665 7261 6765 5f73 7461 7274 203d 206d  verage_start = m
+00012240: 696e 2874 696d 6573 290a 2020 2020 2020  in(times).      
+00012250: 2020 7469 6d65 5f63 6f76 6572 6167 655f    time_coverage_
+00012260: 656e 6420 3d20 6d61 7828 7469 6d65 7329  end = max(times)
+00012270: 0a0a 2020 2020 2020 2020 7469 6d65 5f63  ..        time_c
+00012280: 6f76 6572 6167 655f 7374 6172 745f 7374  overage_start_st
+00012290: 7220 3d20 7374 7228 7469 6d65 5f63 6f76  r = str(time_cov
+000122a0: 6572 6167 655f 7374 6172 7429 5b3a 3139  erage_start)[:19
+000122b0: 5d20 2b20 225a 220a 2020 2020 2020 2020  ] + "Z".        
+000122c0: 7469 6d65 5f63 6f76 6572 6167 655f 656e  time_coverage_en
+000122d0: 645f 7374 7220 3d20 7374 7228 7469 6d65  d_str = str(time
+000122e0: 5f63 6f76 6572 6167 655f 656e 6429 5b3a  _coverage_end)[:
+000122f0: 3139 5d20 2b20 225a 220a 0a20 2020 2020  19] + "Z"..     
+00012300: 2020 2023 2063 7265 6174 6520 726f 6f74     # create root
+00012310: 2067 726f 7570 2066 726f 6d20 7363 7261   group from scra
+00012320: 7463 680a 2020 2020 2020 2020 726f 6f74  tch.        root
+00012330: 203d 2078 722e 4461 7461 7365 7428 2920   = xr.Dataset() 
+00012340: 2023 2064 6174 615f 7661 7273 3d77 726c   # data_vars=wrl
+00012350: 2e69 6f2e 7861 7272 6179 2e67 6c6f 6261  .io.xarray.globa
+00012360: 6c5f 7661 7269 6162 6c65 732c 0a20 2020  l_variables,.   
+00012370: 2020 2020 2023 2061 7474 7273 3d77 726c       # attrs=wrl
+00012380: 2e69 6f2e 7861 7272 6179 2e67 6c6f 6261  .io.xarray.globa
+00012390: 6c5f 6174 7472 7329 0a0a 2020 2020 2020  l_attrs)..      
+000123a0: 2020 2320 7461 6b65 2066 6972 7374 2064    # take first d
+000123b0: 6174 6173 6574 2f66 696c 6520 666f 7220  ataset/file for 
+000123c0: 7265 7472 6965 7661 6c20 6f66 206c 6f63  retrieval of loc
+000123d0: 6174 696f 6e0a 2020 2020 2020 2020 7369  ation.        si
+000123e0: 7465 203d 2073 656c 662e 7369 7465 0a0a  te = self.site..
+000123f0: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
+00012400: 2072 6f6f 7420 7661 7269 6162 6c65 730a   root variables.
+00012410: 2020 2020 2020 2020 726f 6f74 203d 2072          root = r
+00012420: 6f6f 742e 6173 7369 676e 280a 2020 2020  oot.assign(.    
+00012430: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00012440: 2020 2020 2020 2020 2020 2276 6f6c 756d            "volum
+00012450: 655f 6e75 6d62 6572 223a 2030 2c0a 2020  e_number": 0,.  
+00012460: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00012470: 6c61 7466 6f72 6d5f 7479 7065 223a 2073  latform_type": s
+00012480: 7472 2822 6669 7865 6422 292c 0a20 2020  tr("fixed"),.   
+00012490: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+000124a0: 7374 7275 6d65 6e74 5f74 7970 6522 3a20  strument_type": 
+000124b0: 2272 6164 6172 222c 0a20 2020 2020 2020  "radar",.       
+000124c0: 2020 2020 2020 2020 2022 7072 696d 6172           "primar
+000124d0: 795f 6178 6973 223a 2022 6178 6973 5f7a  y_axis": "axis_z
+000124e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000124f0: 2020 2022 7469 6d65 5f63 6f76 6572 6167     "time_coverag
+00012500: 655f 7374 6172 7422 3a20 7469 6d65 5f63  e_start": time_c
+00012510: 6f76 6572 6167 655f 7374 6172 745f 7374  overage_start_st
+00012520: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00012530: 2020 2022 7469 6d65 5f63 6f76 6572 6167     "time_coverag
+00012540: 655f 656e 6422 3a20 7469 6d65 5f63 6f76  e_end": time_cov
+00012550: 6572 6167 655f 656e 645f 7374 722c 0a20  erage_end_str,. 
+00012560: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012570: 6c61 7469 7475 6465 223a 2073 6974 655b  latitude": site[
+00012580: 226c 6174 6974 7564 6522 5d2e 7661 6c75  "latitude"].valu
+00012590: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+000125a0: 2020 2020 226c 6f6e 6769 7475 6465 223a      "longitude":
+000125b0: 2073 6974 655b 226c 6f6e 6769 7475 6465   site["longitude
+000125c0: 225d 2e76 616c 7565 732c 0a20 2020 2020  "].values,.     
+000125d0: 2020 2020 2020 2020 2020 2022 616c 7469             "alti
+000125e0: 7475 6465 223a 2073 6974 655b 2261 6c74  tude": site["alt
+000125f0: 6974 7564 6522 5d2e 7661 6c75 6573 2c0a  itude"].values,.
+00012600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012610: 2273 7765 6570 5f67 726f 7570 5f6e 616d  "sweep_group_nam
+00012620: 6522 3a20 285b 2273 7765 6570 225d 2c20  e": (["sweep"], 
+00012630: 7377 6565 705f 6772 6f75 705f 6e61 6d65  sweep_group_name
+00012640: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+00012650: 2020 2020 2273 7765 6570 5f66 6978 6564      "sweep_fixed
+00012660: 5f61 6e67 6c65 223a 2028 5b22 7377 6565  _angle": (["swee
+00012670: 7022 5d2c 2073 7765 6570 5f66 6978 6564  p"], sweep_fixed
+00012680: 5f61 6e67 6c65 7329 2c0a 2020 2020 2020  _angles),.      
+00012690: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+000126a0: 290a 0a20 2020 2020 2020 2023 2061 7373  )..        # ass
+000126b0: 6967 6e20 726f 6f74 2061 7474 7269 6275  ign root attribu
+000126c0: 7465 730a 2020 2020 2020 2020 6174 7472  tes.        attr
+000126d0: 7320 3d20 636f 6c6c 6563 7469 6f6e 732e  s = collections.
+000126e0: 4f72 6465 7265 6444 6963 7428 290a 2020  OrderedDict().  
+000126f0: 2020 2020 2020 6174 7472 732e 7570 6461        attrs.upda
+00012700: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00012710: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00012720: 2020 2276 6572 7369 6f6e 223a 2022 4e6f    "version": "No
+00012730: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
+00012740: 2020 2020 2022 7469 746c 6522 3a20 224e       "title": "N
+00012750: 6f6e 6522 2c0a 2020 2020 2020 2020 2020  one",.          
+00012760: 2020 2020 2020 2269 6e73 7469 7475 7469        "instituti
+00012770: 6f6e 223a 2022 4e6f 6e65 222c 0a20 2020  on": "None",.   
+00012780: 2020 2020 2020 2020 2020 2020 2022 7265               "re
+00012790: 6665 7265 6e63 6573 223a 2022 4e6f 6e65  ferences": "None
+000127a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000127b0: 2020 2022 736f 7572 6365 223a 2022 4e6f     "source": "No
+000127c0: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
+000127d0: 2020 2020 2022 6869 7374 6f72 7922 3a20       "history": 
+000127e0: 224e 6f6e 6522 2c0a 2020 2020 2020 2020  "None",.        
+000127f0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+00012800: 223a 2022 696d 2f65 7870 6f72 7465 6420  ": "im/exported 
+00012810: 7573 696e 6720 7772 6164 6c69 6222 2c0a  using wradlib",.
+00012820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012830: 2269 6e73 7472 756d 656e 745f 6e61 6d65  "instrument_name
+00012840: 223a 2022 4e6f 6e65 222c 0a20 2020 2020  ": "None",.     
+00012850: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00012860: 2029 0a20 2020 2020 2020 2061 7474 7273   ).        attrs
+00012870: 5b22 7665 7273 696f 6e22 5d20 3d20 7365  ["version"] = se
+00012880: 6c66 2e77 6861 745b 2276 6572 7369 6f6e  lf.what["version
+00012890: 225d 0a20 2020 2020 2020 2072 6f6f 7420  "].        root 
+000128a0: 3d20 726f 6f74 2e61 7373 6967 6e5f 6174  = root.assign_at
+000128b0: 7472 7328 6174 7472 7329 0a20 2020 2020  trs(attrs).     
+000128c0: 2020 2072 6f6f 7420 3d20 726f 6f74 2e61     root = root.a
+000128d0: 7373 6967 6e5f 6174 7472 7328 7365 6c66  ssign_attrs(self
+000128e0: 2e61 7474 7273 290a 2020 2020 2020 2020  .attrs).        
+000128f0: 7365 6c66 2e5f 726f 6f74 203d 2072 6f6f  self._root = roo
+00012900: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
+00012910: 0a20 2020 2064 6566 2073 6974 6528 7365  .    def site(se
+00012920: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00012930: 5265 7475 726e 2063 6f6f 7264 696e 6174  Return coordinat
+00012940: 6573 206f 6620 7261 6461 7220 7369 7465  es of radar site
+00012950: 2e22 2222 0a20 2020 2020 2020 2064 7320  .""".        ds 
+00012960: 3d20 7872 2e44 6174 6173 6574 2863 6f6f  = xr.Dataset(coo
+00012970: 7264 733d 7365 6c66 2e77 6865 7265 292e  rds=self.where).
+00012980: 7265 6e61 6d65 280a 2020 2020 2020 2020  rename(.        
+00012990: 2020 2020 7b22 6865 6967 6874 223a 2022      {"height": "
+000129a0: 616c 7469 7475 6465 222c 2022 6c6f 6e22  altitude", "lon"
+000129b0: 3a20 226c 6f6e 6769 7475 6465 222c 2022  : "longitude", "
+000129c0: 6c61 7422 3a20 226c 6174 6974 7564 6522  lat": "latitude"
+000129d0: 7d0a 2020 2020 2020 2020 290a 2020 2020  }.        ).    
+000129e0: 2020 2020 7265 7475 726e 2064 730a 0a20      return ds.. 
+000129f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00012a00: 2064 6566 2043 6f6e 7665 6e74 696f 6e73   def Conventions
+00012a10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00012a20: 2222 2252 6574 7572 6e20 436f 6e76 656e  """Return Conven
+00012a30: 7469 6f6e 7320 7374 7269 6e67 2e22 2222  tions string."""
+00012a40: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00012a50: 2020 2020 2020 2020 2020 636f 6e76 203d            conv =
+00012a60: 2073 656c 662e 6e63 6964 2e61 7474 7273   self.ncid.attrs
+00012a70: 5b22 436f 6e76 656e 7469 6f6e 7322 5d0a  ["Conventions"].
+00012a80: 2020 2020 2020 2020 6578 6365 7074 204b          except K
+00012a90: 6579 4572 726f 723a 0a20 2020 2020 2020  eyError:.       
+00012aa0: 2020 2020 2063 6f6e 7620 3d20 4e6f 6e65       conv = None
+00012ab0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00012ac0: 636f 6e76 0a0a 2020 2020 6465 6620 746f  conv..    def to
+00012ad0: 5f6f 6469 6d28 7365 6c66 2c20 6669 6c65  _odim(self, file
+00012ae0: 6e61 6d65 2c20 7469 6d65 7374 6570 3d30  name, timestep=0
+00012af0: 293a 0a20 2020 2020 2020 2022 2222 5361  ):.        """Sa
+00012b00: 7665 2076 6f6c 756d 6520 746f 204f 4449  ve volume to ODI
+00012b10: 4d5f 4835 2f56 325f 3220 636f 6d70 6c69  M_H5/V2_2 compli
+00012b20: 616e 7420 6669 6c65 2e0a 0a20 2020 2020  ant file...     
+00012b30: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00012b40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00012b50: 0a20 2020 2020 2020 2066 696c 656e 616d  .        filenam
+00012b60: 6520 3a20 7374 720a 2020 2020 2020 2020  e : str.        
+00012b70: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
+00012b80: 6f75 7470 7574 2066 696c 650a 2020 2020  output file.    
+00012b90: 2020 2020 7469 6d65 7374 6570 203a 2069      timestep : i
+00012ba0: 6e74 0a20 2020 2020 2020 2020 2020 2074  nt.            t
+00012bb0: 696d 6573 7465 7020 6f66 2077 616e 7465  imestep of wante
+00012bc0: 6420 766f 6c75 6d65 0a20 2020 2020 2020  d volume.       
+00012bd0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00012be0: 7365 6c66 2e72 6f6f 743a 0a20 2020 2020  self.root:.     
+00012bf0: 2020 2020 2020 2074 6f5f 6f64 696d 2873         to_odim(s
+00012c00: 656c 662c 2066 696c 656e 616d 652c 2074  elf, filename, t
+00012c10: 696d 6573 7465 703d 7469 6d65 7374 6570  imestep=timestep
+00012c20: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00012c30: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00012c40: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00012c50: 2020 2020 2020 2020 2020 2022 5752 4144             "WRAD
+00012c60: 4c49 423a 204e 6f20 4f64 696d 4835 2d63  LIB: No OdimH5-c
+00012c70: 6f6d 706c 6961 6e74 2064 6174 6120 7374  ompliant data st
+00012c80: 7275 6374 7572 6520 2220 2261 7661 696c  ructure " "avail
+00012c90: 6162 6c65 2e20 4e6f 7420 7361 7669 6e67  able. Not saving
+00012ca0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+00012cb0: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
+00012cc0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00012cd0: 2020 2020 6465 6620 746f 5f63 6672 6164      def to_cfrad
+00012ce0: 6961 6c32 2873 656c 662c 2066 696c 656e  ial2(self, filen
+00012cf0: 616d 652c 2074 696d 6573 7465 703d 3029  ame, timestep=0)
+00012d00: 3a0a 2020 2020 2020 2020 2222 2253 6176  :.        """Sav
+00012d10: 6520 766f 6c75 6d65 2074 6f20 4366 5261  e volume to CfRa
+00012d20: 6469 616c 3220 636f 6d70 6c69 616e 7420  dial2 compliant 
+00012d30: 6669 6c65 2e0a 0a20 2020 2020 2020 2050  file...        P
+00012d40: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00012d50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00012d60: 2020 2020 2066 696c 656e 616d 6520 3a20       filename : 
+00012d70: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
+00012d80: 4e61 6d65 206f 6620 7468 6520 6f75 7470  Name of the outp
+00012d90: 7574 2066 696c 650a 2020 2020 2020 2020  ut file.        
+00012da0: 7469 6d65 7374 6570 203a 2069 6e74 0a20  timestep : int. 
+00012db0: 2020 2020 2020 2020 2020 2074 696d 6573             times
+00012dc0: 7465 7020 7761 6e74 6564 2076 6f6c 756d  tep wanted volum
+00012dd0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+00012de0: 2020 2020 2020 6966 2073 656c 662e 726f        if self.ro
+00012df0: 6f74 3a0a 2020 2020 2020 2020 2020 2020  ot:.            
+00012e00: 746f 5f63 6672 6164 6961 6c32 2873 656c  to_cfradial2(sel
+00012e10: 662c 2066 696c 656e 616d 652c 2074 696d  f, filename, tim
+00012e20: 6573 7465 703d 7469 6d65 7374 6570 290a  estep=timestep).
+00012e30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00012e40: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00012e50: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00012e60: 2020 2020 2020 2020 2022 5752 4144 4c49           "WRADLI
+00012e70: 423a 204e 6f20 4366 5261 6469 616c 322d  B: No CfRadial2-
+00012e80: 636f 6d70 6c69 616e 7420 6461 7461 2073  compliant data s
+00012e90: 7472 7563 7475 7265 2022 0a20 2020 2020  tructure ".     
+00012ea0: 2020 2020 2020 2020 2020 2022 6176 6169             "avai
+00012eb0: 6c61 626c 652e 204e 6f74 2073 6176 696e  lable. Not savin
+00012ec0: 672e 222c 0a20 2020 2020 2020 2020 2020  g.",.           
+00012ed0: 2020 2020 2055 7365 7257 6172 6e69 6e67       UserWarning
+00012ee0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00012ef0: 0a20 2020 2064 6566 2074 6f5f 6e65 7463  .    def to_netc
+00012f00: 6466 2873 656c 662c 2066 696c 656e 616d  df(self, filenam
+00012f10: 652c 2074 696d 6573 7465 703d 4e6f 6e65  e, timestep=None
+00012f20: 2c20 6b65 7973 3d4e 6f6e 6529 3a0a 2020  , keys=None):.  
+00012f30: 2020 2020 2020 2222 2253 6176 6520 766f        """Save vo
+00012f40: 6c75 6d65 2074 6f20 6e65 7463 6466 2063  lume to netcdf c
+00012f50: 6f6d 706c 6961 6e74 2066 696c 652e 0a0a  ompliant file...
+00012f60: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00012f70: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00012f80: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6669  -----.        fi
+00012f90: 6c65 6e61 6d65 203a 2073 7472 0a20 2020  lename : str.   
+00012fa0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+00012fb0: 2074 6865 206f 7574 7075 7420 6669 6c65   the output file
+00012fc0: 0a20 2020 2020 2020 2074 696d 6573 7465  .        timeste
+00012fd0: 7020 3a20 696e 742c 2073 6c69 6365 0a20  p : int, slice. 
+00012fe0: 2020 2020 2020 2020 2020 2074 696d 6573             times
+00012ff0: 7465 702f 736c 6963 6520 6f66 2077 616e  tep/slice of wan
+00013000: 7465 6420 766f 6c75 6d65 0a20 2020 2020  ted volume.     
+00013010: 2020 206b 6579 7320 3a20 6c69 7374 0a20     keys : list. 
+00013020: 2020 2020 2020 2020 2020 206c 6973 7420             list 
+00013030: 6f66 2073 7765 6570 5f67 726f 7570 5f6e  of sweep_group_n
+00013040: 616d 6573 2077 6869 6368 2073 686f 756c  ames which shoul
+00013050: 6420 6265 2077 7269 7474 656e 2074 6f20  d be written to 
+00013060: 7468 6520 6669 6c65 0a20 2020 2020 2020  the file.       
+00013070: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00013080: 7365 6c66 2e72 6f6f 743a 0a20 2020 2020  self.root:.     
+00013090: 2020 2020 2020 2074 6f5f 6e65 7463 6466         to_netcdf
+000130a0: 2873 656c 662c 2066 696c 656e 616d 652c  (self, filename,
+000130b0: 206b 6579 733d 6b65 7973 2c20 7469 6d65   keys=keys, time
+000130c0: 7374 6570 3d74 696d 6573 7465 7029 0a20  step=timestep). 
+000130d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000130e0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+000130f0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00013100: 2020 2020 2020 2020 2257 5241 444c 4942          "WRADLIB
+00013110: 3a20 4e6f 206e 6574 6364 662d 636f 6d70  : No netcdf-comp
+00013120: 6c69 616e 7420 6461 7461 2073 7472 7563  liant data struc
+00013130: 7475 7265 2022 2022 6176 6169 6c61 626c  ture " "availabl
+00013140: 652e 204e 6f74 2073 6176 696e 672e 222c  e. Not saving.",
+00013150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013160: 2055 7365 7257 6172 6e69 6e67 2c0a 2020   UserWarning,.  
+00013170: 2020 2020 2020 2020 2020 290a 0a0a 6465            )...de
+00013180: 6620 636f 6c6c 6563 745f 6279 5f74 696d  f collect_by_tim
+00013190: 6528 6f62 6a29 3a0a 2020 2020 2222 2243  e(obj):.    """C
+000131a0: 6f6c 6c65 6374 2058 5261 6453 7765 6570  ollect XRadSweep
+000131b0: 206f 626a 6563 7473 2068 6176 696e 6720   objects having 
+000131c0: 7361 6d65 2074 696d 650a 0a20 2020 2050  same time..    P
+000131d0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+000131e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206f 626a  --------.    obj
+000131f0: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
+00013200: 6c69 7374 206f 6620 5852 6164 5377 6565  list of XRadSwee
+00013210: 7020 6f62 6a65 6374 730a 0a20 2020 2052  p objects..    R
+00013220: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00013230: 2d2d 0a20 2020 206f 7574 203a 2058 5261  --.    out : XRa
+00013240: 6454 696d 6553 6572 6965 730a 2020 2020  dTimeSeries.    
+00013250: 2020 2020 7772 6170 7065 7220 6172 6f75      wrapper arou
+00013260: 6e64 206c 6973 7420 6f66 2058 5261 6453  nd list of XRadS
+00013270: 7765 6570 206f 626a 6563 7473 0a20 2020  weep objects.   
+00013280: 2022 2222 0a20 2020 206f 7574 203d 2058   """.    out = X
+00013290: 5261 6454 696d 6553 6572 6965 7328 290a  RadTimeSeries().
+000132a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000132b0: 6528 6f62 6a2c 2058 5261 6453 7765 6570  e(obj, XRadSweep
+000132c0: 293a 0a20 2020 2020 2020 206f 626a 203d  ):.        obj =
+000132d0: 205b 6f62 6a5d 0a20 2020 2074 696d 6573   [obj].    times
+000132e0: 203d 205b 6473 2e5f 6765 745f 7469 6d65   = [ds._get_time
+000132f0: 5f66 6173 7428 2920 666f 7220 6473 2069  _fast() for ds i
+00013300: 6e20 6f62 6a5d 0a20 2020 2075 6e69 7175  n obj].    uniqu
+00013310: 655f 7469 6d65 7320 3d20 6e70 2e61 7272  e_times = np.arr
+00013320: 6179 2873 6f72 7465 6428 6c69 7374 2873  ay(sorted(list(s
+00013330: 6574 2874 696d 6573 2929 2929 0a20 2020  et(times)))).   
+00013340: 2069 6620 6c65 6e28 756e 6971 7565 5f74   if len(unique_t
+00013350: 696d 6573 2920 3d3d 206c 656e 286f 626a  imes) == len(obj
+00013360: 293a 0a20 2020 2020 2020 206f 7574 2e65  ):.        out.e
+00013370: 7874 656e 6428 6f62 6a29 0a20 2020 2020  xtend(obj).     
+00013380: 2020 206f 7574 2e73 6f72 7428 6b65 793d     out.sort(key=
+00013390: 6c61 6d62 6461 2078 3a20 782e 5f67 6574  lambda x: x._get
+000133a0: 5f74 696d 655f 6661 7374 2829 290a 2020  _time_fast()).  
+000133b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000133c0: 2320 7275 6e73 206f 6e6c 7920 6966 2073  # runs only if s
+000133d0: 6576 6572 616c 2066 696c 6573 2066 6f72  everal files for
+000133e0: 2074 6865 2073 616d 6520 7469 6d65 7374   the same timest
+000133f0: 6570 2061 7265 2061 7661 696c 6162 6c65  ep are available
+00013400: 0a20 2020 2020 2020 2023 2065 6720 4457  .        # eg DW
+00013410: 4427 7320 6f6e 6520 7377 6565 7020 6f6e  D's one sweep on
+00013420: 6520 6d6f 6d65 6e74 2066 696c 6573 0a20  e moment files. 
+00013430: 2020 2020 2020 2066 6f72 2074 2069 6e20         for t in 
+00013440: 756e 6971 7565 5f74 696d 6573 3a0a 2020  unique_times:.  
+00013450: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
+00013460: 6e70 2e61 7267 7768 6572 6528 7469 6d65  np.argwhere(time
+00013470: 7320 3d3d 2074 292e 666c 6174 7465 6e28  s == t).flatten(
+00013480: 290a 2020 2020 2020 2020 2020 2020 6f75  ).            ou
+00013490: 7431 203d 206f 626a 5b69 6478 5b30 5d5d  t1 = obj[idx[0]]
+000134a0: 0a20 2020 2020 2020 2020 2020 205b 6f75  .            [ou
+000134b0: 7431 2e65 7874 656e 6428 6f62 6a5b 695d  t1.extend(obj[i]
+000134c0: 2920 666f 7220 6920 696e 2069 6478 5b31  ) for i in idx[1
+000134d0: 3a5d 5d0a 2020 2020 2020 2020 2020 2020  :]].            
+000134e0: 6f75 742e 6170 7065 6e64 286f 7574 3129  out.append(out1)
+000134f0: 0a20 2020 2072 6574 7572 6e20 6f75 740a  .    return out.
+00013500: 0a0a 6465 6620 636f 6c6c 6563 745f 6279  ..def collect_by
+00013510: 5f61 6e67 6c65 286f 626a 293a 0a20 2020  _angle(obj):.   
+00013520: 2022 2222 436f 6c6c 6563 7420 5852 6164   """Collect XRad
+00013530: 5377 6565 7020 6f62 6a65 6374 7320 6861  Sweep objects ha
+00013540: 7669 6e67 2073 616d 6520 616e 676c 650a  ving same angle.
+00013550: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00013560: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00013570: 2020 206f 626a 203a 206c 6973 740a 2020     obj : list.  
+00013580: 2020 2020 2020 6c69 7374 206f 6620 5852        list of XR
+00013590: 6164 5377 6565 7020 6f62 6a65 6374 730a  adSweep objects.
+000135a0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+000135b0: 202d 2d2d 2d2d 2d2d 0a20 2020 206f 7574   -------.    out
+000135c0: 203a 2058 5261 6456 6f6c 756d 650a 2020   : XRadVolume.  
+000135d0: 2020 2020 2020 7772 6170 7065 7220 6172        wrapper ar
+000135e0: 6f75 6e64 206e 6573 7465 6420 6c69 7374  ound nested list
+000135f0: 206f 6620 5852 6164 5377 6565 7020 6f62   of XRadSweep ob
+00013600: 6a65 6374 730a 2020 2020 2222 220a 2020  jects.    """.  
+00013610: 2020 6f75 7420 3d20 5852 6164 566f 6c75    out = XRadVolu
+00013620: 6d65 2829 0a20 2020 2061 6e67 6c65 7320  me().    angles 
+00013630: 3d20 5b64 732e 6669 7865 645f 616e 676c  = [ds.fixed_angl
+00013640: 6520 666f 7220 6473 2069 6e20 6f62 6a5d  e for ds in obj]
+00013650: 0a20 2020 2075 6e69 7175 655f 616e 676c  .    unique_angl
+00013660: 6573 203d 206c 6973 7428 7365 7428 616e  es = list(set(an
+00013670: 676c 6573 2929 0a20 2020 2069 6620 6c65  gles)).    if le
+00013680: 6e28 756e 6971 7565 5f61 6e67 6c65 7329  n(unique_angles)
+00013690: 203d 3d20 6c65 6e28 6f62 6a29 3a0a 2020   == len(obj):.  
+000136a0: 2020 2020 2020 6f75 742e 6578 7465 6e64        out.extend
+000136b0: 286f 626a 290a 2020 2020 656c 7365 3a0a  (obj).    else:.
+000136c0: 2020 2020 2020 2020 666f 7220 6120 696e          for a in
+000136d0: 2075 6e69 7175 655f 616e 676c 6573 3a0a   unique_angles:.
+000136e0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
+000136f0: 3d20 6e70 2e61 7267 7768 6572 6528 616e  = np.argwhere(an
+00013700: 676c 6573 203d 3d20 6129 2e66 6c61 7474  gles == a).flatt
+00013710: 656e 2829 0a20 2020 2020 2020 2020 2020  en().           
+00013720: 206d 6572 6765 5f6c 6973 7420 3d20 5b6f   merge_list = [o
+00013730: 626a 5b69 5d20 666f 7220 6920 696e 2069  bj[i] for i in i
+00013740: 6478 5d0a 2020 2020 2020 2020 2020 2020  dx].            
+00013750: 6f75 742e 6170 7065 6e64 286d 6572 6765  out.append(merge
+00013760: 5f6c 6973 7429 0a20 2020 2072 6574 7572  _list).    retur
+00013770: 6e20 6f75 740a 0a0a 6465 6620 5f6f 7065  n out...def _ope
+00013780: 6e5f 6f64 696d 5f73 7765 6570 2866 696c  n_odim_sweep(fil
+00013790: 656e 616d 652c 206c 6f61 6465 722c 202a  ename, loader, *
+000137a0: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
+000137b0: 2252 6574 7572 6e73 206c 6973 7420 6f66  "Returns list of
+000137c0: 2058 5261 6453 7765 6570 206f 626a 6563   XRadSweep objec
+000137d0: 7473 0a0a 2020 2020 4576 6572 7920 7377  ts..    Every sw
+000137e0: 6565 7020 7769 6c6c 2062 6520 7075 7420  eep will be put 
+000137f0: 696e 746f 2069 7427 7320 6f77 6e20 636c  into it's own cl
+00013800: 6173 7320 696e 7374 616e 6365 2e0a 2020  ass instance..  
+00013810: 2020 2222 220a 2020 2020 6c64 5f6b 7761    """.    ld_kwa
+00013820: 7267 7320 3d20 6b77 6172 6773 2e67 6574  rgs = kwargs.get
+00013830: 2822 6c64 5f6b 7761 7267 7322 2c20 7b7d  ("ld_kwargs", {}
+00013840: 290a 2020 2020 6966 206c 6f61 6465 7220  ).    if loader 
+00013850: 3d3d 2022 6e65 7463 6466 3422 3a0a 2020  == "netcdf4":.  
+00013860: 2020 2020 2020 6f70 656e 6572 203d 206e        opener = n
+00013870: 632e 4461 7461 7365 740a 2020 2020 2020  c.Dataset.      
+00013880: 2020 6174 7472 203d 2022 6772 6f75 7073    attr = "groups
+00013890: 220a 2020 2020 656c 6966 206c 6f61 6465  ".    elif loade
+000138a0: 7220 3d3d 2022 6835 6e65 7463 6466 223a  r == "h5netcdf":
+000138b0: 0a20 2020 2020 2020 206f 7065 6e65 7220  .        opener 
+000138c0: 3d20 6835 6e65 7463 6466 2e46 696c 650a  = h5netcdf.File.
+000138d0: 2020 2020 2020 2020 6174 7472 203d 2022          attr = "
+000138e0: 6b65 7973 220a 2020 2020 2020 2020 6c64  keys".        ld
+000138f0: 5f6b 7761 7267 735b 2270 686f 6e79 5f64  _kwargs["phony_d
+00013900: 696d 7322 5d20 3d20 2261 6363 6573 7322  ims"] = "access"
+00013910: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00013920: 2020 206f 7065 6e65 7220 3d20 6835 7079     opener = h5py
+00013930: 2e46 696c 650a 2020 2020 2020 2020 6174  .File.        at
+00013940: 7472 203d 2022 6b65 7973 220a 0a20 2020  tr = "keys"..   
+00013950: 2064 7364 6573 6320 3d20 2264 6174 6173   dsdesc = "datas
+00013960: 6574 220a 2020 2020 7377 6565 705f 636c  et".    sweep_cl
+00013970: 7320 3d20 5852 6164 5377 6565 704f 6469  s = XRadSweepOdi
+00013980: 6d0a 2020 2020 6966 2022 4741 4d49 4322  m.    if "GAMIC"
+00013990: 2069 6e20 6b77 6172 6773 2e67 6574 2822   in kwargs.get("
+000139a0: 666c 6176 6f75 7222 2c20 224f 4449 4d22  flavour", "ODIM"
+000139b0: 293a 0a20 2020 2020 2020 2069 6620 6c6f  ):.        if lo
+000139c0: 6164 6572 203d 3d20 226e 6574 6364 6634  ader == "netcdf4
+000139d0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+000139e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000139f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013a00: 2022 7772 6164 6c69 623a 2047 414d 4943   "wradlib: GAMIC
+00013a10: 2066 696c 6573 2063 616e 2774 2062 6520   files can't be 
+00013a20: 7265 6164 2075 7369 6e67 206e 6574 6364  read using netcd
+00013a30: 6634 220a 2020 2020 2020 2020 2020 2020  f4".            
+00013a40: 2020 2020 2220 6c6f 6164 6572 2e20 5573      " loader. Us
+00013a50: 6520 6569 7468 6572 2027 6835 7079 2720  e either 'h5py' 
+00013a60: 6f72 2027 6835 6e65 7463 6466 2e22 0a20  or 'h5netcdf.". 
+00013a70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00013a80: 2020 2020 2064 7364 6573 6320 3d20 2273       dsdesc = "s
+00013a90: 6361 6e22 0a20 2020 2020 2020 2073 7765  can".        swe
+00013aa0: 6570 5f63 6c73 203d 2058 5261 6453 7765  ep_cls = XRadSwe
+00013ab0: 6570 4761 6d69 630a 0a20 2020 2023 206f  epGamic..    # o
+00013ac0: 7065 6e20 6669 6c65 0a20 2020 2069 6620  pen file.    if 
+00013ad0: 6e6f 7420 6973 696e 7374 616e 6365 2866  not isinstance(f
+00013ae0: 696c 656e 616d 652c 2073 7472 293a 0a20  ilename, str):. 
+00013af0: 2020 2020 2020 2069 6620 6f70 656e 6572         if opener
+00013b00: 203d 3d20 6835 7079 2e46 696c 653a 0a20   == h5py.File:. 
+00013b10: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013b20: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00013b30: 2020 2020 2020 2020 2020 2020 2022 7772               "wr
+00013b40: 6164 6c69 623a 2066 696c 652d 6c69 6b65  adlib: file-like
+00013b50: 206f 626a 6563 7473 2063 616e 2774 2062   objects can't b
+00013b60: 6520 7265 6164 2075 7369 6e67 2068 3570  e read using h5p
+00013b70: 7920 220a 2020 2020 2020 2020 2020 2020  y ".            
+00013b80: 2020 2020 226c 6f61 6465 722e 2055 7365      "loader. Use
+00013b90: 2065 6974 6865 7220 276e 6574 6364 6634   either 'netcdf4
+00013ba0: 2720 6f72 2027 6835 6e65 7463 6466 272e  ' or 'h5netcdf'.
+00013bb0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00013bc0: 2020 2020 2020 2020 6966 206f 7065 6e65          if opene
+00013bd0: 7220 3d3d 206e 632e 4461 7461 7365 743a  r == nc.Dataset:
+00013be0: 0a20 2020 2020 2020 2020 2020 2068 616e  .            han
+00013bf0: 646c 6520 3d20 6f70 656e 6572 280a 2020  dle = opener(.  
+00013c00: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00013c10: 7b73 7472 2866 696c 656e 616d 6529 7d22  {str(filename)}"
+00013c20: 2c20 6d6f 6465 3d22 7222 2c20 6d65 6d6f  , mode="r", memo
+00013c30: 7279 3d66 696c 656e 616d 652e 7265 6164  ry=filename.read
+00013c40: 2829 2c20 2a2a 6c64 5f6b 7761 7267 730a  (), **ld_kwargs.
+00013c50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00013c60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00013c70: 2020 2020 2020 2020 6861 6e64 6c65 203d          handle =
+00013c80: 206f 7065 6e65 7228 6669 6c65 6e61 6d65   opener(filename
+00013c90: 2c20 2272 222c 202a 2a6c 645f 6b77 6172  , "r", **ld_kwar
+00013ca0: 6773 290a 2020 2020 656c 7365 3a0a 2020  gs).    else:.  
+00013cb0: 2020 2020 2020 6861 6e64 6c65 203d 206f        handle = o
+00013cc0: 7065 6e65 7228 6669 6c65 6e61 6d65 2c20  pener(filename, 
+00013cd0: 2272 222c 202a 2a6c 645f 6b77 6172 6773  "r", **ld_kwargs
+00013ce0: 290a 0a20 2020 2023 2067 6574 2067 726f  )..    # get gro
+00013cf0: 7570 206e 616d 6573 0a20 2020 2066 6174  up names.    fat
+00013d00: 7472 203d 2067 6574 6174 7472 2868 616e  tr = getattr(han
+00013d10: 646c 652c 2061 7474 7229 0a20 2020 2069  dle, attr).    i
+00013d20: 6620 6361 6c6c 6162 6c65 2866 6174 7472  f callable(fattr
+00013d30: 293a 0a20 2020 2020 2020 2067 726f 7570  ):.        group
+00013d40: 7320 3d20 6c69 7374 2866 6174 7472 2829  s = list(fattr()
+00013d50: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00013d60: 2020 2020 6772 6f75 7073 203d 206c 6973      groups = lis
+00013d70: 7428 6661 7474 7229 0a0a 2020 2020 2320  t(fattr)..    # 
+00013d80: 6974 6572 6174 6520 6f76 6572 2073 696e  iterate over sin
+00013d90: 676c 6520 7377 6565 7073 0a20 2020 2023  gle sweeps.    #
+00013da0: 2074 6f64 6f3a 2069 6620 736f 7274 696e   todo: if sortin
+00013db0: 6720 646f 6573 206e 6f74 206d 6174 7465  g does not matte
+00013dc0: 722c 2077 6520 6361 6e20 736b 6970 2074  r, we can skip t
+00013dd0: 6869 730a 2020 2020 7377 6565 7073 203d  his.    sweeps =
+00013de0: 205b 6b20 666f 7220 6b20 696e 2067 726f   [k for k in gro
+00013df0: 7570 7320 6966 2064 7364 6573 6320 696e  ups if dsdesc in
+00013e00: 206b 5d0a 2020 2020 7377 6565 7073 5f69   k].    sweeps_i
+00013e10: 6478 203d 206e 702e 6172 6773 6f72 7428  dx = np.argsort(
+00013e20: 5b69 6e74 2873 5b6c 656e 2864 7364 6573  [int(s[len(dsdes
+00013e30: 6329 203a 5d29 2066 6f72 2073 2069 6e20  c) :]) for s in 
+00013e40: 7377 6565 7073 5d29 0a20 2020 2073 7765  sweeps]).    swe
+00013e50: 6570 7320 3d20 6e70 2e61 7272 6179 2873  eps = np.array(s
+00013e60: 7765 6570 7329 5b73 7765 6570 735f 6964  weeps)[sweeps_id
+00013e70: 785d 2e74 6f6c 6973 7428 290a 2020 2020  x].tolist().    
+00013e80: 7265 7475 726e 205b 7377 6565 705f 636c  return [sweep_cl
+00013e90: 7328 6861 6e64 6c65 2c20 6b2c 202a 2a6b  s(handle, k, **k
+00013ea0: 7761 7267 7329 2066 6f72 206b 2069 6e20  wargs) for k in 
+00013eb0: 7377 6565 7073 5d0a 0a0a 6465 6620 6f70  sweeps]...def op
+00013ec0: 656e 5f6f 6469 6d28 7061 7468 732c 206c  en_odim(paths, l
+00013ed0: 6f61 6465 723d 226e 6574 6364 6634 222c  oader="netcdf4",
+00013ee0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00013ef0: 2222 224f 7065 6e20 6d75 6c74 6970 6c65  """Open multiple
+00013f00: 204f 4449 4d20 6669 6c65 7320 6173 2061   ODIM files as a
+00013f10: 2058 5261 6456 6f6c 756d 6520 7374 7275   XRadVolume stru
+00013f20: 6374 7572 652e 0a0a 2020 2020 5061 7261  cture...    Para
+00013f30: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00013f40: 2d2d 2d2d 2d0a 2020 2020 7061 7468 7320  -----.    paths 
+00013f50: 3a20 7374 7220 6f72 2073 6571 7565 6e63  : str or sequenc
+00013f60: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
+00013f70: 2061 2066 696c 656e 616d 6520 6f72 2073   a filename or s
+00013f80: 7472 696e 6720 676c 6f62 2069 6e20 7468  tring glob in th
+00013f90: 6520 666f 726d 2060 2770 6174 682f 746f  e form `'path/to
+00013fa0: 2f6d 792f 6669 6c65 732f 2a2e 6835 2760  /my/files/*.h5'`
+00013fb0: 0a20 2020 2020 2020 206f 7220 616e 2065  .        or an e
+00013fc0: 7870 6c69 6369 7420 6c69 7374 206f 6620  xplicit list of 
+00013fd0: 6669 6c65 7320 746f 206f 7065 6e2e 0a0a  files to open...
+00013fe0: 2020 2020 6c6f 6164 6572 203a 207b 276e      loader : {'n
+00013ff0: 6574 6364 6634 272c 2027 6835 7079 272c  etcdf4', 'h5py',
+00014000: 2027 6835 6e65 7463 6466 277d 0a20 2020   'h5netcdf'}.   
+00014010: 2020 2020 204c 6f61 6465 7220 7573 6564       Loader used
+00014020: 2066 6f72 2061 6363 6573 7369 6e67 2066   for accessing f
+00014030: 696c 6520 6d65 7461 6461 7461 2c20 6465  ile metadata, de
+00014040: 6661 756c 7473 2074 6f20 276e 6574 6364  faults to 'netcd
+00014050: 6634 272e 0a0a 2020 2020 6b77 6172 6773  f4'...    kwargs
+00014060: 203a 206f 7074 696f 6e61 6c0a 2020 2020   : optional.    
+00014070: 2020 2020 4164 6469 7469 6f6e 616c 2061      Additional a
+00014080: 7267 756d 656e 7473 2070 6173 7365 6420  rguments passed 
+00014090: 6f6e 2074 6f20 3a70 793a 636c 6173 733a  on to :py:class:
+000140a0: 6077 7261 646c 6962 2e69 6f2e 5852 6164  `wradlib.io.XRad
+000140b0: 5377 6565 7060 2e0a 2020 2020 2222 220a  Sweep`..    """.
+000140c0: 2020 2020 6966 2028 6c6f 6164 6572 203d      if (loader =
+000140d0: 3d20 2268 356e 6574 6364 6622 2920 2620  = "h5netcdf") & 
+000140e0: 280a 2020 2020 2020 2020 4c6f 6f73 6556  (.        LooseV
+000140f0: 6572 7369 6f6e 2868 356e 6574 6364 662e  ersion(h5netcdf.
+00014100: 5f5f 7665 7273 696f 6e5f 5f29 203c 204c  __version__) < L
+00014110: 6f6f 7365 5665 7273 696f 6e28 2230 2e38  ooseVersion("0.8
+00014120: 2e30 2229 0a20 2020 2029 3a0a 2020 2020  .0").    ):.    
+00014130: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00014140: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
+00014150: 2257 5241 444c 4942 3a20 2768 356e 6574  "WRADLIB: 'h5net
+00014160: 6364 663e 3d30 2e38 2e30 2720 6e65 6564  cdf>=0.8.0' need
+00014170: 6564 2074 6f20 7065 7266 6f72 6d20 7468  ed to perform th
+00014180: 6973 2022 0a20 2020 2020 2020 2020 2020  is ".           
+00014190: 2066 226f 7065 7261 7469 6f6e 2e20 2768   f"operation. 'h
+000141a0: 356e 6574 6364 663d 7b68 356e 6574 6364  5netcdf={h5netcd
+000141b0: 662e 5f5f 7665 7273 696f 6e5f 5f7d 2022  f.__version__} "
+000141c0: 0a20 2020 2020 2020 2020 2020 2066 2261  .            f"a
+000141d0: 7661 696c 6162 6c65 2e22 2c0a 2020 2020  vailable.",.    
+000141e0: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
+000141f0: 696e 672c 0a20 2020 2020 2020 2029 0a0a  ing,.        )..
+00014200: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00014210: 6528 7061 7468 732c 2073 7472 293a 0a20  e(paths, str):. 
+00014220: 2020 2020 2020 2070 6174 6873 203d 2067         paths = g
+00014230: 6c6f 622e 676c 6f62 2870 6174 6873 290a  lob.glob(paths).
+00014240: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00014250: 2020 7061 7468 7320 3d20 6e70 2e61 7272    paths = np.arr
+00014260: 6179 2870 6174 6873 292e 666c 6174 7465  ay(paths).flatte
+00014270: 6e28 292e 746f 6c69 7374 2829 0a0a 2020  n().tolist()..  
+00014280: 2020 6966 206c 6f61 6465 7220 6e6f 7420    if loader not 
+00014290: 696e 205b 226e 6574 6364 6634 222c 2022  in ["netcdf4", "
+000142a0: 6835 6e65 7463 6466 222c 2022 6835 7079  h5netcdf", "h5py
+000142b0: 225d 3a0a 2020 2020 2020 2020 7261 6973  "]:.        rais
+000142c0: 6520 5661 6c75 6545 7272 6f72 2822 7772  e ValueError("wr
+000142d0: 6164 6c69 623a 2055 6e6b 6e6f 776e 206c  adlib: Unknown l
+000142e0: 6f61 6465 723a 207b 7d22 2e66 6f72 6d61  oader: {}".forma
+000142f0: 7428 6c6f 6164 6572 2929 0a0a 2020 2020  t(loader))..    
+00014300: 7377 6565 7073 203d 205b 5d0a 2020 2020  sweeps = [].    
+00014310: 5b0a 2020 2020 2020 2020 7377 6565 7073  [.        sweeps
+00014320: 2e65 7874 656e 6428 5f6f 7065 6e5f 6f64  .extend(_open_od
+00014330: 696d 5f73 7765 6570 2866 2c20 6c6f 6164  im_sweep(f, load
+00014340: 6572 2c20 2a2a 6b77 6172 6773 2929 0a20  er, **kwargs)). 
+00014350: 2020 2020 2020 2066 6f72 2066 2069 6e20         for f in 
+00014360: 7471 646d 2870 6174 6873 2c20 6465 7363  tqdm(paths, desc
+00014370: 3d22 4f70 656e 222c 2075 6e69 743d 2220  ="Open", unit=" 
+00014380: 4669 6c65 7322 2c20 6c65 6176 653d 4e6f  Files", leave=No
+00014390: 6e65 290a 2020 2020 5d0a 2020 2020 616e  ne).    ].    an
+000143a0: 676c 6573 203d 2063 6f6c 6c65 6374 5f62  gles = collect_b
+000143b0: 795f 616e 676c 6528 7377 6565 7073 290a  y_angle(sweeps).
+000143c0: 2020 2020 666f 7220 6920 696e 2074 7164      for i in tqd
+000143d0: 6d28 7261 6e67 6528 6c65 6e28 616e 676c  m(range(len(angl
+000143e0: 6573 2929 2c20 6465 7363 3d22 436f 6c6c  es)), desc="Coll
+000143f0: 6563 7469 6e67 222c 2075 6e69 743d 2220  ecting", unit=" 
+00014400: 416e 676c 6573 222c 206c 6561 7665 3d4e  Angles", leave=N
+00014410: 6f6e 6529 3a0a 2020 2020 2020 2020 616e  one):.        an
+00014420: 676c 6573 5b69 5d20 3d20 636f 6c6c 6563  gles[i] = collec
+00014430: 745f 6279 5f74 696d 6528 616e 676c 6573  t_by_time(angles
+00014440: 5b69 5d29 0a20 2020 2061 6e67 6c65 732e  [i]).    angles.
+00014450: 736f 7274 286b 6579 3d6c 616d 6264 6120  sort(key=lambda 
+00014460: 783a 2078 5b30 5d2e 7469 6d65 290a 2020  x: x[0].time).  
+00014470: 2020 666f 7220 6620 696e 2061 6e67 6c65    for f in angle
+00014480: 733a 0a20 2020 2020 2020 2066 2e5f 7061  s:.        f._pa
+00014490: 7265 6e74 203d 2061 6e67 6c65 730a 2020  rent = angles.  
+000144a0: 2020 616e 676c 6573 2e5f 6e63 6669 6c65    angles._ncfile
+000144b0: 203d 2061 6e67 6c65 735b 305d 2e6e 6366   = angles[0].ncf
+000144c0: 696c 650a 2020 2020 616e 676c 6573 2e5f  ile.    angles._
+000144d0: 6e63 7061 7468 203d 2022 2f22 0a20 2020  ncpath = "/".   
+000144e0: 2072 6574 7572 6e20 616e 676c 6573 0a0a   return angles..
+000144f0: 0a63 6c61 7373 2058 5261 6456 6f6c 4669  .class XRadVolFi
+00014500: 6c65 286f 626a 6563 7429 3a0a 2020 2020  le(object):.    
+00014510: 2222 2242 6173 6543 6c61 7373 2066 6f72  """BaseClass for
+00014520: 2068 6f6c 6469 6e67 206e 6574 4344 4634   holding netCDF4
+00014530: 2e44 6174 6173 6574 2068 616e 646c 6573  .Dataset handles
+00014540: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
+00014550: 6e69 745f 5f28 7365 6c66 2c20 6669 6c65  nit__(self, file
+00014560: 6e61 6d65 3d4e 6f6e 652c 2066 6c61 766f  name=None, flavo
+00014570: 7572 3d4e 6f6e 652c 202a 2a6b 7761 7267  ur=None, **kwarg
+00014580: 7329 3a0a 2020 2020 2020 2020 7365 6c66  s):.        self
+00014590: 2e5f 6669 6c65 6e61 6d65 203d 2066 696c  ._filename = fil
+000145a0: 656e 616d 650a 2020 2020 2020 2020 7365  ename.        se
+000145b0: 6c66 2e5f 6e63 6820 3d20 4e6f 6e65 0a20  lf._nch = None. 
+000145c0: 2020 2020 2020 2073 656c 662e 5f66 6c61         self._fla
+000145d0: 766f 7572 203d 204e 6f6e 650a 2020 2020  vour = None.    
+000145e0: 2020 2020 7365 6c66 2e5f 6e63 682c 2073      self._nch, s
+000145f0: 656c 662e 5f66 6c61 766f 7572 203d 2073  elf._flavour = s
+00014600: 656c 662e 5f63 6865 636b 5f66 696c 6528  elf._check_file(
+00014610: 6669 6c65 6e61 6d65 2c20 666c 6176 6f75  filename, flavou
+00014620: 7229 0a0a 2020 2020 6465 6620 5f63 6865  r)..    def _che
+00014630: 636b 5f66 696c 6528 7365 6c66 2c20 6669  ck_file(self, fi
+00014640: 6c65 6e61 6d65 2c20 666c 6176 6f75 7229  lename, flavour)
+00014650: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00014660: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00014670: 726f 720a 0a20 2020 2064 6566 205f 5f64  ror..    def __d
+00014680: 656c 5f5f 2873 656c 6629 3a0a 2020 2020  el__(self):.    
+00014690: 2020 2020 6966 2073 656c 662e 5f6e 6368      if self._nch
+000146a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000146b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000146c0: 6e63 682e 636c 6f73 6528 290a 0a20 2020  nch.close()..   
+000146d0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000146e0: 6566 2066 696c 656e 616d 6528 7365 6c66  ef filename(self
+000146f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00014700: 6e20 7365 6c66 2e5f 6669 6c65 6e61 6d65  n self._filename
+00014710: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00014720: 2020 2020 6465 6620 6e63 6828 7365 6c66      def nch(self
+00014730: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00014740: 6e20 7365 6c66 2e5f 6e63 680a 0a20 2020  n self._nch..   
+00014750: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00014760: 6566 2066 6c61 766f 7572 2873 656c 6629  ef flavour(self)
+00014770: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00014780: 2073 656c 662e 5f66 6c61 766f 7572 0a0a   self._flavour..
+00014790: 0a63 6c61 7373 204f 6469 6d48 3546 696c  .class OdimH5Fil
+000147a0: 6528 5852 6164 566f 6c46 696c 6529 3a0a  e(XRadVolFile):.
+000147b0: 2020 2020 2222 2243 6c61 7373 2066 6f72      """Class for
+000147c0: 2068 6f6c 6469 6e67 206e 6574 4344 4634   holding netCDF4
+000147d0: 2e44 6174 6173 6574 2068 616e 646c 6573  .Dataset handles
+000147e0: 206f 6620 4f64 696d 4835 2066 696c 6573   of OdimH5 files
+000147f0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00014800: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00014810: 2020 2020 6669 6c65 6e61 6d65 203a 2073      filename : s
+00014820: 7472 0a20 2020 2020 2020 2053 6f75 7263  tr.        Sourc
+00014830: 6520 6461 7461 2066 696c 6520 6e61 6d65  e data file name
+00014840: 2e0a 2020 2020 666c 6176 6f75 7220 3a20  ..    flavour : 
+00014850: 7374 720a 2020 2020 2020 2020 4e61 6d65  str.        Name
+00014860: 206f 6620 6864 6635 2066 6c61 766f 7572   of hdf5 flavour
+00014870: 2028 274f 4449 4d27 206f 7220 2747 414d   ('ODIM' or 'GAM
+00014880: 4943 2729 2e20 4465 6661 756c 7473 2074  IC'). Defaults t
+00014890: 6f20 274f 4449 4d27 2e0a 2020 2020 2222  o 'ODIM'..    ""
+000148a0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+000148b0: 745f 5f28 7365 6c66 2c20 6669 6c65 6e61  t__(self, filena
+000148c0: 6d65 3d4e 6f6e 652c 2066 6c61 766f 7572  me=None, flavour
+000148d0: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
+000148e0: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
+000148f0: 4f64 696d 4835 4669 6c65 2c20 7365 6c66  OdimH5File, self
+00014900: 292e 5f5f 696e 6974 5f5f 2866 696c 656e  ).__init__(filen
+00014910: 616d 653d 6669 6c65 6e61 6d65 2c20 666c  ame=filename, fl
+00014920: 6176 6f75 723d 666c 6176 6f75 722c 202a  avour=flavour, *
+00014930: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+00014940: 6620 5f63 6865 636b 5f66 696c 6528 7365  f _check_file(se
+00014950: 6c66 2c20 6669 6c65 6e61 6d65 2c20 666c  lf, filename, fl
+00014960: 6176 6f75 7229 3a0a 2020 2020 2020 2020  avour):.        
+00014970: 6e63 6820 3d20 6e63 2e44 6174 6173 6574  nch = nc.Dataset
+00014980: 2866 696c 656e 616d 652c 2064 6973 6b6c  (filename, diskl
+00014990: 6573 733d 5472 7565 2c20 7065 7273 6973  ess=True, persis
+000149a0: 743d 4661 6c73 6529 0a20 2020 2020 2020  t=False).       
+000149b0: 2069 6620 6e63 682e 6469 736b 5f66 6f72   if nch.disk_for
+000149c0: 6d61 7420 213d 2022 4844 4635 223a 0a20  mat != "HDF5":. 
+000149d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000149e0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+000149f0: 2020 2020 2020 2020 2020 2020 2777 7261              'wra
+00014a00: 646c 6962 3a20 4669 6c65 207b 7d20 6973  dlib: File {} is
+00014a10: 206e 6569 7468 6572 2022 4e45 5443 4446   neither "NETCDF
+00014a20: 3422 2028 7573 696e 6720 4844 4635 2067  4" (using HDF5 g
+00014a30: 726f 7570 7329 2027 0a20 2020 2020 2020  roups) '.       
+00014a40: 2020 2020 2020 2020 2027 6e6f 7220 706c           'nor pl
+00014a50: 6169 6e20 2248 4446 3522 2e27 2e66 6f72  ain "HDF5".'.for
+00014a60: 6d61 7428 6669 6c65 6e61 6d65 290a 2020  mat(filename).  
+00014a70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00014a80: 2020 2020 6966 2066 6c61 766f 7572 2069      if flavour i
+00014a90: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00014aa0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00014ab0: 2020 2020 2020 2020 2066 6c61 766f 7572           flavour
+00014ac0: 203d 206e 6368 2e43 6f6e 7665 6e74 696f   = nch.Conventio
+00014ad0: 6e73 0a20 2020 2020 2020 2020 2020 2065  ns.            e
+00014ae0: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
+00014af0: 7272 6f72 2061 7320 653a 0a20 2020 2020  rror as e:.     
+00014b00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00014b10: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
+00014b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014b30: 2020 2020 2027 7772 6164 6c69 623a 204d       'wradlib: M
+00014b40: 6973 7369 6e67 2022 436f 6e76 656e 7469  issing "Conventi
+00014b50: 6f6e 7322 2061 7474 7269 6275 7465 2069  ons" attribute i
+00014b60: 6e20 7b7d 202e 2f6e 270a 2020 2020 2020  n {} ./n'.      
+00014b70: 2020 2020 2020 2020 2020 2020 2020 2755                'U
+00014b80: 7365 2074 6865 2022 666c 6176 6f75 7222  se the "flavour"
+00014b90: 206b 7761 7267 2074 6f20 7370 6563 6966   kwarg to specif
+00014ba0: 7920 796f 7572 2073 6f75 7263 6520 270a  y your source '.
+00014bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bc0: 2020 2020 2264 6174 612e 222e 666f 726d      "data.".form
+00014bd0: 6174 2866 696c 656e 616d 6529 0a20 2020  at(filename).   
+00014be0: 2020 2020 2020 2020 2020 2020 2029 2066               ) f
+00014bf0: 726f 6d20 650a 2020 2020 2020 2020 2020  rom e.          
+00014c00: 2020 6966 2022 4f44 494d 2220 6e6f 7420    if "ODIM" not 
+00014c10: 696e 2066 6c61 766f 7572 3a0a 2020 2020  in flavour:.    
+00014c20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00014c30: 6520 4174 7472 6962 7574 6545 7272 6f72  e AttributeError
+00014c40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014c50: 2020 2020 2020 2777 7261 646c 6962 3a20        'wradlib: 
+00014c60: 2243 6f6e 7665 6e74 696f 6e73 2220 6174  "Conventions" at
+00014c70: 7472 6962 7574 6520 227b 7d22 2069 6e20  tribute "{}" in 
+00014c80: 7b7d 2069 7320 756e 6b6e 6f77 6e2e 2f6e  {} is unknown./n
+00014c90: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00014ca0: 2020 2020 2020 2755 7365 2074 6865 2022        'Use the "
+00014cb0: 666c 6176 6f75 7222 206b 7761 7267 2074  flavour" kwarg t
+00014cc0: 6f20 7370 6563 6966 7920 796f 7572 2073  o specify your s
+00014cd0: 6f75 7263 6520 270a 2020 2020 2020 2020  ource '.        
+00014ce0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
+00014cf0: 612e 222e 666f 726d 6174 2866 6c61 766f  a.".format(flavo
+00014d00: 7572 2c20 6669 6c65 6e61 6d65 290a 2020  ur, filename).  
+00014d10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00014d20: 0a20 2020 2020 2020 2069 6620 224f 4449  .        if "ODI
+00014d30: 4d22 2069 6e20 666c 6176 6f75 723a 0a20  M" in flavour:. 
+00014d40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014d50: 5f64 7364 6573 6320 3d20 2264 6174 6173  _dsdesc = "datas
+00014d60: 6574 220a 2020 2020 2020 2020 2020 2020  et".            
+00014d70: 7365 6c66 2e5f 7377 6d6f 6465 203d 2022  self._swmode = "
+00014d80: 7072 6f64 7563 7422 0a20 2020 2020 2020  product".       
+00014d90: 2020 2020 2073 656c 662e 5f6d 666d 7420       self._mfmt 
+00014da0: 3d20 2264 6174 6122 0a20 2020 2020 2020  = "data".       
+00014db0: 2020 2020 2073 656c 662e 5f6d 7372 6320       self._msrc 
+00014dc0: 3d20 2267 726f 7570 7322 0a20 2020 2020  = "groups".     
+00014dd0: 2020 2065 6c69 6620 2247 414d 4943 2220     elif "GAMIC" 
+00014de0: 696e 2066 6c61 766f 7572 3a0a 2020 2020  in flavour:.    
+00014df0: 2020 2020 2020 2020 7365 6c66 2e5f 6473          self._ds
+00014e00: 6465 7363 203d 2022 7363 616e 220a 2020  desc = "scan".  
+00014e10: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00014e20: 7377 6d6f 6465 203d 2022 7363 616e 5f74  swmode = "scan_t
+00014e30: 7970 6522 0a20 2020 2020 2020 2020 2020  ype".           
+00014e40: 2073 656c 662e 5f6d 666d 7420 3d20 226d   self._mfmt = "m
+00014e50: 6f6d 656e 745f 220a 2020 2020 2020 2020  oment_".        
+00014e60: 2020 2020 7365 6c66 2e5f 6d73 7263 203d      self._msrc =
+00014e70: 2022 7661 7269 6162 6c65 7322 0a20 2020   "variables".   
+00014e80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00014e90: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+00014ea0: 7269 6275 7465 4572 726f 7228 0a20 2020  ributeError(.   
+00014eb0: 2020 2020 2020 2020 2020 2020 2027 7772               'wr
+00014ec0: 6164 6c69 623a 2055 6e6b 6e6f 776e 2022  adlib: Unknown "
+00014ed0: 666c 6176 6f75 7222 206b 7761 7267 2061  flavour" kwarg a
+00014ee0: 7474 7269 6275 7465 3a20 7b7d 202e 2720  ttribute: {} .' 
+00014ef0: 2222 2e66 6f72 6d61 7428 666c 6176 6f75  "".format(flavou
+00014f00: 7229 0a20 2020 2020 2020 2020 2020 2029  r).            )
+00014f10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00014f20: 206e 6368 2c20 666c 6176 6f75 720a 0a20   nch, flavour.. 
+00014f30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00014f40: 2064 6566 2066 6c61 766f 7572 2873 656c   def flavour(sel
+00014f50: 6629 3a0a 2020 2020 2020 2020 666c 7620  f):.        flv 
+00014f60: 3d20 5b22 4f44 494d 222c 2022 4741 4d49  = ["ODIM", "GAMI
+00014f70: 4322 5d0a 2020 2020 2020 2020 7265 7475  C"].        retu
+00014f80: 726e 205b 7320 666f 7220 7320 696e 2066  rn [s for s in f
+00014f90: 6c76 2069 6620 7320 696e 2073 656c 662e  lv if s in self.
+00014fa0: 5f66 6c61 766f 7572 5d5b 305d 0a0a 0a63  _flavour][0]...c
+00014fb0: 6c61 7373 204e 6574 4344 4634 4669 6c65  lass NetCDF4File
+00014fc0: 2858 5261 6456 6f6c 4669 6c65 293a 0a20  (XRadVolFile):. 
+00014fd0: 2020 2022 2222 436c 6173 7320 666f 7220     """Class for 
+00014fe0: 686f 6c64 696e 6720 6e65 7443 4446 342e  holding netCDF4.
+00014ff0: 4461 7461 7365 7420 6861 6e64 6c65 7320  Dataset handles 
+00015000: 6f66 2043 662f 5261 6469 616c 2066 696c  of Cf/Radial fil
+00015010: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
+00015020: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00015030: 2d0a 2020 2020 6669 6c65 6e61 6d65 203a  -.    filename :
+00015040: 2073 7472 0a20 2020 2020 2020 2053 6f75   str.        Sou
+00015050: 7263 6520 6461 7461 2066 696c 6520 6e61  rce data file na
+00015060: 6d65 2e0a 2020 2020 666c 6176 6f75 7220  me..    flavour 
+00015070: 3a20 7374 720a 2020 2020 2020 2020 4e61  : str.        Na
+00015080: 6d65 206f 6620 666c 6176 6f75 7220 2827  me of flavour ('
+00015090: 4366 2f52 6164 6961 6c27 206f 7220 2743  Cf/Radial' or 'C
+000150a0: 662f 5261 6469 616c 3227 292e 0a20 2020  f/Radial2')..   
+000150b0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+000150c0: 696e 6974 5f5f 2873 656c 662c 2066 696c  init__(self, fil
+000150d0: 656e 616d 653d 4e6f 6e65 2c20 666c 6176  ename=None, flav
+000150e0: 6f75 723d 4e6f 6e65 2c20 2a2a 6b77 6172  our=None, **kwar
+000150f0: 6773 293a 0a20 2020 2020 2020 2073 7570  gs):.        sup
+00015100: 6572 284e 6574 4344 4634 4669 6c65 2c20  er(NetCDF4File, 
+00015110: 7365 6c66 292e 5f5f 696e 6974 5f5f 2866  self).__init__(f
+00015120: 696c 656e 616d 653d 6669 6c65 6e61 6d65  ilename=filename
+00015130: 2c20 666c 6176 6f75 723d 666c 6176 6f75  , flavour=flavou
+00015140: 722c 202a 2a6b 7761 7267 7329 0a0a 2020  r, **kwargs)..  
+00015150: 2020 6465 6620 5f63 6865 636b 5f66 696c    def _check_fil
+00015160: 6528 7365 6c66 2c20 6669 6c65 6e61 6d65  e(self, filename
+00015170: 2c20 666c 6176 6f75 7229 3a0a 2020 2020  , flavour):.    
+00015180: 2020 2020 6e63 6820 3d20 6e63 2e44 6174      nch = nc.Dat
+00015190: 6173 6574 2866 696c 656e 616d 652c 2064  aset(filename, d
+000151a0: 6973 6b6c 6573 733d 5472 7565 2c20 7065  iskless=True, pe
+000151b0: 7273 6973 743d 4661 6c73 6529 0a20 2020  rsist=False).   
+000151c0: 2020 2020 2069 6620 666c 6176 6f75 7220       if flavour 
+000151d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000151e0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+000151f0: 2020 2020 2020 2020 2020 436f 6e76 656e            Conven
+00015200: 7469 6f6e 7320 3d20 6e63 682e 436f 6e76  tions = nch.Conv
+00015210: 656e 7469 6f6e 730a 2020 2020 2020 2020  entions.        
+00015220: 2020 2020 2020 2020 7665 7273 696f 6e20          version 
+00015230: 3d20 6e63 682e 7665 7273 696f 6e0a 2020  = nch.version.  
+00015240: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00015250: 2041 7474 7269 6275 7465 4572 726f 7220   AttributeError 
+00015260: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
+00015270: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
+00015280: 6962 7574 6545 7272 6f72 280a 2020 2020  ibuteError(.    
+00015290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152a0: 2777 7261 646c 6962 3a20 4d69 7373 696e  'wradlib: Missin
+000152b0: 6720 2243 6f6e 7665 6e74 696f 6e73 2220  g "Conventions" 
+000152c0: 6174 7472 6962 7574 6520 696e 207b 7d20  attribute in {} 
+000152d0: 2e2f 6e27 0a20 2020 2020 2020 2020 2020  ./n'.           
+000152e0: 2020 2020 2020 2020 2027 5573 6520 7468           'Use th
+000152f0: 6520 2266 6c61 766f 7572 2220 6b77 6172  e "flavour" kwar
+00015300: 6720 746f 2073 7065 6369 6679 2079 6f75  g to specify you
+00015310: 7220 736f 7572 6365 270a 2020 2020 2020  r source'.      
+00015320: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00015330: 6174 612e 222e 666f 726d 6174 2866 696c  ata.".format(fil
+00015340: 656e 616d 6529 0a20 2020 2020 2020 2020  ename).         
+00015350: 2020 2020 2020 2029 2066 726f 6d20 650a         ) from e.
+00015360: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+00015370: 6366 2f72 6164 6961 6c22 2069 6e20 436f  cf/radial" in Co
+00015380: 6e76 656e 7469 6f6e 732e 6c6f 7765 7228  nventions.lower(
+00015390: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000153a0: 2020 2069 6620 7665 7273 696f 6e20 3d3d     if version ==
+000153b0: 2022 322e 3022 3a0a 2020 2020 2020 2020   "2.0":.        
+000153c0: 2020 2020 2020 2020 2020 2020 666c 6176              flav
+000153d0: 6f75 7220 3d20 2243 662f 5261 6469 616c  our = "Cf/Radial
+000153e0: 3222 0a20 2020 2020 2020 2020 2020 2020  2".             
+000153f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00015400: 2020 2020 2020 2020 2020 2020 2066 6c61               fla
+00015410: 766f 7572 203d 2022 4366 2f52 6164 6961  vour = "Cf/Radia
+00015420: 6c22 0a0a 2020 2020 2020 2020 6966 2066  l"..        if f
+00015430: 6c61 766f 7572 206e 6f74 2069 6e20 5b22  lavour not in ["
+00015440: 4366 2f52 6164 6961 6c22 2c20 2243 662f  Cf/Radial", "Cf/
+00015450: 5261 6469 616c 3222 5d3a 0a20 2020 2020  Radial2"]:.     
+00015460: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+00015470: 7269 6275 7465 4572 726f 7228 0a20 2020  ributeError(.   
+00015480: 2020 2020 2020 2020 2020 2020 2027 7772               'wr
+00015490: 6164 6c69 623a 2055 6e6b 6e6f 776e 2022  adlib: Unknown "
+000154a0: 666c 6176 6f75 7222 206b 7761 7267 2061  flavour" kwarg a
+000154b0: 7474 7269 6275 7465 3a20 7b7d 202e 2720  ttribute: {} .' 
+000154c0: 2222 2e66 6f72 6d61 7428 666c 6176 6f75  "".format(flavou
+000154d0: 7229 0a20 2020 2020 2020 2020 2020 2029  r).            )
+000154e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000154f0: 206e 6368 2c20 666c 6176 6f75 720a 0a0a   nch, flavour...
+00015500: 636c 6173 7320 5852 6164 566f 6c28 636f  class XRadVol(co
+00015510: 6c6c 6563 7469 6f6e 732e 6162 632e 4d75  llections.abc.Mu
+00015520: 7461 626c 654d 6170 7069 6e67 293a 0a20  tableMapping):. 
+00015530: 2020 2022 2222 4261 7365 436c 6173 7320     """BaseClass 
+00015540: 666f 7220 7861 7272 6179 2062 6173 6564  for xarray based
+00015550: 2052 6164 6172 566f 6c75 6d65 730a 0a20   RadarVolumes.. 
+00015560: 2020 2049 6d70 6c65 6d65 6e74 7320 6063     Implements `c
+00015570: 6f6c 6c65 6374 696f 6e73 2e4d 7574 6162  ollections.Mutab
+00015580: 6c65 4d61 7070 696e 6760 2064 6963 7469  leMapping` dicti
+00015590: 6f6e 6172 792e 0a20 2020 2022 2222 0a0a  onary..    """..
+000155a0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000155b0: 2873 656c 662c 2069 6e69 745f 726f 6f74  (self, init_root
+000155c0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+000155d0: 2073 656c 662e 5f73 7765 6570 7320 3d20   self._sweeps = 
+000155e0: 6469 6374 2829 0a20 2020 2020 2020 2073  dict().        s
+000155f0: 656c 662e 5f6e 6368 203d 206c 6973 7428  elf._nch = list(
+00015600: 290a 2020 2020 2020 2020 7365 6c66 2e72  ).        self.r
+00015610: 6f6f 7420 3d20 4e6f 6e65 0a20 2020 2020  oot = None.     
+00015620: 2020 2073 656c 662e 5f73 7765 6570 5f61     self._sweep_a
+00015630: 6e67 6c65 7320 3d20 6c69 7374 2829 0a20  ngles = list(). 
+00015640: 2020 2020 2020 2073 656c 662e 5f73 7765         self._swe
+00015650: 6570 5f6e 616d 6573 203d 206c 6973 7428  ep_names = list(
+00015660: 290a 2020 2020 2020 2020 6966 2069 6e69  ).        if ini
+00015670: 745f 726f 6f74 3a0a 2020 2020 2020 2020  t_root:.        
+00015680: 2020 2020 7365 6c66 2e5f 696e 6974 5f72      self._init_r
+00015690: 6f6f 7428 290a 0a20 2020 2064 6566 205f  oot()..    def _
+000156a0: 5f67 6574 6974 656d 5f5f 2873 656c 662c  _getitem__(self,
+000156b0: 206b 6579 293a 0a20 2020 2020 2020 2069   key):.        i
+000156c0: 6620 6b65 7920 3d3d 2022 726f 6f74 223a  f key == "root":
+000156d0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+000156e0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+000156f0: 2020 2020 2020 2020 2020 2020 2257 5241              "WRA
+00015700: 444c 4942 3a20 5573 6520 6f66 2060 6f62  DLIB: Use of `ob
+00015710: 6a5b 2772 6f6f 7427 5d60 2069 7320 6465  j['root']` is de
+00015720: 7072 6563 6174 6564 2c20 220a 2020 2020  precated, ".    
+00015730: 2020 2020 2020 2020 2020 2020 2270 6c65              "ple
+00015740: 6173 6520 7573 6520 6f62 6a2e 726f 6f74  ase use obj.root
+00015750: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
+00015760: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
+00015770: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
+00015780: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00015790: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000157a0: 2073 656c 662e 5f72 6f6f 740a 0a20 2020   self._root..   
+000157b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000157c0: 2e5f 7377 6565 7073 5b6b 6579 5d0a 0a20  ._sweeps[key].. 
+000157d0: 2020 2064 6566 205f 5f73 6574 6974 656d     def __setitem
+000157e0: 5f5f 2873 656c 662c 206b 6579 2c20 7661  __(self, key, va
+000157f0: 6c75 6529 3a0a 2020 2020 2020 2020 6966  lue):.        if
+00015800: 206b 6579 2069 6e20 7365 6c66 2e5f 7377   key in self._sw
+00015810: 6565 7073 3a0a 2020 2020 2020 2020 2020  eeps:.          
+00015820: 2020 7365 6c66 2e5f 7377 6565 7073 5b6b    self._sweeps[k
+00015830: 6579 5d20 3d20 7661 6c75 650a 2020 2020  ey] = value.    
+00015840: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00015850: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00015860: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00015870: 2020 2020 2022 5752 4144 4c49 423a 2055       "WRADLIB: U
+00015880: 7365 2063 6c61 7373 206d 6574 686f 6473  se class methods
+00015890: 2074 6f20 6164 6420 6461 7461 2e20 220a   to add data. ".
+000158a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158b0: 2244 6972 6563 7420 7365 7474 696e 6720  "Direct setting 
+000158c0: 6973 206e 6f74 2061 6c6c 6f77 6564 2e22  is not allowed."
+000158d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000158e0: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
+000158f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00015900: 2020 6465 6620 5f5f 6465 6c69 7465 6d5f    def __delitem_
+00015910: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
+00015920: 2020 2020 2020 6465 6c20 7365 6c66 2e5f        del self._
+00015930: 7377 6565 7073 5b6b 6579 5d0a 0a20 2020  sweeps[key]..   
+00015940: 2064 6566 205f 5f69 7465 725f 5f28 7365   def __iter__(se
+00015950: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00015960: 7572 6e20 6974 6572 2873 656c 662e 5f73  urn iter(self._s
+00015970: 7765 6570 7329 0a0a 2020 2020 6465 6620  weeps)..    def 
+00015980: 5f5f 6c65 6e5f 5f28 7365 6c66 293a 0a20  __len__(self):. 
+00015990: 2020 2020 2020 2072 6574 7572 6e20 6c65         return le
+000159a0: 6e28 7365 6c66 2e5f 7377 6565 7073 290a  n(self._sweeps).
+000159b0: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
+000159c0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+000159d0: 2072 6574 7572 6e20 7365 6c66 2e5f 7377   return self._sw
+000159e0: 6565 7073 2e5f 5f72 6570 725f 5f28 290a  eeps.__repr__().
+000159f0: 0a20 2020 2064 6566 205f 5f64 656c 5f5f  .    def __del__
+00015a00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00015a10: 6465 6c20 7365 6c66 2e5f 726f 6f74 0a20  del self._root. 
+00015a20: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+00015a30: 6c69 7374 2873 656c 662e 5f73 7765 6570  list(self._sweep
+00015a40: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00015a50: 6465 6c20 6b0a 2020 2020 2020 2020 666f  del k.        fo
+00015a60: 7220 6b20 696e 2073 656c 662e 5f6e 6368  r k in self._nch
+00015a70: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00015a80: 6c20 6b0a 0a20 2020 2064 6566 205f 696e  l k..    def _in
+00015a90: 6974 5f72 6f6f 7428 7365 6c66 293a 0a20  it_root(self):. 
+00015aa0: 2020 2020 2020 2073 656c 662e 726f 6f74         self.root
+00015ab0: 203d 2078 722e 4461 7461 7365 7428 6461   = xr.Dataset(da
+00015ac0: 7461 5f76 6172 733d 676c 6f62 616c 5f76  ta_vars=global_v
+00015ad0: 6172 6961 626c 6573 2c20 6174 7472 733d  ariables, attrs=
+00015ae0: 676c 6f62 616c 5f61 7474 7273 290a 0a20  global_attrs).. 
+00015af0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00015b00: 2064 6566 2072 6f6f 7428 7365 6c66 293a   def root(self):
+00015b10: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00015b20: 726e 2060 726f 6f74 6020 6461 7461 7365  rn `root` datase
+00015b30: 742e 2222 220a 2020 2020 2020 2020 7265  t.""".        re
+00015b40: 7475 726e 2073 656c 662e 5f72 6f6f 740a  turn self._root.
+00015b50: 0a20 2020 2040 726f 6f74 2e73 6574 7465  .    @root.sette
+00015b60: 720a 2020 2020 6465 6620 726f 6f74 2873  r.    def root(s
+00015b70: 656c 662c 2076 616c 7565 293a 0a20 2020  elf, value):.   
+00015b80: 2020 2020 2073 656c 662e 5f72 6f6f 7420       self._root 
+00015b90: 3d20 7661 6c75 650a 0a20 2020 2040 7072  = value..    @pr
+00015ba0: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
+00015bb0: 7765 6570 5f61 6e67 6c65 7328 7365 6c66  weep_angles(self
+00015bc0: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
+00015bd0: 6c66 2e72 6f6f 7420 6973 204e 6f6e 653a  lf.root is None:
+00015be0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00015bf0: 7572 6e20 7365 6c66 2e5f 7377 6565 705f  urn self._sweep_
+00015c00: 616e 676c 6573 0a20 2020 2020 2020 2072  angles.        r
+00015c10: 6574 7572 6e20 6c69 7374 2873 656c 662e  eturn list(self.
+00015c20: 726f 6f74 2e73 7765 6570 5f66 6978 6564  root.sweep_fixed
+00015c30: 5f61 6e67 6c65 2e76 616c 7565 7329 0a0a  _angle.values)..
+00015c40: 2020 2020 4073 7765 6570 5f61 6e67 6c65      @sweep_angle
+00015c50: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
+00015c60: 2073 7765 6570 5f61 6e67 6c65 7328 7365   sweep_angles(se
+00015c70: 6c66 2c20 7661 6c75 6529 3a0a 2020 2020  lf, value):.    
+00015c80: 2020 2020 6966 2073 656c 662e 726f 6f74      if self.root
+00015c90: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00015ca0: 2020 2020 2020 7365 6c66 2e5f 7377 6565        self._swee
+00015cb0: 705f 616e 676c 6573 2e61 7070 656e 6428  p_angles.append(
+00015cc0: 7661 6c75 6529 0a0a 2020 2020 4070 726f  value)..    @pro
+00015cd0: 7065 7274 790a 2020 2020 6465 6620 7377  perty.    def sw
+00015ce0: 6565 705f 6e61 6d65 7328 7365 6c66 293a  eep_names(self):
+00015cf0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00015d00: 2e72 6f6f 7420 6973 204e 6f6e 653a 0a20  .root is None:. 
+00015d10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015d20: 6e20 7365 6c66 2e5f 7377 6565 705f 6e61  n self._sweep_na
+00015d30: 6d65 730a 2020 2020 2020 2020 656c 7365  mes.        else
+00015d40: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00015d50: 7475 726e 206c 6973 7428 7365 6c66 2e72  turn list(self.r
+00015d60: 6f6f 742e 7377 6565 705f 6772 6f75 705f  oot.sweep_group_
+00015d70: 6e61 6d65 2e76 616c 7565 7329 0a0a 2020  name.values)..  
+00015d80: 2020 4073 7765 6570 5f6e 616d 6573 2e73    @sweep_names.s
+00015d90: 6574 7465 720a 2020 2020 6465 6620 7377  etter.    def sw
+00015da0: 6565 705f 6e61 6d65 7328 7365 6c66 2c20  eep_names(self, 
+00015db0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00015dc0: 6966 2073 656c 662e 726f 6f74 2069 7320  if self.root is 
+00015dd0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00015de0: 2020 7365 6c66 2e5f 7377 6565 705f 6e61    self._sweep_na
+00015df0: 6d65 732e 6170 7065 6e64 2876 616c 7565  mes.append(value
+00015e00: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00015e10: 0a20 2020 2064 6566 2073 7765 6570 2873  .    def sweep(s
+00015e20: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00015e30: 2252 6574 7572 6e20 7377 6565 7020 6469  "Return sweep di
+00015e40: 6d65 6e73 696f 6e20 636f 756e 742e 2222  mension count.""
+00015e50: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00015e60: 2073 656c 662e 726f 6f74 2e64 696d 735b   self.root.dims[
+00015e70: 2273 7765 6570 225d 0a0a 2020 2020 4070  "sweep"]..    @p
+00015e80: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00015e90: 7377 6565 7073 2873 656c 6629 3a0a 2020  sweeps(self):.  
+00015ea0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00015eb0: 7a69 7020 7377 6565 7020 6e61 6d65 732c  zip sweep names,
+00015ec0: 2073 7765 6570 5f61 6e67 6c65 7322 2222   sweep_angles"""
+00015ed0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015ee0: 7a69 7028 7365 6c66 2e73 7765 6570 5f6e  zip(self.sweep_n
+00015ef0: 616d 6573 2c20 7365 6c66 2e73 7765 6570  ames, self.sweep
+00015f00: 5f61 6e67 6c65 7329 0a0a 2020 2020 4070  _angles)..    @p
+00015f10: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00015f20: 6c6f 6361 7469 6f6e 2873 656c 6629 3a0a  location(self):.
+00015f30: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00015f40: 6e20 6c6f 6361 7469 6f6e 206f 6620 6461  n location of da
+00015f50: 7461 2073 6f75 7263 652e 2222 220a 2020  ta source.""".  
+00015f60: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
+00015f70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00015f80: 726f 6f74 2e6c 6f6e 6769 7475 6465 2e76  root.longitude.v
+00015f90: 616c 7565 732e 6974 656d 2829 2c0a 2020  alues.item(),.  
+00015fa0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+00015fb0: 6f6f 742e 6c61 7469 7475 6465 2e76 616c  oot.latitude.val
+00015fc0: 7565 732e 6974 656d 2829 2c0a 2020 2020  ues.item(),.    
+00015fd0: 2020 2020 2020 2020 7365 6c66 2e72 6f6f          self.roo
+00015fe0: 742e 616c 7469 7475 6465 2e76 616c 7565  t.altitude.value
+00015ff0: 732e 6974 656d 2829 2c0a 2020 2020 2020  s.item(),.      
+00016000: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
+00016010: 7479 0a20 2020 2064 6566 2043 6f6e 7665  ty.    def Conve
+00016020: 6e74 696f 6e73 2873 656c 6629 3a0a 2020  ntions(self):.  
+00016030: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00016040: 4346 2f4f 4449 4d20 6043 6f6e 7665 6e74  CF/ODIM `Convent
+00016050: 696f 6e73 602e 2222 220a 2020 2020 2020  ions`.""".      
+00016060: 2020 7265 7475 726e 2073 656c 662e 726f    return self.ro
+00016070: 6f74 2e43 6f6e 7665 6e74 696f 6e73 0a0a  ot.Conventions..
+00016080: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00016090: 2020 6465 6620 7665 7273 696f 6e28 7365    def version(se
+000160a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000160b0: 5265 7475 726e 2043 462f 4f44 494d 2076  Return CF/ODIM v
+000160c0: 6572 7369 6f6e 2222 220a 2020 2020 2020  ersion""".      
+000160d0: 2020 7265 7475 726e 2073 656c 662e 726f    return self.ro
+000160e0: 6f74 2e76 6572 7369 6f6e 0a0a 2020 2020  ot.version..    
+000160f0: 6465 6620 746f 5f63 6672 6164 6961 6c32  def to_cfradial2
+00016100: 2873 656c 662c 2066 696c 656e 616d 6529  (self, filename)
+00016110: 3a0a 2020 2020 2020 2020 2222 2253 6176  :.        """Sav
+00016120: 6520 766f 6c75 6d65 2074 6f20 4366 5261  e volume to CfRa
+00016130: 6469 616c 322e 3020 636f 6d70 6c69 616e  dial2.0 complian
+00016140: 7420 6669 6c65 2e0a 0a20 2020 2020 2020  t file...       
+00016150: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00016160: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00016170: 2020 2020 2020 2066 696c 656e 616d 6520         filename 
+00016180: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
+00016190: 2020 4e61 6d65 206f 6620 7468 6520 6f75    Name of the ou
+000161a0: 7470 7574 2066 696c 650a 2020 2020 2020  tput file.      
+000161b0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000161c0: 2073 656c 662e 726f 6f74 3a0a 2020 2020   self.root:.    
+000161d0: 2020 2020 2020 2020 746f 5f63 6672 6164          to_cfrad
+000161e0: 6961 6c32 2873 656c 662c 2066 696c 656e  ial2(self, filen
+000161f0: 616d 6529 0a20 2020 2020 2020 2065 6c73  ame).        els
+00016200: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
+00016210: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00016220: 2020 2020 2020 2020 2020 2020 2020 2257                "W
+00016230: 5241 444c 4942 3a20 4e6f 2043 6652 6164  RADLIB: No CfRad
+00016240: 6961 6c32 2d63 6f6d 706c 6961 6e74 2064  ial2-compliant d
+00016250: 6174 6120 7374 7275 6374 7572 6520 220a  ata structure ".
+00016260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016270: 2261 7661 696c 6162 6c65 2e20 4e6f 7420  "available. Not 
+00016280: 7361 7669 6e67 2e22 2c0a 2020 2020 2020  saving.",.      
+00016290: 2020 2020 2020 2020 2020 5573 6572 5761            UserWa
+000162a0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+000162b0: 2020 2029 0a0a 2020 2020 6465 6620 746f     )..    def to
+000162c0: 5f6f 6469 6d28 7365 6c66 2c20 6669 6c65  _odim(self, file
+000162d0: 6e61 6d65 293a 0a20 2020 2020 2020 2022  name):.        "
+000162e0: 2222 5361 7665 2076 6f6c 756d 6520 746f  ""Save volume to
+000162f0: 204f 4449 4d5f 4835 2f56 325f 3220 636f   ODIM_H5/V2_2 co
+00016300: 6d70 6c69 616e 7420 6669 6c65 2e0a 0a20  mpliant file... 
+00016310: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00016320: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00016330: 2d2d 2d2d 0a20 2020 2020 2020 2066 696c  ----.        fil
+00016340: 656e 616d 6520 3a20 7374 720a 2020 2020  ename : str.    
+00016350: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
+00016360: 7468 6520 6f75 7470 7574 2066 696c 650a  the output file.
+00016370: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00016380: 2020 2020 6966 2073 656c 662e 726f 6f74      if self.root
+00016390: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
+000163a0: 5f6f 6469 6d28 7365 6c66 2c20 6669 6c65  _odim(self, file
+000163b0: 6e61 6d65 290a 2020 2020 2020 2020 656c  name).        el
+000163c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000163d0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+000163e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000163f0: 5752 4144 4c49 423a 204e 6f20 4f64 696d  WRADLIB: No Odim
+00016400: 4835 2d63 6f6d 706c 6961 6e74 2064 6174  H5-compliant dat
+00016410: 6120 7374 7275 6374 7572 6520 2220 2261  a structure " "a
+00016420: 7661 696c 6162 6c65 2e20 4e6f 7420 7361  vailable. Not sa
+00016430: 7669 6e67 2e22 2c0a 2020 2020 2020 2020  ving.",.        
+00016440: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
+00016450: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+00016460: 2029 0a0a 2020 2020 6465 6620 6765 6f72   )..    def geor
+00016470: 6566 6572 656e 6365 2873 656c 662c 2073  eference(self, s
+00016480: 7765 6570 733d 4e6f 6e65 293a 0a20 2020  weeps=None):.   
+00016490: 2020 2020 2022 2222 4765 6f72 6566 6572       """Georefer
+000164a0: 656e 6365 2073 7765 6570 730a 0a20 2020  ence sweeps..   
+000164b0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000164c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000164d0: 2d2d 0a20 2020 2020 2020 2073 7765 6570  --.        sweep
+000164e0: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
+000164f0: 2020 2020 206c 6973 7420 7769 7468 2073       list with s
+00016500: 7765 6570 206b 6579 7320 746f 2067 656f  weep keys to geo
+00016510: 7265 6665 7265 6e63 652c 2064 6566 6175  reference, defau
+00016520: 6c74 7320 746f 2061 6c6c 2073 7765 6570  lts to all sweep
+00016530: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00016540: 2020 2020 2020 6966 2073 7765 6570 7320        if sweeps 
+00016550: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00016560: 2020 2020 2073 7765 6570 7320 3d20 7365       sweeps = se
+00016570: 6c66 0a0a 2020 2020 2020 2020 666f 7220  lf..        for 
+00016580: 7377 7020 696e 2073 7765 6570 733a 0a20  swp in sweeps:. 
+00016590: 2020 2020 2020 2020 2020 2073 656c 665b             self[
+000165a0: 7377 705d 203d 2073 656c 665b 7377 705d  swp] = self[swp]
+000165b0: 2e70 6970 6528 7861 7272 6179 2e67 656f  .pipe(xarray.geo
+000165c0: 7265 6665 7265 6e63 655f 6461 7461 7365  reference_datase
+000165d0: 7429 0a0a 0a63 6c61 7373 2043 6652 6164  t)...class CfRad
+000165e0: 6961 6c28 5852 6164 566f 6c29 3a0a 2020  ial(XRadVol):.  
+000165f0: 2020 2222 2243 6c61 7373 2066 6f72 2078    """Class for x
+00016600: 6172 7261 7920 6261 7365 6420 7265 7472  array based retr
+00016610: 6965 7661 6c20 6f66 2043 6652 6164 6961  ieval of CfRadia
+00016620: 6c20 6461 7461 2066 696c 6573 2222 220a  l data files""".
+00016630: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00016640: 5f28 7365 6c66 2c20 6669 6c65 6e61 6d65  _(self, filename
+00016650: 3d4e 6f6e 652c 2066 6c61 766f 7572 3d4e  =None, flavour=N
+00016660: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0a  one, **kwargs):.
+00016670: 2020 2020 2020 2020 2222 2249 6e69 7469          """Initi
+00016680: 616c 697a 6520 7861 7272 6179 2073 7472  alize xarray str
+00016690: 7563 7475 7265 2066 726f 6d20 4366 2f52  ucture from Cf/R
+000166a0: 6164 6961 6c20 6461 7461 2073 7472 7563  adial data struc
+000166b0: 7475 7265 2e0a 0a20 2020 2020 2020 2050  ture...        P
+000166c0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+000166d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000166e0: 2020 2020 2066 696c 656e 616d 6520 3a20       filename : 
+000166f0: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
+00016700: 536f 7572 6365 2064 6174 6120 6669 6c65  Source data file
+00016710: 206e 616d 652e 0a20 2020 2020 2020 2066   name..        f
+00016720: 6c61 766f 7572 203a 2073 7472 0a20 2020  lavour : str.   
+00016730: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+00016740: 2066 6c61 766f 7572 2028 2743 662f 5261   flavour ('Cf/Ra
+00016750: 6469 616c 2720 6f72 2027 4366 2f52 6164  dial' or 'Cf/Rad
+00016760: 6961 6c32 2729 2e0a 0a20 2020 2020 2020  ial2')...       
+00016770: 204b 6579 776f 7264 2041 7267 756d 656e   Keyword Argumen
+00016780: 7473 0a20 2020 2020 2020 202d 2d2d 2d2d  ts.        -----
+00016790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000167a0: 2020 2020 2064 6563 6f64 655f 7469 6d65       decode_time
+000167b0: 7320 3a20 626f 6f6c 0a20 2020 2020 2020  s : bool.       
+000167c0: 2020 2020 2049 6620 5472 7565 2c20 6465       If True, de
+000167d0: 636f 6465 2063 6620 7469 6d65 7320 746f  code cf times to
+000167e0: 206e 702e 6461 7465 7469 6d65 3634 2e20   np.datetime64. 
+000167f0: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
+00016800: 2e0a 2020 2020 2020 2020 6465 636f 6465  ..        decode
+00016810: 5f63 6f6f 7264 7320 3a20 626f 6f6c 0a20  _coords : bool. 
+00016820: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+00016830: 7565 2c20 7573 6520 7468 6520 e280 9863  ue, use the ...c
+00016840: 6f6f 7264 696e 6174 6573 e280 9920 6174  oordinates... at
+00016850: 7472 6962 7574 6520 6f6e 2076 6172 6961  tribute on varia
+00016860: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+00016870: 746f 2061 7373 6967 6e20 636f 6f72 6469  to assign coordi
+00016880: 6e61 7465 732e 2044 6566 6175 6c74 7320  nates. Defaults 
+00016890: 746f 2054 7275 652e 0a20 2020 2020 2020  to True..       
+000168a0: 206d 6173 6b5f 616e 645f 7363 616c 6520   mask_and_scale 
+000168b0: 3a20 626f 6f6c 0a20 2020 2020 2020 2020  : bool.         
+000168c0: 2020 2049 6620 5472 7565 2c20 6c61 7a69     If True, lazi
+000168d0: 6c79 2073 6361 6c65 2028 7573 696e 6720  ly scale (using 
+000168e0: 7363 616c 655f 6661 6374 6f72 2061 6e64  scale_factor and
+000168f0: 2061 6464 5f6f 6666 7365 7429 0a20 2020   add_offset).   
+00016900: 2020 2020 2020 2020 2061 6e64 206d 6173           and mas
+00016910: 6b20 2875 7369 6e67 205f 4669 6c6c 5661  k (using _FillVa
+00016920: 6c75 6529 2e20 4465 6661 756c 7473 2074  lue). Defaults t
+00016930: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
+00016940: 6368 756e 6b73 203a 2069 6e74 207c 2064  chunks : int | d
+00016950: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
+00016960: 2020 2020 2020 2020 2020 4966 2063 6875            If chu
+00016970: 6e6b 7320 6973 2070 726f 7669 6465 642c  nks is provided,
+00016980: 2069 7420 7573 6564 2074 6f20 6c6f 6164   it used to load
+00016990: 2074 6865 206e 6577 2064 6174 6173 6574   the new dataset
+000169a0: 2069 6e74 6f20 6461 736b 0a20 2020 2020   into dask.     
+000169b0: 2020 2020 2020 2061 7272 6179 732e 2063         arrays. c
+000169c0: 6875 6e6b 733d 7b7d 206c 6f61 6473 2074  hunks={} loads t
+000169d0: 6865 2064 6174 6173 6574 2077 6974 6820  he dataset with 
+000169e0: 6461 736b 2075 7369 6e67 2061 2073 696e  dask using a sin
+000169f0: 676c 650a 2020 2020 2020 2020 2020 2020  gle.            
+00016a00: 6368 756e 6b20 666f 7220 616c 6c20 6172  chunk for all ar
+00016a10: 7261 7973 2e0a 2020 2020 2020 2020 6765  rays..        ge
+00016a20: 6f72 6566 203a 2062 6f6f 6c0a 2020 2020  oref : bool.    
+00016a30: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+00016a40: 2061 6464 7320 3244 2041 4551 4420 782c   adds 2D AEQD x,
+00016a50: 792c 7a2d 636f 6f72 6469 6e61 7465 732c  y,z-coordinates,
+00016a60: 2067 726f 756e 645f 7261 6e67 6520 2867   ground_range (g
+00016a70: 7229 2061 6e64 0a20 2020 2020 2020 2020  r) and.         
+00016a80: 2020 2032 4420 2872 6179 732c 6269 6e73     2D (rays,bins
+00016a90: 292d 636f 6f72 6469 6e61 7465 7320 666f  )-coordinates fo
+00016aa0: 7220 6561 7379 2067 656f 7265 6665 7265  r easy georefere
+00016ab0: 6e63 696e 6720 2865 672e 2063 6172 746f  ncing (eg. carto
+00016ac0: 7079 290a 2020 2020 2020 2020 6469 6d30  py).        dim0
+00016ad0: 203a 2073 7472 0a20 2020 2020 2020 2020   : str.         
+00016ae0: 2020 206e 616d 6520 6f66 2074 6865 2072     name of the r
+00016af0: 6179 2d64 696d 656e 7369 6f6e 206f 6620  ay-dimension of 
+00016b00: 4461 7461 4172 7261 7973 2061 6e64 2044  DataArrays and D
+00016b10: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00016b20: 2020 2020 2020 2020 2a20 6074 696d 6560          * `time`
+00016b30: 202d 2063 6672 6164 6961 6c32 2073 7461   - cfradial2 sta
+00016b40: 6e64 6172 640a 2020 2020 2020 2020 2020  ndard.          
+00016b50: 2020 2020 2020 2a20 6061 7a69 6d75 7468        * `azimuth
+00016b60: 6020 2d20 6265 7474 6572 2066 6f72 2077  ` - better for w
+00016b70: 6f72 6b69 6e67 2077 6974 6820 7861 7272  orking with xarr
+00016b80: 6179 0a20 2020 2020 2020 2022 2222 0a20  ay.        """. 
+00016b90: 2020 2020 2020 2073 7570 6572 2843 6652         super(CfR
+00016ba0: 6164 6961 6c2c 2073 656c 6629 2e5f 5f69  adial, self).__i
+00016bb0: 6e69 745f 5f28 290a 2020 2020 2020 2020  nit__().        
+00016bc0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00016bd0: 6528 6669 6c65 6e61 6d65 2c20 6c69 7374  e(filename, list
+00016be0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00016bf0: 696c 656e 616d 6520 3d20 5b66 696c 656e  ilename = [filen
+00016c00: 616d 655d 0a20 2020 2020 2020 2066 6f72  ame].        for
+00016c10: 2069 2c20 6620 696e 2065 6e75 6d65 7261   i, f in enumera
+00016c20: 7465 2866 696c 656e 616d 6529 3a0a 2020  te(filename):.  
+00016c30: 2020 2020 2020 2020 2020 6e63 6820 3d20            nch = 
+00016c40: 4e65 7443 4446 3446 696c 6528 662c 2066  NetCDF4File(f, f
+00016c50: 6c61 766f 7572 3d66 6c61 766f 7572 290a  lavour=flavour).
+00016c60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016c70: 2e5f 6e63 682e 6170 7065 6e64 286e 6368  ._nch.append(nch
+00016c80: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00016c90: 206e 6368 2e66 6c61 766f 7572 203d 3d20   nch.flavour == 
+00016ca0: 2243 662f 5261 6469 616c 3222 3a0a 2020  "Cf/Radial2":.  
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00016cc0: 6c66 2e61 7373 6967 6e5f 6461 7461 5f72  lf.assign_data_r
+00016cd0: 6164 6961 6c32 286e 6368 2c20 2a2a 6b77  adial2(nch, **kw
+00016ce0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
+00016cf0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00016d00: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00016d10: 6967 6e5f 6461 7461 5f72 6164 6961 6c28  ign_data_radial(
+00016d20: 6e63 682c 202a 2a6b 7761 7267 7329 0a0a  nch, **kwargs)..
+00016d30: 2020 2020 6465 6620 6173 7369 676e 5f64      def assign_d
+00016d40: 6174 615f 7261 6469 616c 3228 7365 6c66  ata_radial2(self
+00016d50: 2c20 6e63 682c 202a 2a6b 7761 7267 7329  , nch, **kwargs)
+00016d60: 3a0a 2020 2020 2020 2020 2222 2241 7373  :.        """Ass
+00016d70: 6967 6e20 6672 6f6d 2043 6652 6164 6961  ign from CfRadia
+00016d80: 6c32 2064 6174 6120 7374 7275 6374 7572  l2 data structur
+00016d90: 652e 0a0a 2020 2020 2020 2020 5061 7261  e...        Para
+00016da0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00016db0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00016dc0: 2020 6e63 6820 3a20 4e65 7443 4446 3446    nch : NetCDF4F
+00016dd0: 696c 6520 6f62 6a65 6374 0a0a 2020 2020  ile object..    
+00016de0: 2020 2020 4b65 7977 6f72 6420 4172 6775      Keyword Argu
+00016df0: 6d65 6e74 730a 2020 2020 2020 2020 2d2d  ments.        --
+00016e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00016e10: 2020 2020 2020 2020 6465 636f 6465 5f74          decode_t
+00016e20: 696d 6573 203a 2062 6f6f 6c0a 2020 2020  imes : bool.    
+00016e30: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+00016e40: 2064 6563 6f64 6520 6366 2074 696d 6573   decode cf times
+00016e50: 2074 6f20 6e70 2e64 6174 6574 696d 6536   to np.datetime6
+00016e60: 342e 2044 6566 6175 6c74 7320 746f 2054  4. Defaults to T
+00016e70: 7275 652e 0a20 2020 2020 2020 2064 6563  rue..        dec
+00016e80: 6f64 655f 636f 6f72 6473 203a 2062 6f6f  ode_coords : boo
+00016e90: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+00016ea0: 2054 7275 652c 2075 7365 2074 6865 20e2   True, use the .
+00016eb0: 8098 636f 6f72 6469 6e61 7465 73e2 8099  ..coordinates...
+00016ec0: 2061 7474 7269 6275 7465 206f 6e20 7661   attribute on va
+00016ed0: 7269 6162 6c65 0a20 2020 2020 2020 2020  riable.         
+00016ee0: 2020 2074 6f20 6173 7369 676e 2063 6f6f     to assign coo
+00016ef0: 7264 696e 6174 6573 2e20 4465 6661 756c  rdinates. Defaul
+00016f00: 7473 2074 6f20 5472 7565 2e0a 2020 2020  ts to True..    
+00016f10: 2020 2020 6d61 736b 5f61 6e64 5f73 6361      mask_and_sca
+00016f20: 6c65 203a 2062 6f6f 6c0a 2020 2020 2020  le : bool.      
+00016f30: 2020 2020 2020 4966 2054 7275 652c 206c        If True, l
+00016f40: 617a 696c 7920 7363 616c 6520 2875 7369  azily scale (usi
+00016f50: 6e67 2073 6361 6c65 5f66 6163 746f 7220  ng scale_factor 
+00016f60: 616e 6420 6164 645f 6f66 6673 6574 290a  and add_offset).
+00016f70: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00016f80: 6d61 736b 2028 7573 696e 6720 5f46 696c  mask (using _Fil
+00016f90: 6c56 616c 7565 292e 2044 6566 6175 6c74  lValue). Default
+00016fa0: 7320 746f 2054 7275 652e 0a20 2020 2020  s to True..     
+00016fb0: 2020 2063 6875 6e6b 7320 3a20 696e 7420     chunks : int 
+00016fc0: 7c20 6469 6374 2c20 6f70 7469 6f6e 616c  | dict, optional
+00016fd0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00016fe0: 6368 756e 6b73 2069 7320 7072 6f76 6964  chunks is provid
+00016ff0: 6564 2c20 6974 2075 7365 6420 746f 206c  ed, it used to l
+00017000: 6f61 6420 7468 6520 6e65 7720 6461 7461  oad the new data
+00017010: 7365 7420 696e 746f 2064 6173 6b0a 2020  set into dask.  
+00017020: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
+00017030: 2e20 6368 756e 6b73 3d7b 7d20 6c6f 6164  . chunks={} load
+00017040: 7320 7468 6520 6461 7461 7365 7420 7769  s the dataset wi
+00017050: 7468 2064 6173 6b20 7573 696e 6720 6120  th dask using a 
+00017060: 7369 6e67 6c65 0a20 2020 2020 2020 2020  single.         
+00017070: 2020 2063 6875 6e6b 2066 6f72 2061 6c6c     chunk for all
+00017080: 2061 7272 6179 732e 0a20 2020 2020 2020   arrays..       
+00017090: 2067 656f 7265 6620 3a20 626f 6f6c 0a20   georef : bool. 
+000170a0: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+000170b0: 7565 2c20 6164 6473 2032 4420 4145 5144  ue, adds 2D AEQD
+000170c0: 2078 2c79 2c7a 2d63 6f6f 7264 696e 6174   x,y,z-coordinat
+000170d0: 6573 2c20 6772 6f75 6e64 5f72 616e 6765  es, ground_range
+000170e0: 2028 6772 2920 616e 640a 2020 2020 2020   (gr) and.      
+000170f0: 2020 2020 2020 3244 2028 7261 7973 2c62        2D (rays,b
+00017100: 696e 7329 2d63 6f6f 7264 696e 6174 6573  ins)-coordinates
+00017110: 2066 6f72 2065 6173 7920 6765 6f72 6566   for easy georef
+00017120: 6572 656e 6369 6e67 2028 6567 2e20 6361  erencing (eg. ca
+00017130: 7274 6f70 7929 0a20 2020 2020 2020 2064  rtopy).        d
+00017140: 696d 3020 3a20 7374 720a 2020 2020 2020  im0 : str.      
+00017150: 2020 2020 2020 6e61 6d65 206f 6620 7468        name of th
+00017160: 6520 7261 792d 6469 6d65 6e73 696f 6e20  e ray-dimension 
+00017170: 6f66 2044 6174 6141 7272 6179 7320 616e  of DataArrays an
+00017180: 6420 4461 7461 7365 743a 0a20 2020 2020  d Dataset:.     
+00017190: 2020 2020 2020 2020 2020 202a 2060 7469             * `ti
+000171a0: 6d65 6020 2d20 6366 7261 6469 616c 3220  me` - cfradial2 
+000171b0: 7374 616e 6461 7264 0a20 2020 2020 2020  standard.       
+000171c0: 2020 2020 2020 2020 202a 2060 617a 696d           * `azim
+000171d0: 7574 6860 202d 2062 6574 7465 7220 666f  uth` - better fo
+000171e0: 7220 776f 726b 696e 6720 7769 7468 2078  r working with x
+000171f0: 6172 7261 790a 2020 2020 2020 2020 2222  array.        ""
+00017200: 220a 2020 2020 2020 2020 2320 6b65 7977  ".        # keyw
+00017210: 6f72 6420 6172 6775 6d65 6e74 2068 616e  ord argument han
+00017220: 646c 696e 670a 2020 2020 2020 2020 6765  dling.        ge
+00017230: 6f72 6566 203d 206b 7761 7267 732e 706f  oref = kwargs.po
+00017240: 7028 2267 656f 7265 6622 2c20 4661 6c73  p("georef", Fals
+00017250: 6529 0a20 2020 2020 2020 2064 696d 3020  e).        dim0 
+00017260: 3d20 6b77 6172 6773 2e70 6f70 2822 6469  = kwargs.pop("di
+00017270: 6d30 222c 2022 7469 6d65 2229 0a0a 2020  m0", "time")..  
+00017280: 2020 2020 2020 7365 6c66 2e72 6f6f 7420        self.root 
+00017290: 3d20 5f6f 7065 6e5f 6461 7461 7365 7428  = _open_dataset(
+000172a0: 6e63 682e 6e63 682c 2067 7270 3d4e 6f6e  nch.nch, grp=Non
+000172b0: 652c 202a 2a6b 7761 7267 7329 0a20 2020  e, **kwargs).   
+000172c0: 2020 2020 2073 7765 6570 6e61 6d65 7320       sweepnames 
+000172d0: 3d20 7365 6c66 2e72 6f6f 742e 7377 6565  = self.root.swee
+000172e0: 705f 6772 6f75 705f 6e61 6d65 2e76 616c  p_group_name.val
+000172f0: 7565 730a 2020 2020 2020 2020 666f 7220  ues.        for 
+00017300: 7377 2069 6e20 7377 6565 706e 616d 6573  sw in sweepnames
+00017310: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+00017320: 203d 205f 6f70 656e 5f64 6174 6173 6574   = _open_dataset
+00017330: 286e 6368 2e6e 6368 2c20 6772 703d 7377  (nch.nch, grp=sw
+00017340: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00017350: 2020 2020 2020 2020 6473 203d 2064 732e          ds = ds.
+00017360: 7377 6170 5f64 696d 7328 7b22 7469 6d65  swap_dims({"time
+00017370: 223a 2064 696d 307d 290a 2020 2020 2020  ": dim0}).      
+00017380: 2020 2020 2020 636f 6f72 6473 203d 207b        coords = {
+00017390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000173a0: 2022 6c6f 6e67 6974 7564 6522 3a20 7365   "longitude": se
+000173b0: 6c66 2e72 6f6f 742e 6c6f 6e67 6974 7564  lf.root.longitud
+000173c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000173d0: 2020 2022 6c61 7469 7475 6465 223a 2073     "latitude": s
+000173e0: 656c 662e 726f 6f74 2e6c 6174 6974 7564  elf.root.latitud
+000173f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00017400: 2020 2022 616c 7469 7475 6465 223a 2073     "altitude": s
+00017410: 656c 662e 726f 6f74 2e61 6c74 6974 7564  elf.root.altitud
+00017420: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00017430: 2020 2022 617a 696d 7574 6822 3a20 6473     "azimuth": ds
+00017440: 2e61 7a69 6d75 7468 2c0a 2020 2020 2020  .azimuth,.      
+00017450: 2020 2020 2020 2020 2020 2265 6c65 7661            "eleva
+00017460: 7469 6f6e 223a 2064 732e 656c 6576 6174  tion": ds.elevat
+00017470: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00017480: 207d 0a20 2020 2020 2020 2020 2020 2064   }.            d
+00017490: 7320 3d20 6473 2e61 7373 6967 6e5f 636f  s = ds.assign_co
+000174a0: 6f72 6473 282a 2a63 6f6f 7264 7329 0a0a  ords(**coords)..
+000174b0: 2020 2020 2020 2020 2020 2020 2320 6164              # ad
+000174c0: 6469 6e67 2078 797a 2061 6571 642d 636f  ding xyz aeqd-co
+000174d0: 6f72 6469 6e61 7465 730a 2020 2020 2020  ordinates.      
+000174e0: 2020 2020 2020 6966 2067 656f 7265 663a        if georef:
+000174f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017500: 2064 7320 3d20 7861 7272 6179 2e67 656f   ds = xarray.geo
+00017510: 7265 6665 7265 6e63 655f 6461 7461 7365  reference_datase
+00017520: 7428 6473 290a 0a20 2020 2020 2020 2020  t(ds)..         
+00017530: 2020 2073 656c 662e 5f73 7765 6570 735b     self._sweeps[
+00017540: 7377 5d20 3d20 6473 0a0a 2020 2020 6465  sw] = ds..    de
+00017550: 6620 6173 7369 676e 5f64 6174 615f 7261  f assign_data_ra
+00017560: 6469 616c 2873 656c 662c 206e 6368 2c20  dial(self, nch, 
+00017570: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00017580: 2020 2022 2222 4173 7369 676e 2066 726f     """Assign fro
+00017590: 6d20 4366 5261 6469 616c 3120 6461 7461  m CfRadial1 data
+000175a0: 2073 7472 7563 7475 7265 2e0a 0a20 2020   structure...   
+000175b0: 2020 2020 204b 6579 776f 7264 2041 7267       Keyword Arg
+000175c0: 756d 656e 7473 0a20 2020 2020 2020 202d  uments.        -
+000175d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000175e0: 0a20 2020 2020 2020 2064 6563 6f64 655f  .        decode_
+000175f0: 7469 6d65 7320 3a20 626f 6f6c 0a20 2020  times : bool.   
+00017600: 2020 2020 2020 2020 2049 6620 5472 7565           If True
+00017610: 2c20 6465 636f 6465 2063 6620 7469 6d65  , decode cf time
+00017620: 7320 746f 206e 702e 6461 7465 7469 6d65  s to np.datetime
+00017630: 3634 2e20 4465 6661 756c 7473 2074 6f20  64. Defaults to 
+00017640: 5472 7565 2e0a 2020 2020 2020 2020 6465  True..        de
+00017650: 636f 6465 5f63 6f6f 7264 7320 3a20 626f  code_coords : bo
+00017660: 6f6c 0a20 2020 2020 2020 2020 2020 2049  ol.            I
+00017670: 6620 5472 7565 2c20 7573 6520 7468 6520  f True, use the 
+00017680: e280 9863 6f6f 7264 696e 6174 6573 e280  ...coordinates..
+00017690: 9920 6174 7472 6962 7574 6520 6f6e 2076  . attribute on v
+000176a0: 6172 6961 626c 650a 2020 2020 2020 2020  ariable.        
+000176b0: 2020 2020 746f 2061 7373 6967 6e20 636f      to assign co
+000176c0: 6f72 6469 6e61 7465 732e 2044 6566 6175  ordinates. Defau
+000176d0: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+000176e0: 2020 2020 206d 6173 6b5f 616e 645f 7363       mask_and_sc
+000176f0: 616c 6520 3a20 626f 6f6c 0a20 2020 2020  ale : bool.     
+00017700: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+00017710: 6c61 7a69 6c79 2073 6361 6c65 2028 7573  lazily scale (us
+00017720: 696e 6720 7363 616c 655f 6661 6374 6f72  ing scale_factor
+00017730: 2061 6e64 2061 6464 5f6f 6666 7365 7429   and add_offset)
+00017740: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00017750: 206d 6173 6b20 2875 7369 6e67 205f 4669   mask (using _Fi
+00017760: 6c6c 5661 6c75 6529 2e20 4465 6661 756c  llValue). Defaul
+00017770: 7473 2074 6f20 5472 7565 2e0a 2020 2020  ts to True..    
+00017780: 2020 2020 6368 756e 6b73 203a 2069 6e74      chunks : int
+00017790: 207c 2064 6963 742c 206f 7074 696f 6e61   | dict, optiona
+000177a0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+000177b0: 2063 6875 6e6b 7320 6973 2070 726f 7669   chunks is provi
+000177c0: 6465 642c 2069 7420 7573 6564 2074 6f20  ded, it used to 
+000177d0: 6c6f 6164 2074 6865 206e 6577 2064 6174  load the new dat
+000177e0: 6173 6574 2069 6e74 6f20 6461 736b 0a20  aset into dask. 
+000177f0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00017800: 732e 2063 6875 6e6b 733d 7b7d 206c 6f61  s. chunks={} loa
+00017810: 6473 2074 6865 2064 6174 6173 6574 2077  ds the dataset w
+00017820: 6974 6820 6461 736b 2075 7369 6e67 2061  ith dask using a
+00017830: 2073 696e 676c 650a 2020 2020 2020 2020   single.        
+00017840: 2020 2020 6368 756e 6b20 666f 7220 616c      chunk for al
+00017850: 6c20 6172 7261 7973 2e0a 2020 2020 2020  l arrays..      
+00017860: 2020 6765 6f72 6566 203a 2062 6f6f 6c0a    georef : bool.
+00017870: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+00017880: 7275 652c 2061 6464 7320 3244 2041 4551  rue, adds 2D AEQ
+00017890: 4420 782c 792c 7a2d 636f 6f72 6469 6e61  D x,y,z-coordina
+000178a0: 7465 732c 2067 726f 756e 645f 7261 6e67  tes, ground_rang
+000178b0: 6520 2867 7229 2061 6e64 0a20 2020 2020  e (gr) and.     
+000178c0: 2020 2020 2020 2032 4420 2872 6179 732c         2D (rays,
+000178d0: 6269 6e73 292d 636f 6f72 6469 6e61 7465  bins)-coordinate
+000178e0: 7320 666f 7220 6561 7379 2067 656f 7265  s for easy geore
+000178f0: 6665 7265 6e63 696e 6720 2865 672e 2063  ferencing (eg. c
+00017900: 6172 746f 7079 290a 2020 2020 2020 2020  artopy).        
+00017910: 6469 6d30 203a 2073 7472 0a20 2020 2020  dim0 : str.     
+00017920: 2020 2020 2020 206e 616d 6520 6f66 2074         name of t
+00017930: 6865 2072 6179 2d64 696d 656e 7369 6f6e  he ray-dimension
+00017940: 206f 6620 4461 7461 4172 7261 7973 2061   of DataArrays a
+00017950: 6e64 2044 6174 6173 6574 3a0a 2020 2020  nd Dataset:.    
+00017960: 2020 2020 2020 2020 2020 2020 2a20 6074              * `t
+00017970: 696d 6560 202d 2063 6672 6164 6961 6c32  ime` - cfradial2
+00017980: 2073 7461 6e64 6172 640a 2020 2020 2020   standard.      
+00017990: 2020 2020 2020 2020 2020 2a20 6061 7a69            * `azi
+000179a0: 6d75 7468 6020 2d20 6265 7474 6572 2066  muth` - better f
+000179b0: 6f72 2077 6f72 6b69 6e67 2077 6974 6820  or working with 
+000179c0: 7861 7272 6179 0a20 2020 2020 2020 2022  xarray.        "
+000179d0: 2222 0a20 2020 2020 2020 2023 206b 6579  "".        # key
+000179e0: 776f 7264 2061 7267 756d 656e 7420 6861  word argument ha
+000179f0: 6e64 6c69 6e67 0a20 2020 2020 2020 2067  ndling.        g
+00017a00: 656f 7265 6620 3d20 6b77 6172 6773 2e70  eoref = kwargs.p
+00017a10: 6f70 2822 6765 6f72 6566 222c 2046 616c  op("georef", Fal
+00017a20: 7365 290a 2020 2020 2020 2020 6469 6d30  se).        dim0
+00017a30: 203d 206b 7761 7267 732e 706f 7028 2264   = kwargs.pop("d
+00017a40: 696d 3022 2c20 2274 696d 6522 290a 0a20  im0", "time").. 
+00017a50: 2020 2020 2020 2072 6f6f 7420 3d20 5f6f         root = _o
+00017a60: 7065 6e5f 6461 7461 7365 7428 6e63 682e  pen_dataset(nch.
+00017a70: 6e63 682c 2067 7270 3d4e 6f6e 652c 202a  nch, grp=None, *
+00017a80: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+00017a90: 2076 6172 203d 2072 6f6f 742e 7661 7269   var = root.vari
+00017aa0: 6162 6c65 732e 6b65 7973 2829 0a20 2020  ables.keys().   
+00017ab0: 2020 2020 2072 656d 6f76 655f 726f 6f74       remove_root
+00017ac0: 203d 2076 6172 205e 2072 6f6f 745f 7661   = var ^ root_va
+00017ad0: 7273 0a20 2020 2020 2020 2072 656d 6f76  rs.        remov
+00017ae0: 655f 726f 6f74 2026 3d20 7661 720a 2020  e_root &= var.  
+00017af0: 2020 2020 2020 726f 6f74 3120 3d20 726f        root1 = ro
+00017b00: 6f74 2e64 726f 705f 7661 7273 2872 656d  ot.drop_vars(rem
+00017b10: 6f76 655f 726f 6f74 292e 7265 6e61 6d65  ove_root).rename
+00017b20: 287b 2266 6978 6564 5f61 6e67 6c65 223a  ({"fixed_angle":
+00017b30: 2022 7377 6565 705f 6669 7865 645f 616e   "sweep_fixed_an
+00017b40: 676c 6522 7d29 0a20 2020 2020 2020 2073  gle"}).        s
+00017b50: 7765 6570 5f67 726f 7570 5f6e 616d 6520  weep_group_name 
+00017b60: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00017b70: 2069 2069 6e20 7261 6e67 6528 726f 6f74   i in range(root
+00017b80: 312e 6469 6d73 5b22 7377 6565 7022 5d29  1.dims["sweep"])
+00017b90: 3a0a 2020 2020 2020 2020 2020 2020 7377  :.            sw
+00017ba0: 6565 705f 6772 6f75 705f 6e61 6d65 2e61  eep_group_name.a
+00017bb0: 7070 656e 6428 2273 7765 6570 5f7b 7d22  ppend("sweep_{}"
+00017bc0: 2e66 6f72 6d61 7428 6920 2b20 3129 290a  .format(i + 1)).
+00017bd0: 2020 2020 2020 2020 7365 6c66 2e72 6f6f          self.roo
+00017be0: 7420 3d20 726f 6f74 312e 6173 7369 676e  t = root1.assign
+00017bf0: 287b 2273 7765 6570 5f67 726f 7570 5f6e  ({"sweep_group_n
+00017c00: 616d 6522 3a20 285b 2273 7765 6570 225d  ame": (["sweep"]
+00017c10: 2c20 7377 6565 705f 6772 6f75 705f 6e61  , sweep_group_na
+00017c20: 6d65 297d 290a 0a20 2020 2020 2020 206b  me)})..        k
+00017c30: 6565 705f 7661 7273 203d 2073 7765 6570  eep_vars = sweep
+00017c40: 5f76 6172 7331 207c 2073 7765 6570 5f76  _vars1 | sweep_v
+00017c50: 6172 7332 207c 2073 7765 6570 5f76 6172  ars2 | sweep_var
+00017c60: 7333 0a20 2020 2020 2020 2072 656d 6f76  s3.        remov
+00017c70: 655f 7661 7273 203d 2076 6172 205e 206b  e_vars = var ^ k
+00017c80: 6565 705f 7661 7273 0a20 2020 2020 2020  eep_vars.       
+00017c90: 2072 656d 6f76 655f 7661 7273 2026 3d20   remove_vars &= 
+00017ca0: 7661 720a 2020 2020 2020 2020 6461 7461  var.        data
+00017cb0: 203d 2072 6f6f 742e 6472 6f70 5f76 6172   = root.drop_var
+00017cc0: 7328 7265 6d6f 7665 5f76 6172 7329 0a20  s(remove_vars). 
+00017cd0: 2020 2020 2020 2064 6174 612e 6174 7472         data.attr
+00017ce0: 7320 3d20 7b7d 0a20 2020 2020 2020 2073  s = {}.        s
+00017cf0: 7461 7274 5f69 6478 203d 2064 6174 612e  tart_idx = data.
+00017d00: 7377 6565 705f 7374 6172 745f 7261 795f  sweep_start_ray_
+00017d10: 696e 6465 782e 7661 6c75 6573 0a20 2020  index.values.   
+00017d20: 2020 2020 2065 6e64 5f69 6478 203d 2064       end_idx = d
+00017d30: 6174 612e 7377 6565 705f 656e 645f 7261  ata.sweep_end_ra
+00017d40: 795f 696e 6465 782e 7661 6c75 6573 0a20  y_index.values. 
+00017d50: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
+00017d60: 7461 2e64 726f 705f 7661 7273 287b 2273  ta.drop_vars({"s
+00017d70: 7765 6570 5f73 7461 7274 5f72 6179 5f69  weep_start_ray_i
+00017d80: 6e64 6578 222c 2022 7377 6565 705f 656e  ndex", "sweep_en
+00017d90: 645f 7261 795f 696e 6465 7822 7d29 0a20  d_ray_index"}). 
+00017da0: 2020 2020 2020 2066 6f72 2069 2c20 7377         for i, sw
+00017db0: 2069 6e20 656e 756d 6572 6174 6528 7377   in enumerate(sw
+00017dc0: 6565 705f 6772 6f75 705f 6e61 6d65 293a  eep_group_name):
+00017dd0: 0a20 2020 2020 2020 2020 2020 2074 736c  .            tsl
+00017de0: 6963 6520 3d20 736c 6963 6528 7374 6172  ice = slice(star
+00017df0: 745f 6964 785b 695d 2c20 656e 645f 6964  t_idx[i], end_id
+00017e00: 785b 695d 290a 2020 2020 2020 2020 2020  x[i]).          
+00017e10: 2020 6473 203d 2064 6174 612e 6973 656c    ds = data.isel
+00017e20: 2874 696d 653d 7473 6c69 6365 2c20 7377  (time=tslice, sw
+00017e30: 6565 703d 736c 6963 6528 692c 2069 202b  eep=slice(i, i +
+00017e40: 2031 2929 2e73 7175 6565 7a65 2822 7377   1)).squeeze("sw
+00017e50: 6565 7022 290a 2020 2020 2020 2020 2020  eep").          
+00017e60: 2020 6473 203d 2064 732e 7377 6170 5f64    ds = ds.swap_d
+00017e70: 696d 7328 7b22 7469 6d65 223a 2064 696d  ims({"time": dim
+00017e80: 307d 290a 2020 2020 2020 2020 2020 2020  0}).            
+00017e90: 6473 2e73 7765 6570 5f6d 6f64 652e 6c6f  ds.sweep_mode.lo
+00017ea0: 6164 2829 0a20 2020 2020 2020 2020 2020  ad().           
+00017eb0: 2063 6f6f 7264 7320 3d20 7b0a 2020 2020   coords = {.    
+00017ec0: 2020 2020 2020 2020 2020 2020 226c 6f6e              "lon
+00017ed0: 6769 7475 6465 223a 2073 656c 662e 726f  gitude": self.ro
+00017ee0: 6f74 2e6c 6f6e 6769 7475 6465 2c0a 2020  ot.longitude,.  
+00017ef0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+00017f00: 6174 6974 7564 6522 3a20 7365 6c66 2e72  atitude": self.r
+00017f10: 6f6f 742e 6c61 7469 7475 6465 2c0a 2020  oot.latitude,.  
+00017f20: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00017f30: 6c74 6974 7564 6522 3a20 7365 6c66 2e72  ltitude": self.r
+00017f40: 6f6f 742e 616c 7469 7475 6465 2c0a 2020  oot.altitude,.  
+00017f50: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00017f60: 7a69 6d75 7468 223a 2064 732e 617a 696d  zimuth": ds.azim
+00017f70: 7574 682c 0a20 2020 2020 2020 2020 2020  uth,.           
+00017f80: 2020 2020 2022 656c 6576 6174 696f 6e22       "elevation"
+00017f90: 3a20 6473 2e65 6c65 7661 7469 6f6e 2c0a  : ds.elevation,.
+00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017fb0: 2273 7765 6570 5f6d 6f64 6522 3a20 6473  "sweep_mode": ds
+00017fc0: 2e73 7765 6570 5f6d 6f64 652e 6974 656d  .sweep_mode.item
+00017fd0: 2829 2e64 6563 6f64 6528 292c 0a20 2020  ().decode(),.   
+00017fe0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00017ff0: 2020 2020 2020 2064 7320 3d20 6473 2e61         ds = ds.a
+00018000: 7373 6967 6e5f 636f 6f72 6473 282a 2a63  ssign_coords(**c
+00018010: 6f6f 7264 7329 0a0a 2020 2020 2020 2020  oords)..        
+00018020: 2020 2020 2320 6164 6469 6e67 2078 797a      # adding xyz
+00018030: 2061 6571 642d 636f 6f72 6469 6e61 7465   aeqd-coordinate
+00018040: 730a 2020 2020 2020 2020 2020 2020 6966  s.            if
+00018050: 2067 656f 7265 663a 0a20 2020 2020 2020   georef:.       
+00018060: 2020 2020 2020 2020 2064 7320 3d20 7861           ds = xa
+00018070: 7272 6179 2e67 656f 7265 6665 7265 6e63  rray.georeferenc
+00018080: 655f 6461 7461 7365 7428 6473 290a 0a20  e_dataset(ds).. 
+00018090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000180a0: 5f73 7765 6570 735b 7377 5d20 3d20 6473  _sweeps[sw] = ds
+000180b0: 0a0a 0a63 6c61 7373 204f 6469 6d48 3528  ...class OdimH5(
+000180c0: 5852 6164 566f 6c29 3a0a 2020 2020 2222  XRadVol):.    ""
+000180d0: 2243 6c61 7373 2066 6f72 2078 6172 7261  "Class for xarra
+000180e0: 7920 6261 7365 6420 7265 7472 6965 7661  y based retrieva
+000180f0: 6c20 6f66 204f 4449 4d5f 4835 2064 6174  l of ODIM_H5 dat
+00018100: 6120 6669 6c65 7322 2222 0a0a 2020 2020  a files"""..    
+00018110: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00018120: 662c 2066 696c 656e 616d 653d 4e6f 6e65  f, filename=None
+00018130: 2c20 666c 6176 6f75 723d 4e6f 6e65 2c20  , flavour=None, 
+00018140: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00018150: 2020 2022 2222 496e 6974 6961 6c69 7a65     """Initialize
+00018160: 2078 6172 7261 7920 7374 7275 6374 7572   xarray structur
+00018170: 6520 6672 6f6d 2068 6466 3520 6461 7461  e from hdf5 data
+00018180: 2073 7472 7563 7475 7265 2e0a 0a20 2020   structure...   
+00018190: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000181a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000181b0: 2d2d 0a20 2020 2020 2020 2066 696c 656e  --.        filen
+000181c0: 616d 6520 3a20 7374 720a 2020 2020 2020  ame : str.      
+000181d0: 2020 2020 2020 536f 7572 6365 2064 6174        Source dat
+000181e0: 6120 6669 6c65 206e 616d 652e 0a20 2020  a file name..   
+000181f0: 2020 2020 2066 6c61 766f 7572 203a 2073       flavour : s
+00018200: 7472 0a20 2020 2020 2020 2020 2020 204e  tr.            N
+00018210: 616d 6520 6f66 2068 6466 3520 666c 6176  ame of hdf5 flav
+00018220: 6f75 7220 2827 4f44 494d 2720 6f72 2027  our ('ODIM' or '
+00018230: 4741 4d49 4327 292e 2044 6566 6175 6c74  GAMIC'). Default
+00018240: 7320 746f 2027 4f44 494d 272e 0a0a 2020  s to 'ODIM'...  
+00018250: 2020 2020 2020 4b65 7977 6f72 6420 4172        Keyword Ar
+00018260: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00018270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00018280: 2d0a 2020 2020 2020 2020 6465 636f 6465  -.        decode
+00018290: 5f74 696d 6573 203a 2062 6f6f 6c0a 2020  _times : bool.  
+000182a0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+000182b0: 652c 2064 6563 6f64 6520 6366 2074 696d  e, decode cf tim
+000182c0: 6573 2074 6f20 6e70 2e64 6174 6574 696d  es to np.datetim
+000182d0: 6536 342e 2044 6566 6175 6c74 7320 746f  e64. Defaults to
+000182e0: 2054 7275 652e 0a20 2020 2020 2020 2064   True..        d
+000182f0: 6563 6f64 655f 636f 6f72 6473 203a 2062  ecode_coords : b
+00018300: 6f6f 6c0a 2020 2020 2020 2020 2020 2020  ool.            
+00018310: 4966 2054 7275 652c 2075 7365 2074 6865  If True, use the
+00018320: 20e2 8098 636f 6f72 6469 6e61 7465 73e2   ...coordinates.
+00018330: 8099 2061 7474 7269 6275 7465 206f 6e20  .. attribute on 
+00018340: 7661 7269 6162 6c65 0a20 2020 2020 2020  variable.       
+00018350: 2020 2020 2074 6f20 6173 7369 676e 2063       to assign c
+00018360: 6f6f 7264 696e 6174 6573 2e20 4465 6661  oordinates. Defa
+00018370: 756c 7473 2074 6f20 5472 7565 2e0a 2020  ults to True..  
+00018380: 2020 2020 2020 6d61 736b 5f61 6e64 5f73        mask_and_s
+00018390: 6361 6c65 203a 2062 6f6f 6c0a 2020 2020  cale : bool.    
+000183a0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+000183b0: 206c 617a 696c 7920 7363 616c 6520 2875   lazily scale (u
+000183c0: 7369 6e67 2073 6361 6c65 5f66 6163 746f  sing scale_facto
+000183d0: 7220 616e 6420 6164 645f 6f66 6673 6574  r and add_offset
+000183e0: 290a 2020 2020 2020 2020 2020 2020 616e  ).            an
+000183f0: 6420 6d61 736b 2028 7573 696e 6720 5f46  d mask (using _F
+00018400: 696c 6c56 616c 7565 292e 2044 6566 6175  illValue). Defau
+00018410: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+00018420: 2020 2020 2063 6875 6e6b 7320 3a20 696e       chunks : in
+00018430: 7420 7c20 6469 6374 2c20 6f70 7469 6f6e  t | dict, option
+00018440: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00018450: 6620 6368 756e 6b73 2069 7320 7072 6f76  f chunks is prov
+00018460: 6964 6564 2c20 6974 2075 7365 6420 746f  ided, it used to
+00018470: 206c 6f61 6420 7468 6520 6e65 7720 6461   load the new da
+00018480: 7461 7365 7420 696e 746f 2064 6173 6b0a  taset into dask.
+00018490: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+000184a0: 7973 2e20 6368 756e 6b73 3d7b 7d20 6c6f  ys. chunks={} lo
+000184b0: 6164 7320 7468 6520 6461 7461 7365 7420  ads the dataset 
+000184c0: 7769 7468 2064 6173 6b20 7573 696e 6720  with dask using 
+000184d0: 6120 7369 6e67 6c65 0a20 2020 2020 2020  a single.       
+000184e0: 2020 2020 2063 6875 6e6b 2066 6f72 2061       chunk for a
+000184f0: 6c6c 2061 7272 6179 732e 0a20 2020 2020  ll arrays..     
+00018500: 2020 2067 656f 7265 6620 3a20 626f 6f6c     georef : bool
+00018510: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00018520: 5472 7565 2c20 6164 6473 2032 4420 4145  True, adds 2D AE
+00018530: 5144 2078 2c79 2c7a 2d63 6f6f 7264 696e  QD x,y,z-coordin
+00018540: 6174 6573 2c20 6772 6f75 6e64 5f72 616e  ates, ground_ran
+00018550: 6765 2028 6772 2920 616e 640a 2020 2020  ge (gr) and.    
+00018560: 2020 2020 2020 2020 3244 2028 7261 7973          2D (rays
+00018570: 2c62 696e 7329 2d63 6f6f 7264 696e 6174  ,bins)-coordinat
+00018580: 6573 2066 6f72 2065 6173 7920 6765 6f72  es for easy geor
+00018590: 6566 6572 656e 6369 6e67 2028 6567 2e20  eferencing (eg. 
+000185a0: 6361 7274 6f70 7929 0a20 2020 2020 2020  cartopy).       
+000185b0: 2073 7461 6e64 6172 6420 3a20 7374 720a   standard : str.
+000185c0: 2020 2020 2020 2020 2020 2020 2a20 606e              * `n
+000185d0: 6f6e 6560 202d 2064 6174 6120 6973 2072  one` - data is r
+000185e0: 6561 6420 6173 2076 6572 6261 7469 6d20  ead as verbatim 
+000185f0: 6173 2070 6f73 7369 626c 652c 206e 6f20  as possible, no 
+00018600: 6d65 7461 6461 7461 0a20 2020 2020 2020  metadata.       
+00018610: 2020 2020 202a 2060 6f64 696d 6020 2d20       * `odim` - 
+00018620: 6461 7461 2069 7320 7265 6164 2c20 6f64  data is read, od
+00018630: 696d 206d 6574 6164 6174 6120 6164 6465  im metadata adde
+00018640: 6420 746f 2064 6174 6173 6574 730a 2020  d to datasets.  
+00018650: 2020 2020 2020 2020 2020 2a20 6063 662d            * `cf-
+00018660: 6d61 6e64 6174 6f72 7960 202d 2064 6174  mandatory` - dat
+00018670: 6120 6973 2072 6561 6420 6163 636f 7264  a is read accord
+00018680: 696e 6720 746f 2063 6672 6164 6961 6c32  ing to cfradial2
+00018690: 2073 7461 6e64 6172 640a 2020 2020 2020   standard.      
+000186a0: 2020 2020 2020 2020 696d 706f 7274 696e          importin
+000186b0: 6720 6d61 6e64 6174 6f72 7920 6d65 7461  g mandatory meta
+000186c0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
+000186d0: 202a 2060 6366 2d66 756c 6c60 202d 2064   * `cf-full` - d
+000186e0: 6174 6120 6973 2072 6561 6420 6163 636f  ata is read acco
+000186f0: 7264 696e 6720 746f 2063 6672 6164 6961  rding to cfradia
+00018700: 6c32 2073 7461 6e64 6172 640a 2020 2020  l2 standard.    
+00018710: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00018720: 696e 6720 616c 6c20 6176 6169 6c61 626c  ing all availabl
+00018730: 6520 6366 7261 6469 616c 3220 6d65 7461  e cfradial2 meta
+00018740: 6461 7461 2028 6e6f 7420 6675 6c6c 790a  data (not fully.
+00018750: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00018760: 706c 656d 656e 7465 6429 0a20 2020 2020  plemented).     
+00018770: 2020 2064 696d 3020 3a20 7374 720a 2020     dim0 : str.  
+00018780: 2020 2020 2020 2020 2020 6e61 6d65 206f            name o
+00018790: 6620 7468 6520 7261 792d 6469 6d65 6e73  f the ray-dimens
+000187a0: 696f 6e20 6f66 2044 6174 6141 7272 6179  ion of DataArray
+000187b0: 7320 616e 6420 4461 7461 7365 743a 0a20  s and Dataset:. 
+000187c0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+000187d0: 2060 7469 6d65 6020 2d20 6366 7261 6469   `time` - cfradi
+000187e0: 616c 3220 7374 616e 6461 7264 0a20 2020  al2 standard.   
+000187f0: 2020 2020 2020 2020 2020 2020 202a 2060               * `
+00018800: 617a 696d 7574 6860 202d 2062 6574 7465  azimuth` - bette
+00018810: 7220 666f 7220 776f 726b 696e 6720 7769  r for working wi
+00018820: 7468 2078 6172 7261 790a 2020 2020 2020  th xarray.      
+00018830: 2020 2222 220a 2020 2020 2020 2020 7375    """.        su
+00018840: 7065 7228 4f64 696d 4835 2c20 7365 6c66  per(OdimH5, self
+00018850: 292e 5f5f 696e 6974 5f5f 2829 0a0a 2020  ).__init__()..  
+00018860: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00018870: 6e73 7461 6e63 6528 6669 6c65 6e61 6d65  nstance(filename
+00018880: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+00018890: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
+000188a0: 5b66 696c 656e 616d 655d 0a0a 2020 2020  [filename]..    
+000188b0: 2020 2020 6966 206c 656e 2866 696c 656e      if len(filen
+000188c0: 616d 6529 203d 3d20 303a 0a20 2020 2020  ame) == 0:.     
+000188d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000188e0: 7565 4572 726f 7228 2246 696c 6520 6c69  ueError("File li
+000188f0: 7374 2065 6d70 7479 2229 0a0a 2020 2020  st empty")..    
+00018900: 2020 2020 666f 7220 6620 696e 2066 696c      for f in fil
+00018910: 656e 616d 653a 0a20 2020 2020 2020 2020  ename:.         
+00018920: 2020 2073 656c 662e 6173 7369 676e 5f64     self.assign_d
+00018930: 6174 6128 662c 2066 6c61 766f 7572 3d66  ata(f, flavour=f
+00018940: 6c61 766f 7572 2c20 2a2a 6b77 6172 6773  lavour, **kwargs
+00018950: 290a 0a20 2020 2020 2020 2069 6620 2263  )..        if "c
+00018960: 6622 2069 6e20 6b77 6172 6773 2e67 6574  f" in kwargs.get
+00018970: 2822 7374 616e 6461 7264 222c 2022 6366  ("standard", "cf
+00018980: 2d6d 616e 6461 746f 7279 2229 3a0a 2020  -mandatory"):.  
+00018990: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000189a0: 7373 6967 6e5f 726f 6f74 2829 0a0a 2020  ssign_root()..  
+000189b0: 2020 6465 6620 6173 7369 676e 5f64 6174    def assign_dat
+000189c0: 6128 7365 6c66 2c20 6669 6c65 6e61 6d65  a(self, filename
+000189d0: 2c20 666c 6176 6f75 723d 4e6f 6e65 2c20  , flavour=None, 
+000189e0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+000189f0: 2020 2022 2222 4173 7369 676e 2078 6172     """Assign xar
+00018a00: 7261 7920 6461 7461 7365 7420 6672 6f6d  ray dataset from
+00018a10: 2068 6466 3520 6461 7461 2073 7472 7563   hdf5 data struc
+00018a20: 7475 7265 2e0a 0a20 2020 2020 2020 2050  ture...        P
+00018a30: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00018a40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00018a50: 2020 2020 2066 696c 656e 616d 6520 3a20       filename : 
+00018a60: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
+00018a70: 536f 7572 6365 2064 6174 6120 6669 6c65  Source data file
+00018a80: 206e 616d 652e 0a20 2020 2020 2020 2066   name..        f
+00018a90: 6c61 766f 7572 203a 2073 7472 0a20 2020  lavour : str.   
+00018aa0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+00018ab0: 2068 6466 3520 666c 6176 6f75 7220 2827   hdf5 flavour ('
+00018ac0: 4f44 494d 2720 6f72 2027 4741 4d49 4327  ODIM' or 'GAMIC'
+00018ad0: 292e 2044 6566 6175 6c74 7320 746f 2027  ). Defaults to '
+00018ae0: 4f44 494d 272e 0a0a 2020 2020 2020 2020  ODIM'...        
+00018af0: 4b65 7977 6f72 6420 4172 6775 6d65 6e74  Keyword Argument
+00018b00: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00018b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00018b20: 2020 2020 6465 636f 6465 5f74 696d 6573      decode_times
+00018b30: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
+00018b40: 2020 2020 4966 2054 7275 652c 2064 6563      If True, dec
+00018b50: 6f64 6520 6366 2074 696d 6573 2074 6f20  ode cf times to 
+00018b60: 6e70 2e64 6174 6574 696d 6536 342e 2044  np.datetime64. D
+00018b70: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
+00018b80: 0a20 2020 2020 2020 2064 6563 6f64 655f  .        decode_
+00018b90: 636f 6f72 6473 203a 2062 6f6f 6c0a 2020  coords : bool.  
+00018ba0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+00018bb0: 652c 2075 7365 2074 6865 20e2 8098 636f  e, use the ...co
+00018bc0: 6f72 6469 6e61 7465 73e2 8099 2061 7474  ordinates... att
+00018bd0: 7269 6275 7465 206f 6e20 7661 7269 6162  ribute on variab
+00018be0: 6c65 0a20 2020 2020 2020 2020 2020 2074  le.            t
+00018bf0: 6f20 6173 7369 676e 2063 6f6f 7264 696e  o assign coordin
+00018c00: 6174 6573 2e20 4465 6661 756c 7473 2074  ates. Defaults t
+00018c10: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
+00018c20: 6d61 736b 5f61 6e64 5f73 6361 6c65 203a  mask_and_scale :
+00018c30: 2062 6f6f 6c0a 2020 2020 2020 2020 2020   bool.          
+00018c40: 2020 4966 2054 7275 652c 206c 617a 696c    If True, lazil
+00018c50: 7920 7363 616c 6520 2875 7369 6e67 2073  y scale (using s
+00018c60: 6361 6c65 5f66 6163 746f 7220 616e 6420  cale_factor and 
+00018c70: 6164 645f 6f66 6673 6574 290a 2020 2020  add_offset).    
+00018c80: 2020 2020 2020 2020 616e 6420 6d61 736b          and mask
+00018c90: 2028 7573 696e 6720 5f46 696c 6c56 616c   (using _FillVal
+00018ca0: 7565 292e 2044 6566 6175 6c74 7320 746f  ue). Defaults to
+00018cb0: 2054 7275 652e 0a20 2020 2020 2020 2063   True..        c
+00018cc0: 6875 6e6b 7320 3a20 696e 7420 7c20 6469  hunks : int | di
+00018cd0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
+00018ce0: 2020 2020 2020 2020 2049 6620 6368 756e           If chun
+00018cf0: 6b73 2069 7320 7072 6f76 6964 6564 2c20  ks is provided, 
+00018d00: 6974 2075 7365 6420 746f 206c 6f61 6420  it used to load 
+00018d10: 7468 6520 6e65 7720 6461 7461 7365 7420  the new dataset 
+00018d20: 696e 746f 2064 6173 6b0a 2020 2020 2020  into dask.      
+00018d30: 2020 2020 2020 6172 7261 7973 2e20 6368        arrays. ch
+00018d40: 756e 6b73 3d7b 7d20 6c6f 6164 7320 7468  unks={} loads th
+00018d50: 6520 6461 7461 7365 7420 7769 7468 2064  e dataset with d
+00018d60: 6173 6b20 7573 696e 6720 6120 7369 6e67  ask using a sing
+00018d70: 6c65 0a20 2020 2020 2020 2020 2020 2063  le.            c
+00018d80: 6875 6e6b 2066 6f72 2061 6c6c 2061 7272  hunk for all arr
+00018d90: 6179 732e 0a20 2020 2020 2020 2067 656f  ays..        geo
+00018da0: 7265 6620 3a20 626f 6f6c 0a20 2020 2020  ref : bool.     
+00018db0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+00018dc0: 6164 6473 2032 4420 4145 5144 2078 2c79  adds 2D AEQD x,y
+00018dd0: 2c7a 2d63 6f6f 7264 696e 6174 6573 2c20  ,z-coordinates, 
+00018de0: 6772 6f75 6e64 5f72 616e 6765 2028 6772  ground_range (gr
+00018df0: 2920 616e 640a 2020 2020 2020 2020 2020  ) and.          
+00018e00: 2020 3244 2028 7261 7973 2c62 696e 7329    2D (rays,bins)
+00018e10: 2d63 6f6f 7264 696e 6174 6573 2066 6f72  -coordinates for
+00018e20: 2065 6173 7920 6765 6f72 6566 6572 656e   easy georeferen
+00018e30: 6369 6e67 2028 6567 2e20 6361 7274 6f70  cing (eg. cartop
+00018e40: 7929 2e0a 2020 2020 2020 2020 2020 2020  y)..            
+00018e50: 4465 6661 756c 7473 2074 6f20 4661 6c73  Defaults to Fals
+00018e60: 652e 0a20 2020 2020 2020 2073 7461 6e64  e..        stand
+00018e70: 6172 6420 3a20 7374 720a 2020 2020 2020  ard : str.      
+00018e80: 2020 2020 2020 2a20 606e 6f6e 6560 202d        * `none` -
+00018e90: 2064 6174 6120 6973 2072 6561 6420 6173   data is read as
+00018ea0: 2076 6572 6261 7469 6d20 6173 2070 6f73   verbatim as pos
+00018eb0: 7369 626c 652c 206e 6f20 6d65 7461 6461  sible, no metada
+00018ec0: 7461 0a20 2020 2020 2020 2020 2020 202a  ta.            *
+00018ed0: 2060 6f64 696d 6020 2d20 6461 7461 2069   `odim` - data i
+00018ee0: 7320 7265 6164 2c20 6f64 696d 206d 6574  s read, odim met
+00018ef0: 6164 6174 6120 6164 6465 6420 746f 2064  adata added to d
+00018f00: 6174 6173 6574 730a 2020 2020 2020 2020  atasets.        
+00018f10: 2020 2020 2a20 6063 662d 6d61 6e64 6174      * `cf-mandat
+00018f20: 6f72 7960 202d 2064 6174 6120 6973 2072  ory` - data is r
+00018f30: 6561 6420 6163 636f 7264 696e 6720 746f  ead according to
+00018f40: 2063 6672 6164 6961 6c32 2073 7461 6e64   cfradial2 stand
+00018f50: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
+00018f60: 2020 696d 706f 7274 696e 6720 6d61 6e64    importing mand
+00018f70: 6174 6f72 7920 6d65 7461 6461 7461 2c20  atory metadata, 
+00018f80: 6465 6661 756c 7420 7661 6c75 650a 2020  default value.  
+00018f90: 2020 2020 2020 2020 2020 2a20 6063 662d            * `cf-
+00018fa0: 6675 6c6c 6020 2d20 6461 7461 2069 7320  full` - data is 
+00018fb0: 7265 6164 2061 6363 6f72 6469 6e67 2074  read according t
+00018fc0: 6f20 6366 7261 6469 616c 3220 7374 616e  o cfradial2 stan
+00018fd0: 6461 7264 0a20 2020 2020 2020 2020 2020  dard.           
+00018fe0: 2020 2069 6d70 6f72 7469 6e67 2061 6c6c     importing all
+00018ff0: 2061 7661 696c 6162 6c65 2063 6672 6164   available cfrad
+00019000: 6961 6c32 206d 6574 6164 6174 6120 286e  ial2 metadata (n
+00019010: 6f74 2066 756c 6c79 0a20 2020 2020 2020  ot fully.       
+00019020: 2020 2020 2020 2069 6d70 6c65 6d65 6e74         implement
+00019030: 6564 290a 2020 2020 2020 2020 6469 6d30  ed).        dim0
+00019040: 203a 2073 7472 0a20 2020 2020 2020 2020   : str.         
+00019050: 2020 206e 616d 6520 6f66 2074 6865 2072     name of the r
+00019060: 6179 2d64 696d 656e 7369 6f6e 206f 6620  ay-dimension of 
+00019070: 4461 7461 4172 7261 7973 2061 6e64 2044  DataArrays and D
+00019080: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00019090: 2020 2020 2020 2020 2a20 6074 696d 6560          * `time`
+000190a0: 202d 2063 6672 6164 6961 6c32 2073 7461   - cfradial2 sta
+000190b0: 6e64 6172 642c 2064 6566 6175 6c74 2076  ndard, default v
+000190c0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+000190d0: 2020 2020 202a 2060 617a 696d 7574 6860       * `azimuth`
+000190e0: 202d 2062 6574 7465 7220 666f 7220 776f   - better for wo
+000190f0: 726b 696e 6720 7769 7468 2078 6172 7261  rking with xarra
+00019100: 790a 2020 2020 2020 2020 2222 220a 2020  y.        """.  
+00019110: 2020 2020 2020 6e63 6820 3d20 4f64 696d        nch = Odim
+00019120: 4835 4669 6c65 2866 696c 656e 616d 652c  H5File(filename,
+00019130: 2066 6c61 766f 7572 3d66 6c61 766f 7572   flavour=flavour
+00019140: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00019150: 6e63 682e 6170 7065 6e64 286e 6368 290a  nch.append(nch).
+00019160: 0a20 2020 2020 2020 2023 206b 6579 776f  .        # keywo
+00019170: 7264 2061 7267 756d 656e 7420 6861 6e64  rd argument hand
+00019180: 6c69 6e67 0a20 2020 2020 2020 2064 6563  ling.        dec
+00019190: 6f64 655f 7469 6d65 7320 3d20 6b77 6172  ode_times = kwar
+000191a0: 6773 2e67 6574 2822 6465 636f 6465 5f74  gs.get("decode_t
+000191b0: 696d 6573 222c 2054 7275 6529 0a20 2020  imes", True).   
+000191c0: 2020 2020 2064 6563 6f64 655f 636f 6f72       decode_coor
+000191d0: 6473 203d 206b 7761 7267 732e 6765 7428  ds = kwargs.get(
+000191e0: 2264 6563 6f64 655f 636f 6f72 6473 222c  "decode_coords",
+000191f0: 2054 7275 6529 0a20 2020 2020 2020 206d   True).        m
+00019200: 6173 6b5f 616e 645f 7363 616c 6520 3d20  ask_and_scale = 
+00019210: 6b77 6172 6773 2e67 6574 2822 6d61 736b  kwargs.get("mask
+00019220: 5f61 6e64 5f73 6361 6c65 222c 2054 7275  _and_scale", Tru
+00019230: 6529 0a20 2020 2020 2020 2067 656f 7265  e).        geore
+00019240: 6620 3d20 6b77 6172 6773 2e67 6574 2822  f = kwargs.get("
+00019250: 6765 6f72 6566 222c 2046 616c 7365 290a  georef", False).
+00019260: 2020 2020 2020 2020 7374 616e 6461 7264          standard
+00019270: 203d 206b 7761 7267 732e 6765 7428 2273   = kwargs.get("s
+00019280: 7461 6e64 6172 6422 2c20 2263 662d 6d61  tandard", "cf-ma
+00019290: 6e64 6174 6f72 7922 290a 2020 2020 2020  ndatory").      
+000192a0: 2020 6469 6d30 203d 206b 7761 7267 732e    dim0 = kwargs.
+000192b0: 6765 7428 2264 696d 3022 2c20 2274 696d  get("dim0", "tim
+000192c0: 6522 290a 0a20 2020 2020 2020 2023 2072  e")..        # r
+000192d0: 6574 7269 6576 6520 616e 6420 6173 7369  etrieve and assi
+000192e0: 676e 2067 6c6f 6261 6c20 6772 6f75 7073  gn global groups
+000192f0: 202f 686f 772c 202f 7768 6174 2c20 2f77   /how, /what, /w
+00019300: 6865 7265 0a20 2020 2020 2020 2067 726f  here.        gro
+00019310: 7570 7320 3d20 5b22 686f 7722 2c20 2277  ups = ["how", "w
+00019320: 6861 7422 2c20 2277 6865 7265 225d 0a20  hat", "where"]. 
+00019330: 2020 2020 2020 2068 6f77 2c20 7768 6174         how, what
+00019340: 2c20 7768 6572 6520 3d20 5f67 6574 5f6f  , where = _get_o
+00019350: 6469 6d5f 6772 6f75 7073 286e 6368 2e6e  dim_groups(nch.n
+00019360: 6368 2c20 6772 6f75 7073 290a 2020 2020  ch, groups).    
+00019370: 2020 2020 7274 5f67 7270 7320 3d20 7b22      rt_grps = {"
+00019380: 686f 7722 3a20 686f 772c 2022 7768 6174  how": how, "what
+00019390: 223a 2077 6861 742c 2022 7768 6572 6522  ": what, "where"
+000193a0: 3a20 7768 6572 657d 0a0a 2020 2020 2020  : where}..      
+000193b0: 2020 2320 7377 6565 7020 6772 6f75 7020    # sweep group 
+000193c0: 6861 6e64 6c69 6e67 0a20 2020 2020 2020  handling.       
+000193d0: 2028 7372 635f 7377 705f 6772 705f 6e61   (src_swp_grp_na
+000193e0: 6d65 2c20 7377 705f 6772 705f 6e61 6d65  me, swp_grp_name
+000193f0: 2920 3d20 5f67 6574 5f6f 6469 6d5f 7377  ) = _get_odim_sw
+00019400: 6565 705f 6772 6f75 705f 6e61 6d65 7328  eep_group_names(
+00019410: 0a20 2020 2020 2020 2020 2020 206e 6368  .            nch
+00019420: 2e6e 6368 2c20 6e63 682e 5f64 7364 6573  .nch, nch._dsdes
+00019430: 630a 2020 2020 2020 2020 290a 0a20 2020  c.        )..   
+00019440: 2020 2020 2023 2069 7465 7261 7465 2073       # iterate s
+00019450: 7765 6570 7320 696e 2066 696c 650a 2020  weeps in file.  
+00019460: 2020 2020 2020 666f 7220 692c 2073 7765        for i, swe
+00019470: 6570 2069 6e20 656e 756d 6572 6174 6528  ep in enumerate(
+00019480: 7372 635f 7377 705f 6772 705f 6e61 6d65  src_swp_grp_name
+00019490: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+000194a0: 2072 6574 7269 6576 6520 6473 2061 6e64   retrieve ds and
+000194b0: 2061 7373 6967 6e20 6461 7461 7365 7458   assign datasetX
+000194c0: 2068 6f77 2f77 6861 742f 7768 6572 6520   how/what/where 
+000194d0: 6772 6f75 7020 6174 7472 6962 7574 6573  group attributes
+000194e0: 0a20 2020 2020 2020 2020 2020 2067 726f  .            gro
+000194f0: 7570 7320 3d20 5b4e 6f6e 652c 2022 686f  ups = [None, "ho
+00019500: 7722 2c20 2277 6861 7422 2c20 2277 6865  w", "what", "whe
+00019510: 7265 225d 0a20 2020 2020 2020 2020 2020  re"].           
+00019520: 2064 732c 2064 735f 686f 772c 2064 735f   ds, ds_how, ds_
+00019530: 7768 6174 2c20 6473 5f77 6865 7265 203d  what, ds_where =
+00019540: 205f 6765 745f 6f64 696d 5f67 726f 7570   _get_odim_group
+00019550: 7328 6e63 682e 6e63 685b 7377 6565 705d  s(nch.nch[sweep]
+00019560: 2c20 6772 6f75 7073 290a 2020 2020 2020  , groups).      
+00019570: 2020 2020 2020 6473 5f67 7270 7320 3d20        ds_grps = 
+00019580: 7b22 686f 7722 3a20 6473 5f68 6f77 2c20  {"how": ds_how, 
+00019590: 2277 6861 7422 3a20 6473 5f77 6861 742c  "what": ds_what,
+000195a0: 2022 7768 6572 6522 3a20 6473 5f77 6865   "where": ds_whe
+000195b0: 7265 7d0a 0a20 2020 2020 2020 2020 2020  re}..           
+000195c0: 2023 206d 6f6d 656e 7473 0a20 2020 2020   # moments.     
+000195d0: 2020 2020 2020 2064 7320 3d20 5f61 7373         ds = _ass
+000195e0: 6967 6e5f 6f64 696d 5f6d 6f6d 656e 7473  ign_odim_moments
+000195f0: 2864 732c 206e 6368 2c20 7377 6565 702c  (ds, nch, sweep,
+00019600: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+00019610: 2020 2020 2020 2020 2320 7265 7472 6965          # retrie
+00019620: 7665 2061 6e64 2061 7373 6967 6e20 6761  ve and assign ga
+00019630: 6d69 6320 7261 795f 6865 6164 6572 0a20  mic ray_header. 
+00019640: 2020 2020 2020 2020 2020 2069 6620 6e63             if nc
+00019650: 682e 666c 6176 6f75 7220 3d3d 2022 4741  h.flavour == "GA
+00019660: 4d49 4322 3a0a 2020 2020 2020 2020 2020  MIC":.          
+00019670: 2020 2020 2020 7268 203d 205f 6765 745f        rh = _get_
+00019680: 6761 6d69 635f 7261 795f 6865 6164 6572  gamic_ray_header
+00019690: 286e 6368 2e66 696c 656e 616d 652c 2069  (nch.filename, i
+000196a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000196b0: 2020 6473 5f67 7270 735b 2277 6861 7422    ds_grps["what"
+000196c0: 5d20 3d20 6473 5f67 7270 735b 2277 6861  ] = ds_grps["wha
+000196d0: 7422 5d2e 6173 7369 676e 2872 6829 0a0a  t"].assign(rh)..
+000196e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+000196f0: 6f72 6469 6e61 7465 7320 7772 6170 2d75  ordinates wrap-u
+00019700: 700a 2020 2020 2020 2020 2020 2020 7661  p.            va
+00019710: 7273 203d 2063 6f6c 6c65 6374 696f 6e73  rs = collections
+00019720: 2e4f 7264 6572 6564 4469 6374 2829 0a20  .OrderedDict(). 
+00019730: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
+00019740: 7320 3d20 636f 6c6c 6563 7469 6f6e 732e  s = collections.
+00019750: 4f72 6465 7265 6444 6963 7428 290a 2020  OrderedDict().  
+00019760: 2020 2020 2020 2020 2020 6966 2022 6366            if "cf
+00019770: 2220 696e 2073 7461 6e64 6172 6420 6f72  " in standard or
+00019780: 2067 656f 7265 663a 0a20 2020 2020 2020   georef:.       
+00019790: 2020 2020 2020 2020 2063 6f6f 7264 735b           coords[
+000197a0: 226c 6f6e 6769 7475 6465 225d 203d 2072  "longitude"] = r
+000197b0: 745f 6772 7073 5b22 7768 6572 6522 5d2e  t_grps["where"].
+000197c0: 6174 7472 735b 226c 6f6e 225d 0a20 2020  attrs["lon"].   
+000197d0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+000197e0: 7264 735b 226c 6174 6974 7564 6522 5d20  rds["latitude"] 
+000197f0: 3d20 7274 5f67 7270 735b 2277 6865 7265  = rt_grps["where
+00019800: 225d 2e61 7474 7273 5b22 6c61 7422 5d0a  "].attrs["lat"].
+00019810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019820: 636f 6f72 6473 5b22 616c 7469 7475 6465  coords["altitude
+00019830: 225d 203d 2072 745f 6772 7073 5b22 7768  "] = rt_grps["wh
+00019840: 6572 6522 5d2e 6174 7472 735b 2268 6569  ere"].attrs["hei
+00019850: 6768 7422 5d0a 2020 2020 2020 2020 2020  ght"].          
+00019860: 2020 6966 2022 6366 2220 696e 2073 7461    if "cf" in sta
+00019870: 6e64 6172 6420 6f72 2067 656f 7265 663a  ndard or georef:
+00019880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019890: 2073 7765 6570 5f6d 6f64 6520 3d20 5f67   sweep_mode = _g
+000198a0: 6574 5f6f 6469 6d5f 7377 6565 705f 6d6f  et_odim_sweep_mo
+000198b0: 6465 286e 6368 2c20 6473 5f67 7270 7329  de(nch, ds_grps)
+000198c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000198d0: 2063 6f6f 7264 735b 2273 7765 6570 5f6d   coords["sweep_m
+000198e0: 6f64 6522 5d20 3d20 7377 6565 705f 6d6f  ode"] = sweep_mo
+000198f0: 6465 0a20 2020 2020 2020 2020 2020 2069  de.            i
+00019900: 6620 2263 6622 2069 6e20 7374 616e 6461  f "cf" in standa
+00019910: 7264 206f 7220 6465 636f 6465 5f63 6f6f  rd or decode_coo
+00019920: 7264 7320 6f72 2067 656f 7265 663a 0a20  rds or georef:. 
+00019930: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019940: 6f6f 7264 732e 7570 6461 7465 285f 6765  oords.update(_ge
+00019950: 745f 6f64 696d 5f63 6f6f 7264 696e 6174  t_odim_coordinat
+00019960: 6573 286e 6368 2c20 6473 5f67 7270 7329  es(nch, ds_grps)
 00019970: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00019980: 2020 6966 2064 6563 6f64 655f 7469 6d65    if decode_time
-00019990: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000199a0: 2020 2020 2020 2063 6f6f 7264 735b 2274         coords["t
-000199b0: 696d 6522 5d20 3d20 285b 2264 696d 5f30  ime"] = (["dim_0
-000199c0: 225d 2c20 7469 6d65 7661 6c73 2c20 7469  "], timevals, ti
-000199d0: 6d65 5f61 7474 7273 290a 2020 2020 2020  me_attrs).      
-000199e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000199f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a00: 2020 2020 636f 6f72 6473 5b22 7469 6d65      coords["time
-00019a10: 225d 203d 2028 5b22 6469 6d5f 3022 5d2c  "] = (["dim_0"],
-00019a20: 2074 696d 6576 616c 7329 0a0a 2020 2020   timevals)..    
-00019a30: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
-00019a40: 2067 6c6f 6261 6c20 7377 6565 7020 6174   global sweep at
-00019a50: 7472 6962 7574 6573 0a20 2020 2020 2020  tributes.       
-00019a60: 2020 2020 2066 6978 6564 5f61 6e67 6c65       fixed_angle
-00019a70: 203d 205f 6765 745f 6f64 696d 5f66 6978   = _get_odim_fix
-00019a80: 6564 5f61 6e67 6c65 286e 6368 2c20 6473  ed_angle(nch, ds
-00019a90: 5f67 7270 7329 0a20 2020 2020 2020 2020  _grps).         
-00019aa0: 2020 2069 6620 2263 6622 2069 6e20 7374     if "cf" in st
-00019ab0: 616e 6461 7264 3a0a 2020 2020 2020 2020  andard:.        
-00019ac0: 2020 2020 2020 2020 7661 7273 2e75 7064          vars.upd
-00019ad0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-00019ae0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00019af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b00: 2020 2022 7377 6565 705f 6e75 6d62 6572     "sweep_number
-00019b10: 223a 2069 2c0a 2020 2020 2020 2020 2020  ": i,.          
-00019b20: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00019b30: 7765 6570 5f6d 6f64 6522 3a20 7377 6565  weep_mode": swee
-00019b40: 705f 6d6f 6465 2c0a 2020 2020 2020 2020  p_mode,.        
-00019b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b60: 2266 6f6c 6c6f 775f 6d6f 6465 223a 2022  "follow_mode": "
-00019b70: 6e6f 6e65 222c 0a20 2020 2020 2020 2020  none",.         
-00019b80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00019b90: 7072 745f 6d6f 6465 223a 2022 6669 7865  prt_mode": "fixe
-00019ba0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-00019bb0: 2020 2020 2020 2020 2020 2020 2266 6978              "fix
-00019bc0: 6564 5f61 6e67 6c65 223a 2066 6978 6564  ed_angle": fixed
-00019bd0: 5f61 6e67 6c65 2c0a 2020 2020 2020 2020  _angle,.        
-00019be0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00019bf0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00019c00: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00019c10: 6366 2d66 756c 6c22 2069 6e20 7374 616e  cf-full" in stan
-00019c20: 6461 7264 3a0a 2020 2020 2020 2020 2020  dard:.          
-00019c30: 2020 2020 2020 6675 6c6c 5f76 6172 7320        full_vars 
-00019c40: 3d20 5f67 6574 5f6f 6469 6d5f 6675 6c6c  = _get_odim_full
-00019c50: 5f76 6172 7328 6e63 682c 2064 735f 6772  _vars(nch, ds_gr
-00019c60: 7073 290a 2020 2020 2020 2020 2020 2020  ps).            
-00019c70: 2020 2020 7661 7273 2e75 7064 6174 6528      vars.update(
-00019c80: 6675 6c6c 5f76 6172 7329 0a0a 2020 2020  full_vars)..    
-00019c90: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
-00019ca0: 2076 6172 6961 626c 6573 2061 6e64 2063   variables and c
-00019cb0: 6f6f 7264 696e 6174 6573 0a20 2020 2020  oordinates.     
-00019cc0: 2020 2020 2020 2064 7320 3d20 6473 2e61         ds = ds.a
-00019cd0: 7373 6967 6e28 7661 7273 290a 2020 2020  ssign(vars).    
-00019ce0: 2020 2020 2020 2020 6473 203d 2064 732e          ds = ds.
-00019cf0: 6173 7369 676e 5f63 6f6f 7264 7328 2a2a  assign_coords(**
-00019d00: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
-00019d10: 2020 2020 6473 203d 2064 732e 7265 6e61      ds = ds.rena
-00019d20: 6d65 287b 2264 696d 5f30 223a 2064 696d  me({"dim_0": dim
-00019d30: 302c 2022 6469 6d5f 3122 3a20 2272 616e  0, "dim_1": "ran
-00019d40: 6765 227d 290a 0a20 2020 2020 2020 2020  ge"})..         
-00019d50: 2020 2023 2064 6563 6f64 6520 6461 7461     # decode data
-00019d60: 7365 7420 6966 2072 6571 7565 7374 6564  set if requested
-00019d70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00019d80: 6465 636f 6465 5f74 696d 6573 206f 7220  decode_times or 
-00019d90: 6465 636f 6465 5f63 6f6f 7264 7320 6f72  decode_coords or
-00019da0: 206d 6173 6b5f 616e 645f 7363 616c 653a   mask_and_scale:
-00019db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019dc0: 2064 7320 3d20 7872 2e64 6563 6f64 655f   ds = xr.decode_
-00019dd0: 6366 280a 2020 2020 2020 2020 2020 2020  cf(.            
-00019de0: 2020 2020 2020 2020 6473 2c0a 2020 2020          ds,.    
-00019df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e00: 6465 636f 6465 5f74 696d 6573 3d64 6563  decode_times=dec
-00019e10: 6f64 655f 7469 6d65 732c 0a20 2020 2020  ode_times,.     
-00019e20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00019e30: 6563 6f64 655f 636f 6f72 6473 3d64 6563  ecode_coords=dec
-00019e40: 6f64 655f 636f 6f72 6473 2c0a 2020 2020  ode_coords,.    
-00019e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e60: 6d61 736b 5f61 6e64 5f73 6361 6c65 3d6d  mask_and_scale=m
-00019e70: 6173 6b5f 616e 645f 7363 616c 652c 0a20  ask_and_scale,. 
-00019e80: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00019e90: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00019ea0: 6465 7465 726d 696e 6520 6966 2073 616d  determine if sam
-00019eb0: 6520 7377 6565 700a 2020 2020 2020 2020  e sweep.        
-00019ec0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00019ed0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
-00019ee0: 2073 656c 662e 7377 6565 705f 616e 676c   self.sweep_angl
-00019ef0: 6573 2e69 6e64 6578 2866 6978 6564 5f61  es.index(fixed_a
-00019f00: 6e67 6c65 290a 2020 2020 2020 2020 2020  ngle).          
-00019f10: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-00019f20: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00019f30: 2020 2020 206e 6964 7820 3d20 6c65 6e28       nidx = len(
-00019f40: 7365 6c66 2e5f 7377 6565 7073 2920 2b20  self._sweeps) + 
-00019f50: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00019f60: 2020 7377 705f 6772 705f 6e61 6d65 203d    swp_grp_name =
-00019f70: 2066 2273 7765 6570 5f7b 6e69 6478 7d22   f"sweep_{nidx}"
-00019f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019f90: 2073 656c 662e 5f73 7765 6570 735b 7377   self._sweeps[sw
-00019fa0: 705f 6772 705f 6e61 6d65 5d20 3d20 6473  p_grp_name] = ds
-00019fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019fc0: 2073 656c 662e 7377 6565 705f 6e61 6d65   self.sweep_name
-00019fd0: 732e 6170 7065 6e64 2873 7770 5f67 7270  s.append(swp_grp
-00019fe0: 5f6e 616d 6529 0a20 2020 2020 2020 2020  _name).         
-00019ff0: 2020 2020 2020 2073 656c 662e 7377 6565         self.swee
-0001a000: 705f 616e 676c 6573 2e61 7070 656e 6428  p_angles.append(
-0001a010: 6669 7865 645f 616e 676c 6529 0a20 2020  fixed_angle).   
-0001a020: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001a030: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0001a040: 6963 746b 6579 203d 2073 656c 662e 7377  ictkey = self.sw
-0001a050: 6565 705f 6e61 6d65 735b 696e 6465 785d  eep_names[index]
-0001a060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a070: 2073 656c 662e 5f73 7765 6570 735b 6469   self._sweeps[di
-0001a080: 6374 6b65 795d 203d 2078 722e 6d65 7267  ctkey] = xr.merg
-0001a090: 6528 5b73 656c 662e 5f73 7765 6570 735b  e([self._sweeps[
-0001a0a0: 6469 6374 6b65 795d 2c20 6473 5d29 0a0a  dictkey], ds])..
-0001a0b0: 2020 2020 6465 6620 6173 7369 676e 5f72      def assign_r
-0001a0c0: 6f6f 7428 7365 6c66 293a 0a20 2020 2020  oot(self):.     
-0001a0d0: 2020 2023 2072 6574 7269 6576 6520 616e     # retrieve an
-0001a0e0: 6420 6173 7369 676e 2067 6c6f 6261 6c20  d assign global 
-0001a0f0: 6772 6f75 7073 202f 686f 772c 202f 7768  groups /how, /wh
-0001a100: 6174 2c20 2f77 6865 7265 0a20 2020 2020  at, /where.     
-0001a110: 2020 2066 6972 7374 203d 2073 656c 662e     first = self.
-0001a120: 5f6e 6368 5b30 5d0a 0a20 2020 2020 2020  _nch[0]..       
-0001a130: 2067 726f 7570 7320 3d20 5b22 686f 7722   groups = ["how"
-0001a140: 2c20 2277 6861 7422 2c20 2277 6865 7265  , "what", "where
-0001a150: 225d 0a20 2020 2020 2020 2068 6f77 2c20  "].        how, 
-0001a160: 7768 6174 2c20 7768 6572 6520 3d20 5f67  what, where = _g
-0001a170: 6574 5f6f 6469 6d5f 6772 6f75 7073 2866  et_odim_groups(f
-0001a180: 6972 7374 2e6e 6368 2c20 6772 6f75 7073  irst.nch, groups
-0001a190: 290a 2020 2020 2020 2020 7274 5f67 7270  ).        rt_grp
-0001a1a0: 7320 3d20 7b22 686f 7722 3a20 686f 772c  s = {"how": how,
-0001a1b0: 2022 7768 6174 223a 2077 6861 742c 2022   "what": what, "
-0001a1c0: 7768 6572 6522 3a20 7768 6572 657d 0a0a  where": where}..
-0001a1d0: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
-0001a1e0: 2072 6f6f 7420 7661 7269 6162 6c65 730a   root variables.
-0001a1f0: 2020 2020 2020 2020 2320 6578 7472 6163          # extrac
-0001a200: 7420 7469 6d65 2063 6f76 6572 6167 650a  t time coverage.
-0001a210: 2020 2020 2020 2020 746d 696e 203d 205b          tmin = [
-0001a220: 6473 2e74 696d 652e 7661 6c75 6573 2e6d  ds.time.values.m
-0001a230: 696e 2829 2066 6f72 2064 7320 696e 2073  in() for ds in s
-0001a240: 656c 662e 5f73 7765 6570 732e 7661 6c75  elf._sweeps.valu
-0001a250: 6573 2829 5d0a 2020 2020 2020 2020 7469  es()].        ti
-0001a260: 6d65 5f63 6f76 6572 6167 655f 7374 6172  me_coverage_star
-0001a270: 7420 3d20 6d69 6e28 746d 696e 290a 2020  t = min(tmin).  
-0001a280: 2020 2020 2020 746d 6178 203d 205b 6473        tmax = [ds
-0001a290: 2e74 696d 652e 7661 6c75 6573 2e6d 6178  .time.values.max
-0001a2a0: 2829 2066 6f72 2064 7320 696e 2073 656c  () for ds in sel
-0001a2b0: 662e 5f73 7765 6570 732e 7661 6c75 6573  f._sweeps.values
-0001a2c0: 2829 5d0a 2020 2020 2020 2020 7469 6d65  ()].        time
-0001a2d0: 5f63 6f76 6572 6167 655f 656e 6420 3d20  _coverage_end = 
-0001a2e0: 6d61 7828 746d 6178 290a 0a20 2020 2020  max(tmax)..     
-0001a2f0: 2020 2074 696d 655f 636f 7665 7261 6765     time_coverage
-0001a300: 5f73 7461 7274 5f73 7472 203d 2073 7472  _start_str = str
-0001a310: 2874 696d 655f 636f 7665 7261 6765 5f73  (time_coverage_s
-0001a320: 7461 7274 295b 3a31 395d 202b 2022 5a22  tart)[:19] + "Z"
-0001a330: 0a20 2020 2020 2020 2074 696d 655f 636f  .        time_co
-0001a340: 7665 7261 6765 5f65 6e64 5f73 7472 203d  verage_end_str =
-0001a350: 2073 7472 2874 696d 655f 636f 7665 7261   str(time_covera
-0001a360: 6765 5f65 6e64 295b 3a31 395d 202b 2022  ge_end)[:19] + "
-0001a370: 5a22 0a0a 2020 2020 2020 2020 2320 6372  Z"..        # cr
-0001a380: 6561 7465 2072 6f6f 7420 6772 6f75 7020  eate root group 
-0001a390: 6672 6f6d 2073 6372 6174 6368 0a20 2020  from scratch.   
-0001a3a0: 2020 2020 2072 6f6f 7420 3d20 7872 2e44       root = xr.D
-0001a3b0: 6174 6173 6574 2864 6174 615f 7661 7273  ataset(data_vars
-0001a3c0: 3d67 6c6f 6261 6c5f 7661 7269 6162 6c65  =global_variable
-0001a3d0: 732c 2061 7474 7273 3d67 6c6f 6261 6c5f  s, attrs=global_
-0001a3e0: 6174 7472 7329 0a0a 2020 2020 2020 2020  attrs)..        
-0001a3f0: 2320 6173 7369 676e 2072 6f6f 7420 7661  # assign root va
-0001a400: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
-0001a410: 726f 6f74 203d 2072 6f6f 742e 6173 7369  root = root.assi
-0001a420: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
-0001a430: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001a440: 2020 2276 6f6c 756d 655f 6e75 6d62 6572    "volume_number
-0001a450: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-0001a460: 2020 2020 2020 2270 6c61 7466 6f72 6d5f        "platform_
-0001a470: 7479 7065 223a 2073 7472 2822 6669 7865  type": str("fixe
-0001a480: 6422 292c 0a20 2020 2020 2020 2020 2020  d"),.           
-0001a490: 2020 2020 2022 696e 7374 7275 6d65 6e74       "instrument
-0001a4a0: 5f74 7970 6522 3a20 2272 6164 6172 222c  _type": "radar",
-0001a4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a4c0: 2022 7072 696d 6172 795f 6178 6973 223a   "primary_axis":
-0001a4d0: 2022 6178 6973 5f7a 222c 0a20 2020 2020   "axis_z",.     
-0001a4e0: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-0001a4f0: 5f63 6f76 6572 6167 655f 7374 6172 7422  _coverage_start"
-0001a500: 3a20 7469 6d65 5f63 6f76 6572 6167 655f  : time_coverage_
-0001a510: 7374 6172 745f 7374 722c 0a20 2020 2020  start_str,.     
-0001a520: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-0001a530: 5f63 6f76 6572 6167 655f 656e 6422 3a20  _coverage_end": 
-0001a540: 7469 6d65 5f63 6f76 6572 6167 655f 656e  time_coverage_en
-0001a550: 645f 7374 722c 0a20 2020 2020 2020 2020  d_str,.         
-0001a560: 2020 2020 2020 2022 6c61 7469 7475 6465         "latitude
-0001a570: 223a 2072 745f 6772 7073 5b22 7768 6572  ": rt_grps["wher
-0001a580: 6522 5d2e 6174 7472 735b 226c 6174 225d  e"].attrs["lat"]
-0001a590: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a5a0: 2020 226c 6f6e 6769 7475 6465 223a 2072    "longitude": r
-0001a5b0: 745f 6772 7073 5b22 7768 6572 6522 5d2e  t_grps["where"].
-0001a5c0: 6174 7472 735b 226c 6f6e 225d 2c0a 2020  attrs["lon"],.  
-0001a5d0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0001a5e0: 6c74 6974 7564 6522 3a20 7274 5f67 7270  ltitude": rt_grp
-0001a5f0: 735b 2277 6865 7265 225d 2e61 7474 7273  s["where"].attrs
-0001a600: 5b22 6865 6967 6874 225d 2c0a 2020 2020  ["height"],.    
-0001a610: 2020 2020 2020 2020 2020 2020 2273 7765              "swe
-0001a620: 6570 5f67 726f 7570 5f6e 616d 6522 3a20  ep_group_name": 
-0001a630: 285b 2273 7765 6570 225d 2c20 7365 6c66  (["sweep"], self
-0001a640: 2e73 7765 6570 5f6e 616d 6573 292c 0a20  .sweep_names),. 
-0001a650: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001a660: 7377 6565 705f 6669 7865 645f 616e 676c  sweep_fixed_angl
-0001a670: 6522 3a20 285b 2273 7765 6570 225d 2c20  e": (["sweep"], 
-0001a680: 7365 6c66 2e73 7765 6570 5f61 6e67 6c65  self.sweep_angle
-0001a690: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-0001a6a0: 7d0a 2020 2020 2020 2020 290a 0a20 2020  }.        )..   
-0001a6b0: 2020 2020 2023 2061 7373 6967 6e20 726f       # assign ro
-0001a6c0: 6f74 2061 7474 7269 6275 7465 730a 2020  ot attributes.  
-0001a6d0: 2020 2020 2020 6174 7472 7320 3d20 5f67        attrs = _g
-0001a6e0: 6574 5f6f 6469 6d5f 726f 6f74 5f61 7474  et_odim_root_att
-0001a6f0: 7269 6275 7465 7328 6669 7273 742c 2072  ributes(first, r
-0001a700: 745f 6772 7073 290a 2020 2020 2020 2020  t_grps).        
-0001a710: 726f 6f74 203d 2072 6f6f 742e 6173 7369  root = root.assi
-0001a720: 676e 5f61 7474 7273 2861 7474 7273 290a  gn_attrs(attrs).
-0001a730: 2020 2020 2020 2020 7365 6c66 2e72 6f6f          self.roo
-0001a740: 7420 3d20 726f 6f74 0a0a 0a64 6566 205f  t = root...def _
-0001a750: 7772 6974 655f 6f64 696d 2873 7263 2c20  write_odim(src, 
-0001a760: 6465 7374 293a 0a20 2020 2022 2222 5772  dest):.    """Wr
-0001a770: 6974 6573 204f 6469 6d20 4174 7472 6962  ites Odim Attrib
-0001a780: 7574 6573 2e0a 0a20 2020 2050 6172 616d  utes...    Param
-0001a790: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-0001a7a0: 2d2d 2d2d 0a20 2020 2073 7263 203a 2064  ----.    src : d
-0001a7b0: 6963 740a 2020 2020 2020 2020 4174 7472  ict.        Attr
-0001a7c0: 6962 7574 6573 2074 6f20 7772 6974 650a  ibutes to write.
-0001a7d0: 2020 2020 6465 7374 203a 2068 616e 646c      dest : handl
-0001a7e0: 650a 2020 2020 2020 2020 6835 7079 2d67  e.        h5py-g
-0001a7f0: 726f 7570 2068 616e 646c 650a 2020 2020  roup handle.    
-0001a800: 2222 220a 2020 2020 666f 7220 6b65 792c  """.    for key,
-0001a810: 2076 616c 7565 2069 6e20 7372 632e 6974   value in src.it
-0001a820: 656d 7328 293a 0a20 2020 2020 2020 2069  ems():.        i
-0001a830: 6620 6b65 7920 696e 2064 6573 742e 6174  f key in dest.at
-0001a840: 7472 733a 0a20 2020 2020 2020 2020 2020  trs:.           
-0001a850: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-0001a860: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001a870: 7661 6c75 652c 2073 7472 293a 0a20 2020  value, str):.   
-0001a880: 2020 2020 2020 2020 2074 6964 203d 2068           tid = h
-0001a890: 3570 792e 6835 742e 435f 5331 2e63 6f70  5py.h5t.C_S1.cop
-0001a8a0: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-0001a8b0: 7469 642e 7365 745f 7369 7a65 286c 656e  tid.set_size(len
-0001a8c0: 2876 616c 7565 2920 2b20 3129 0a20 2020  (value) + 1).   
-0001a8d0: 2020 2020 2020 2020 2048 3554 5f43 5f53           H5T_C_S
-0001a8e0: 315f 4e45 5720 3d20 6835 7079 2e44 6174  1_NEW = h5py.Dat
-0001a8f0: 6174 7970 6528 7469 6429 0a20 2020 2020  atype(tid).     
-0001a900: 2020 2020 2020 2064 6573 742e 6174 7472         dest.attr
-0001a910: 732e 6372 6561 7465 286b 6579 2c20 7661  s.create(key, va
-0001a920: 6c75 652c 2064 7479 7065 3d48 3554 5f43  lue, dtype=H5T_C
-0001a930: 5f53 315f 4e45 5729 0a20 2020 2020 2020  _S1_NEW).       
-0001a940: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001a950: 2020 2064 6573 742e 6174 7472 735b 6b65     dest.attrs[ke
-0001a960: 795d 203d 2076 616c 7565 0a0a 0a64 6566  y] = value...def
-0001a970: 205f 7772 6974 655f 6f64 696d 5f64 6174   _write_odim_dat
-0001a980: 6173 7061 6365 2873 7263 2c20 6465 7374  aspace(src, dest
-0001a990: 293a 0a20 2020 2022 2222 5772 6974 6573  ):.    """Writes
-0001a9a0: 204f 6469 6d20 4461 7461 7370 6163 6573   Odim Dataspaces
-0001a9b0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-0001a9c0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0001a9d0: 0a20 2020 2073 7263 203a 2064 6963 740a  .    src : dict.
-0001a9e0: 2020 2020 2020 2020 4d6f 6d65 6e74 7320          Moments 
-0001a9f0: 746f 2077 7269 7465 0a20 2020 2064 6573  to write.    des
-0001aa00: 7420 3a20 6861 6e64 6c65 0a20 2020 2020  t : handle.     
-0001aa10: 2020 2068 3570 792d 6772 6f75 7020 6861     h5py-group ha
-0001aa20: 6e64 6c65 0a20 2020 2022 2222 0a20 2020  ndle.    """.   
-0001aa30: 206b 6579 7320 3d20 5b6b 6579 2066 6f72   keys = [key for
-0001aa40: 206b 6579 2069 6e20 7372 6320 6966 206b   key in src if k
-0001aa50: 6579 2069 6e20 4f44 494d 5f4e 414d 4553  ey in ODIM_NAMES
-0001aa60: 5d0a 2020 2020 6461 7461 5f6c 6973 7420  ].    data_list 
-0001aa70: 3d20 5b22 6461 7461 7b7d 222e 666f 726d  = ["data{}".form
-0001aa80: 6174 2869 202b 2031 2920 666f 7220 6920  at(i + 1) for i 
-0001aa90: 696e 2072 616e 6765 286c 656e 286b 6579  in range(len(key
-0001aaa0: 7329 295d 0a20 2020 2064 6174 615f 6964  s))].    data_id
-0001aab0: 7820 3d20 6e70 2e61 7267 736f 7274 2864  x = np.argsort(d
-0001aac0: 6174 615f 6c69 7374 290a 2020 2020 666f  ata_list).    fo
-0001aad0: 7220 6964 7820 696e 2064 6174 615f 6964  r idx in data_id
-0001aae0: 783a 0a20 2020 2020 2020 2076 616c 7565  x:.        value
-0001aaf0: 203d 2073 7263 5b6b 6579 735b 6964 785d   = src[keys[idx]
-0001ab00: 5d0a 2020 2020 2020 2020 6835 5f64 6174  ].        h5_dat
-0001ab10: 6120 3d20 6465 7374 2e63 7265 6174 655f  a = dest.create_
-0001ab20: 6772 6f75 7028 6461 7461 5f6c 6973 745b  group(data_list[
-0001ab30: 6964 785d 290a 2020 2020 2020 2020 656e  idx]).        en
-0001ab40: 6320 3d20 7661 6c75 652e 656e 636f 6469  c = value.encodi
-0001ab50: 6e67 0a0a 2020 2020 2020 2020 2320 702e  ng..        # p.
-0001ab60: 2032 3120 6666 0a20 2020 2020 2020 2068   21 ff.        h
-0001ab70: 355f 7768 6174 203d 2068 355f 6461 7461  5_what = h5_data
-0001ab80: 2e63 7265 6174 655f 6772 6f75 7028 2277  .create_group("w
-0001ab90: 6861 7422 290a 2020 2020 2020 2020 7472  hat").        tr
-0001aba0: 793a 0a20 2020 2020 2020 2020 2020 2075  y:.            u
-0001abb0: 6e64 6574 6563 7420 3d20 666c 6f61 7428  ndetect = float(
-0001abc0: 7661 6c75 652e 5f55 6e64 6574 6563 7429  value._Undetect)
-0001abd0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0001abe0: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-0001abf0: 2020 2020 2020 2020 2020 2020 756e 6465              unde
-0001ac00: 7465 6374 203d 206e 702e 6669 6e66 6f28  tect = np.finfo(
-0001ac10: 6e70 2e66 6c6f 6174 292e 6d61 780a 2020  np.float).max.  
-0001ac20: 2020 2020 2020 7768 6174 203d 207b 0a20        what = {. 
-0001ac30: 2020 2020 2020 2020 2020 2022 7175 616e             "quan
-0001ac40: 7469 7479 223a 2076 616c 7565 2e6e 616d  tity": value.nam
-0001ac50: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-0001ac60: 6761 696e 223a 2066 6c6f 6174 2865 6e63  gain": float(enc
-0001ac70: 5b22 7363 616c 655f 6661 6374 6f72 225d  ["scale_factor"]
-0001ac80: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001ac90: 6f66 6673 6574 223a 2066 6c6f 6174 2865  offset": float(e
-0001aca0: 6e63 5b22 6164 645f 6f66 6673 6574 225d  nc["add_offset"]
-0001acb0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001acc0: 6e6f 6461 7461 223a 2066 6c6f 6174 2865  nodata": float(e
-0001acd0: 6e63 5b22 5f46 696c 6c56 616c 7565 225d  nc["_FillValue"]
-0001ace0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0001acf0: 756e 6465 7465 6374 223a 2075 6e64 6574  undetect": undet
-0001ad00: 6563 742c 0a20 2020 2020 2020 207d 0a20  ect,.        }. 
-0001ad10: 2020 2020 2020 205f 7772 6974 655f 6f64         _write_od
-0001ad20: 696d 2877 6861 742c 2068 355f 7768 6174  im(what, h5_what
-0001ad30: 290a 0a20 2020 2020 2020 2023 206d 6f6d  )..        # mom
-0001ad40: 656e 7473 2068 616e 646c 696e 670a 2020  ents handling.  
-0001ad50: 2020 2020 2020 7661 6c20 3d20 7661 6c75        val = valu
-0001ad60: 652e 736f 7274 6279 2822 617a 696d 7574  e.sortby("azimut
-0001ad70: 6822 292e 7661 6c75 6573 0a20 2020 2020  h").values.     
-0001ad80: 2020 2066 696c 6c76 616c 203d 2065 6e63     fillval = enc
-0001ad90: 5b22 5f46 696c 6c56 616c 7565 225d 202a  ["_FillValue"] *
-0001ada0: 2065 6e63 5b22 7363 616c 655f 6661 6374   enc["scale_fact
-0001adb0: 6f72 225d 0a20 2020 2020 2020 2066 696c  or"].        fil
-0001adc0: 6c76 616c 202b 3d20 656e 635b 2261 6464  lval += enc["add
-0001add0: 5f6f 6666 7365 7422 5d0a 2020 2020 2020  _offset"].      
-0001ade0: 2020 7661 6c5b 6e70 2e69 736e 616e 2876    val[np.isnan(v
-0001adf0: 616c 295d 203d 2066 696c 6c76 616c 0a20  al)] = fillval. 
-0001ae00: 2020 2020 2020 2076 616c 203d 2028 7661         val = (va
-0001ae10: 6c20 2d20 656e 635b 2261 6464 5f6f 6666  l - enc["add_off
-0001ae20: 7365 7422 5d29 202f 2065 6e63 5b22 7363  set"]) / enc["sc
-0001ae30: 616c 655f 6661 6374 6f72 225d 0a20 2020  ale_factor"].   
-0001ae40: 2020 2020 2076 616c 203d 206e 702e 7269       val = np.ri
-0001ae50: 6e74 2876 616c 292e 6173 7479 7065 2865  nt(val).astype(e
-0001ae60: 6e63 5b22 6474 7970 6522 5d29 0a20 2020  nc["dtype"]).   
-0001ae70: 2020 2020 2064 7320 3d20 6835 5f64 6174       ds = h5_dat
-0001ae80: 612e 6372 6561 7465 5f64 6174 6173 6574  a.create_dataset
-0001ae90: 280a 2020 2020 2020 2020 2020 2020 2264  (.            "d
-0001aea0: 6174 6122 2c0a 2020 2020 2020 2020 2020  ata",.          
-0001aeb0: 2020 6461 7461 3d76 616c 2c0a 2020 2020    data=val,.    
-0001aec0: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
-0001aed0: 696f 6e3d 2267 7a69 7022 2c0a 2020 2020  ion="gzip",.    
-0001aee0: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
-0001aef0: 696f 6e5f 6f70 7473 3d36 2c0a 2020 2020  ion_opts=6,.    
-0001af00: 2020 2020 2020 2020 6669 6c6c 7661 6c75          fillvalu
-0001af10: 653d 656e 635b 225f 4669 6c6c 5661 6c75  e=enc["_FillValu
-0001af20: 6522 5d2c 0a20 2020 2020 2020 2029 0a20  e"],.        ). 
-0001af30: 2020 2020 2020 2069 6620 656e 635b 2264         if enc["d
-0001af40: 7479 7065 225d 203d 3d20 2275 696e 7438  type"] == "uint8
-0001af50: 223a 0a20 2020 2020 2020 2020 2020 2069  ":.            i
-0001af60: 6d61 6765 203d 2022 494d 4147 4522 0a20  mage = "IMAGE". 
-0001af70: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-0001af80: 6f6e 203d 2022 312e 3222 0a20 2020 2020  on = "1.2".     
-0001af90: 2020 2020 2020 2074 6964 3120 3d20 6835         tid1 = h5
-0001afa0: 7079 2e68 3574 2e43 5f53 312e 636f 7079  py.h5t.C_S1.copy
-0001afb0: 2829 0a20 2020 2020 2020 2020 2020 2074  ().            t
-0001afc0: 6964 312e 7365 745f 7369 7a65 286c 656e  id1.set_size(len
-0001afd0: 2869 6d61 6765 2920 2b20 3129 0a20 2020  (image) + 1).   
-0001afe0: 2020 2020 2020 2020 2048 3554 5f43 5f53           H5T_C_S
-0001aff0: 315f 494d 4720 3d20 6835 7079 2e44 6174  1_IMG = h5py.Dat
-0001b000: 6174 7970 6528 7469 6431 290a 2020 2020  atype(tid1).    
-0001b010: 2020 2020 2020 2020 7469 6432 203d 2068          tid2 = h
-0001b020: 3570 792e 6835 742e 435f 5331 2e63 6f70  5py.h5t.C_S1.cop
-0001b030: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-0001b040: 7469 6432 2e73 6574 5f73 697a 6528 6c65  tid2.set_size(le
-0001b050: 6e28 7665 7273 696f 6e29 202b 2031 290a  n(version) + 1).
-0001b060: 2020 2020 2020 2020 2020 2020 4835 545f              H5T_
-0001b070: 435f 5331 5f56 4552 203d 2068 3570 792e  C_S1_VER = h5py.
-0001b080: 4461 7461 7479 7065 2874 6964 3229 0a20  Datatype(tid2). 
-0001b090: 2020 2020 2020 2020 2020 2064 732e 6174             ds.at
-0001b0a0: 7472 732e 6372 6561 7465 2822 434c 4153  trs.create("CLAS
-0001b0b0: 5322 2c20 696d 6167 652c 2064 7479 7065  S", image, dtype
-0001b0c0: 3d48 3554 5f43 5f53 315f 494d 4729 0a20  =H5T_C_S1_IMG). 
-0001b0d0: 2020 2020 2020 2020 2020 2064 732e 6174             ds.at
-0001b0e0: 7472 732e 6372 6561 7465 2822 494d 4147  trs.create("IMAG
-0001b0f0: 455f 5645 5253 494f 4e22 2c20 7665 7273  E_VERSION", vers
-0001b100: 696f 6e2c 2064 7479 7065 3d48 3554 5f43  ion, dtype=H5T_C
-0001b110: 5f53 315f 5645 5229 0a0a 0a64 6566 205f  _S1_VER)...def _
-0001b120: 6f70 656e 5f64 6174 6173 6574 286e 6368  open_dataset(nch
-0001b130: 2c20 6772 703d 4e6f 6e65 2c20 2a2a 6b77  , grp=None, **kw
-0001b140: 6172 6773 293a 0a20 2020 2022 2222 4f70  args):.    """Op
-0001b150: 656e 206e 6574 6364 6634 2f68 6466 3520  en netcdf4/hdf5 
-0001b160: 6772 6f75 7020 6173 2078 6172 7261 7920  group as xarray 
-0001b170: 6461 7461 7365 742e 0a0a 2020 2020 5061  dataset...    Pa
-0001b180: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-0001b190: 2d2d 2d2d 2d2d 2d0a 2020 2020 6e63 6820  -------.    nch 
-0001b1a0: 3a20 6861 6e64 6c65 0a20 2020 2020 2020  : handle.       
-0001b1b0: 206e 6574 6364 6634 2d66 696c 6520 6861   netcdf4-file ha
-0001b1c0: 6e64 6c65 0a20 2020 2067 7270 203a 2073  ndle.    grp : s
-0001b1d0: 7472 0a20 2020 2020 2020 2067 726f 7570  tr.        group
-0001b1e0: 2074 6f20 6163 6365 7373 0a0a 2020 2020   to access..    
-0001b1f0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-0001b200: 2d2d 2d0a 2020 2020 6e63 6820 3a20 6861  ---.    nch : ha
-0001b210: 6e64 6c65 0a20 2020 2020 2020 2078 6172  ndle.        xar
-0001b220: 7261 7920 4461 7461 7365 7420 6861 6e64  ray Dataset hand
-0001b230: 6c65 0a20 2020 2022 2222 0a20 2020 2069  le.    """.    i
-0001b240: 6620 6772 7020 6973 206e 6f74 204e 6f6e  f grp is not Non
-0001b250: 653a 0a20 2020 2020 2020 206e 6368 203d  e:.        nch =
-0001b260: 206e 6368 2e67 726f 7570 732e 6765 7428   nch.groups.get(
-0001b270: 6772 702c 2046 616c 7365 290a 2020 2020  grp, False).    
-0001b280: 6966 206e 6368 3a0a 2020 2020 2020 2020  if nch:.        
-0001b290: 6e63 6820 3d20 7872 2e6f 7065 6e5f 6461  nch = xr.open_da
-0001b2a0: 7461 7365 7428 7872 2e62 6163 6b65 6e64  taset(xr.backend
-0001b2b0: 732e 4e65 7443 4446 3444 6174 6153 746f  s.NetCDF4DataSto
-0001b2c0: 7265 286e 6368 292c 202a 2a6b 7761 7267  re(nch), **kwarg
-0001b2d0: 7329 0a20 2020 2072 6574 7572 6e20 6e63  s).    return nc
-0001b2e0: 680a 0a0a 6465 6620 5f67 6574 5f67 616d  h...def _get_gam
-0001b2f0: 6963 5f72 6179 5f68 6561 6465 7228 6669  ic_ray_header(fi
-0001b300: 6c65 6e61 6d65 2c20 7363 616e 293a 0a20  lename, scan):. 
-0001b310: 2020 2022 2222 5265 7475 726e 7320 4741     """Returns GA
-0001b320: 4d49 4320 7261 7920 6865 6164 6572 2064  MIC ray header d
-0001b330: 6963 7469 6f6e 6172 792e 0a0a 2020 2020  ictionary...    
-0001b340: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001b350: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6669  ---------.    fi
-0001b360: 6c65 6e61 6d65 203a 2073 7472 0a20 2020  lename : str.   
-0001b370: 2020 2020 2066 696c 656e 616d 6520 6f66       filename of
-0001b380: 2047 414d 4943 2066 696c 650a 2020 2020   GAMIC file.    
-0001b390: 7363 616e 203a 2069 6e74 0a20 2020 2020  scan : int.     
-0001b3a0: 2020 204e 756d 6265 7220 6f66 2073 6361     Number of sca
-0001b3b0: 6e20 696e 2066 696c 650a 0a20 2020 2052  n in file..    R
-0001b3c0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-0001b3d0: 2d2d 0a20 2020 2076 6172 7320 3a20 6469  --.    vars : di
-0001b3e0: 6374 0a20 2020 2020 2020 204f 7264 6572  ct.        Order
-0001b3f0: 6564 4469 6374 206f 6620 7261 7920 6865  edDict of ray he
-0001b400: 6164 6572 2069 7465 6d73 0a20 2020 2022  ader items.    "
-0001b410: 2222 0a20 2020 2023 2054 6f44 6f3a 206d  "".    # ToDo: m
-0001b420: 6f76 6520 7261 7968 6561 6465 7220 696e  ove rayheader in
-0001b430: 746f 206f 776e 2064 6174 6173 6574 0a20  to own dataset. 
-0001b440: 2020 2068 3520 3d20 6835 7079 2e46 696c     h5 = h5py.Fil
-0001b450: 6528 6669 6c65 6e61 6d65 2c20 6d6f 6465  e(filename, mode
-0001b460: 3d22 7222 290a 2020 2020 7261 795f 6865  ="r").    ray_he
-0001b470: 6164 6572 203d 2068 355b 2273 6361 6e7b  ader = h5["scan{
-0001b480: 7d2f 7261 795f 6865 6164 6572 222e 666f  }/ray_header".fo
-0001b490: 726d 6174 2873 6361 6e29 5d5b 3a5d 0a20  rmat(scan)][:]. 
-0001b4a0: 2020 2068 352e 636c 6f73 6528 290a 2020     h5.close().  
-0001b4b0: 2020 7661 7273 203d 2063 6f6c 6c65 6374    vars = collect
-0001b4c0: 696f 6e73 2e4f 7264 6572 6564 4469 6374  ions.OrderedDict
-0001b4d0: 2829 0a20 2020 2066 6f72 206e 616d 6520  ().    for name 
-0001b4e0: 696e 2072 6179 5f68 6561 6465 722e 6474  in ray_header.dt
-0001b4f0: 7970 652e 6e61 6d65 733a 0a20 2020 2020  ype.names:.     
-0001b500: 2020 2072 6820 3d20 7261 795f 6865 6164     rh = ray_head
-0001b510: 6572 5b6e 616d 655d 0a20 2020 2020 2020  er[name].       
-0001b520: 2061 7474 7273 203d 204e 6f6e 650a 2020   attrs = None.  
-0001b530: 2020 2020 2020 7661 7273 2e75 7064 6174        vars.updat
-0001b540: 6528 7b6e 616d 653a 2028 5b22 6469 6d5f  e({name: (["dim_
-0001b550: 3022 5d2c 2072 682c 2061 7474 7273 297d  0"], rh, attrs)}
-0001b560: 290a 2020 2020 7265 7475 726e 2076 6172  ).    return var
-0001b570: 730a 0a0a 6465 6620 5f67 6574 5f6f 6469  s...def _get_odi
-0001b580: 6d5f 7377 6565 705f 6772 6f75 705f 6e61  m_sweep_group_na
-0001b590: 6d65 7328 6e63 682c 206e 616d 6529 3a0a  mes(nch, name):.
-0001b5a0: 2020 2020 2222 2252 6574 7572 6e20 7377      """Return sw
-0001b5b0: 6565 7020 6e61 6d65 732e 0a0a 2020 2020  eep names...    
-0001b5c0: 5265 7475 726e 7320 736f 7572 6365 206e  Returns source n
-0001b5d0: 616d 6573 2061 6e64 2063 6672 6164 6961  ames and cfradia
-0001b5e0: 6c20 6e61 6d65 732e 0a0a 2020 2020 5061  l names...    Pa
-0001b5f0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-0001b600: 2d2d 2d2d 2d2d 2d0a 2020 2020 6e63 6820  -------.    nch 
-0001b610: 3a20 6861 6e64 6c65 0a20 2020 2020 2020  : handle.       
-0001b620: 206e 6574 4344 4634 2044 6174 6173 6574   netCDF4 Dataset
-0001b630: 2068 616e 646c 650a 2020 2020 6e61 6d65   handle.    name
-0001b640: 203a 2073 7472 0a20 2020 2020 2020 2043   : str.        C
-0001b650: 6f6d 6d6f 6e20 7061 7274 206f 6620 736f  ommon part of so
-0001b660: 7572 6365 2064 6174 6173 6574 206e 616d  urce dataset nam
-0001b670: 6573 2e0a 0a20 2020 2052 6574 7572 6e73  es...    Returns
-0001b680: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-0001b690: 2073 7263 203a 206c 6973 740a 2020 2020   src : list.    
-0001b6a0: 2020 2020 6c69 7374 206f 6620 736f 7572      list of sour
-0001b6b0: 6365 2064 6174 6173 6574 206e 616d 6573  ce dataset names
-0001b6c0: 0a20 2020 2073 7767 5f67 7270 5f6e 616d  .    swg_grp_nam
-0001b6d0: 6520 3a20 6c69 7374 0a20 2020 2020 2020  e : list.       
-0001b6e0: 206c 6973 7420 6f66 2063 6f72 7265 7370   list of corresp
-0001b6f0: 6f6e 6469 6e67 2063 6672 6164 6961 6c20  onding cfradial 
-0001b700: 7377 6565 705f 6772 6f75 705f 6e61 6d65  sweep_group_name
-0001b710: 0a20 2020 2022 2222 0a20 2020 2073 7263  .    """.    src
-0001b720: 203d 205b 6b65 7920 666f 7220 6b65 7920   = [key for key 
-0001b730: 696e 206e 6368 2e67 726f 7570 732e 6b65  in nch.groups.ke
-0001b740: 7973 2829 2069 6620 6e61 6d65 2069 6e20  ys() if name in 
-0001b750: 6b65 795d 0a20 2020 2073 7263 2e73 6f72  key].    src.sor
-0001b760: 7428 6b65 793d 6c61 6d62 6461 2078 3a20  t(key=lambda x: 
-0001b770: 696e 7428 785b 6c65 6e28 6e61 6d65 2920  int(x[len(name) 
-0001b780: 3a5d 2929 0a20 2020 2073 7770 5f67 7270  :])).    swp_grp
-0001b790: 5f6e 616d 6520 3d20 5b22 7377 6565 705f  _name = ["sweep_
-0001b7a0: 7b7d 222e 666f 726d 6174 2869 2920 666f  {}".format(i) fo
-0001b7b0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-0001b7c0: 6c65 6e28 7372 6329 202b 2031 295d 0a20  len(src) + 1)]. 
-0001b7d0: 2020 2072 6574 7572 6e20 7372 632c 2073     return src, s
-0001b7e0: 7770 5f67 7270 5f6e 616d 650a 0a0a 6465  wp_grp_name...de
-0001b7f0: 6620 5f67 6574 5f6f 6469 6d5f 7661 7269  f _get_odim_vari
-0001b800: 6162 6c65 735f 6d6f 6d65 6e74 7328 6473  ables_moments(ds
-0001b810: 2c20 6d6f 6d65 6e74 733d 4e6f 6e65 2c20  , moments=None, 
-0001b820: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
-0001b830: 2222 5265 7472 6965 7665 2072 6164 6172  ""Retrieve radar
-0001b840: 206d 6f6d 656e 7473 2066 726f 6d20 6461   moments from da
-0001b850: 7461 7365 7420 7661 7269 6162 6c65 732e  taset variables.
-0001b860: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0001b870: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-0001b880: 2020 2020 6473 203a 2078 6172 7261 7920      ds : xarray 
-0001b890: 6461 7461 7365 740a 2020 2020 2020 2020  dataset.        
-0001b8a0: 736f 7572 6365 2064 6174 6173 6574 0a20  source dataset. 
-0001b8b0: 2020 206d 6f6d 656e 7473 203a 206c 6973     moments : lis
-0001b8c0: 740a 2020 2020 2020 2020 6c69 7374 206f  t.        list o
-0001b8d0: 6620 6d6f 6d65 6e74 2073 7472 696e 6773  f moment strings
-0001b8e0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-0001b8f0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6473    -------.    ds
-0001b900: 203a 2078 6172 7261 7920 4461 7461 7365   : xarray Datase
-0001b910: 740a 2020 2020 2020 2020 616c 7465 7265  t.        altere
-0001b920: 6420 6461 7461 7365 740a 2020 2020 2222  d dataset.    ""
-0001b930: 220a 0a20 2020 2073 7461 6e64 6172 6420  "..    standard 
-0001b940: 3d20 6b77 6172 6773 2e67 6574 2822 7374  = kwargs.get("st
-0001b950: 616e 6461 7264 222c 2022 6366 2d6d 616e  andard", "cf-man
-0001b960: 6461 746f 7279 2229 0a20 2020 206d 6173  datory").    mas
-0001b970: 6b5f 616e 645f 7363 616c 6520 3d20 6b77  k_and_scale = kw
-0001b980: 6172 6773 2e67 6574 2822 6d61 736b 5f61  args.get("mask_a
-0001b990: 6e64 5f73 6361 6c65 222c 2054 7275 6529  nd_scale", True)
-0001b9a0: 0a20 2020 2064 6563 6f64 655f 636f 6f72  .    decode_coor
-0001b9b0: 6473 203d 206b 7761 7267 732e 6765 7428  ds = kwargs.get(
-0001b9c0: 2264 6563 6f64 655f 636f 6f72 6473 222c  "decode_coords",
-0001b9d0: 2054 7275 6529 0a0a 2020 2020 2320 6669   True)..    # fi
-0001b9e0: 7820 6469 6d65 6e73 696f 6e73 0a20 2020  x dimensions.   
-0001b9f0: 2064 696d 7320 3d20 736f 7274 6564 286c   dims = sorted(l
-0001ba00: 6973 7428 6473 2e64 696d 732e 6b65 7973  ist(ds.dims.keys
-0001ba10: 2829 292c 206b 6579 3d6c 616d 6264 6120  ()), key=lambda 
-0001ba20: 783a 2069 6e74 2878 5b6c 656e 2822 7068  x: int(x[len("ph
-0001ba30: 6f6e 795f 6469 6d5f 2229 203a 5d29 290a  ony_dim_") :])).
-0001ba40: 0a20 2020 2064 7320 3d20 6473 2e72 656e  .    ds = ds.ren
-0001ba50: 616d 6528 7b64 696d 735b 305d 3a20 2264  ame({dims[0]: "d
-0001ba60: 696d 5f30 222c 2064 696d 735b 315d 3a20  im_0", dims[1]: 
-0001ba70: 2264 696d 5f31 227d 290a 0a20 2020 2066  "dim_1"})..    f
-0001ba80: 6f72 206d 6f6d 2069 6e20 6d6f 6d65 6e74  or mom in moment
-0001ba90: 733a 0a20 2020 2020 2020 2023 206f 7065  s:.        # ope
-0001baa0: 6e20 6461 7461 5820 6461 7461 7365 740a  n dataX dataset.
-0001bab0: 2020 2020 2020 2020 646d 6f6d 203d 2064          dmom = d
-0001bac0: 735b 6d6f 6d5d 0a20 2020 2020 2020 206e  s[mom].        n
-0001bad0: 616d 6520 3d20 646d 6f6d 2e6d 6f6d 656e  ame = dmom.momen
-0001bae0: 742e 6c6f 7765 7228 290a 2020 2020 2020  t.lower().      
-0001baf0: 2020 6966 2022 6366 2220 696e 2073 7461    if "cf" in sta
-0001bb00: 6e64 6172 6420 616e 6420 6e61 6d65 206e  ndard and name n
-0001bb10: 6f74 2069 6e20 4741 4d49 435f 4e41 4d45  ot in GAMIC_NAME
-0001bb20: 532e 6b65 7973 2829 3a0a 2020 2020 2020  S.keys():.      
-0001bb30: 2020 2020 2020 6473 203d 2064 732e 6472        ds = ds.dr
-0001bb40: 6f70 5f76 6172 7328 6d6f 6d29 0a20 2020  op_vars(mom).   
-0001bb50: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0001bb60: 650a 0a20 2020 2020 2020 2023 2065 7874  e..        # ext
-0001bb70: 7261 6374 2061 7474 7269 6275 7465 730a  ract attributes.
-0001bb80: 2020 2020 2020 2020 646d 6178 203d 206e          dmax = n
-0001bb90: 702e 6969 6e66 6f28 646d 6f6d 2e64 7479  p.iinfo(dmom.dty
-0001bba0: 7065 292e 6d61 780a 2020 2020 2020 2020  pe).max.        
-0001bbb0: 646d 696e 203d 206e 702e 6969 6e66 6f28  dmin = np.iinfo(
-0001bbc0: 646d 6f6d 2e64 7479 7065 292e 6d69 6e0a  dmom.dtype).min.
-0001bbd0: 2020 2020 2020 2020 6d69 6e76 616c 203d          minval =
-0001bbe0: 2064 6d6f 6d2e 6479 6e5f 7261 6e67 655f   dmom.dyn_range_
-0001bbf0: 6d69 6e0a 2020 2020 2020 2020 6d61 7876  min.        maxv
-0001bc00: 616c 203d 2064 6d6f 6d2e 6479 6e5f 7261  al = dmom.dyn_ra
-0001bc10: 6e67 655f 6d61 780a 2020 2020 2020 2020  nge_max.        
-0001bc20: 6761 696e 203d 2028 6d61 7876 616c 202d  gain = (maxval -
-0001bc30: 206d 696e 7661 6c29 202f 2064 6d61 780a   minval) / dmax.
-0001bc40: 2020 2020 2020 2020 6f66 6673 6574 203d          offset =
-0001bc50: 206d 696e 7661 6c0a 2020 2020 2020 2020   minval.        
-0001bc60: 6669 6c6c 7661 6c20 3d20 666c 6f61 7428  fillval = float(
-0001bc70: 646d 6178 290a 2020 2020 2020 2020 756e  dmax).        un
-0001bc80: 6465 7465 6374 203d 2066 6c6f 6174 2864  detect = float(d
-0001bc90: 6d69 6e29 0a0a 2020 2020 2020 2020 2320  min)..        # 
-0001bca0: 6372 6561 7465 2061 7474 7269 6275 7465  create attribute
-0001bcb0: 2064 6963 740a 2020 2020 2020 2020 6174   dict.        at
-0001bcc0: 7472 7320 3d20 636f 6c6c 6563 7469 6f6e  trs = collection
-0001bcd0: 732e 4f72 6465 7265 6444 6963 7428 290a  s.OrderedDict().
-0001bce0: 2020 2020 2020 2020 2320 636c 6561 6e20          # clean 
-0001bcf0: 6d6f 6d65 6e74 2061 7474 7269 6275 7465  moment attribute
-0001bd00: 730a 2020 2020 2020 2020 6966 2073 7461  s.        if sta
-0001bd10: 6e64 6172 6420 213d 2022 6e6f 6e65 223a  ndard != "none":
-0001bd20: 0a20 2020 2020 2020 2020 2020 2064 6d6f  .            dmo
-0001bd30: 6d2e 6174 7472 7320 3d20 636f 6c6c 6563  m.attrs = collec
-0001bd40: 7469 6f6e 732e 4f72 6465 7265 6444 6963  tions.OrderedDic
-0001bd50: 7428 290a 0a20 2020 2020 2020 2069 6620  t()..        if 
-0001bd60: 7374 616e 6461 7264 2069 6e20 5b22 6f64  standard in ["od
-0001bd70: 696d 225d 3a0a 2020 2020 2020 2020 2020  im"]:.          
-0001bd80: 2020 6174 7472 735b 2267 6169 6e22 5d20    attrs["gain"] 
-0001bd90: 3d20 6761 696e 0a20 2020 2020 2020 2020  = gain.         
-0001bda0: 2020 2061 7474 7273 5b22 6f66 6673 6574     attrs["offset
-0001bdb0: 225d 203d 206f 6666 7365 740a 2020 2020  "] = offset.    
-0001bdc0: 2020 2020 2020 2020 6174 7472 735b 226e          attrs["n
-0001bdd0: 6f64 6174 6122 5d20 3d20 6669 6c6c 7661  odata"] = fillva
-0001bde0: 6c0a 2020 2020 2020 2020 2020 2020 6174  l.            at
-0001bdf0: 7472 735b 2275 6e64 6574 6563 7422 5d20  trs["undetect"] 
-0001be00: 3d20 756e 6465 7465 6374 0a0a 2020 2020  = undetect..    
-0001be10: 2020 2020 2320 6164 6420 6366 7261 6469      # add cfradi
-0001be20: 616c 206d 6f6d 656e 7420 6174 7472 6962  al moment attrib
-0001be30: 7574 6573 0a20 2020 2020 2020 2069 6620  utes.        if 
-0001be40: 2263 6622 2069 6e20 7374 616e 6461 7264  "cf" in standard
-0001be50: 206f 7220 6d61 736b 5f61 6e64 5f73 6361   or mask_and_sca
-0001be60: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-0001be70: 6174 7472 735b 2273 6361 6c65 5f66 6163  attrs["scale_fac
-0001be80: 746f 7222 5d20 3d20 6761 696e 0a20 2020  tor"] = gain.   
-0001be90: 2020 2020 2020 2020 2061 7474 7273 5b22           attrs["
-0001bea0: 6164 645f 6f66 6673 6574 225d 203d 206d  add_offset"] = m
-0001beb0: 696e 7661 6c0a 2020 2020 2020 2020 2020  inval.          
-0001bec0: 2020 6174 7472 735b 225f 4669 6c6c 5661    attrs["_FillVa
-0001bed0: 6c75 6522 5d20 3d20 666c 6f61 7428 646d  lue"] = float(dm
-0001bee0: 6178 290a 0a20 2020 2020 2020 2069 6620  ax)..        if 
-0001bef0: 2263 6622 2069 6e20 7374 616e 6461 7264  "cf" in standard
-0001bf00: 206f 7220 6465 636f 6465 5f63 6f6f 7264   or decode_coord
-0001bf10: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-0001bf20: 7474 7273 5b22 636f 6f72 6469 6e61 7465  ttrs["coordinate
-0001bf30: 7322 5d20 3d20 2265 6c65 7661 7469 6f6e  s"] = "elevation
-0001bf40: 2061 7a69 6d75 7468 2072 616e 6765 220a   azimuth range".
-0001bf50: 0a20 2020 2020 2020 2069 6620 2266 756c  .        if "ful
-0001bf60: 6c22 2069 6e20 7374 616e 6461 7264 3a0a  l" in standard:.
-0001bf70: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0001bf80: 735b 225f 556e 6465 7465 6374 225d 203d  s["_Undetect"] =
-0001bf90: 2075 6e64 6574 6563 740a 0a20 2020 2020   undetect..     
-0001bfa0: 2020 2069 6620 2263 6622 2069 6e20 7374     if "cf" in st
-0001bfb0: 616e 6461 7264 3a0a 2020 2020 2020 2020  andard:.        
-0001bfc0: 2020 2020 6366 6e61 6d65 203d 2047 414d      cfname = GAM
-0001bfd0: 4943 5f4e 414d 4553 5b6e 616d 655d 0a20  IC_NAMES[name]. 
-0001bfe0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0001bff0: 2c20 7620 696e 206d 6f6d 656e 7473 5f6d  , v in moments_m
-0001c000: 6170 7069 6e67 5b63 666e 616d 655d 2e69  apping[cfname].i
-0001c010: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0001c020: 2020 2020 2020 2020 6174 7472 735b 6b5d          attrs[k]
-0001c030: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
-0001c040: 206e 616d 6520 3d20 6174 7472 732e 706f   name = attrs.po
-0001c050: 7028 2273 686f 7274 5f6e 616d 6522 290a  p("short_name").
-0001c060: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0001c070: 732e 706f 7028 2267 616d 6963 2229 0a0a  s.pop("gamic")..
-0001c080: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
-0001c090: 2061 7474 7269 6275 7465 7320 746f 206d   attributes to m
-0001c0a0: 6f6d 656e 740a 2020 2020 2020 2020 646d  oment.        dm
-0001c0b0: 6f6d 2e61 7474 7273 2e75 7064 6174 6528  om.attrs.update(
-0001c0c0: 6174 7472 7329 0a0a 2020 2020 2020 2020  attrs)..        
-0001c0d0: 2320 6b65 6570 206f 7269 6769 6e61 6c20  # keep original 
-0001c0e0: 6461 7461 7365 7420 6e61 6d65 0a20 2020  dataset name.   
-0001c0f0: 2020 2020 2069 6620 7374 616e 6461 7264       if standard
-0001c100: 2021 3d20 226e 6f6e 6522 3a0a 2020 2020   != "none":.    
-0001c110: 2020 2020 2020 2020 6473 203d 2064 732e          ds = ds.
-0001c120: 7265 6e61 6d65 287b 6d6f 6d3a 206e 616d  rename({mom: nam
-0001c130: 652e 7570 7065 7228 297d 290a 0a20 2020  e.upper()})..   
-0001c140: 2072 6574 7572 6e20 6473 0a0a 0a64 6566   return ds...def
-0001c150: 205f 6765 745f 6f64 696d 5f67 726f 7570   _get_odim_group
-0001c160: 5f6d 6f6d 656e 7473 286e 6368 2c20 7377  _moments(nch, sw
-0001c170: 6565 702c 206d 6f6d 656e 7473 3d4e 6f6e  eep, moments=Non
-0001c180: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-0001c190: 2020 2222 2252 6574 7269 6576 6520 7261    """Retrieve ra
-0001c1a0: 6461 7220 6d6f 6d65 6e74 7320 6672 6f6d  dar moments from
-0001c1b0: 2068 6466 2067 726f 7570 732e 0a0a 2020   hdf groups...  
-0001c1c0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0001c1d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0001c1e0: 6e63 6820 3a20 6e65 7443 4446 2044 6174  nch : netCDF Dat
-0001c1f0: 6173 6574 2068 616e 646c 650a 2020 2020  aset handle.    
-0001c200: 7377 6565 7020 3a20 7374 720a 2020 2020  sweep : str.    
-0001c210: 2020 2020 7377 6565 7020 6b65 790a 2020      sweep key.  
-0001c220: 2020 6d6f 6d65 6e74 7320 3a20 6c69 7374    moments : list
-0001c230: 0a20 2020 2020 2020 206c 6973 7420 6f66  .        list of
-0001c240: 206d 6f6d 656e 7420 7374 7269 6e67 730a   moment strings.
-0001c250: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-0001c260: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 7320   -------.    ds 
-0001c270: 3a20 6469 6374 696f 6e61 7279 0a20 2020  : dictionary.   
-0001c280: 2020 2020 206d 6f6d 656e 7420 6461 7461       moment data
-0001c290: 7365 7473 0a20 2020 2022 2222 0a0a 2020  sets.    """..  
-0001c2a0: 2020 7374 616e 6461 7264 203d 206b 7761    standard = kwa
-0001c2b0: 7267 732e 6765 7428 2273 7461 6e64 6172  rgs.get("standar
-0001c2c0: 6422 2c20 2263 662d 6d61 6e64 6174 6f72  d", "cf-mandator
-0001c2d0: 7922 290a 2020 2020 6d61 736b 5f61 6e64  y").    mask_and
-0001c2e0: 5f73 6361 6c65 203d 206b 7761 7267 732e  _scale = kwargs.
-0001c2f0: 6765 7428 226d 6173 6b5f 616e 645f 7363  get("mask_and_sc
-0001c300: 616c 6522 2c20 5472 7565 290a 2020 2020  ale", True).    
-0001c310: 6465 636f 6465 5f63 6f6f 7264 7320 3d20  decode_coords = 
-0001c320: 6b77 6172 6773 2e67 6574 2822 6465 636f  kwargs.get("deco
-0001c330: 6465 5f63 6f6f 7264 7322 2c20 5472 7565  de_coords", True
-0001c340: 290a 2020 2020 6368 756e 6b73 203d 206b  ).    chunks = k
-0001c350: 7761 7267 732e 6765 7428 2263 6875 6e6b  wargs.get("chunk
-0001c360: 7322 2c20 4e6f 6e65 290a 0a20 2020 2064  s", None)..    d
-0001c370: 6174 6173 203d 207b 7d0a 2020 2020 666f  atas = {}.    fo
-0001c380: 7220 6d6f 6d20 696e 206d 6f6d 656e 7473  r mom in moments
-0001c390: 3a0a 2020 2020 2020 2020 646d 6f6d 5f77  :.        dmom_w
-0001c3a0: 6861 7420 3d20 5f6f 7065 6e5f 6461 7461  hat = _open_data
-0001c3b0: 7365 7428 6e63 685b 7377 6565 705d 5b6d  set(nch[sweep][m
-0001c3c0: 6f6d 5d2c 2022 7768 6174 222c 2063 6875  om], "what", chu
-0001c3d0: 6e6b 733d 6368 756e 6b73 290a 2020 2020  nks=chunks).    
-0001c3e0: 2020 2020 6e61 6d65 203d 2064 6d6f 6d5f      name = dmom_
-0001c3f0: 7768 6174 2e61 7474 7273 2e70 6f70 2822  what.attrs.pop("
-0001c400: 7175 616e 7469 7479 2229 0a20 2020 2020  quantity").     
-0001c410: 2020 2069 6620 2263 6622 2069 6e20 7374     if "cf" in st
-0001c420: 616e 6461 7264 2061 6e64 206e 616d 6520  andard and name 
-0001c430: 6e6f 7420 696e 206d 6f6d 656e 7473 5f6d  not in moments_m
-0001c440: 6170 7069 6e67 2e6b 6579 7328 293a 0a20  apping.keys():. 
-0001c450: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-0001c460: 6e75 650a 2020 2020 2020 2020 6473 6d6f  nue.        dsmo
-0001c470: 6d20 3d20 5f6f 7065 6e5f 6461 7461 7365  m = _open_datase
-0001c480: 7428 6e63 685b 7377 6565 705d 2c20 6d6f  t(nch[sweep], mo
-0001c490: 6d2c 2063 6875 6e6b 733d 6368 756e 6b73  m, chunks=chunks
-0001c4a0: 290a 0a20 2020 2020 2020 2023 2063 7265  )..        # cre
-0001c4b0: 6174 6520 6174 7472 6962 7574 6520 6469  ate attribute di
-0001c4c0: 6374 0a20 2020 2020 2020 2061 7474 7273  ct.        attrs
-0001c4d0: 203d 2063 6f6c 6c65 6374 696f 6e73 2e4f   = collections.O
-0001c4e0: 7264 6572 6564 4469 6374 2829 0a0a 2020  rderedDict()..  
-0001c4f0: 2020 2020 2020 6966 2073 7461 6e64 6172        if standar
-0001c500: 6420 696e 205b 226f 6469 6d22 5d3a 0a20  d in ["odim"]:. 
-0001c510: 2020 2020 2020 2020 2020 2061 7474 7273             attrs
-0001c520: 2e75 7064 6174 6528 646d 6f6d 5f77 6861  .update(dmom_wha
-0001c530: 742e 6174 7472 7329 0a0a 2020 2020 2020  t.attrs)..      
-0001c540: 2020 2320 6164 6420 6366 7261 6469 616c    # add cfradial
-0001c550: 206d 6f6d 656e 7420 6174 7472 6962 7574   moment attribut
-0001c560: 6573 0a20 2020 2020 2020 2069 6620 2263  es.        if "c
-0001c570: 6622 2069 6e20 7374 616e 6461 7264 206f  f" in standard o
-0001c580: 7220 6d61 736b 5f61 6e64 5f73 6361 6c65  r mask_and_scale
-0001c590: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-0001c5a0: 7472 735b 2273 6361 6c65 5f66 6163 746f  trs["scale_facto
-0001c5b0: 7222 5d20 3d20 646d 6f6d 5f77 6861 742e  r"] = dmom_what.
-0001c5c0: 6174 7472 732e 6765 7428 2267 6169 6e22  attrs.get("gain"
-0001c5d0: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
-0001c5e0: 7472 735b 2261 6464 5f6f 6666 7365 7422  trs["add_offset"
-0001c5f0: 5d20 3d20 646d 6f6d 5f77 6861 742e 6174  ] = dmom_what.at
-0001c600: 7472 732e 6765 7428 226f 6666 7365 7422  trs.get("offset"
-0001c610: 290a 2020 2020 2020 2020 2020 2020 6174  ).            at
-0001c620: 7472 735b 225f 4669 6c6c 5661 6c75 6522  trs["_FillValue"
-0001c630: 5d20 3d20 646d 6f6d 5f77 6861 742e 6174  ] = dmom_what.at
-0001c640: 7472 732e 6765 7428 226e 6f64 6174 6122  trs.get("nodata"
-0001c650: 290a 2020 2020 2020 2020 6966 2022 6366  ).        if "cf
-0001c660: 2220 696e 2073 7461 6e64 6172 6420 6f72  " in standard or
-0001c670: 2064 6563 6f64 655f 636f 6f72 6473 3a0a   decode_coords:.
-0001c680: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0001c690: 735b 2263 6f6f 7264 696e 6174 6573 225d  s["coordinates"]
-0001c6a0: 203d 2022 656c 6576 6174 696f 6e20 617a   = "elevation az
-0001c6b0: 696d 7574 6820 7261 6e67 6522 0a20 2020  imuth range".   
-0001c6c0: 2020 2020 2069 6620 2263 6622 2069 6e20       if "cf" in 
-0001c6d0: 7374 616e 6461 7264 3a0a 2020 2020 2020  standard:.      
-0001c6e0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-0001c6f0: 6e20 6d6f 6d65 6e74 735f 6d61 7070 696e  n moments_mappin
-0001c700: 675b 6e61 6d65 5d2e 6974 656d 7328 293a  g[name].items():
-0001c710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c720: 2061 7474 7273 5b6b 5d20 3d20 760a 2020   attrs[k] = v.  
-0001c730: 2020 2020 2020 2020 2020 2320 6472 6f70            # drop
-0001c740: 2073 686f 7274 5f6e 616d 650a 2020 2020   short_name.    
-0001c750: 2020 2020 2020 2020 6174 7472 732e 706f          attrs.po
-0001c760: 7028 2273 686f 7274 5f6e 616d 6522 290a  p("short_name").
-0001c770: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0001c780: 732e 706f 7028 2267 616d 6963 2229 0a20  s.pop("gamic"). 
-0001c790: 2020 2020 2020 2069 6620 2266 756c 6c22         if "full"
-0001c7a0: 2069 6e20 7374 616e 6461 7264 3a0a 2020   in standard:.  
-0001c7b0: 2020 2020 2020 2020 2020 6174 7472 735b            attrs[
-0001c7c0: 225f 556e 6465 7465 6374 225d 203d 2064  "_Undetect"] = d
-0001c7d0: 6d6f 6d5f 7768 6174 2e61 7474 7273 2e67  mom_what.attrs.g
-0001c7e0: 6574 2822 756e 6465 7465 6374 2229 0a0a  et("undetect")..
-0001c7f0: 2020 2020 2020 2020 2320 6173 7369 676e          # assign
-0001c800: 2061 7474 7269 6275 7465 730a 2020 2020   attributes.    
-0001c810: 2020 2020 646d 6f6d 203d 2064 736d 6f6d      dmom = dsmom
-0001c820: 2e64 6174 612e 6173 7369 676e 5f61 7474  .data.assign_att
-0001c830: 7273 2861 7474 7273 290a 0a20 2020 2020  rs(attrs)..     
-0001c840: 2020 2023 206b 6565 7020 6f72 6967 696e     # keep origin
-0001c850: 616c 2064 6174 6173 6574 206e 616d 650a  al dataset name.
-0001c860: 2020 2020 2020 2020 6966 2073 7461 6e64          if stand
-0001c870: 6172 6420 3d3d 2022 6e6f 6e65 223a 0a20  ard == "none":. 
-0001c880: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-0001c890: 3d20 6d6f 6d0a 0a20 2020 2020 2020 2023  = mom..        #
-0001c8a0: 2066 6978 2064 696d 656e 7369 6f6e 730a   fix dimensions.
-0001c8b0: 2020 2020 2020 2020 6469 6d73 203d 2064          dims = d
-0001c8c0: 6d6f 6d2e 6469 6d73 0a20 2020 2020 2020  mom.dims.       
-0001c8d0: 2064 6174 6173 2e75 7064 6174 6528 7b6e   datas.update({n
-0001c8e0: 616d 653a 2064 6d6f 6d2e 7265 6e61 6d65  ame: dmom.rename
-0001c8f0: 287b 6469 6d73 5b30 5d3a 2022 6469 6d5f  ({dims[0]: "dim_
-0001c900: 3022 2c20 6469 6d73 5b31 5d3a 2022 6469  0", dims[1]: "di
-0001c910: 6d5f 3122 7d29 7d29 0a20 2020 2072 6574  m_1"})}).    ret
-0001c920: 7572 6e20 6461 7461 730a 0a0a 6465 6620  urn datas...def 
-0001c930: 5f67 6574 5f6f 6469 6d5f 6772 6f75 7073  _get_odim_groups
-0001c940: 286e 6366 2c20 6772 6f75 7073 2c20 2a2a  (ncf, groups, **
-0001c950: 6b77 6172 6773 293a 0a20 2020 2022 2222  kwargs):.    """
-0001c960: 4765 7420 6864 6620 6772 6f75 7073 2e0a  Get hdf groups..
-0001c970: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-0001c980: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0001c990: 2020 206e 6366 203a 206e 6574 4344 6634     ncf : netCDf4
-0001c9a0: 2044 6174 6173 6574 2068 616e 646c 650a   Dataset handle.
-0001c9b0: 2020 2020 6772 6f75 7073 203a 206c 6973      groups : lis
-0001c9c0: 740a 2020 2020 2020 2020 6c69 7374 206f  t.        list o
-0001c9d0: 6620 6772 6f75 7073 2d6b 6579 730a 0a20  f groups-keys.. 
-0001c9e0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-0001c9f0: 2d2d 2d2d 2d2d 0a20 2020 206f 7574 203a  ------.    out :
-0001ca00: 2074 7570 6c65 0a20 2020 2020 2020 2074   tuple.        t
-0001ca10: 7570 6c65 206f 6620 7861 7272 6179 2064  uple of xarray d
-0001ca20: 6174 6173 6574 730a 2020 2020 2222 220a  atasets.    """.
-0001ca30: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
-0001ca40: 286d 6170 286c 616d 6264 6120 783a 205f  (map(lambda x: _
-0001ca50: 6f70 656e 5f64 6174 6173 6574 286e 6366  open_dataset(ncf
-0001ca60: 2c20 782c 202a 2a6b 7761 7267 7329 2c20  , x, **kwargs), 
-0001ca70: 6772 6f75 7073 2929 0a0a 0a64 6566 205f  groups))...def _
-0001ca80: 6765 745f 6f64 696d 5f6d 6f6d 656e 745f  get_odim_moment_
-0001ca90: 6e61 6d65 7328 7377 6565 702c 2066 6d74  names(sweep, fmt
-0001caa0: 3d4e 6f6e 652c 2073 7263 3d4e 6f6e 6529  =None, src=None)
-0001cab0: 3a0a 2020 2020 2222 2247 6574 206d 6f6d  :.    """Get mom
-0001cac0: 656e 7420 6e61 6d65 732e 0a0a 2020 2020  ent names...    
-0001cad0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001cae0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7377  ---------.    sw
-0001caf0: 6565 7020 3a20 6e65 7443 4466 3420 4772  eep : netCDf4 Gr
-0001cb00: 6f75 7020 6861 6e64 6c65 0a20 2020 2066  oup handle.    f
-0001cb10: 6d74 203a 2073 7472 0a20 2020 2020 2020  mt : str.       
-0001cb20: 2064 6174 6173 6574 2064 6573 6372 6970   dataset descrip
-0001cb30: 746f 7220 666f 726d 6174 0a20 2020 2073  tor format.    s
-0001cb40: 7263 203a 2073 7472 0a20 2020 2020 2020  rc : str.       
-0001cb50: 2064 6174 6173 6574 206c 6f63 6174 696f   dataset locatio
-0001cb60: 6e0a 0a20 2020 2052 6574 7572 6e73 0a20  n..    Returns. 
-0001cb70: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 206f     -------.    o
-0001cb80: 7574 203a 203a 636c 6173 733a 606e 756d  ut : :class:`num
-0001cb90: 7079 3a6e 756d 7079 2e6e 6461 7272 6179  py:numpy.ndarray
-0001cba0: 600a 2020 2020 2020 2020 6172 7261 7920  `.        array 
-0001cbb0: 6f66 206d 6f6d 656e 7420 6e61 6d65 730a  of moment names.
-0001cbc0: 2020 2020 2222 220a 2020 2020 6d6f 6d65      """.    mome
-0001cbd0: 6e74 7320 3d20 5b6d 6f6d 2066 6f72 206d  nts = [mom for m
-0001cbe0: 6f6d 2069 6e20 6765 7461 7474 7228 7377  om in getattr(sw
-0001cbf0: 6565 702c 2073 7263 292e 6b65 7973 2829  eep, src).keys()
-0001cc00: 2069 6620 666d 7420 696e 206d 6f6d 5d0a   if fmt in mom].
-0001cc10: 2020 2020 6d6f 6d65 6e74 735f 6964 7820      moments_idx 
-0001cc20: 3d20 6e70 2e61 7267 736f 7274 285b 696e  = np.argsort([in
-0001cc30: 7428 735b 6c65 6e28 666d 7429 203a 5d29  t(s[len(fmt) :])
-0001cc40: 2066 6f72 2073 2069 6e20 6d6f 6d65 6e74   for s in moment
-0001cc50: 735d 290a 2020 2020 7265 7475 726e 206e  s]).    return n
-0001cc60: 702e 6172 7261 7928 6d6f 6d65 6e74 7329  p.array(moments)
-0001cc70: 5b6d 6f6d 656e 7473 5f69 6478 5d0a 0a0a  [moments_idx]...
-0001cc80: 6465 6620 5f61 7373 6967 6e5f 6f64 696d  def _assign_odim
-0001cc90: 5f6d 6f6d 656e 7473 2864 732c 206e 6368  _moments(ds, nch
-0001cca0: 2c20 7377 6565 702c 202a 2a6b 7761 7267  , sweep, **kwarg
-0001ccb0: 7329 3a0a 2020 2020 2222 2241 7373 6967  s):.    """Assig
-0001ccc0: 6e20 7261 6461 7220 6d6f 6d65 6e74 7320  n radar moments 
-0001ccd0: 746f 2064 6174 6173 6574 2e0a 0a20 2020  to dataset...   
-0001cce0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0001ccf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e  ----------.    n
-0001cd00: 6368 203a 206e 6574 4344 4634 2e44 6174  ch : netCDF4.Dat
-0001cd10: 6173 6574 2068 616e 646c 650a 2020 2020  aset handle.    
-0001cd20: 2020 2020 736f 7572 6365 206e 6574 4344      source netCD
-0001cd30: 4634 2044 6174 6173 6574 0a20 2020 2064  F4 Dataset.    d
-0001cd40: 7320 3a20 7861 7272 6179 2064 6174 6173  s : xarray datas
-0001cd50: 6574 0a20 2020 2020 2020 2064 6573 7469  et.        desti
-0001cd60: 6e61 7469 6f6e 2064 6174 6173 6574 0a20  nation dataset. 
-0001cd70: 2020 2073 7765 6570 203a 2073 7472 0a20     sweep : str. 
-0001cd80: 2020 2020 2020 206e 6574 6364 6620 6772         netcdf gr
-0001cd90: 6f75 7020 6e61 6d65 0a0a 2020 2020 4b65  oup name..    Ke
-0001cda0: 7977 6f72 6420 4172 6775 6d65 6e74 730a  yword Arguments.
-0001cdb0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001cdc0: 2d2d 2d2d 2d0a 2020 2020 6465 636f 6465  -----.    decode
-0001cdd0: 5f74 696d 6573 203a 2062 6f6f 6c0a 2020  _times : bool.  
-0001cde0: 2020 2020 2020 4966 2054 7275 652c 2064        If True, d
-0001cdf0: 6563 6f64 6520 6366 2074 696d 6573 2074  ecode cf times t
-0001ce00: 6f20 6e70 2e64 6174 6574 696d 6536 342e  o np.datetime64.
-0001ce10: 2044 6566 6175 6c74 7320 746f 2054 7275   Defaults to Tru
-0001ce20: 652e 0a20 2020 2064 6563 6f64 655f 636f  e..    decode_co
-0001ce30: 6f72 6473 203a 2062 6f6f 6c0a 2020 2020  ords : bool.    
-0001ce40: 2020 2020 4966 2054 7275 652c 2075 7365      If True, use
-0001ce50: 2074 6865 20e2 8098 636f 6f72 6469 6e61   the ...coordina
-0001ce60: 7465 73e2 8099 2061 7474 7269 6275 7465  tes... attribute
-0001ce70: 206f 6e20 7661 7269 6162 6c65 0a20 2020   on variable.   
-0001ce80: 2020 2020 2074 6f20 6173 7369 676e 2063       to assign c
-0001ce90: 6f6f 7264 696e 6174 6573 2e20 4465 6661  oordinates. Defa
-0001cea0: 756c 7473 2074 6f20 5472 7565 2e0a 2020  ults to True..  
-0001ceb0: 2020 6d61 736b 5f61 6e64 5f73 6361 6c65    mask_and_scale
-0001cec0: 203a 2062 6f6f 6c0a 2020 2020 2020 2020   : bool.        
-0001ced0: 4966 2054 7275 652c 206c 617a 696c 7920  If True, lazily 
-0001cee0: 7363 616c 6520 2875 7369 6e67 2073 6361  scale (using sca
-0001cef0: 6c65 5f66 6163 746f 7220 616e 6420 6164  le_factor and ad
-0001cf00: 645f 6f66 6673 6574 290a 2020 2020 2020  d_offset).      
-0001cf10: 2020 616e 6420 6d61 736b 2028 7573 696e    and mask (usin
-0001cf20: 6720 5f46 696c 6c56 616c 7565 292e 2044  g _FillValue). D
-0001cf30: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
-0001cf40: 0a20 2020 2067 656f 7265 6620 3a20 626f  .    georef : bo
-0001cf50: 6f6c 0a20 2020 2020 2020 2049 6620 5472  ol.        If Tr
-0001cf60: 7565 2c20 6164 6473 2032 4420 4145 5144  ue, adds 2D AEQD
-0001cf70: 2078 2c79 2c7a 2d63 6f6f 7264 696e 6174   x,y,z-coordinat
-0001cf80: 6573 2c20 6772 6f75 6e64 5f72 616e 6765  es, ground_range
-0001cf90: 2028 6772 2920 616e 640a 2020 2020 2020   (gr) and.      
-0001cfa0: 2020 3244 2028 7261 7973 2c62 696e 7329    2D (rays,bins)
-0001cfb0: 2d63 6f6f 7264 696e 6174 6573 2066 6f72  -coordinates for
-0001cfc0: 2065 6173 7920 6765 6f72 6566 6572 656e   easy georeferen
-0001cfd0: 6369 6e67 2028 6567 2e20 6361 7274 6f70  cing (eg. cartop
-0001cfe0: 7929 0a20 2020 2073 7461 6e64 6172 6420  y).    standard 
-0001cff0: 3a20 7374 720a 2020 2020 2020 2020 2a20  : str.        * 
-0001d000: 606e 6f6e 6560 202d 2064 6174 6120 6973  `none` - data is
-0001d010: 2072 6561 6420 6173 2076 6572 6261 7469   read as verbati
-0001d020: 6d20 6173 2070 6f73 7369 626c 652c 206e  m as possible, n
-0001d030: 6f20 6d65 7461 6461 7461 0a20 2020 2020  o metadata.     
-0001d040: 2020 202a 2060 6f64 696d 6020 2d20 6461     * `odim` - da
-0001d050: 7461 2069 7320 7265 6164 2c20 6f64 696d  ta is read, odim
-0001d060: 206d 6574 6164 6174 6120 6164 6465 6420   metadata added 
-0001d070: 746f 2064 6174 6173 6574 730a 2020 2020  to datasets.    
-0001d080: 2020 2020 2a20 6063 662d 6d61 6e64 6174      * `cf-mandat
-0001d090: 6f72 7960 202d 2064 6174 6120 6973 2072  ory` - data is r
-0001d0a0: 6561 6420 6163 636f 7264 696e 6720 746f  ead according to
-0001d0b0: 2063 6672 6164 6961 6c32 2073 7461 6e64   cfradial2 stand
-0001d0c0: 6172 640a 2020 2020 2020 2020 2020 696d  ard.          im
-0001d0d0: 706f 7274 696e 6720 6d61 6e64 6174 6f72  porting mandator
-0001d0e0: 7920 6d65 7461 6461 7461 0a20 2020 2020  y metadata.     
-0001d0f0: 2020 202a 2060 6366 2d66 756c 6c60 202d     * `cf-full` -
-0001d100: 2064 6174 6120 6973 2072 6561 6420 6163   data is read ac
-0001d110: 636f 7264 696e 6720 746f 2063 6672 6164  cording to cfrad
-0001d120: 6961 6c32 2073 7461 6e64 6172 640a 2020  ial2 standard.  
-0001d130: 2020 2020 2020 2020 696d 706f 7274 696e          importin
-0001d140: 6720 616c 6c20 6176 6169 6c61 626c 6520  g all available 
-0001d150: 6366 7261 6469 616c 3220 6d65 7461 6461  cfradial2 metada
-0001d160: 7461 2028 6e6f 7420 6675 6c6c 790a 2020  ta (not fully.  
-0001d170: 2020 2020 2020 2020 696d 706c 656d 656e          implemen
-0001d180: 7465 6429 0a0a 2020 2020 5265 7475 726e  ted)..    Return
-0001d190: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-0001d1a0: 2020 6473 203a 2078 6172 7261 7920 6461    ds : xarray da
-0001d1b0: 7461 7365 740a 2020 2020 2020 2020 4461  taset.        Da
-0001d1c0: 7461 7365 7420 7769 7468 2061 7373 6967  taset with assig
-0001d1d0: 6e65 6420 7261 6461 7220 6d6f 6d65 6e74  ned radar moment
-0001d1e0: 730a 2020 2020 2222 220a 2020 2020 6d6f  s.    """.    mo
-0001d1f0: 6d65 6e74 7320 3d20 5f67 6574 5f6f 6469  ments = _get_odi
-0001d200: 6d5f 6d6f 6d65 6e74 5f6e 616d 6573 286e  m_moment_names(n
-0001d210: 6368 2e6e 6368 5b73 7765 6570 5d2c 2066  ch.nch[sweep], f
-0001d220: 6d74 3d6e 6368 2e5f 6d66 6d74 2c20 7372  mt=nch._mfmt, sr
-0001d230: 633d 6e63 682e 5f6d 7372 6329 0a20 2020  c=nch._msrc).   
-0001d240: 2069 6620 6e63 682e 666c 6176 6f75 7220   if nch.flavour 
-0001d250: 3d3d 2022 4f44 494d 223a 0a20 2020 2020  == "ODIM":.     
-0001d260: 2020 2066 6f72 206e 616d 652c 2064 6d6f     for name, dmo
-0001d270: 6d20 696e 205f 6765 745f 6f64 696d 5f67  m in _get_odim_g
-0001d280: 726f 7570 5f6d 6f6d 656e 7473 280a 2020  roup_moments(.  
-0001d290: 2020 2020 2020 2020 2020 6e63 682e 6e63            nch.nc
-0001d2a0: 682c 2073 7765 6570 2c20 6d6f 6d65 6e74  h, sweep, moment
-0001d2b0: 733d 6d6f 6d65 6e74 732c 202a 2a6b 7761  s=moments, **kwa
-0001d2c0: 7267 730a 2020 2020 2020 2020 292e 6974  rgs.        ).it
-0001d2d0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0001d2e0: 2020 2064 735b 6e61 6d65 5d20 3d20 646d     ds[name] = dm
-0001d2f0: 6f6d 0a20 2020 2069 6620 6e63 682e 666c  om.    if nch.fl
-0001d300: 6176 6f75 7220 3d3d 2022 4741 4d49 4322  avour == "GAMIC"
-0001d310: 3a0a 2020 2020 2020 2020 6473 203d 205f  :.        ds = _
-0001d320: 6765 745f 6f64 696d 5f76 6172 6961 626c  get_odim_variabl
-0001d330: 6573 5f6d 6f6d 656e 7473 2864 732c 206d  es_moments(ds, m
-0001d340: 6f6d 656e 7473 3d6d 6f6d 656e 7473 2c20  oments=moments, 
-0001d350: 2a2a 6b77 6172 6773 290a 0a20 2020 2072  **kwargs)..    r
-0001d360: 6574 7572 6e20 6473 0a0a 0a64 6566 205f  eturn ds...def _
-0001d370: 6765 745f 6f64 696d 5f74 696d 6576 616c  get_odim_timeval
-0001d380: 7565 7328 6e63 682c 2067 7270 7329 3a0a  ues(nch, grps):.
-0001d390: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0001d3a0: 5469 6d65 4172 7261 7920 6672 6f6d 2073  TimeArray from s
-0001d3b0: 6f75 7263 6520 6461 7461 2e0a 0a20 2020  ource data...   
-0001d3c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0001d3d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e  ----------.    n
-0001d3e0: 6368 203a 206e 6574 4344 4634 2e44 6174  ch : netCDF4.Dat
-0001d3f0: 6173 6574 2068 616e 646c 650a 2020 2020  aset handle.    
-0001d400: 2020 2020 736f 7572 6365 206e 6574 4344      source netCD
-0001d410: 4634 2044 6174 6173 6574 0a20 2020 2067  F4 Dataset.    g
-0001d420: 7270 7320 3a20 6469 6374 0a20 2020 2020  rps : dict.     
-0001d430: 2020 2044 6963 7469 6f6e 6172 7920 6f66     Dictionary of
-0001d440: 2064 6174 6173 6574 2068 6466 3520 6772   dataset hdf5 gr
-0001d450: 6f75 7073 2028 2768 6f77 272c 2027 7768  oups ('how', 'wh
-0001d460: 6174 272c 2027 7768 6572 6527 290a 0a20  at', 'where').. 
-0001d470: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-0001d480: 2d2d 2d2d 2d2d 0a20 2020 2074 696d 6576  ------.    timev
-0001d490: 616c 7320 3a20 3a63 6c61 7373 3a60 6e75  als : :class:`nu
-0001d4a0: 6d70 793a 6e75 6d70 792e 6e64 6172 7261  mpy:numpy.ndarra
-0001d4b0: 7960 0a20 2020 2020 2020 2020 2020 2061  y`.            a
-0001d4c0: 7272 6179 206f 6620 7469 6d65 2076 616c  rray of time val
-0001d4d0: 7565 730a 2020 2020 2222 220a 2020 2020  ues.    """.    
-0001d4e0: 6966 206e 6368 2e66 6c61 766f 7572 203d  if nch.flavour =
-0001d4f0: 3d20 224f 4449 4d22 3a0a 2020 2020 2020  = "ODIM":.      
-0001d500: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0001d510: 2020 2074 696d 6576 616c 7320 3d20 6772     timevals = gr
-0001d520: 7073 5b22 686f 7722 5d2e 6f64 696d 2e74  ps["how"].odim.t
-0001d530: 696d 655f 7261 6e67 650a 2020 2020 2020  ime_range.      
-0001d540: 2020 6578 6365 7074 2028 4b65 7945 7272    except (KeyErr
-0001d550: 6f72 2c20 4174 7472 6962 7574 6545 7272  or, AttributeErr
-0001d560: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-0001d570: 2023 2074 696d 6568 616e 646c 696e 6720   # timehandling 
-0001d580: 6966 206f 6e6c 7920 7374 6172 7420 616e  if only start an
-0001d590: 6420 656e 6420 7469 6d65 2069 7320 6769  d end time is gi
-0001d5a0: 7665 6e0a 2020 2020 2020 2020 2020 2020  ven.            
-0001d5b0: 7374 6172 742c 2065 6e64 203d 2067 7270  start, end = grp
-0001d5c0: 735b 2277 6861 7422 5d2e 6f64 696d 2e74  s["what"].odim.t
-0001d5d0: 696d 655f 7261 6e67 6532 0a20 2020 2020  ime_range2.     
-0001d5e0: 2020 2020 2020 2069 6620 7374 6172 7420         if start 
-0001d5f0: 3d3d 2065 6e64 3a0a 2020 2020 2020 2020  == end:.        
-0001d600: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0001d610: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0001d620: 2020 2020 2020 2020 2020 2022 5752 4144             "WRAD
-0001d630: 4c49 423a 2045 7175 616c 204f 4449 4d20  LIB: Equal ODIM 
-0001d640: 6073 7461 7274 7469 6d65 6020 616e 6420  `starttime` and 
-0001d650: 6065 6e64 7469 6d65 6020 220a 2020 2020  `endtime` ".    
-0001d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d670: 2276 616c 7565 732e 2043 616e 2774 2064  "values. Can't d
-0001d680: 6574 6572 6d69 6e65 2063 6f72 7265 6374  etermine correct
-0001d690: 2073 7765 6570 2073 7461 7274 2d2c 2022   sweep start-, "
-0001d6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d6b0: 2020 2020 2022 656e 642d 2061 6e64 2072       "end- and r
-0001d6c0: 6179 7469 6d65 732e 222c 0a20 2020 2020  aytimes.",.     
-0001d6d0: 2020 2020 2020 2020 2020 2020 2020 2055                 U
-0001d6e0: 7365 7257 6172 6e69 6e67 2c0a 2020 2020  serWarning,.    
-0001d6f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001d700: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-0001d710: 6d65 7661 6c73 203d 206e 702e 6f6e 6573  mevals = np.ones
-0001d720: 2867 7270 735b 2277 6865 7265 225d 2e6e  (grps["where"].n
-0001d730: 7261 7973 2920 2a20 7374 6172 740a 2020  rays) * start.  
-0001d740: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d760: 6465 6c74 6120 3d20 2865 6e64 202d 2073  delta = (end - s
-0001d770: 7461 7274 2920 2f20 6772 7073 5b22 7768  tart) / grps["wh
-0001d780: 6572 6522 5d2e 6e72 6179 730a 2020 2020  ere"].nrays.    
-0001d790: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0001d7a0: 7661 6c73 203d 206e 702e 6172 616e 6765  vals = np.arange
-0001d7b0: 2873 7461 7274 202b 2064 656c 7461 202f  (start + delta /
-0001d7c0: 2032 2e30 2c20 656e 642c 2064 656c 7461   2.0, end, delta
-0001d7d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001d7e0: 2020 7469 6d65 7661 6c73 203d 206e 702e    timevals = np.
-0001d7f0: 726f 6c6c 2874 696d 6576 616c 732c 2073  roll(timevals, s
-0001d800: 6869 6674 3d2d 6772 7073 5b22 7768 6572  hift=-grps["wher
-0001d810: 6522 5d2e 6131 6761 7465 290a 2020 2020  e"].a1gate).    
-0001d820: 6966 206e 6368 2e66 6c61 766f 7572 203d  if nch.flavour =
-0001d830: 3d20 2247 414d 4943 223a 0a20 2020 2020  = "GAMIC":.     
-0001d840: 2020 2074 696d 6576 616c 7320 3d20 6772     timevals = gr
-0001d850: 7073 5b22 7768 6174 225d 2e67 616d 6963  ps["what"].gamic
-0001d860: 2e74 696d 655f 7261 6e67 652e 7661 6c75  .time_range.valu
-0001d870: 6573 0a0a 2020 2020 7265 7475 726e 2074  es..    return t
-0001d880: 696d 6576 616c 730a 0a0a 6465 6620 5f67  imevals...def _g
-0001d890: 6574 5f6f 6469 6d5f 636f 6f72 6469 6e61  et_odim_coordina
-0001d8a0: 7465 7328 6e63 682c 2067 7270 7329 3a0a  tes(nch, grps):.
-0001d8b0: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0001d8c0: 636f 6f72 6469 6e61 7465 7320 6163 636f  coordinates acco
-0001d8d0: 7264 696e 6720 4f64 696d 4835 2073 7461  rding OdimH5 sta
-0001d8e0: 6e64 6172 642e 0a0a 2020 2020 5061 7261  ndard...    Para
-0001d8f0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0001d900: 2d2d 2d2d 2d0a 2020 2020 6e63 6820 3a20  -----.    nch : 
-0001d910: 6e65 7443 4446 342e 4461 7461 7365 7420  netCDF4.Dataset 
-0001d920: 6861 6e64 6c65 0a20 2020 2020 2020 2073  handle.        s
-0001d930: 6f75 7263 6520 6e65 7443 4446 3420 4461  ource netCDF4 Da
-0001d940: 7461 7365 740a 2020 2020 6772 7073 203a  taset.    grps :
-0001d950: 2064 6963 740a 2020 2020 2020 2020 4469   dict.        Di
-0001d960: 6374 696f 6e61 7279 206f 6620 6461 7461  ctionary of data
-0001d970: 7365 7420 6864 6635 2067 726f 7570 7320  set hdf5 groups 
-0001d980: 2827 686f 7727 2c20 2777 6861 7427 2c20  ('how', 'what', 
-0001d990: 2777 6865 7265 2729 0a0a 2020 2020 5265  'where')..    Re
-0001d9a0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-0001d9b0: 2d0a 2020 2020 636f 6f72 6473 203a 2064  -.    coords : d
-0001d9c0: 6963 740a 2020 2020 2020 2020 4469 6374  ict.        Dict
-0001d9d0: 696f 6e61 7279 206f 6620 636f 6f72 6469  ionary of coordi
-0001d9e0: 6e61 7465 2061 7272 6179 730a 2020 2020  nate arrays.    
-0001d9f0: 2222 220a 2020 2020 666c 6176 6f75 7220  """.    flavour 
-0001da00: 3d20 6e63 682e 666c 6176 6f75 722e 6c6f  = nch.flavour.lo
-0001da10: 7765 7228 290a 2020 2020 636f 6f72 6473  wer().    coords
-0001da20: 203d 2063 6f6c 6c65 6374 696f 6e73 2e4f   = collections.O
-0001da30: 7264 6572 6564 4469 6374 2829 0a20 2020  rderedDict().   
-0001da40: 2069 6620 666c 6176 6f75 7220 3d3d 2022   if flavour == "
-0001da50: 6f64 696d 223a 0a20 2020 2020 2020 2072  odim":.        r
-0001da60: 6e67 203d 2067 7270 735b 2277 6865 7265  ng = grps["where
-0001da70: 225d 0a20 2020 2020 2020 2061 7a20 3d20  "].        az = 
-0001da80: 656c 203d 2067 7270 735b 2268 6f77 225d  el = grps["how"]
-0001da90: 0a20 2020 2069 6620 666c 6176 6f75 7220  .    if flavour 
-0001daa0: 3d3d 2022 6761 6d69 6322 3a0a 2020 2020  == "gamic":.    
-0001dab0: 2020 2020 617a 203d 2065 6c20 3d20 6772      az = el = gr
-0001dac0: 7073 5b22 7768 6174 225d 0a20 2020 2020  ps["what"].     
-0001dad0: 2020 2072 6e67 203d 2067 7270 735b 2268     rng = grps["h
-0001dae0: 6f77 225d 0a20 2020 2074 7279 3a0a 2020  ow"].    try:.  
-0001daf0: 2020 2020 2020 636f 6f72 6473 5b22 617a        coords["az
-0001db00: 696d 7574 6822 5d20 3d20 6765 7461 7474  imuth"] = getatt
-0001db10: 7228 617a 2c20 666c 6176 6f75 7229 2e61  r(az, flavour).a
-0001db20: 7a69 6d75 7468 5f72 616e 6765 0a20 2020  zimuth_range.   
-0001db30: 2020 2020 2063 6f6f 7264 735b 2265 6c65       coords["ele
-0001db40: 7661 7469 6f6e 225d 203d 2067 6574 6174  vation"] = getat
-0001db50: 7472 2865 6c2c 2066 6c61 766f 7572 292e  tr(el, flavour).
-0001db60: 656c 6576 6174 696f 6e5f 7261 6e67 650a  elevation_range.
-0001db70: 2020 2020 6578 6365 7074 2028 4b65 7945      except (KeyE
-0001db80: 7272 6f72 2c20 4174 7472 6962 7574 6545  rror, AttributeE
-0001db90: 7272 6f72 293a 0a20 2020 2020 2020 2061  rror):.        a
-0001dba0: 7a20 3d20 656c 203d 2067 7270 735b 2277  z = el = grps["w
-0001dbb0: 6865 7265 225d 0a20 2020 2020 2020 2063  here"].        c
-0001dbc0: 6f6f 7264 735b 2261 7a69 6d75 7468 225d  oords["azimuth"]
-0001dbd0: 203d 2067 6574 6174 7472 2861 7a2c 2066   = getattr(az, f
-0001dbe0: 6c61 766f 7572 292e 617a 696d 7574 685f  lavour).azimuth_
-0001dbf0: 7261 6e67 6532 0a20 2020 2020 2020 2063  range2.        c
-0001dc00: 6f6f 7264 735b 2265 6c65 7661 7469 6f6e  oords["elevation
-0001dc10: 225d 203d 2067 6574 6174 7472 2865 6c2c  "] = getattr(el,
-0001dc20: 2066 6c61 766f 7572 292e 656c 6576 6174   flavour).elevat
-0001dc30: 696f 6e5f 7261 6e67 6532 0a20 2020 2063  ion_range2.    c
-0001dc40: 6f6f 7264 735b 2272 616e 6765 225d 203d  oords["range"] =
-0001dc50: 2067 6574 6174 7472 2872 6e67 2c20 666c   getattr(rng, fl
-0001dc60: 6176 6f75 7229 2e72 6164 6961 6c5f 7261  avour).radial_ra
-0001dc70: 6e67 650a 0a20 2020 2072 6574 7572 6e20  nge..    return 
-0001dc80: 636f 6f72 6473 0a0a 0a64 6566 205f 6765  coords...def _ge
-0001dc90: 745f 6f64 696d 5f73 7765 6570 5f6d 6f64  t_odim_sweep_mod
-0001dca0: 6528 6e63 682c 2067 7270 293a 0a20 2020  e(nch, grp):.   
-0001dcb0: 2022 2222 5265 7472 6965 7665 2073 7765   """Retrieve swe
-0001dcc0: 6570 206d 6f64 650a 0a20 2020 2050 6172  ep mode..    Par
-0001dcd0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-0001dce0: 2d2d 2d2d 2d2d 0a20 2020 206e 6368 203a  ------.    nch :
-0001dcf0: 206e 6574 4344 4634 2e44 6174 6173 6574   netCDF4.Dataset
-0001dd00: 2068 616e 646c 650a 2020 2020 6772 7020   handle.    grp 
-0001dd10: 3a20 6469 6374 0a20 2020 2020 2020 2044  : dict.        D
-0001dd20: 6963 7469 6f6e 6172 7920 6f66 2064 6174  ictionary of dat
-0001dd30: 6173 6574 2068 6466 3520 6772 6f75 7073  aset hdf5 groups
-0001dd40: 2028 2768 6f77 272c 2027 7768 6174 272c   ('how', 'what',
-0001dd50: 2027 7768 6572 6527 290a 0a20 2020 2052   'where')..    R
-0001dd60: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-0001dd70: 2d2d 0a20 2020 206f 7574 203a 2073 7472  --.    out : str
-0001dd80: 0a20 2020 2020 2020 2027 617a 696d 7574  .        'azimut
-0001dd90: 685f 7375 7276 6569 6c6c 616e 6365 2720  h_surveillance' 
-0001dda0: 6f72 2027 7268 6927 0a0a 2020 2020 2222  or 'rhi'..    ""
-0001ddb0: 220a 2020 2020 6f64 696d 5f6d 6f64 6520  ".    odim_mode 
-0001ddc0: 3d20 6772 705b 2277 6861 7422 5d2e 6174  = grp["what"].at
-0001ddd0: 7472 735b 6e63 682e 5f73 776d 6f64 655d  trs[nch._swmode]
-0001dde0: 0a20 2020 2072 6574 7572 6e20 2272 6869  .    return "rhi
-0001ddf0: 2220 6966 206f 6469 6d5f 6d6f 6465 203d  " if odim_mode =
-0001de00: 3d20 2252 4849 2220 656c 7365 2022 617a  = "RHI" else "az
-0001de10: 696d 7574 685f 7375 7276 6569 6c6c 616e  imuth_surveillan
-0001de20: 6365 220a 0a0a 6465 6620 5f67 6574 5f6f  ce"...def _get_o
-0001de30: 6469 6d5f 6675 6c6c 5f76 6172 7328 6e63  dim_full_vars(nc
-0001de40: 682c 2067 7270 7329 3a0a 2020 2020 2222  h, grps):.    ""
-0001de50: 2252 6574 7269 6576 6520 6176 6169 6c61  "Retrieve availa
-0001de60: 626c 6520 6e6f 6e20 6d61 6e64 6174 6f72  ble non mandator
-0001de70: 7920 7661 7269 6162 6c65 7320 6672 6f6d  y variables from
-0001de80: 2073 6f75 7263 6520 6461 7461 2e0a 0a20   source data... 
-0001de90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0001dea0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0001deb0: 206e 6368 203a 206e 6574 4344 4634 2e44   nch : netCDF4.D
-0001dec0: 6174 6173 6574 2068 616e 646c 650a 2020  ataset handle.  
-0001ded0: 2020 6772 7073 203a 2064 6963 740a 2020    grps : dict.  
-0001dee0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-0001def0: 206f 6620 6461 7461 7365 7420 6864 6635   of dataset hdf5
-0001df00: 2067 726f 7570 7320 2827 686f 7727 2c20   groups ('how', 
-0001df10: 2777 6861 7427 2c20 2777 6865 7265 2729  'what', 'where')
-0001df20: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-0001df30: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6675    -------.    fu
-0001df40: 6c6c 5f76 6172 7320 3a20 6469 6374 0a20  ll_vars : dict. 
-0001df50: 2020 2020 2020 2066 756c 6c20 6366 2d76         full cf-v
-0001df60: 6172 6961 626c 6573 0a20 2020 2022 2222  ariables.    """
-0001df70: 0a20 2020 2066 756c 6c5f 7661 7273 203d  .    full_vars =
-0001df80: 2063 6f6c 6c65 6374 696f 6e73 2e4f 7264   collections.Ord
-0001df90: 6572 6564 4469 6374 2829 0a20 2020 2069  eredDict().    i
-0001dfa0: 6620 6e63 682e 666c 6176 6f75 7220 3d3d  f nch.flavour ==
-0001dfb0: 2022 4f44 494d 223a 0a20 2020 2020 2020   "ODIM":.       
-0001dfc0: 2066 6f72 206b 2c20 7620 696e 2063 665f   for k, v in cf_
-0001dfd0: 6675 6c6c 5f76 6172 732e 6974 656d 7328  full_vars.items(
-0001dfe0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-0001dff0: 756c 6c5f 7661 7273 5b6b 5d20 3d20 6765  ull_vars[k] = ge
-0001e000: 7461 7474 7228 6765 7461 7474 7228 6772  tattr(getattr(gr
-0001e010: 7073 5b22 686f 7722 5d2c 206e 6368 2e66  ps["how"], nch.f
-0001e020: 6c61 766f 7572 2e6c 6f77 6572 2829 292c  lavour.lower()),
-0001e030: 206b 290a 2020 2020 6966 206e 6368 2e66   k).    if nch.f
-0001e040: 6c61 766f 7572 203d 3d20 2247 414d 4943  lavour == "GAMIC
-0001e050: 223a 0a20 2020 2020 2020 2070 6173 730a  ":.        pass.
-0001e060: 0a20 2020 2072 6574 7572 6e20 6675 6c6c  .    return full
-0001e070: 5f76 6172 730a 0a0a 6465 6620 5f67 6574  _vars...def _get
-0001e080: 5f6f 6469 6d5f 6669 7865 645f 616e 676c  _odim_fixed_angl
-0001e090: 6528 6e63 682c 2067 7270 7329 3a0a 2020  e(nch, grps):.  
-0001e0a0: 2020 2222 2252 6574 7269 6576 6520 6669    """Retrieve fi
-0001e0b0: 7865 6420 616e 676c 6520 6672 6f6d 2073  xed angle from s
-0001e0c0: 6f75 7263 6520 6461 7461 2e0a 0a20 2020  ource data...   
-0001e0d0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0001e0e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e  ----------.    n
-0001e0f0: 6368 203a 206e 6574 4344 4634 2e44 6174  ch : netCDF4.Dat
-0001e100: 6173 6574 2068 616e 646c 650a 2020 2020  aset handle.    
-0001e110: 6772 7073 203a 2064 6963 740a 2020 2020  grps : dict.    
-0001e120: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
-0001e130: 6620 6461 7461 7365 7420 6864 6635 2067  f dataset hdf5 g
-0001e140: 726f 7570 7320 2827 686f 7727 2c20 2777  roups ('how', 'w
-0001e150: 6861 7427 2c20 2777 6865 7265 2729 0a0a  hat', 'where')..
-0001e160: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0001e170: 2d2d 2d2d 2d2d 2d0a 2020 2020 6669 7865  -------.    fixe
-0001e180: 642d 616e 676c 6520 3a20 666c 6f61 740a  d-angle : float.
-0001e190: 2020 2020 2020 2020 6669 7865 6420 616e          fixed an
-0001e1a0: 676c 6520 6f66 2073 7065 6369 6669 6320  gle of specific 
-0001e1b0: 7363 616e 0a20 2020 2022 2222 0a20 2020  scan.    """.   
-0001e1c0: 206d 6f64 6520 3d20 5f67 6574 5f6f 6469   mode = _get_odi
-0001e1d0: 6d5f 7377 6565 705f 6d6f 6465 286e 6368  m_sweep_mode(nch
-0001e1e0: 2c20 6772 7073 290a 2020 2020 6966 206e  , grps).    if n
-0001e1f0: 6368 2e66 6c61 766f 7572 203d 3d20 224f  ch.flavour == "O
-0001e200: 4449 4d22 3a0a 2020 2020 2020 2020 616e  DIM":.        an
-0001e210: 6720 3d20 7b22 617a 696d 7574 685f 7375  g = {"azimuth_su
-0001e220: 7276 6569 6c6c 616e 6365 223a 2022 656c  rveillance": "el
-0001e230: 616e 676c 6522 2c20 2272 6869 223a 2022  angle", "rhi": "
-0001e240: 617a 616e 676c 6522 7d0a 2020 2020 2020  azangle"}.      
-0001e250: 2020 6669 7865 645f 616e 676c 6520 3d20    fixed_angle = 
-0001e260: 6765 7461 7474 7228 6772 7073 5b22 7768  getattr(grps["wh
-0001e270: 6572 6522 5d2c 2061 6e67 5b6d 6f64 655d  ere"], ang[mode]
-0001e280: 290a 2020 2020 6966 206e 6368 2e66 6c61  ).    if nch.fla
-0001e290: 766f 7572 203d 3d20 2247 414d 4943 223a  vour == "GAMIC":
-0001e2a0: 0a20 2020 2020 2020 2061 6e67 203d 207b  .        ang = {
-0001e2b0: 2261 7a69 6d75 7468 5f73 7572 7665 696c  "azimuth_surveil
-0001e2c0: 6c61 6e63 6522 3a20 2265 6c65 7661 7469  lance": "elevati
-0001e2d0: 6f6e 222c 2022 7268 6922 3a20 2261 7a69  on", "rhi": "azi
-0001e2e0: 6d75 7468 227d 0a20 2020 2020 2020 2066  muth"}.        f
-0001e2f0: 6978 6564 5f61 6e67 6c65 203d 2067 7270  ixed_angle = grp
-0001e300: 735b 2268 6f77 225d 2e61 7474 7273 5b61  s["how"].attrs[a
-0001e310: 6e67 5b6d 6f64 655d 5d0a 2020 2020 7265  ng[mode]].    re
-0001e320: 7475 726e 2066 6978 6564 5f61 6e67 6c65  turn fixed_angle
-0001e330: 0a0a 0a64 6566 205f 6765 745f 6f64 696d  ...def _get_odim
-0001e340: 5f72 6f6f 745f 6174 7472 6962 7574 6573  _root_attributes
-0001e350: 286e 6368 2c20 6772 7073 293a 0a20 2020  (nch, grps):.   
-0001e360: 2022 2222 5265 7472 6965 7665 2072 6f6f   """Retrieve roo
-0001e370: 7420 6174 7472 6962 7574 6573 2061 6363  t attributes acc
-0001e380: 6f72 6469 6e67 2043 6652 6164 6961 6c32  ording CfRadial2
-0001e390: 2073 7461 6e64 6172 642e 0a0a 2020 2020   standard...    
-0001e3a0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001e3b0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6772  ---------.    gr
-0001e3c0: 7073 203a 2064 6963 740a 2020 2020 2020  ps : dict.      
-0001e3d0: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
-0001e3e0: 726f 6f74 2068 6466 3520 6772 6f75 7073  root hdf5 groups
-0001e3f0: 2028 2768 6f77 272c 2027 7768 6174 272c   ('how', 'what',
-0001e400: 2027 7768 6572 6527 290a 0a20 2020 2052   'where')..    R
-0001e410: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-0001e420: 2d2d 0a20 2020 2061 7474 7273 203a 2064  --.    attrs : d
-0001e430: 6963 740a 2020 2020 2020 2020 4469 6374  ict.        Dict
-0001e440: 696f 6e61 7279 206f 6620 726f 6f74 2061  ionary of root a
-0001e450: 7474 7269 6275 7465 730a 2020 2020 2222  ttributes.    ""
-0001e460: 220a 0a20 2020 2061 7474 7273 203d 2063  "..    attrs = c
-0001e470: 6f6c 6c65 6374 696f 6e73 2e4f 7264 6572  ollections.Order
-0001e480: 6564 4469 6374 2829 0a20 2020 2061 7474  edDict().    att
-0001e490: 7273 2e75 7064 6174 6528 0a20 2020 2020  rs.update(.     
-0001e4a0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-0001e4b0: 2022 7665 7273 696f 6e22 3a20 224e 6f6e   "version": "Non
-0001e4c0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001e4d0: 2274 6974 6c65 223a 2022 4e6f 6e65 222c  "title": "None",
-0001e4e0: 0a20 2020 2020 2020 2020 2020 2022 696e  .            "in
-0001e4f0: 7374 6974 7574 696f 6e22 3a20 224e 6f6e  stitution": "Non
-0001e500: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001e510: 2272 6566 6572 656e 6365 7322 3a20 224e  "references": "N
-0001e520: 6f6e 6522 2c0a 2020 2020 2020 2020 2020  one",.          
-0001e530: 2020 2273 6f75 7263 6522 3a20 224e 6f6e    "source": "Non
-0001e540: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001e550: 2268 6973 746f 7279 223a 2022 4e6f 6e65  "history": "None
-0001e560: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001e570: 636f 6d6d 656e 7422 3a20 2269 6d2f 6578  comment": "im/ex
-0001e580: 706f 7274 6564 2075 7369 6e67 2077 7261  ported using wra
-0001e590: 646c 6962 222c 0a20 2020 2020 2020 2020  dlib",.         
-0001e5a0: 2020 2022 696e 7374 7275 6d65 6e74 5f6e     "instrument_n
-0001e5b0: 616d 6522 3a20 224e 6f6e 6522 2c0a 2020  ame": "None",.  
-0001e5c0: 2020 2020 2020 7d0a 2020 2020 290a 2020        }.    ).  
-0001e5d0: 2020 6174 7472 735b 2276 6572 7369 6f6e    attrs["version
-0001e5e0: 225d 203d 2067 7270 735b 2277 6861 7422  "] = grps["what"
-0001e5f0: 5d2e 6174 7472 735b 2276 6572 7369 6f6e  ].attrs["version
-0001e600: 225d 0a0a 2020 2020 6966 206e 6368 2e66  "]..    if nch.f
-0001e610: 6c61 766f 7572 203d 3d20 224f 4449 4d22  lavour == "ODIM"
-0001e620: 3a0a 2020 2020 2020 2020 6174 7472 735b  :.        attrs[
-0001e630: 2269 6e73 7469 7475 7469 6f6e 225d 203d  "institution"] =
-0001e640: 2067 7270 735b 2277 6861 7422 5d2e 6174   grps["what"].at
-0001e650: 7472 735b 2273 6f75 7263 6522 5d0a 2020  trs["source"].  
-0001e660: 2020 2020 2020 6174 7472 735b 2269 6e73        attrs["ins
-0001e670: 7472 756d 656e 7422 5d20 3d20 6772 7073  trument"] = grps
-0001e680: 5b22 7768 6174 225d 2e61 7474 7273 5b22  ["what"].attrs["
-0001e690: 736f 7572 6365 225d 0a20 2020 2069 6620  source"].    if 
-0001e6a0: 6e63 682e 666c 6176 6f75 7220 3d3d 2022  nch.flavour == "
-0001e6b0: 4741 4d49 4322 3a0a 2020 2020 2020 2020  GAMIC":.        
-0001e6c0: 6174 7472 735b 2274 6974 6c65 225d 203d  attrs["title"] =
-0001e6d0: 2067 7270 735b 2268 6f77 225d 2e61 7474   grps["how"].att
-0001e6e0: 7273 5b22 7465 6d70 6c61 7465 5f6e 616d  rs["template_nam
-0001e6f0: 6522 5d0a 2020 2020 2020 2020 6174 7472  e"].        attr
-0001e700: 735b 2269 6e73 7472 756d 656e 7422 5d20  s["instrument"] 
-0001e710: 3d20 6772 7073 5b22 686f 7722 5d2e 6174  = grps["how"].at
-0001e720: 7472 735b 2268 6f73 745f 6e61 6d65 225d  trs["host_name"]
-0001e730: 0a0a 2020 2020 7265 7475 726e 2061 7474  ..    return att
-0001e740: 7273 0a                                  rs.
+00019980: 2020 2320 6765 6f72 6566 6572 656e 6365    # georeference
+00019990: 206e 6565 6473 2063 6f6f 7264 696e 6174   needs coordinat
+000199a0: 6520 7661 7269 6162 6c65 730a 2020 2020  e variables.    
+000199b0: 2020 2020 2020 2020 2020 2020 6966 2067              if g
+000199c0: 656f 7265 663a 0a20 2020 2020 2020 2020  eoref:.         
+000199d0: 2020 2020 2020 2020 2020 2067 656f 6473             geods
+000199e0: 203d 2078 722e 4461 7461 7365 7428 7661   = xr.Dataset(va
+000199f0: 7273 2c20 636f 6f72 6473 290a 2020 2020  rs, coords).    
+00019a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a10: 6765 6f64 7320 3d20 7861 7272 6179 2e67  geods = xarray.g
+00019a20: 656f 7265 6665 7265 6e63 655f 6461 7461  eoreference_data
+00019a30: 7365 7428 6765 6f64 7329 0a20 2020 2020  set(geods).     
+00019a40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019a50: 6f6f 7264 732e 7570 6461 7465 2867 656f  oords.update(geo
+00019a60: 6473 2e63 6f6f 7264 7329 0a20 2020 2020  ds.coords).     
+00019a70: 2020 2020 2020 2023 2074 696d 6520 636f         # time co
+00019a80: 6f72 6469 6e61 7465 0a20 2020 2020 2020  ordinate.       
+00019a90: 2020 2020 2069 6620 2263 6622 2069 6e20       if "cf" in 
+00019aa0: 7374 616e 6461 7264 206f 7220 6465 636f  standard or deco
+00019ab0: 6465 5f74 696d 6573 3a0a 2020 2020 2020  de_times:.      
+00019ac0: 2020 2020 2020 2020 2020 7469 6d65 7661            timeva
+00019ad0: 6c73 203d 205f 6765 745f 6f64 696d 5f74  ls = _get_odim_t
+00019ae0: 696d 6576 616c 7565 7328 6e63 682c 2064  imevalues(nch, d
+00019af0: 735f 6772 7073 290a 2020 2020 2020 2020  s_grps).        
+00019b00: 2020 2020 2020 2020 6966 2064 6563 6f64          if decod
+00019b10: 655f 7469 6d65 733a 0a20 2020 2020 2020  e_times:.       
+00019b20: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00019b30: 7264 735b 2274 696d 6522 5d20 3d20 285b  rds["time"] = ([
+00019b40: 2264 696d 5f30 225d 2c20 7469 6d65 7661  "dim_0"], timeva
+00019b50: 6c73 2c20 7469 6d65 5f61 7474 7273 290a  ls, time_attrs).
+00019b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019b80: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
+00019b90: 5b22 7469 6d65 225d 203d 2028 5b22 6469  ["time"] = (["di
+00019ba0: 6d5f 3022 5d2c 2074 696d 6576 616c 7329  m_0"], timevals)
+00019bb0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00019bc0: 6173 7369 676e 2067 6c6f 6261 6c20 7377  assign global sw
+00019bd0: 6565 7020 6174 7472 6962 7574 6573 0a20  eep attributes. 
+00019be0: 2020 2020 2020 2020 2020 2066 6978 6564             fixed
+00019bf0: 5f61 6e67 6c65 203d 205f 6765 745f 6f64  _angle = _get_od
+00019c00: 696d 5f66 6978 6564 5f61 6e67 6c65 286e  im_fixed_angle(n
+00019c10: 6368 2c20 6473 5f67 7270 7329 0a20 2020  ch, ds_grps).   
+00019c20: 2020 2020 2020 2020 2069 6620 2263 6622           if "cf"
+00019c30: 2069 6e20 7374 616e 6461 7264 3a0a 2020   in standard:.  
+00019c40: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00019c50: 7273 2e75 7064 6174 6528 0a20 2020 2020  rs.update(.     
+00019c60: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00019c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019c80: 2020 2020 2020 2020 2022 7377 6565 705f           "sweep_
+00019c90: 6e75 6d62 6572 223a 2069 2c0a 2020 2020  number": i,.    
+00019ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cb0: 2020 2020 2273 7765 6570 5f6d 6f64 6522      "sweep_mode"
+00019cc0: 3a20 7377 6565 705f 6d6f 6465 2c0a 2020  : sweep_mode,.  
+00019cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ce0: 2020 2020 2020 2266 6f6c 6c6f 775f 6d6f        "follow_mo
+00019cf0: 6465 223a 2022 6e6f 6e65 222c 0a20 2020  de": "none",.   
+00019d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d10: 2020 2020 2022 7072 745f 6d6f 6465 223a       "prt_mode":
+00019d20: 2022 6669 7865 6422 2c0a 2020 2020 2020   "fixed",.      
+00019d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d40: 2020 2266 6978 6564 5f61 6e67 6c65 223a    "fixed_angle":
+00019d50: 2066 6978 6564 5f61 6e67 6c65 2c0a 2020   fixed_angle,.  
+00019d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d70: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+00019d80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00019d90: 2020 6966 2022 6366 2d66 756c 6c22 2069    if "cf-full" i
+00019da0: 6e20 7374 616e 6461 7264 3a0a 2020 2020  n standard:.    
+00019db0: 2020 2020 2020 2020 2020 2020 6675 6c6c              full
+00019dc0: 5f76 6172 7320 3d20 5f67 6574 5f6f 6469  _vars = _get_odi
+00019dd0: 6d5f 6675 6c6c 5f76 6172 7328 6e63 682c  m_full_vars(nch,
+00019de0: 2064 735f 6772 7073 290a 2020 2020 2020   ds_grps).      
+00019df0: 2020 2020 2020 2020 2020 7661 7273 2e75            vars.u
+00019e00: 7064 6174 6528 6675 6c6c 5f76 6172 7329  pdate(full_vars)
+00019e10: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00019e20: 6173 7369 676e 2076 6172 6961 626c 6573  assign variables
+00019e30: 2061 6e64 2063 6f6f 7264 696e 6174 6573   and coordinates
+00019e40: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
+00019e50: 3d20 6473 2e61 7373 6967 6e28 7661 7273  = ds.assign(vars
+00019e60: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
+00019e70: 203d 2064 732e 6173 7369 676e 5f63 6f6f   = ds.assign_coo
+00019e80: 7264 7328 2a2a 636f 6f72 6473 290a 2020  rds(**coords).  
+00019e90: 2020 2020 2020 2020 2020 6473 203d 2064            ds = d
+00019ea0: 732e 7265 6e61 6d65 287b 2264 696d 5f30  s.rename({"dim_0
+00019eb0: 223a 2064 696d 302c 2022 6469 6d5f 3122  ": dim0, "dim_1"
+00019ec0: 3a20 2272 616e 6765 227d 290a 0a20 2020  : "range"})..   
+00019ed0: 2020 2020 2020 2020 2023 2064 6563 6f64           # decod
+00019ee0: 6520 6461 7461 7365 7420 6966 2072 6571  e dataset if req
+00019ef0: 7565 7374 6564 0a20 2020 2020 2020 2020  uested.         
+00019f00: 2020 2069 6620 6465 636f 6465 5f74 696d     if decode_tim
+00019f10: 6573 206f 7220 6465 636f 6465 5f63 6f6f  es or decode_coo
+00019f20: 7264 7320 6f72 206d 6173 6b5f 616e 645f  rds or mask_and_
+00019f30: 7363 616c 653a 0a20 2020 2020 2020 2020  scale:.         
+00019f40: 2020 2020 2020 2064 7320 3d20 7872 2e64         ds = xr.d
+00019f50: 6563 6f64 655f 6366 280a 2020 2020 2020  ecode_cf(.      
+00019f60: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+00019f70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019f80: 2020 2020 2020 6465 636f 6465 5f74 696d        decode_tim
+00019f90: 6573 3d64 6563 6f64 655f 7469 6d65 732c  es=decode_times,
+00019fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019fb0: 2020 2020 2064 6563 6f64 655f 636f 6f72       decode_coor
+00019fc0: 6473 3d64 6563 6f64 655f 636f 6f72 6473  ds=decode_coords
+00019fd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019fe0: 2020 2020 2020 6d61 736b 5f61 6e64 5f73        mask_and_s
+00019ff0: 6361 6c65 3d6d 6173 6b5f 616e 645f 7363  cale=mask_and_sc
+0001a000: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
+0001a010: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001a020: 2020 2020 2320 6465 7465 726d 696e 6520      # determine 
+0001a030: 6966 2073 616d 6520 7377 6565 700a 2020  if same sweep.  
+0001a040: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0001a050: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001a060: 6e64 6578 203d 2073 656c 662e 7377 6565  ndex = self.swee
+0001a070: 705f 616e 676c 6573 2e69 6e64 6578 2866  p_angles.index(f
+0001a080: 6978 6564 5f61 6e67 6c65 290a 2020 2020  ixed_angle).    
+0001a090: 2020 2020 2020 2020 6578 6365 7074 2056          except V
+0001a0a0: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
+0001a0b0: 2020 2020 2020 2020 2020 206e 6964 7820             nidx 
+0001a0c0: 3d20 6c65 6e28 7365 6c66 2e5f 7377 6565  = len(self._swee
+0001a0d0: 7073 2920 2b20 310a 2020 2020 2020 2020  ps) + 1.        
+0001a0e0: 2020 2020 2020 2020 7377 705f 6772 705f          swp_grp_
+0001a0f0: 6e61 6d65 203d 2066 2273 7765 6570 5f7b  name = f"sweep_{
+0001a100: 6e69 6478 7d22 0a20 2020 2020 2020 2020  nidx}".         
+0001a110: 2020 2020 2020 2073 656c 662e 5f73 7765         self._swe
+0001a120: 6570 735b 7377 705f 6772 705f 6e61 6d65  eps[swp_grp_name
+0001a130: 5d20 3d20 6473 0a20 2020 2020 2020 2020  ] = ds.         
+0001a140: 2020 2020 2020 2073 656c 662e 7377 6565         self.swee
+0001a150: 705f 6e61 6d65 732e 6170 7065 6e64 2873  p_names.append(s
+0001a160: 7770 5f67 7270 5f6e 616d 6529 0a20 2020  wp_grp_name).   
+0001a170: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001a180: 662e 7377 6565 705f 616e 676c 6573 2e61  f.sweep_angles.a
+0001a190: 7070 656e 6428 6669 7865 645f 616e 676c  ppend(fixed_angl
+0001a1a0: 6529 0a20 2020 2020 2020 2020 2020 2065  e).            e
+0001a1b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001a1c0: 2020 2020 2064 6963 746b 6579 203d 2073       dictkey = s
+0001a1d0: 656c 662e 7377 6565 705f 6e61 6d65 735b  elf.sweep_names[
+0001a1e0: 696e 6465 785d 0a20 2020 2020 2020 2020  index].         
+0001a1f0: 2020 2020 2020 2073 656c 662e 5f73 7765         self._swe
+0001a200: 6570 735b 6469 6374 6b65 795d 203d 2078  eps[dictkey] = x
+0001a210: 722e 6d65 7267 6528 5b73 656c 662e 5f73  r.merge([self._s
+0001a220: 7765 6570 735b 6469 6374 6b65 795d 2c20  weeps[dictkey], 
+0001a230: 6473 5d29 0a0a 2020 2020 6465 6620 6173  ds])..    def as
+0001a240: 7369 676e 5f72 6f6f 7428 7365 6c66 293a  sign_root(self):
+0001a250: 0a20 2020 2020 2020 2023 2072 6574 7269  .        # retri
+0001a260: 6576 6520 616e 6420 6173 7369 676e 2067  eve and assign g
+0001a270: 6c6f 6261 6c20 6772 6f75 7073 202f 686f  lobal groups /ho
+0001a280: 772c 202f 7768 6174 2c20 2f77 6865 7265  w, /what, /where
+0001a290: 0a20 2020 2020 2020 2066 6972 7374 203d  .        first =
+0001a2a0: 2073 656c 662e 5f6e 6368 5b30 5d0a 0a20   self._nch[0].. 
+0001a2b0: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
+0001a2c0: 5b22 686f 7722 2c20 2277 6861 7422 2c20  ["how", "what", 
+0001a2d0: 2277 6865 7265 225d 0a20 2020 2020 2020  "where"].       
+0001a2e0: 2068 6f77 2c20 7768 6174 2c20 7768 6572   how, what, wher
+0001a2f0: 6520 3d20 5f67 6574 5f6f 6469 6d5f 6772  e = _get_odim_gr
+0001a300: 6f75 7073 2866 6972 7374 2e6e 6368 2c20  oups(first.nch, 
+0001a310: 6772 6f75 7073 290a 2020 2020 2020 2020  groups).        
+0001a320: 7274 5f67 7270 7320 3d20 7b22 686f 7722  rt_grps = {"how"
+0001a330: 3a20 686f 772c 2022 7768 6174 223a 2077  : how, "what": w
+0001a340: 6861 742c 2022 7768 6572 6522 3a20 7768  hat, "where": wh
+0001a350: 6572 657d 0a0a 2020 2020 2020 2020 2320  ere}..        # 
+0001a360: 6173 7369 676e 2072 6f6f 7420 7661 7269  assign root vari
+0001a370: 6162 6c65 730a 2020 2020 2020 2020 2320  ables.        # 
+0001a380: 6578 7472 6163 7420 7469 6d65 2063 6f76  extract time cov
+0001a390: 6572 6167 650a 2020 2020 2020 2020 746d  erage.        tm
+0001a3a0: 696e 203d 205b 6473 2e74 696d 652e 7661  in = [ds.time.va
+0001a3b0: 6c75 6573 2e6d 696e 2829 2066 6f72 2064  lues.min() for d
+0001a3c0: 7320 696e 2073 656c 662e 5f73 7765 6570  s in self._sweep
+0001a3d0: 732e 7661 6c75 6573 2829 5d0a 2020 2020  s.values()].    
+0001a3e0: 2020 2020 7469 6d65 5f63 6f76 6572 6167      time_coverag
+0001a3f0: 655f 7374 6172 7420 3d20 6d69 6e28 746d  e_start = min(tm
+0001a400: 696e 290a 2020 2020 2020 2020 746d 6178  in).        tmax
+0001a410: 203d 205b 6473 2e74 696d 652e 7661 6c75   = [ds.time.valu
+0001a420: 6573 2e6d 6178 2829 2066 6f72 2064 7320  es.max() for ds 
+0001a430: 696e 2073 656c 662e 5f73 7765 6570 732e  in self._sweeps.
+0001a440: 7661 6c75 6573 2829 5d0a 2020 2020 2020  values()].      
+0001a450: 2020 7469 6d65 5f63 6f76 6572 6167 655f    time_coverage_
+0001a460: 656e 6420 3d20 6d61 7828 746d 6178 290a  end = max(tmax).
+0001a470: 0a20 2020 2020 2020 2074 696d 655f 636f  .        time_co
+0001a480: 7665 7261 6765 5f73 7461 7274 5f73 7472  verage_start_str
+0001a490: 203d 2073 7472 2874 696d 655f 636f 7665   = str(time_cove
+0001a4a0: 7261 6765 5f73 7461 7274 295b 3a31 395d  rage_start)[:19]
+0001a4b0: 202b 2022 5a22 0a20 2020 2020 2020 2074   + "Z".        t
+0001a4c0: 696d 655f 636f 7665 7261 6765 5f65 6e64  ime_coverage_end
+0001a4d0: 5f73 7472 203d 2073 7472 2874 696d 655f  _str = str(time_
+0001a4e0: 636f 7665 7261 6765 5f65 6e64 295b 3a31  coverage_end)[:1
+0001a4f0: 395d 202b 2022 5a22 0a0a 2020 2020 2020  9] + "Z"..      
+0001a500: 2020 2320 6372 6561 7465 2072 6f6f 7420    # create root 
+0001a510: 6772 6f75 7020 6672 6f6d 2073 6372 6174  group from scrat
+0001a520: 6368 0a20 2020 2020 2020 2072 6f6f 7420  ch.        root 
+0001a530: 3d20 7872 2e44 6174 6173 6574 2864 6174  = xr.Dataset(dat
+0001a540: 615f 7661 7273 3d67 6c6f 6261 6c5f 7661  a_vars=global_va
+0001a550: 7269 6162 6c65 732c 2061 7474 7273 3d67  riables, attrs=g
+0001a560: 6c6f 6261 6c5f 6174 7472 7329 0a0a 2020  lobal_attrs)..  
+0001a570: 2020 2020 2020 2320 6173 7369 676e 2072        # assign r
+0001a580: 6f6f 7420 7661 7269 6162 6c65 730a 2020  oot variables.  
+0001a590: 2020 2020 2020 726f 6f74 203d 2072 6f6f        root = roo
+0001a5a0: 742e 6173 7369 676e 280a 2020 2020 2020  t.assign(.      
+0001a5b0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0001a5c0: 2020 2020 2020 2020 2276 6f6c 756d 655f          "volume_
+0001a5d0: 6e75 6d62 6572 223a 2030 2c0a 2020 2020  number": 0,.    
+0001a5e0: 2020 2020 2020 2020 2020 2020 2270 6c61              "pla
+0001a5f0: 7466 6f72 6d5f 7479 7065 223a 2073 7472  tform_type": str
+0001a600: 2822 6669 7865 6422 292c 0a20 2020 2020  ("fixed"),.     
+0001a610: 2020 2020 2020 2020 2020 2022 696e 7374             "inst
+0001a620: 7275 6d65 6e74 5f74 7970 6522 3a20 2272  rument_type": "r
+0001a630: 6164 6172 222c 0a20 2020 2020 2020 2020  adar",.         
+0001a640: 2020 2020 2020 2022 7072 696d 6172 795f         "primary_
+0001a650: 6178 6973 223a 2022 6178 6973 5f7a 222c  axis": "axis_z",
+0001a660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a670: 2022 7469 6d65 5f63 6f76 6572 6167 655f   "time_coverage_
+0001a680: 7374 6172 7422 3a20 7469 6d65 5f63 6f76  start": time_cov
+0001a690: 6572 6167 655f 7374 6172 745f 7374 722c  erage_start_str,
+0001a6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a6b0: 2022 7469 6d65 5f63 6f76 6572 6167 655f   "time_coverage_
+0001a6c0: 656e 6422 3a20 7469 6d65 5f63 6f76 6572  end": time_cover
+0001a6d0: 6167 655f 656e 645f 7374 722c 0a20 2020  age_end_str,.   
+0001a6e0: 2020 2020 2020 2020 2020 2020 2022 6c61               "la
+0001a6f0: 7469 7475 6465 223a 2072 745f 6772 7073  titude": rt_grps
+0001a700: 5b22 7768 6572 6522 5d2e 6174 7472 735b  ["where"].attrs[
+0001a710: 226c 6174 225d 2c0a 2020 2020 2020 2020  "lat"],.        
+0001a720: 2020 2020 2020 2020 226c 6f6e 6769 7475          "longitu
+0001a730: 6465 223a 2072 745f 6772 7073 5b22 7768  de": rt_grps["wh
+0001a740: 6572 6522 5d2e 6174 7472 735b 226c 6f6e  ere"].attrs["lon
+0001a750: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0001a760: 2020 2020 2261 6c74 6974 7564 6522 3a20      "altitude": 
+0001a770: 7274 5f67 7270 735b 2277 6865 7265 225d  rt_grps["where"]
+0001a780: 2e61 7474 7273 5b22 6865 6967 6874 225d  .attrs["height"]
+0001a790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a7a0: 2020 2273 7765 6570 5f67 726f 7570 5f6e    "sweep_group_n
+0001a7b0: 616d 6522 3a20 285b 2273 7765 6570 225d  ame": (["sweep"]
+0001a7c0: 2c20 7365 6c66 2e73 7765 6570 5f6e 616d  , self.sweep_nam
+0001a7d0: 6573 292c 0a20 2020 2020 2020 2020 2020  es),.           
+0001a7e0: 2020 2020 2022 7377 6565 705f 6669 7865       "sweep_fixe
+0001a7f0: 645f 616e 676c 6522 3a20 285b 2273 7765  d_angle": (["swe
+0001a800: 6570 225d 2c20 7365 6c66 2e73 7765 6570  ep"], self.sweep
+0001a810: 5f61 6e67 6c65 7329 2c0a 2020 2020 2020  _angles),.      
+0001a820: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0001a830: 290a 0a20 2020 2020 2020 2023 2061 7373  )..        # ass
+0001a840: 6967 6e20 726f 6f74 2061 7474 7269 6275  ign root attribu
+0001a850: 7465 730a 2020 2020 2020 2020 6174 7472  tes.        attr
+0001a860: 7320 3d20 5f67 6574 5f6f 6469 6d5f 726f  s = _get_odim_ro
+0001a870: 6f74 5f61 7474 7269 6275 7465 7328 6669  ot_attributes(fi
+0001a880: 7273 742c 2072 745f 6772 7073 290a 2020  rst, rt_grps).  
+0001a890: 2020 2020 2020 726f 6f74 203d 2072 6f6f        root = roo
+0001a8a0: 742e 6173 7369 676e 5f61 7474 7273 2861  t.assign_attrs(a
+0001a8b0: 7474 7273 290a 2020 2020 2020 2020 7365  ttrs).        se
+0001a8c0: 6c66 2e72 6f6f 7420 3d20 726f 6f74 0a0a  lf.root = root..
+0001a8d0: 0a64 6566 205f 7772 6974 655f 6f64 696d  .def _write_odim
+0001a8e0: 2873 7263 2c20 6465 7374 293a 0a20 2020  (src, dest):.   
+0001a8f0: 2022 2222 5772 6974 6573 204f 6469 6d20   """Writes Odim 
+0001a900: 4174 7472 6962 7574 6573 2e0a 0a20 2020  Attributes...   
+0001a910: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0001a920: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073  ----------.    s
+0001a930: 7263 203a 2064 6963 740a 2020 2020 2020  rc : dict.      
+0001a940: 2020 4174 7472 6962 7574 6573 2074 6f20    Attributes to 
+0001a950: 7772 6974 650a 2020 2020 6465 7374 203a  write.    dest :
+0001a960: 2068 616e 646c 650a 2020 2020 2020 2020   handle.        
+0001a970: 6835 7079 2d67 726f 7570 2068 616e 646c  h5py-group handl
+0001a980: 650a 2020 2020 2222 220a 2020 2020 666f  e.    """.    fo
+0001a990: 7220 6b65 792c 2076 616c 7565 2069 6e20  r key, value in 
+0001a9a0: 7372 632e 6974 656d 7328 293a 0a20 2020  src.items():.   
+0001a9b0: 2020 2020 2069 6620 6b65 7920 696e 2064       if key in d
+0001a9c0: 6573 742e 6174 7472 733a 0a20 2020 2020  est.attrs:.     
+0001a9d0: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
+0001a9e0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001a9f0: 7461 6e63 6528 7661 6c75 652c 2073 7472  tance(value, str
+0001aa00: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
+0001aa10: 6964 203d 2068 3570 792e 6835 742e 435f  id = h5py.h5t.C_
+0001aa20: 5331 2e63 6f70 7928 290a 2020 2020 2020  S1.copy().      
+0001aa30: 2020 2020 2020 7469 642e 7365 745f 7369        tid.set_si
+0001aa40: 7a65 286c 656e 2876 616c 7565 2920 2b20  ze(len(value) + 
+0001aa50: 3129 0a20 2020 2020 2020 2020 2020 2048  1).            H
+0001aa60: 3554 5f43 5f53 315f 4e45 5720 3d20 6835  5T_C_S1_NEW = h5
+0001aa70: 7079 2e44 6174 6174 7970 6528 7469 6429  py.Datatype(tid)
+0001aa80: 0a20 2020 2020 2020 2020 2020 2064 6573  .            des
+0001aa90: 742e 6174 7472 732e 6372 6561 7465 286b  t.attrs.create(k
+0001aaa0: 6579 2c20 7661 6c75 652c 2064 7479 7065  ey, value, dtype
+0001aab0: 3d48 3554 5f43 5f53 315f 4e45 5729 0a20  =H5T_C_S1_NEW). 
+0001aac0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001aad0: 2020 2020 2020 2020 2064 6573 742e 6174           dest.at
+0001aae0: 7472 735b 6b65 795d 203d 2076 616c 7565  trs[key] = value
+0001aaf0: 0a0a 0a64 6566 205f 7772 6974 655f 6f64  ...def _write_od
+0001ab00: 696d 5f64 6174 6173 7061 6365 2873 7263  im_dataspace(src
+0001ab10: 2c20 6465 7374 293a 0a20 2020 2022 2222  , dest):.    """
+0001ab20: 5772 6974 6573 204f 6469 6d20 4461 7461  Writes Odim Data
+0001ab30: 7370 6163 6573 2e0a 0a20 2020 2050 6172  spaces...    Par
+0001ab40: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+0001ab50: 2d2d 2d2d 2d2d 0a20 2020 2073 7263 203a  ------.    src :
+0001ab60: 2064 6963 740a 2020 2020 2020 2020 4d6f   dict.        Mo
+0001ab70: 6d65 6e74 7320 746f 2077 7269 7465 0a20  ments to write. 
+0001ab80: 2020 2064 6573 7420 3a20 6861 6e64 6c65     dest : handle
+0001ab90: 0a20 2020 2020 2020 2068 3570 792d 6772  .        h5py-gr
+0001aba0: 6f75 7020 6861 6e64 6c65 0a20 2020 2022  oup handle.    "
+0001abb0: 2222 0a20 2020 206b 6579 7320 3d20 5b6b  "".    keys = [k
+0001abc0: 6579 2066 6f72 206b 6579 2069 6e20 7372  ey for key in sr
+0001abd0: 6320 6966 206b 6579 2069 6e20 4f44 494d  c if key in ODIM
+0001abe0: 5f4e 414d 4553 5d0a 2020 2020 6461 7461  _NAMES].    data
+0001abf0: 5f6c 6973 7420 3d20 5b22 6461 7461 7b7d  _list = ["data{}
+0001ac00: 222e 666f 726d 6174 2869 202b 2031 2920  ".format(i + 1) 
+0001ac10: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+0001ac20: 656e 286b 6579 7329 295d 0a20 2020 2064  en(keys))].    d
+0001ac30: 6174 615f 6964 7820 3d20 6e70 2e61 7267  ata_idx = np.arg
+0001ac40: 736f 7274 2864 6174 615f 6c69 7374 290a  sort(data_list).
+0001ac50: 2020 2020 666f 7220 6964 7820 696e 2064      for idx in d
+0001ac60: 6174 615f 6964 783a 0a20 2020 2020 2020  ata_idx:.       
+0001ac70: 2076 616c 7565 203d 2073 7263 5b6b 6579   value = src[key
+0001ac80: 735b 6964 785d 5d0a 2020 2020 2020 2020  s[idx]].        
+0001ac90: 6835 5f64 6174 6120 3d20 6465 7374 2e63  h5_data = dest.c
+0001aca0: 7265 6174 655f 6772 6f75 7028 6461 7461  reate_group(data
+0001acb0: 5f6c 6973 745b 6964 785d 290a 2020 2020  _list[idx]).    
+0001acc0: 2020 2020 656e 6320 3d20 7661 6c75 652e      enc = value.
+0001acd0: 656e 636f 6469 6e67 0a0a 2020 2020 2020  encoding..      
+0001ace0: 2020 2320 702e 2032 3120 6666 0a20 2020    # p. 21 ff.   
+0001acf0: 2020 2020 2068 355f 7768 6174 203d 2068       h5_what = h
+0001ad00: 355f 6461 7461 2e63 7265 6174 655f 6772  5_data.create_gr
+0001ad10: 6f75 7028 2277 6861 7422 290a 2020 2020  oup("what").    
+0001ad20: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001ad30: 2020 2020 2075 6e64 6574 6563 7420 3d20       undetect = 
+0001ad40: 666c 6f61 7428 7661 6c75 652e 5f55 6e64  float(value._Und
+0001ad50: 6574 6563 7429 0a20 2020 2020 2020 2065  etect).        e
+0001ad60: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
+0001ad70: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0001ad80: 2020 756e 6465 7465 6374 203d 206e 702e    undetect = np.
+0001ad90: 6669 6e66 6f28 6e70 2e66 6c6f 6174 5f29  finfo(np.float_)
+0001ada0: 2e6d 6178 0a20 2020 2020 2020 2077 6861  .max.        wha
+0001adb0: 7420 3d20 7b0a 2020 2020 2020 2020 2020  t = {.          
+0001adc0: 2020 2271 7561 6e74 6974 7922 3a20 7661    "quantity": va
+0001add0: 6c75 652e 6e61 6d65 2c0a 2020 2020 2020  lue.name,.      
+0001ade0: 2020 2020 2020 2267 6169 6e22 3a20 666c        "gain": fl
+0001adf0: 6f61 7428 656e 635b 2273 6361 6c65 5f66  oat(enc["scale_f
+0001ae00: 6163 746f 7222 5d29 2c0a 2020 2020 2020  actor"]),.      
+0001ae10: 2020 2020 2020 226f 6666 7365 7422 3a20        "offset": 
+0001ae20: 666c 6f61 7428 656e 635b 2261 6464 5f6f  float(enc["add_o
+0001ae30: 6666 7365 7422 5d29 2c0a 2020 2020 2020  ffset"]),.      
+0001ae40: 2020 2020 2020 226e 6f64 6174 6122 3a20        "nodata": 
+0001ae50: 666c 6f61 7428 656e 635b 225f 4669 6c6c  float(enc["_Fill
+0001ae60: 5661 6c75 6522 5d29 2c0a 2020 2020 2020  Value"]),.      
+0001ae70: 2020 2020 2020 2275 6e64 6574 6563 7422        "undetect"
+0001ae80: 3a20 756e 6465 7465 6374 2c0a 2020 2020  : undetect,.    
+0001ae90: 2020 2020 7d0a 2020 2020 2020 2020 5f77      }.        _w
+0001aea0: 7269 7465 5f6f 6469 6d28 7768 6174 2c20  rite_odim(what, 
+0001aeb0: 6835 5f77 6861 7429 0a0a 2020 2020 2020  h5_what)..      
+0001aec0: 2020 2320 6d6f 6d65 6e74 7320 6861 6e64    # moments hand
+0001aed0: 6c69 6e67 0a20 2020 2020 2020 2076 616c  ling.        val
+0001aee0: 203d 2076 616c 7565 2e73 6f72 7462 7928   = value.sortby(
+0001aef0: 2261 7a69 6d75 7468 2229 2e76 616c 7565  "azimuth").value
+0001af00: 730a 2020 2020 2020 2020 6669 6c6c 7661  s.        fillva
+0001af10: 6c20 3d20 656e 635b 225f 4669 6c6c 5661  l = enc["_FillVa
+0001af20: 6c75 6522 5d20 2a20 656e 635b 2273 6361  lue"] * enc["sca
+0001af30: 6c65 5f66 6163 746f 7222 5d0a 2020 2020  le_factor"].    
+0001af40: 2020 2020 6669 6c6c 7661 6c20 2b3d 2065      fillval += e
+0001af50: 6e63 5b22 6164 645f 6f66 6673 6574 225d  nc["add_offset"]
+0001af60: 0a20 2020 2020 2020 2076 616c 5b6e 702e  .        val[np.
+0001af70: 6973 6e61 6e28 7661 6c29 5d20 3d20 6669  isnan(val)] = fi
+0001af80: 6c6c 7661 6c0a 2020 2020 2020 2020 7661  llval.        va
+0001af90: 6c20 3d20 2876 616c 202d 2065 6e63 5b22  l = (val - enc["
+0001afa0: 6164 645f 6f66 6673 6574 225d 2920 2f20  add_offset"]) / 
+0001afb0: 656e 635b 2273 6361 6c65 5f66 6163 746f  enc["scale_facto
+0001afc0: 7222 5d0a 2020 2020 2020 2020 7661 6c20  r"].        val 
+0001afd0: 3d20 6e70 2e72 696e 7428 7661 6c29 2e61  = np.rint(val).a
+0001afe0: 7374 7970 6528 656e 635b 2264 7479 7065  stype(enc["dtype
+0001aff0: 225d 290a 2020 2020 2020 2020 6473 203d  "]).        ds =
+0001b000: 2068 355f 6461 7461 2e63 7265 6174 655f   h5_data.create_
+0001b010: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
+0001b020: 2020 2020 2022 6461 7461 222c 0a20 2020       "data",.   
+0001b030: 2020 2020 2020 2020 2064 6174 613d 7661           data=va
+0001b040: 6c2c 0a20 2020 2020 2020 2020 2020 2063  l,.            c
+0001b050: 6f6d 7072 6573 7369 6f6e 3d22 677a 6970  ompression="gzip
+0001b060: 222c 0a20 2020 2020 2020 2020 2020 2063  ",.            c
+0001b070: 6f6d 7072 6573 7369 6f6e 5f6f 7074 733d  ompression_opts=
+0001b080: 362c 0a20 2020 2020 2020 2020 2020 2066  6,.            f
+0001b090: 696c 6c76 616c 7565 3d65 6e63 5b22 5f46  illvalue=enc["_F
+0001b0a0: 696c 6c56 616c 7565 225d 2c0a 2020 2020  illValue"],.    
+0001b0b0: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+0001b0c0: 2065 6e63 5b22 6474 7970 6522 5d20 3d3d   enc["dtype"] ==
+0001b0d0: 2022 7569 6e74 3822 3a0a 2020 2020 2020   "uint8":.      
+0001b0e0: 2020 2020 2020 696d 6167 6520 3d20 2249        image = "I
+0001b0f0: 4d41 4745 220a 2020 2020 2020 2020 2020  MAGE".          
+0001b100: 2020 7665 7273 696f 6e20 3d20 2231 2e32    version = "1.2
+0001b110: 220a 2020 2020 2020 2020 2020 2020 7469  ".            ti
+0001b120: 6431 203d 2068 3570 792e 6835 742e 435f  d1 = h5py.h5t.C_
+0001b130: 5331 2e63 6f70 7928 290a 2020 2020 2020  S1.copy().      
+0001b140: 2020 2020 2020 7469 6431 2e73 6574 5f73        tid1.set_s
+0001b150: 697a 6528 6c65 6e28 696d 6167 6529 202b  ize(len(image) +
+0001b160: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+0001b170: 4835 545f 435f 5331 5f49 4d47 203d 2068  H5T_C_S1_IMG = h
+0001b180: 3570 792e 4461 7461 7479 7065 2874 6964  5py.Datatype(tid
+0001b190: 3129 0a20 2020 2020 2020 2020 2020 2074  1).            t
+0001b1a0: 6964 3220 3d20 6835 7079 2e68 3574 2e43  id2 = h5py.h5t.C
+0001b1b0: 5f53 312e 636f 7079 2829 0a20 2020 2020  _S1.copy().     
+0001b1c0: 2020 2020 2020 2074 6964 322e 7365 745f         tid2.set_
+0001b1d0: 7369 7a65 286c 656e 2876 6572 7369 6f6e  size(len(version
+0001b1e0: 2920 2b20 3129 0a20 2020 2020 2020 2020  ) + 1).         
+0001b1f0: 2020 2048 3554 5f43 5f53 315f 5645 5220     H5T_C_S1_VER 
+0001b200: 3d20 6835 7079 2e44 6174 6174 7970 6528  = h5py.Datatype(
+0001b210: 7469 6432 290a 2020 2020 2020 2020 2020  tid2).          
+0001b220: 2020 6473 2e61 7474 7273 2e63 7265 6174    ds.attrs.creat
+0001b230: 6528 2243 4c41 5353 222c 2069 6d61 6765  e("CLASS", image
+0001b240: 2c20 6474 7970 653d 4835 545f 435f 5331  , dtype=H5T_C_S1
+0001b250: 5f49 4d47 290a 2020 2020 2020 2020 2020  _IMG).          
+0001b260: 2020 6473 2e61 7474 7273 2e63 7265 6174    ds.attrs.creat
+0001b270: 6528 2249 4d41 4745 5f56 4552 5349 4f4e  e("IMAGE_VERSION
+0001b280: 222c 2076 6572 7369 6f6e 2c20 6474 7970  ", version, dtyp
+0001b290: 653d 4835 545f 435f 5331 5f56 4552 290a  e=H5T_C_S1_VER).
+0001b2a0: 0a0a 6465 6620 5f6f 7065 6e5f 6461 7461  ..def _open_data
+0001b2b0: 7365 7428 6e63 682c 2067 7270 3d4e 6f6e  set(nch, grp=Non
+0001b2c0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
+0001b2d0: 2020 2222 224f 7065 6e20 6e65 7463 6466    """Open netcdf
+0001b2e0: 342f 6864 6635 2067 726f 7570 2061 7320  4/hdf5 group as 
+0001b2f0: 7861 7272 6179 2064 6174 6173 6574 2e0a  xarray dataset..
+0001b300: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0001b310: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001b320: 2020 206e 6368 203a 2068 616e 646c 650a     nch : handle.
+0001b330: 2020 2020 2020 2020 6e65 7463 6466 342d          netcdf4-
+0001b340: 6669 6c65 2068 616e 646c 650a 2020 2020  file handle.    
+0001b350: 6772 7020 3a20 7374 720a 2020 2020 2020  grp : str.      
+0001b360: 2020 6772 6f75 7020 746f 2061 6363 6573    group to acces
+0001b370: 730a 0a20 2020 2052 6574 7572 6e73 0a20  s..    Returns. 
+0001b380: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 206e     -------.    n
+0001b390: 6368 203a 2068 616e 646c 650a 2020 2020  ch : handle.    
+0001b3a0: 2020 2020 7861 7272 6179 2044 6174 6173      xarray Datas
+0001b3b0: 6574 2068 616e 646c 650a 2020 2020 2222  et handle.    ""
+0001b3c0: 220a 2020 2020 6966 2067 7270 2069 7320  ".    if grp is 
+0001b3d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001b3e0: 2020 6e63 6820 3d20 6e63 682e 6772 6f75    nch = nch.grou
+0001b3f0: 7073 2e67 6574 2867 7270 2c20 4661 6c73  ps.get(grp, Fals
+0001b400: 6529 0a20 2020 2069 6620 6e63 683a 0a20  e).    if nch:. 
+0001b410: 2020 2020 2020 206e 6368 203d 2078 722e         nch = xr.
+0001b420: 6f70 656e 5f64 6174 6173 6574 2878 722e  open_dataset(xr.
+0001b430: 6261 636b 656e 6473 2e4e 6574 4344 4634  backends.NetCDF4
+0001b440: 4461 7461 5374 6f72 6528 6e63 6829 2c20  DataStore(nch), 
+0001b450: 2a2a 6b77 6172 6773 290a 2020 2020 7265  **kwargs).    re
+0001b460: 7475 726e 206e 6368 0a0a 0a64 6566 205f  turn nch...def _
+0001b470: 6765 745f 6761 6d69 635f 7261 795f 6865  get_gamic_ray_he
+0001b480: 6164 6572 2866 696c 656e 616d 652c 2073  ader(filename, s
+0001b490: 6361 6e29 3a0a 2020 2020 2222 2252 6574  can):.    """Ret
+0001b4a0: 7572 6e73 2047 414d 4943 2072 6179 2068  urns GAMIC ray h
+0001b4b0: 6561 6465 7220 6469 6374 696f 6e61 7279  eader dictionary
+0001b4c0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0001b4d0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0001b4e0: 0a20 2020 2066 696c 656e 616d 6520 3a20  .    filename : 
+0001b4f0: 7374 720a 2020 2020 2020 2020 6669 6c65  str.        file
+0001b500: 6e61 6d65 206f 6620 4741 4d49 4320 6669  name of GAMIC fi
+0001b510: 6c65 0a20 2020 2073 6361 6e20 3a20 696e  le.    scan : in
+0001b520: 740a 2020 2020 2020 2020 4e75 6d62 6572  t.        Number
+0001b530: 206f 6620 7363 616e 2069 6e20 6669 6c65   of scan in file
+0001b540: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+0001b550: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 7661    -------.    va
+0001b560: 7273 203a 2064 6963 740a 2020 2020 2020  rs : dict.      
+0001b570: 2020 4f72 6465 7265 6444 6963 7420 6f66    OrderedDict of
+0001b580: 2072 6179 2068 6561 6465 7220 6974 656d   ray header item
+0001b590: 730a 2020 2020 2222 220a 2020 2020 2320  s.    """.    # 
+0001b5a0: 546f 446f 3a20 6d6f 7665 2072 6179 6865  ToDo: move rayhe
+0001b5b0: 6164 6572 2069 6e74 6f20 6f77 6e20 6461  ader into own da
+0001b5c0: 7461 7365 740a 2020 2020 6835 203d 2068  taset.    h5 = h
+0001b5d0: 3570 792e 4669 6c65 2866 696c 656e 616d  5py.File(filenam
+0001b5e0: 652c 206d 6f64 653d 2272 2229 0a20 2020  e, mode="r").   
+0001b5f0: 2072 6179 5f68 6561 6465 7220 3d20 6835   ray_header = h5
+0001b600: 5b22 7363 616e 7b7d 2f72 6179 5f68 6561  ["scan{}/ray_hea
+0001b610: 6465 7222 2e66 6f72 6d61 7428 7363 616e  der".format(scan
+0001b620: 295d 5b3a 5d0a 2020 2020 6835 2e63 6c6f  )][:].    h5.clo
+0001b630: 7365 2829 0a20 2020 2076 6172 7320 3d20  se().    vars = 
+0001b640: 636f 6c6c 6563 7469 6f6e 732e 4f72 6465  collections.Orde
+0001b650: 7265 6444 6963 7428 290a 2020 2020 666f  redDict().    fo
+0001b660: 7220 6e61 6d65 2069 6e20 7261 795f 6865  r name in ray_he
+0001b670: 6164 6572 2e64 7479 7065 2e6e 616d 6573  ader.dtype.names
+0001b680: 3a0a 2020 2020 2020 2020 7268 203d 2072  :.        rh = r
+0001b690: 6179 5f68 6561 6465 725b 6e61 6d65 5d0a  ay_header[name].
+0001b6a0: 2020 2020 2020 2020 6174 7472 7320 3d20          attrs = 
+0001b6b0: 4e6f 6e65 0a20 2020 2020 2020 2076 6172  None.        var
+0001b6c0: 732e 7570 6461 7465 287b 6e61 6d65 3a20  s.update({name: 
+0001b6d0: 285b 2264 696d 5f30 225d 2c20 7268 2c20  (["dim_0"], rh, 
+0001b6e0: 6174 7472 7329 7d29 0a20 2020 2072 6574  attrs)}).    ret
+0001b6f0: 7572 6e20 7661 7273 0a0a 0a64 6566 205f  urn vars...def _
+0001b700: 6765 745f 6f64 696d 5f73 7765 6570 5f67  get_odim_sweep_g
+0001b710: 726f 7570 5f6e 616d 6573 286e 6368 2c20  roup_names(nch, 
+0001b720: 6e61 6d65 293a 0a20 2020 2022 2222 5265  name):.    """Re
+0001b730: 7475 726e 2073 7765 6570 206e 616d 6573  turn sweep names
+0001b740: 2e0a 0a20 2020 2052 6574 7572 6e73 2073  ...    Returns s
+0001b750: 6f75 7263 6520 6e61 6d65 7320 616e 6420  ource names and 
+0001b760: 6366 7261 6469 616c 206e 616d 6573 2e0a  cfradial names..
+0001b770: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0001b780: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001b790: 2020 206e 6368 203a 2068 616e 646c 650a     nch : handle.
+0001b7a0: 2020 2020 2020 2020 6e65 7443 4446 3420          netCDF4 
+0001b7b0: 4461 7461 7365 7420 6861 6e64 6c65 0a20  Dataset handle. 
+0001b7c0: 2020 206e 616d 6520 3a20 7374 720a 2020     name : str.  
+0001b7d0: 2020 2020 2020 436f 6d6d 6f6e 2070 6172        Common par
+0001b7e0: 7420 6f66 2073 6f75 7263 6520 6461 7461  t of source data
+0001b7f0: 7365 7420 6e61 6d65 732e 0a0a 2020 2020  set names...    
+0001b800: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+0001b810: 2d2d 2d0a 2020 2020 7372 6320 3a20 6c69  ---.    src : li
+0001b820: 7374 0a20 2020 2020 2020 206c 6973 7420  st.        list 
+0001b830: 6f66 2073 6f75 7263 6520 6461 7461 7365  of source datase
+0001b840: 7420 6e61 6d65 730a 2020 2020 7377 675f  t names.    swg_
+0001b850: 6772 705f 6e61 6d65 203a 206c 6973 740a  grp_name : list.
+0001b860: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+0001b870: 636f 7272 6573 706f 6e64 696e 6720 6366  corresponding cf
+0001b880: 7261 6469 616c 2073 7765 6570 5f67 726f  radial sweep_gro
+0001b890: 7570 5f6e 616d 650a 2020 2020 2222 220a  up_name.    """.
+0001b8a0: 2020 2020 7372 6320 3d20 5b6b 6579 2066      src = [key f
+0001b8b0: 6f72 206b 6579 2069 6e20 6e63 682e 6772  or key in nch.gr
+0001b8c0: 6f75 7073 2e6b 6579 7328 2920 6966 206e  oups.keys() if n
+0001b8d0: 616d 6520 696e 206b 6579 5d0a 2020 2020  ame in key].    
+0001b8e0: 7372 632e 736f 7274 286b 6579 3d6c 616d  src.sort(key=lam
+0001b8f0: 6264 6120 783a 2069 6e74 2878 5b6c 656e  bda x: int(x[len
+0001b900: 286e 616d 6529 203a 5d29 290a 2020 2020  (name) :])).    
+0001b910: 7377 705f 6772 705f 6e61 6d65 203d 205b  swp_grp_name = [
+0001b920: 2273 7765 6570 5f7b 7d22 2e66 6f72 6d61  "sweep_{}".forma
+0001b930: 7428 6929 2066 6f72 2069 2069 6e20 7261  t(i) for i in ra
+0001b940: 6e67 6528 312c 206c 656e 2873 7263 2920  nge(1, len(src) 
+0001b950: 2b20 3129 5d0a 2020 2020 7265 7475 726e  + 1)].    return
+0001b960: 2073 7263 2c20 7377 705f 6772 705f 6e61   src, swp_grp_na
+0001b970: 6d65 0a0a 0a64 6566 205f 6765 745f 6f64  me...def _get_od
+0001b980: 696d 5f76 6172 6961 626c 6573 5f6d 6f6d  im_variables_mom
+0001b990: 656e 7473 2864 732c 206d 6f6d 656e 7473  ents(ds, moments
+0001b9a0: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
+0001b9b0: 3a0a 2020 2020 2222 2252 6574 7269 6576  :.    """Retriev
+0001b9c0: 6520 7261 6461 7220 6d6f 6d65 6e74 7320  e radar moments 
+0001b9d0: 6672 6f6d 2064 6174 6173 6574 2076 6172  from dataset var
+0001b9e0: 6961 626c 6573 2e0a 0a20 2020 2050 6172  iables...    Par
+0001b9f0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+0001ba00: 2d2d 2d2d 2d2d 0a20 2020 2064 7320 3a20  ------.    ds : 
+0001ba10: 7861 7272 6179 2064 6174 6173 6574 0a20  xarray dataset. 
+0001ba20: 2020 2020 2020 2073 6f75 7263 6520 6461         source da
+0001ba30: 7461 7365 740a 2020 2020 6d6f 6d65 6e74  taset.    moment
+0001ba40: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
+0001ba50: 206c 6973 7420 6f66 206d 6f6d 656e 7420   list of moment 
+0001ba60: 7374 7269 6e67 730a 0a20 2020 2052 6574  strings..    Ret
+0001ba70: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+0001ba80: 0a20 2020 2064 7320 3a20 7861 7272 6179  .    ds : xarray
+0001ba90: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
+0001baa0: 2061 6c74 6572 6564 2064 6174 6173 6574   altered dataset
+0001bab0: 0a20 2020 2022 2222 0a0a 2020 2020 7374  .    """..    st
+0001bac0: 616e 6461 7264 203d 206b 7761 7267 732e  andard = kwargs.
+0001bad0: 6765 7428 2273 7461 6e64 6172 6422 2c20  get("standard", 
+0001bae0: 2263 662d 6d61 6e64 6174 6f72 7922 290a  "cf-mandatory").
+0001baf0: 2020 2020 6d61 736b 5f61 6e64 5f73 6361      mask_and_sca
+0001bb00: 6c65 203d 206b 7761 7267 732e 6765 7428  le = kwargs.get(
+0001bb10: 226d 6173 6b5f 616e 645f 7363 616c 6522  "mask_and_scale"
+0001bb20: 2c20 5472 7565 290a 2020 2020 6465 636f  , True).    deco
+0001bb30: 6465 5f63 6f6f 7264 7320 3d20 6b77 6172  de_coords = kwar
+0001bb40: 6773 2e67 6574 2822 6465 636f 6465 5f63  gs.get("decode_c
+0001bb50: 6f6f 7264 7322 2c20 5472 7565 290a 0a20  oords", True).. 
+0001bb60: 2020 2023 2066 6978 2064 696d 656e 7369     # fix dimensi
+0001bb70: 6f6e 730a 2020 2020 6469 6d73 203d 2073  ons.    dims = s
+0001bb80: 6f72 7465 6428 6c69 7374 2864 732e 6469  orted(list(ds.di
+0001bb90: 6d73 2e6b 6579 7328 2929 2c20 6b65 793d  ms.keys()), key=
+0001bba0: 6c61 6d62 6461 2078 3a20 696e 7428 785b  lambda x: int(x[
+0001bbb0: 6c65 6e28 2270 686f 6e79 5f64 696d 5f22  len("phony_dim_"
+0001bbc0: 2920 3a5d 2929 0a0a 2020 2020 6473 203d  ) :]))..    ds =
+0001bbd0: 2064 732e 7265 6e61 6d65 287b 6469 6d73   ds.rename({dims
+0001bbe0: 5b30 5d3a 2022 6469 6d5f 3022 2c20 6469  [0]: "dim_0", di
+0001bbf0: 6d73 5b31 5d3a 2022 6469 6d5f 3122 7d29  ms[1]: "dim_1"})
+0001bc00: 0a0a 2020 2020 666f 7220 6d6f 6d20 696e  ..    for mom in
+0001bc10: 206d 6f6d 656e 7473 3a0a 2020 2020 2020   moments:.      
+0001bc20: 2020 2320 6f70 656e 2064 6174 6158 2064    # open dataX d
+0001bc30: 6174 6173 6574 0a20 2020 2020 2020 2064  ataset.        d
+0001bc40: 6d6f 6d20 3d20 6473 5b6d 6f6d 5d0a 2020  mom = ds[mom].  
+0001bc50: 2020 2020 2020 6e61 6d65 203d 2064 6d6f        name = dmo
+0001bc60: 6d2e 6d6f 6d65 6e74 2e6c 6f77 6572 2829  m.moment.lower()
+0001bc70: 0a20 2020 2020 2020 2069 6620 2263 6622  .        if "cf"
+0001bc80: 2069 6e20 7374 616e 6461 7264 2061 6e64   in standard and
+0001bc90: 206e 616d 6520 6e6f 7420 696e 2047 414d   name not in GAM
+0001bca0: 4943 5f4e 414d 4553 2e6b 6579 7328 293a  IC_NAMES.keys():
+0001bcb0: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
+0001bcc0: 3d20 6473 2e64 726f 705f 7661 7273 286d  = ds.drop_vars(m
+0001bcd0: 6f6d 290a 2020 2020 2020 2020 2020 2020  om).            
+0001bce0: 636f 6e74 696e 7565 0a0a 2020 2020 2020  continue..      
+0001bcf0: 2020 2320 6578 7472 6163 7420 6174 7472    # extract attr
+0001bd00: 6962 7574 6573 0a20 2020 2020 2020 2064  ibutes.        d
+0001bd10: 6d61 7820 3d20 6e70 2e69 696e 666f 2864  max = np.iinfo(d
+0001bd20: 6d6f 6d2e 6474 7970 6529 2e6d 6178 0a20  mom.dtype).max. 
+0001bd30: 2020 2020 2020 2064 6d69 6e20 3d20 6e70         dmin = np
+0001bd40: 2e69 696e 666f 2864 6d6f 6d2e 6474 7970  .iinfo(dmom.dtyp
+0001bd50: 6529 2e6d 696e 0a20 2020 2020 2020 206d  e).min.        m
+0001bd60: 696e 7661 6c20 3d20 646d 6f6d 2e64 796e  inval = dmom.dyn
+0001bd70: 5f72 616e 6765 5f6d 696e 0a20 2020 2020  _range_min.     
+0001bd80: 2020 206d 6178 7661 6c20 3d20 646d 6f6d     maxval = dmom
+0001bd90: 2e64 796e 5f72 616e 6765 5f6d 6178 0a20  .dyn_range_max. 
+0001bda0: 2020 2020 2020 2067 6169 6e20 3d20 286d         gain = (m
+0001bdb0: 6178 7661 6c20 2d20 6d69 6e76 616c 2920  axval - minval) 
+0001bdc0: 2f20 646d 6178 0a20 2020 2020 2020 206f  / dmax.        o
+0001bdd0: 6666 7365 7420 3d20 6d69 6e76 616c 0a20  ffset = minval. 
+0001bde0: 2020 2020 2020 2066 696c 6c76 616c 203d         fillval =
+0001bdf0: 2066 6c6f 6174 2864 6d61 7829 0a20 2020   float(dmax).   
+0001be00: 2020 2020 2075 6e64 6574 6563 7420 3d20       undetect = 
+0001be10: 666c 6f61 7428 646d 696e 290a 0a20 2020  float(dmin)..   
+0001be20: 2020 2020 2023 2063 7265 6174 6520 6174       # create at
+0001be30: 7472 6962 7574 6520 6469 6374 0a20 2020  tribute dict.   
+0001be40: 2020 2020 2061 7474 7273 203d 2063 6f6c       attrs = col
+0001be50: 6c65 6374 696f 6e73 2e4f 7264 6572 6564  lections.Ordered
+0001be60: 4469 6374 2829 0a20 2020 2020 2020 2023  Dict().        #
+0001be70: 2063 6c65 616e 206d 6f6d 656e 7420 6174   clean moment at
+0001be80: 7472 6962 7574 6573 0a20 2020 2020 2020  tributes.       
+0001be90: 2069 6620 7374 616e 6461 7264 2021 3d20   if standard != 
+0001bea0: 226e 6f6e 6522 3a0a 2020 2020 2020 2020  "none":.        
+0001beb0: 2020 2020 646d 6f6d 2e61 7474 7273 203d      dmom.attrs =
+0001bec0: 2063 6f6c 6c65 6374 696f 6e73 2e4f 7264   collections.Ord
+0001bed0: 6572 6564 4469 6374 2829 0a0a 2020 2020  eredDict()..    
+0001bee0: 2020 2020 6966 2073 7461 6e64 6172 6420      if standard 
+0001bef0: 696e 205b 226f 6469 6d22 5d3a 0a20 2020  in ["odim"]:.   
+0001bf00: 2020 2020 2020 2020 2061 7474 7273 5b22           attrs["
+0001bf10: 6761 696e 225d 203d 2067 6169 6e0a 2020  gain"] = gain.  
+0001bf20: 2020 2020 2020 2020 2020 6174 7472 735b            attrs[
+0001bf30: 226f 6666 7365 7422 5d20 3d20 6f66 6673  "offset"] = offs
+0001bf40: 6574 0a20 2020 2020 2020 2020 2020 2061  et.            a
+0001bf50: 7474 7273 5b22 6e6f 6461 7461 225d 203d  ttrs["nodata"] =
+0001bf60: 2066 696c 6c76 616c 0a20 2020 2020 2020   fillval.       
+0001bf70: 2020 2020 2061 7474 7273 5b22 756e 6465       attrs["unde
+0001bf80: 7465 6374 225d 203d 2075 6e64 6574 6563  tect"] = undetec
+0001bf90: 740a 0a20 2020 2020 2020 2023 2061 6464  t..        # add
+0001bfa0: 2063 6672 6164 6961 6c20 6d6f 6d65 6e74   cfradial moment
+0001bfb0: 2061 7474 7269 6275 7465 730a 2020 2020   attributes.    
+0001bfc0: 2020 2020 6966 2022 6366 2220 696e 2073      if "cf" in s
+0001bfd0: 7461 6e64 6172 6420 6f72 206d 6173 6b5f  tandard or mask_
+0001bfe0: 616e 645f 7363 616c 653a 0a20 2020 2020  and_scale:.     
+0001bff0: 2020 2020 2020 2061 7474 7273 5b22 7363         attrs["sc
+0001c000: 616c 655f 6661 6374 6f72 225d 203d 2067  ale_factor"] = g
+0001c010: 6169 6e0a 2020 2020 2020 2020 2020 2020  ain.            
+0001c020: 6174 7472 735b 2261 6464 5f6f 6666 7365  attrs["add_offse
+0001c030: 7422 5d20 3d20 6d69 6e76 616c 0a20 2020  t"] = minval.   
+0001c040: 2020 2020 2020 2020 2061 7474 7273 5b22           attrs["
+0001c050: 5f46 696c 6c56 616c 7565 225d 203d 2066  _FillValue"] = f
+0001c060: 6c6f 6174 2864 6d61 7829 0a0a 2020 2020  loat(dmax)..    
+0001c070: 2020 2020 6966 2022 6366 2220 696e 2073      if "cf" in s
+0001c080: 7461 6e64 6172 6420 6f72 2064 6563 6f64  tandard or decod
+0001c090: 655f 636f 6f72 6473 3a0a 2020 2020 2020  e_coords:.      
+0001c0a0: 2020 2020 2020 6174 7472 735b 2263 6f6f        attrs["coo
+0001c0b0: 7264 696e 6174 6573 225d 203d 2022 656c  rdinates"] = "el
+0001c0c0: 6576 6174 696f 6e20 617a 696d 7574 6820  evation azimuth 
+0001c0d0: 7261 6e67 6522 0a0a 2020 2020 2020 2020  range"..        
+0001c0e0: 6966 2022 6675 6c6c 2220 696e 2073 7461  if "full" in sta
+0001c0f0: 6e64 6172 643a 0a20 2020 2020 2020 2020  ndard:.         
+0001c100: 2020 2061 7474 7273 5b22 5f55 6e64 6574     attrs["_Undet
+0001c110: 6563 7422 5d20 3d20 756e 6465 7465 6374  ect"] = undetect
+0001c120: 0a0a 2020 2020 2020 2020 6966 2022 6366  ..        if "cf
+0001c130: 2220 696e 2073 7461 6e64 6172 643a 0a20  " in standard:. 
+0001c140: 2020 2020 2020 2020 2020 2063 666e 616d             cfnam
+0001c150: 6520 3d20 4741 4d49 435f 4e41 4d45 535b  e = GAMIC_NAMES[
+0001c160: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+0001c170: 2020 666f 7220 6b2c 2076 2069 6e20 6d6f    for k, v in mo
+0001c180: 6d65 6e74 735f 6d61 7070 696e 675b 6366  ments_mapping[cf
+0001c190: 6e61 6d65 5d2e 6974 656d 7328 293a 0a20  name].items():. 
+0001c1a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001c1b0: 7474 7273 5b6b 5d20 3d20 760a 2020 2020  ttrs[k] = v.    
+0001c1c0: 2020 2020 2020 2020 6e61 6d65 203d 2061          name = a
+0001c1d0: 7474 7273 2e70 6f70 2822 7368 6f72 745f  ttrs.pop("short_
+0001c1e0: 6e61 6d65 2229 0a20 2020 2020 2020 2020  name").         
+0001c1f0: 2020 2061 7474 7273 2e70 6f70 2822 6761     attrs.pop("ga
+0001c200: 6d69 6322 290a 0a20 2020 2020 2020 2023  mic")..        #
+0001c210: 2061 7373 6967 6e20 6174 7472 6962 7574   assign attribut
+0001c220: 6573 2074 6f20 6d6f 6d65 6e74 0a20 2020  es to moment.   
+0001c230: 2020 2020 2064 6d6f 6d2e 6174 7472 732e       dmom.attrs.
+0001c240: 7570 6461 7465 2861 7474 7273 290a 0a20  update(attrs).. 
+0001c250: 2020 2020 2020 2023 206b 6565 7020 6f72         # keep or
+0001c260: 6967 696e 616c 2064 6174 6173 6574 206e  iginal dataset n
+0001c270: 616d 650a 2020 2020 2020 2020 6966 2073  ame.        if s
+0001c280: 7461 6e64 6172 6420 213d 2022 6e6f 6e65  tandard != "none
+0001c290: 223a 0a20 2020 2020 2020 2020 2020 2064  ":.            d
+0001c2a0: 7320 3d20 6473 2e72 656e 616d 6528 7b6d  s = ds.rename({m
+0001c2b0: 6f6d 3a20 6e61 6d65 2e75 7070 6572 2829  om: name.upper()
+0001c2c0: 7d29 0a0a 2020 2020 7265 7475 726e 2064  })..    return d
+0001c2d0: 730a 0a0a 6465 6620 5f67 6574 5f6f 6469  s...def _get_odi
+0001c2e0: 6d5f 6772 6f75 705f 6d6f 6d65 6e74 7328  m_group_moments(
+0001c2f0: 6e63 682c 2073 7765 6570 2c20 6d6f 6d65  nch, sweep, mome
+0001c300: 6e74 733d 4e6f 6e65 2c20 2a2a 6b77 6172  nts=None, **kwar
+0001c310: 6773 293a 0a20 2020 2022 2222 5265 7472  gs):.    """Retr
+0001c320: 6965 7665 2072 6164 6172 206d 6f6d 656e  ieve radar momen
+0001c330: 7473 2066 726f 6d20 6864 6620 6772 6f75  ts from hdf grou
+0001c340: 7073 2e0a 0a20 2020 2050 6172 616d 6574  ps...    Paramet
+0001c350: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+0001c360: 2d2d 0a20 2020 206e 6368 203a 206e 6574  --.    nch : net
+0001c370: 4344 4620 4461 7461 7365 7420 6861 6e64  CDF Dataset hand
+0001c380: 6c65 0a20 2020 2073 7765 6570 203a 2073  le.    sweep : s
+0001c390: 7472 0a20 2020 2020 2020 2073 7765 6570  tr.        sweep
+0001c3a0: 206b 6579 0a20 2020 206d 6f6d 656e 7473   key.    moments
+0001c3b0: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
+0001c3c0: 6c69 7374 206f 6620 6d6f 6d65 6e74 2073  list of moment s
+0001c3d0: 7472 696e 6773 0a0a 2020 2020 5265 7475  trings..    Retu
+0001c3e0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+0001c3f0: 2020 2020 6473 203a 2064 6963 7469 6f6e      ds : diction
+0001c400: 6172 790a 2020 2020 2020 2020 6d6f 6d65  ary.        mome
+0001c410: 6e74 2064 6174 6173 6574 730a 2020 2020  nt datasets.    
+0001c420: 2222 220a 0a20 2020 2073 7461 6e64 6172  """..    standar
+0001c430: 6420 3d20 6b77 6172 6773 2e67 6574 2822  d = kwargs.get("
+0001c440: 7374 616e 6461 7264 222c 2022 6366 2d6d  standard", "cf-m
+0001c450: 616e 6461 746f 7279 2229 0a20 2020 206d  andatory").    m
+0001c460: 6173 6b5f 616e 645f 7363 616c 6520 3d20  ask_and_scale = 
+0001c470: 6b77 6172 6773 2e67 6574 2822 6d61 736b  kwargs.get("mask
+0001c480: 5f61 6e64 5f73 6361 6c65 222c 2054 7275  _and_scale", Tru
+0001c490: 6529 0a20 2020 2064 6563 6f64 655f 636f  e).    decode_co
+0001c4a0: 6f72 6473 203d 206b 7761 7267 732e 6765  ords = kwargs.ge
+0001c4b0: 7428 2264 6563 6f64 655f 636f 6f72 6473  t("decode_coords
+0001c4c0: 222c 2054 7275 6529 0a20 2020 2063 6875  ", True).    chu
+0001c4d0: 6e6b 7320 3d20 6b77 6172 6773 2e67 6574  nks = kwargs.get
+0001c4e0: 2822 6368 756e 6b73 222c 204e 6f6e 6529  ("chunks", None)
+0001c4f0: 0a0a 2020 2020 6461 7461 7320 3d20 7b7d  ..    datas = {}
+0001c500: 0a20 2020 2066 6f72 206d 6f6d 2069 6e20  .    for mom in 
+0001c510: 6d6f 6d65 6e74 733a 0a20 2020 2020 2020  moments:.       
+0001c520: 2064 6d6f 6d5f 7768 6174 203d 205f 6f70   dmom_what = _op
+0001c530: 656e 5f64 6174 6173 6574 286e 6368 5b73  en_dataset(nch[s
+0001c540: 7765 6570 5d5b 6d6f 6d5d 2c20 2277 6861  weep][mom], "wha
+0001c550: 7422 2c20 6368 756e 6b73 3d63 6875 6e6b  t", chunks=chunk
+0001c560: 7329 0a20 2020 2020 2020 206e 616d 6520  s).        name 
+0001c570: 3d20 646d 6f6d 5f77 6861 742e 6174 7472  = dmom_what.attr
+0001c580: 732e 706f 7028 2271 7561 6e74 6974 7922  s.pop("quantity"
+0001c590: 290a 2020 2020 2020 2020 6966 2022 6366  ).        if "cf
+0001c5a0: 2220 696e 2073 7461 6e64 6172 6420 616e  " in standard an
+0001c5b0: 6420 6e61 6d65 206e 6f74 2069 6e20 6d6f  d name not in mo
+0001c5c0: 6d65 6e74 735f 6d61 7070 696e 672e 6b65  ments_mapping.ke
+0001c5d0: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+0001c5e0: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+0001c5f0: 2020 2064 736d 6f6d 203d 205f 6f70 656e     dsmom = _open
+0001c600: 5f64 6174 6173 6574 286e 6368 5b73 7765  _dataset(nch[swe
+0001c610: 6570 5d2c 206d 6f6d 2c20 6368 756e 6b73  ep], mom, chunks
+0001c620: 3d63 6875 6e6b 7329 0a0a 2020 2020 2020  =chunks)..      
+0001c630: 2020 2320 6372 6561 7465 2061 7474 7269    # create attri
+0001c640: 6275 7465 2064 6963 740a 2020 2020 2020  bute dict.      
+0001c650: 2020 6174 7472 7320 3d20 636f 6c6c 6563    attrs = collec
+0001c660: 7469 6f6e 732e 4f72 6465 7265 6444 6963  tions.OrderedDic
+0001c670: 7428 290a 0a20 2020 2020 2020 2069 6620  t()..        if 
+0001c680: 7374 616e 6461 7264 2069 6e20 5b22 6f64  standard in ["od
+0001c690: 696d 225d 3a0a 2020 2020 2020 2020 2020  im"]:.          
+0001c6a0: 2020 6174 7472 732e 7570 6461 7465 2864    attrs.update(d
+0001c6b0: 6d6f 6d5f 7768 6174 2e61 7474 7273 290a  mom_what.attrs).
+0001c6c0: 0a20 2020 2020 2020 2023 2061 6464 2063  .        # add c
+0001c6d0: 6672 6164 6961 6c20 6d6f 6d65 6e74 2061  fradial moment a
+0001c6e0: 7474 7269 6275 7465 730a 2020 2020 2020  ttributes.      
+0001c6f0: 2020 6966 2022 6366 2220 696e 2073 7461    if "cf" in sta
+0001c700: 6e64 6172 6420 6f72 206d 6173 6b5f 616e  ndard or mask_an
+0001c710: 645f 7363 616c 653a 0a20 2020 2020 2020  d_scale:.       
+0001c720: 2020 2020 2061 7474 7273 5b22 7363 616c       attrs["scal
+0001c730: 655f 6661 6374 6f72 225d 203d 2064 6d6f  e_factor"] = dmo
+0001c740: 6d5f 7768 6174 2e61 7474 7273 2e67 6574  m_what.attrs.get
+0001c750: 2822 6761 696e 2229 0a20 2020 2020 2020  ("gain").       
+0001c760: 2020 2020 2061 7474 7273 5b22 6164 645f       attrs["add_
+0001c770: 6f66 6673 6574 225d 203d 2064 6d6f 6d5f  offset"] = dmom_
+0001c780: 7768 6174 2e61 7474 7273 2e67 6574 2822  what.attrs.get("
+0001c790: 6f66 6673 6574 2229 0a20 2020 2020 2020  offset").       
+0001c7a0: 2020 2020 2061 7474 7273 5b22 5f46 696c       attrs["_Fil
+0001c7b0: 6c56 616c 7565 225d 203d 2064 6d6f 6d5f  lValue"] = dmom_
+0001c7c0: 7768 6174 2e61 7474 7273 2e67 6574 2822  what.attrs.get("
+0001c7d0: 6e6f 6461 7461 2229 0a20 2020 2020 2020  nodata").       
+0001c7e0: 2069 6620 2263 6622 2069 6e20 7374 616e   if "cf" in stan
+0001c7f0: 6461 7264 206f 7220 6465 636f 6465 5f63  dard or decode_c
+0001c800: 6f6f 7264 733a 0a20 2020 2020 2020 2020  oords:.         
+0001c810: 2020 2061 7474 7273 5b22 636f 6f72 6469     attrs["coordi
+0001c820: 6e61 7465 7322 5d20 3d20 2265 6c65 7661  nates"] = "eleva
+0001c830: 7469 6f6e 2061 7a69 6d75 7468 2072 616e  tion azimuth ran
+0001c840: 6765 220a 2020 2020 2020 2020 6966 2022  ge".        if "
+0001c850: 6366 2220 696e 2073 7461 6e64 6172 643a  cf" in standard:
+0001c860: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001c870: 206b 2c20 7620 696e 206d 6f6d 656e 7473   k, v in moments
+0001c880: 5f6d 6170 7069 6e67 5b6e 616d 655d 2e69  _mapping[name].i
+0001c890: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0001c8a0: 2020 2020 2020 2020 6174 7472 735b 6b5d          attrs[k]
+0001c8b0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+0001c8c0: 2023 2064 726f 7020 7368 6f72 745f 6e61   # drop short_na
+0001c8d0: 6d65 0a20 2020 2020 2020 2020 2020 2061  me.            a
+0001c8e0: 7474 7273 2e70 6f70 2822 7368 6f72 745f  ttrs.pop("short_
+0001c8f0: 6e61 6d65 2229 0a20 2020 2020 2020 2020  name").         
+0001c900: 2020 2061 7474 7273 2e70 6f70 2822 6761     attrs.pop("ga
+0001c910: 6d69 6322 290a 2020 2020 2020 2020 6966  mic").        if
+0001c920: 2022 6675 6c6c 2220 696e 2073 7461 6e64   "full" in stand
+0001c930: 6172 643a 0a20 2020 2020 2020 2020 2020  ard:.           
+0001c940: 2061 7474 7273 5b22 5f55 6e64 6574 6563   attrs["_Undetec
+0001c950: 7422 5d20 3d20 646d 6f6d 5f77 6861 742e  t"] = dmom_what.
+0001c960: 6174 7472 732e 6765 7428 2275 6e64 6574  attrs.get("undet
+0001c970: 6563 7422 290a 0a20 2020 2020 2020 2023  ect")..        #
+0001c980: 2061 7373 6967 6e20 6174 7472 6962 7574   assign attribut
+0001c990: 6573 0a20 2020 2020 2020 2064 6d6f 6d20  es.        dmom 
+0001c9a0: 3d20 6473 6d6f 6d2e 6461 7461 2e61 7373  = dsmom.data.ass
+0001c9b0: 6967 6e5f 6174 7472 7328 6174 7472 7329  ign_attrs(attrs)
+0001c9c0: 0a0a 2020 2020 2020 2020 2320 6b65 6570  ..        # keep
+0001c9d0: 206f 7269 6769 6e61 6c20 6461 7461 7365   original datase
+0001c9e0: 7420 6e61 6d65 0a20 2020 2020 2020 2069  t name.        i
+0001c9f0: 6620 7374 616e 6461 7264 203d 3d20 226e  f standard == "n
+0001ca00: 6f6e 6522 3a0a 2020 2020 2020 2020 2020  one":.          
+0001ca10: 2020 6e61 6d65 203d 206d 6f6d 0a0a 2020    name = mom..  
+0001ca20: 2020 2020 2020 2320 6669 7820 6469 6d65        # fix dime
+0001ca30: 6e73 696f 6e73 0a20 2020 2020 2020 2064  nsions.        d
+0001ca40: 696d 7320 3d20 646d 6f6d 2e64 696d 730a  ims = dmom.dims.
+0001ca50: 2020 2020 2020 2020 6461 7461 732e 7570          datas.up
+0001ca60: 6461 7465 287b 6e61 6d65 3a20 646d 6f6d  date({name: dmom
+0001ca70: 2e72 656e 616d 6528 7b64 696d 735b 305d  .rename({dims[0]
+0001ca80: 3a20 2264 696d 5f30 222c 2064 696d 735b  : "dim_0", dims[
+0001ca90: 315d 3a20 2264 696d 5f31 227d 297d 290a  1]: "dim_1"})}).
+0001caa0: 2020 2020 7265 7475 726e 2064 6174 6173      return datas
+0001cab0: 0a0a 0a64 6566 205f 6765 745f 6f64 696d  ...def _get_odim
+0001cac0: 5f67 726f 7570 7328 6e63 662c 2067 726f  _groups(ncf, gro
+0001cad0: 7570 732c 202a 2a6b 7761 7267 7329 3a0a  ups, **kwargs):.
+0001cae0: 2020 2020 2222 2247 6574 2068 6466 2067      """Get hdf g
+0001caf0: 726f 7570 732e 0a0a 2020 2020 5061 7261  roups...    Para
+0001cb00: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+0001cb10: 2d2d 2d2d 2d0a 2020 2020 6e63 6620 3a20  -----.    ncf : 
+0001cb20: 6e65 7443 4466 3420 4461 7461 7365 7420  netCDf4 Dataset 
+0001cb30: 6861 6e64 6c65 0a20 2020 2067 726f 7570  handle.    group
+0001cb40: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
+0001cb50: 206c 6973 7420 6f66 2067 726f 7570 732d   list of groups-
+0001cb60: 6b65 7973 0a0a 2020 2020 5265 7475 726e  keys..    Return
+0001cb70: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0001cb80: 2020 6f75 7420 3a20 7475 706c 650a 2020    out : tuple.  
+0001cb90: 2020 2020 2020 7475 706c 6520 6f66 2078        tuple of x
+0001cba0: 6172 7261 7920 6461 7461 7365 7473 0a20  array datasets. 
+0001cbb0: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+0001cbc0: 6e20 7475 706c 6528 6d61 7028 6c61 6d62  n tuple(map(lamb
+0001cbd0: 6461 2078 3a20 5f6f 7065 6e5f 6461 7461  da x: _open_data
+0001cbe0: 7365 7428 6e63 662c 2078 2c20 2a2a 6b77  set(ncf, x, **kw
+0001cbf0: 6172 6773 292c 2067 726f 7570 7329 290a  args), groups)).
+0001cc00: 0a0a 6465 6620 5f67 6574 5f6f 6469 6d5f  ..def _get_odim_
+0001cc10: 6d6f 6d65 6e74 5f6e 616d 6573 2873 7765  moment_names(swe
+0001cc20: 6570 2c20 666d 743d 4e6f 6e65 2c20 7372  ep, fmt=None, sr
+0001cc30: 633d 4e6f 6e65 293a 0a20 2020 2022 2222  c=None):.    """
+0001cc40: 4765 7420 6d6f 6d65 6e74 206e 616d 6573  Get moment names
+0001cc50: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0001cc60: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0001cc70: 0a20 2020 2073 7765 6570 203a 206e 6574  .    sweep : net
+0001cc80: 4344 6634 2047 726f 7570 2068 616e 646c  CDf4 Group handl
+0001cc90: 650a 2020 2020 666d 7420 3a20 7374 720a  e.    fmt : str.
+0001cca0: 2020 2020 2020 2020 6461 7461 7365 7420          dataset 
+0001ccb0: 6465 7363 7269 7074 6f72 2066 6f72 6d61  descriptor forma
+0001ccc0: 740a 2020 2020 7372 6320 3a20 7374 720a  t.    src : str.
+0001ccd0: 2020 2020 2020 2020 6461 7461 7365 7420          dataset 
+0001cce0: 6c6f 6361 7469 6f6e 0a0a 2020 2020 5265  location..    Re
+0001ccf0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+0001cd00: 2d0a 2020 2020 6f75 7420 3a20 3a63 6c61  -.    out : :cla
+0001cd10: 7373 3a60 6e75 6d70 793a 6e75 6d70 792e  ss:`numpy:numpy.
+0001cd20: 6e64 6172 7261 7960 0a20 2020 2020 2020  ndarray`.       
+0001cd30: 2061 7272 6179 206f 6620 6d6f 6d65 6e74   array of moment
+0001cd40: 206e 616d 6573 0a20 2020 2022 2222 0a20   names.    """. 
+0001cd50: 2020 206d 6f6d 656e 7473 203d 205b 6d6f     moments = [mo
+0001cd60: 6d20 666f 7220 6d6f 6d20 696e 2067 6574  m for mom in get
+0001cd70: 6174 7472 2873 7765 6570 2c20 7372 6329  attr(sweep, src)
+0001cd80: 2e6b 6579 7328 2920 6966 2066 6d74 2069  .keys() if fmt i
+0001cd90: 6e20 6d6f 6d5d 0a20 2020 206d 6f6d 656e  n mom].    momen
+0001cda0: 7473 5f69 6478 203d 206e 702e 6172 6773  ts_idx = np.args
+0001cdb0: 6f72 7428 5b69 6e74 2873 5b6c 656e 2866  ort([int(s[len(f
+0001cdc0: 6d74 2920 3a5d 2920 666f 7220 7320 696e  mt) :]) for s in
+0001cdd0: 206d 6f6d 656e 7473 5d29 0a20 2020 2072   moments]).    r
+0001cde0: 6574 7572 6e20 6e70 2e61 7272 6179 286d  eturn np.array(m
+0001cdf0: 6f6d 656e 7473 295b 6d6f 6d65 6e74 735f  oments)[moments_
+0001ce00: 6964 785d 0a0a 0a64 6566 205f 6173 7369  idx]...def _assi
+0001ce10: 676e 5f6f 6469 6d5f 6d6f 6d65 6e74 7328  gn_odim_moments(
+0001ce20: 6473 2c20 6e63 682c 2073 7765 6570 2c20  ds, nch, sweep, 
+0001ce30: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
+0001ce40: 2222 4173 7369 676e 2072 6164 6172 206d  ""Assign radar m
+0001ce50: 6f6d 656e 7473 2074 6f20 6461 7461 7365  oments to datase
+0001ce60: 742e 0a0a 2020 2020 5061 7261 6d65 7465  t...    Paramete
+0001ce70: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0001ce80: 2d0a 2020 2020 6e63 6820 3a20 6e65 7443  -.    nch : netC
+0001ce90: 4446 342e 4461 7461 7365 7420 6861 6e64  DF4.Dataset hand
+0001cea0: 6c65 0a20 2020 2020 2020 2073 6f75 7263  le.        sourc
+0001ceb0: 6520 6e65 7443 4446 3420 4461 7461 7365  e netCDF4 Datase
+0001cec0: 740a 2020 2020 6473 203a 2078 6172 7261  t.    ds : xarra
+0001ced0: 7920 6461 7461 7365 740a 2020 2020 2020  y dataset.      
+0001cee0: 2020 6465 7374 696e 6174 696f 6e20 6461    destination da
+0001cef0: 7461 7365 740a 2020 2020 7377 6565 7020  taset.    sweep 
+0001cf00: 3a20 7374 720a 2020 2020 2020 2020 6e65  : str.        ne
+0001cf10: 7463 6466 2067 726f 7570 206e 616d 650a  tcdf group name.
+0001cf20: 0a20 2020 204b 6579 776f 7264 2041 7267  .    Keyword Arg
+0001cf30: 756d 656e 7473 0a20 2020 202d 2d2d 2d2d  uments.    -----
+0001cf40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001cf50: 2064 6563 6f64 655f 7469 6d65 7320 3a20   decode_times : 
+0001cf60: 626f 6f6c 0a20 2020 2020 2020 2049 6620  bool.        If 
+0001cf70: 5472 7565 2c20 6465 636f 6465 2063 6620  True, decode cf 
+0001cf80: 7469 6d65 7320 746f 206e 702e 6461 7465  times to np.date
+0001cf90: 7469 6d65 3634 2e20 4465 6661 756c 7473  time64. Defaults
+0001cfa0: 2074 6f20 5472 7565 2e0a 2020 2020 6465   to True..    de
+0001cfb0: 636f 6465 5f63 6f6f 7264 7320 3a20 626f  code_coords : bo
+0001cfc0: 6f6c 0a20 2020 2020 2020 2049 6620 5472  ol.        If Tr
+0001cfd0: 7565 2c20 7573 6520 7468 6520 e280 9863  ue, use the ...c
+0001cfe0: 6f6f 7264 696e 6174 6573 e280 9920 6174  oordinates... at
+0001cff0: 7472 6962 7574 6520 6f6e 2076 6172 6961  tribute on varia
+0001d000: 626c 650a 2020 2020 2020 2020 746f 2061  ble.        to a
+0001d010: 7373 6967 6e20 636f 6f72 6469 6e61 7465  ssign coordinate
+0001d020: 732e 2044 6566 6175 6c74 7320 746f 2054  s. Defaults to T
+0001d030: 7275 652e 0a20 2020 206d 6173 6b5f 616e  rue..    mask_an
+0001d040: 645f 7363 616c 6520 3a20 626f 6f6c 0a20  d_scale : bool. 
+0001d050: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+0001d060: 6c61 7a69 6c79 2073 6361 6c65 2028 7573  lazily scale (us
+0001d070: 696e 6720 7363 616c 655f 6661 6374 6f72  ing scale_factor
+0001d080: 2061 6e64 2061 6464 5f6f 6666 7365 7429   and add_offset)
+0001d090: 0a20 2020 2020 2020 2061 6e64 206d 6173  .        and mas
+0001d0a0: 6b20 2875 7369 6e67 205f 4669 6c6c 5661  k (using _FillVa
+0001d0b0: 6c75 6529 2e20 4465 6661 756c 7473 2074  lue). Defaults t
+0001d0c0: 6f20 5472 7565 2e0a 2020 2020 6765 6f72  o True..    geor
+0001d0d0: 6566 203a 2062 6f6f 6c0a 2020 2020 2020  ef : bool.      
+0001d0e0: 2020 4966 2054 7275 652c 2061 6464 7320    If True, adds 
+0001d0f0: 3244 2041 4551 4420 782c 792c 7a2d 636f  2D AEQD x,y,z-co
+0001d100: 6f72 6469 6e61 7465 732c 2067 726f 756e  ordinates, groun
+0001d110: 645f 7261 6e67 6520 2867 7229 2061 6e64  d_range (gr) and
+0001d120: 0a20 2020 2020 2020 2032 4420 2872 6179  .        2D (ray
+0001d130: 732c 6269 6e73 292d 636f 6f72 6469 6e61  s,bins)-coordina
+0001d140: 7465 7320 666f 7220 6561 7379 2067 656f  tes for easy geo
+0001d150: 7265 6665 7265 6e63 696e 6720 2865 672e  referencing (eg.
+0001d160: 2063 6172 746f 7079 290a 2020 2020 7374   cartopy).    st
+0001d170: 616e 6461 7264 203a 2073 7472 0a20 2020  andard : str.   
+0001d180: 2020 2020 202a 2060 6e6f 6e65 6020 2d20       * `none` - 
+0001d190: 6461 7461 2069 7320 7265 6164 2061 7320  data is read as 
+0001d1a0: 7665 7262 6174 696d 2061 7320 706f 7373  verbatim as poss
+0001d1b0: 6962 6c65 2c20 6e6f 206d 6574 6164 6174  ible, no metadat
+0001d1c0: 610a 2020 2020 2020 2020 2a20 606f 6469  a.        * `odi
+0001d1d0: 6d60 202d 2064 6174 6120 6973 2072 6561  m` - data is rea
+0001d1e0: 642c 206f 6469 6d20 6d65 7461 6461 7461  d, odim metadata
+0001d1f0: 2061 6464 6564 2074 6f20 6461 7461 7365   added to datase
+0001d200: 7473 0a20 2020 2020 2020 202a 2060 6366  ts.        * `cf
+0001d210: 2d6d 616e 6461 746f 7279 6020 2d20 6461  -mandatory` - da
+0001d220: 7461 2069 7320 7265 6164 2061 6363 6f72  ta is read accor
+0001d230: 6469 6e67 2074 6f20 6366 7261 6469 616c  ding to cfradial
+0001d240: 3220 7374 616e 6461 7264 0a20 2020 2020  2 standard.     
+0001d250: 2020 2020 2069 6d70 6f72 7469 6e67 206d       importing m
+0001d260: 616e 6461 746f 7279 206d 6574 6164 6174  andatory metadat
+0001d270: 610a 2020 2020 2020 2020 2a20 6063 662d  a.        * `cf-
+0001d280: 6675 6c6c 6020 2d20 6461 7461 2069 7320  full` - data is 
+0001d290: 7265 6164 2061 6363 6f72 6469 6e67 2074  read according t
+0001d2a0: 6f20 6366 7261 6469 616c 3220 7374 616e  o cfradial2 stan
+0001d2b0: 6461 7264 0a20 2020 2020 2020 2020 2069  dard.          i
+0001d2c0: 6d70 6f72 7469 6e67 2061 6c6c 2061 7661  mporting all ava
+0001d2d0: 696c 6162 6c65 2063 6672 6164 6961 6c32  ilable cfradial2
+0001d2e0: 206d 6574 6164 6174 6120 286e 6f74 2066   metadata (not f
+0001d2f0: 756c 6c79 0a20 2020 2020 2020 2020 2069  ully.          i
+0001d300: 6d70 6c65 6d65 6e74 6564 290a 0a20 2020  mplemented)..   
+0001d310: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+0001d320: 2d2d 2d2d 0a20 2020 2064 7320 3a20 7861  ----.    ds : xa
+0001d330: 7272 6179 2064 6174 6173 6574 0a20 2020  rray dataset.   
+0001d340: 2020 2020 2044 6174 6173 6574 2077 6974       Dataset wit
+0001d350: 6820 6173 7369 676e 6564 2072 6164 6172  h assigned radar
+0001d360: 206d 6f6d 656e 7473 0a20 2020 2022 2222   moments.    """
+0001d370: 0a20 2020 206d 6f6d 656e 7473 203d 205f  .    moments = _
+0001d380: 6765 745f 6f64 696d 5f6d 6f6d 656e 745f  get_odim_moment_
+0001d390: 6e61 6d65 7328 6e63 682e 6e63 685b 7377  names(nch.nch[sw
+0001d3a0: 6565 705d 2c20 666d 743d 6e63 682e 5f6d  eep], fmt=nch._m
+0001d3b0: 666d 742c 2073 7263 3d6e 6368 2e5f 6d73  fmt, src=nch._ms
+0001d3c0: 7263 290a 2020 2020 6966 206e 6368 2e66  rc).    if nch.f
+0001d3d0: 6c61 766f 7572 203d 3d20 224f 4449 4d22  lavour == "ODIM"
+0001d3e0: 3a0a 2020 2020 2020 2020 666f 7220 6e61  :.        for na
+0001d3f0: 6d65 2c20 646d 6f6d 2069 6e20 5f67 6574  me, dmom in _get
+0001d400: 5f6f 6469 6d5f 6772 6f75 705f 6d6f 6d65  _odim_group_mome
+0001d410: 6e74 7328 0a20 2020 2020 2020 2020 2020  nts(.           
+0001d420: 206e 6368 2e6e 6368 2c20 7377 6565 702c   nch.nch, sweep,
+0001d430: 206d 6f6d 656e 7473 3d6d 6f6d 656e 7473   moments=moments
+0001d440: 2c20 2a2a 6b77 6172 6773 0a20 2020 2020  , **kwargs.     
+0001d450: 2020 2029 2e69 7465 6d73 2829 3a0a 2020     ).items():.  
+0001d460: 2020 2020 2020 2020 2020 6473 5b6e 616d            ds[nam
+0001d470: 655d 203d 2064 6d6f 6d0a 2020 2020 6966  e] = dmom.    if
+0001d480: 206e 6368 2e66 6c61 766f 7572 203d 3d20   nch.flavour == 
+0001d490: 2247 414d 4943 223a 0a20 2020 2020 2020  "GAMIC":.       
+0001d4a0: 2064 7320 3d20 5f67 6574 5f6f 6469 6d5f   ds = _get_odim_
+0001d4b0: 7661 7269 6162 6c65 735f 6d6f 6d65 6e74  variables_moment
+0001d4c0: 7328 6473 2c20 6d6f 6d65 6e74 733d 6d6f  s(ds, moments=mo
+0001d4d0: 6d65 6e74 732c 202a 2a6b 7761 7267 7329  ments, **kwargs)
+0001d4e0: 0a0a 2020 2020 7265 7475 726e 2064 730a  ..    return ds.
+0001d4f0: 0a0a 6465 6620 5f67 6574 5f6f 6469 6d5f  ..def _get_odim_
+0001d500: 7469 6d65 7661 6c75 6573 286e 6368 2c20  timevalues(nch, 
+0001d510: 6772 7073 293a 0a20 2020 2022 2222 5265  grps):.    """Re
+0001d520: 7472 6965 7665 2054 696d 6541 7272 6179  trieve TimeArray
+0001d530: 2066 726f 6d20 736f 7572 6365 2064 6174   from source dat
+0001d540: 612e 0a0a 2020 2020 5061 7261 6d65 7465  a...    Paramete
+0001d550: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0001d560: 2d0a 2020 2020 6e63 6820 3a20 6e65 7443  -.    nch : netC
+0001d570: 4446 342e 4461 7461 7365 7420 6861 6e64  DF4.Dataset hand
+0001d580: 6c65 0a20 2020 2020 2020 2073 6f75 7263  le.        sourc
+0001d590: 6520 6e65 7443 4446 3420 4461 7461 7365  e netCDF4 Datase
+0001d5a0: 740a 2020 2020 6772 7073 203a 2064 6963  t.    grps : dic
+0001d5b0: 740a 2020 2020 2020 2020 4469 6374 696f  t.        Dictio
+0001d5c0: 6e61 7279 206f 6620 6461 7461 7365 7420  nary of dataset 
+0001d5d0: 6864 6635 2067 726f 7570 7320 2827 686f  hdf5 groups ('ho
+0001d5e0: 7727 2c20 2777 6861 7427 2c20 2777 6865  w', 'what', 'whe
+0001d5f0: 7265 2729 0a0a 2020 2020 5265 7475 726e  re')..    Return
+0001d600: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0001d610: 2020 7469 6d65 7661 6c73 203a 203a 636c    timevals : :cl
+0001d620: 6173 733a 606e 756d 7079 3a6e 756d 7079  ass:`numpy:numpy
+0001d630: 2e6e 6461 7272 6179 600a 2020 2020 2020  .ndarray`.      
+0001d640: 2020 2020 2020 6172 7261 7920 6f66 2074        array of t
+0001d650: 696d 6520 7661 6c75 6573 0a20 2020 2022  ime values.    "
+0001d660: 2222 0a20 2020 2069 6620 6e63 682e 666c  "".    if nch.fl
+0001d670: 6176 6f75 7220 3d3d 2022 4f44 494d 223a  avour == "ODIM":
+0001d680: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0001d690: 2020 2020 2020 2020 2020 7469 6d65 7661            timeva
+0001d6a0: 6c73 203d 2067 7270 735b 2268 6f77 225d  ls = grps["how"]
+0001d6b0: 2e6f 6469 6d2e 7469 6d65 5f72 616e 6765  .odim.time_range
+0001d6c0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0001d6d0: 284b 6579 4572 726f 722c 2041 7474 7269  (KeyError, Attri
+0001d6e0: 6275 7465 4572 726f 7229 3a0a 2020 2020  buteError):.    
+0001d6f0: 2020 2020 2020 2020 2320 7469 6d65 6861          # timeha
+0001d700: 6e64 6c69 6e67 2069 6620 6f6e 6c79 2073  ndling if only s
+0001d710: 7461 7274 2061 6e64 2065 6e64 2074 696d  tart and end tim
+0001d720: 6520 6973 2067 6976 656e 0a20 2020 2020  e is given.     
+0001d730: 2020 2020 2020 2073 7461 7274 2c20 656e         start, en
+0001d740: 6420 3d20 6772 7073 5b22 7768 6174 225d  d = grps["what"]
+0001d750: 2e6f 6469 6d2e 7469 6d65 5f72 616e 6765  .odim.time_range
+0001d760: 320a 2020 2020 2020 2020 2020 2020 6966  2.            if
+0001d770: 2073 7461 7274 203d 3d20 656e 643a 0a20   start == end:. 
+0001d780: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001d790: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7b0: 2020 2257 5241 444c 4942 3a20 4571 7561    "WRADLIB: Equa
+0001d7c0: 6c20 4f44 494d 2060 7374 6172 7474 696d  l ODIM `starttim
+0001d7d0: 6560 2061 6e64 2060 656e 6474 696d 6560  e` and `endtime`
+0001d7e0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0001d7f0: 2020 2020 2020 2022 7661 6c75 6573 2e20         "values. 
+0001d800: 4361 6e27 7420 6465 7465 726d 696e 6520  Can't determine 
+0001d810: 636f 7272 6563 7420 7377 6565 7020 7374  correct sweep st
+0001d820: 6172 742d 2c20 220a 2020 2020 2020 2020  art-, ".        
+0001d830: 2020 2020 2020 2020 2020 2020 2265 6e64              "end
+0001d840: 2d20 616e 6420 7261 7974 696d 6573 2e22  - and raytimes."
+0001d850: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d860: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
+0001d870: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+0001d880: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001d890: 2020 2020 2074 696d 6576 616c 7320 3d20       timevals = 
+0001d8a0: 6e70 2e6f 6e65 7328 6772 7073 5b22 7768  np.ones(grps["wh
+0001d8b0: 6572 6522 5d2e 6e72 6179 7329 202a 2073  ere"].nrays) * s
+0001d8c0: 7461 7274 0a20 2020 2020 2020 2020 2020  tart.           
+0001d8d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001d8e0: 2020 2020 2020 2064 656c 7461 203d 2028         delta = (
+0001d8f0: 656e 6420 2d20 7374 6172 7429 202f 2067  end - start) / g
+0001d900: 7270 735b 2277 6865 7265 225d 2e6e 7261  rps["where"].nra
+0001d910: 7973 0a20 2020 2020 2020 2020 2020 2020  ys.             
+0001d920: 2020 2074 696d 6576 616c 7320 3d20 6e70     timevals = np
+0001d930: 2e61 7261 6e67 6528 7374 6172 7420 2b20  .arange(start + 
+0001d940: 6465 6c74 6120 2f20 322e 302c 2065 6e64  delta / 2.0, end
+0001d950: 2c20 6465 6c74 6129 0a20 2020 2020 2020  , delta).       
+0001d960: 2020 2020 2020 2020 2074 696d 6576 616c           timeval
+0001d970: 7320 3d20 6e70 2e72 6f6c 6c28 7469 6d65  s = np.roll(time
+0001d980: 7661 6c73 2c20 7368 6966 743d 2d67 7270  vals, shift=-grp
+0001d990: 735b 2277 6865 7265 225d 2e61 3167 6174  s["where"].a1gat
+0001d9a0: 6529 0a20 2020 2069 6620 6e63 682e 666c  e).    if nch.fl
+0001d9b0: 6176 6f75 7220 3d3d 2022 4741 4d49 4322  avour == "GAMIC"
+0001d9c0: 3a0a 2020 2020 2020 2020 7469 6d65 7661  :.        timeva
+0001d9d0: 6c73 203d 2067 7270 735b 2277 6861 7422  ls = grps["what"
+0001d9e0: 5d2e 6761 6d69 632e 7469 6d65 5f72 616e  ].gamic.time_ran
+0001d9f0: 6765 2e76 616c 7565 730a 0a20 2020 2072  ge.values..    r
+0001da00: 6574 7572 6e20 7469 6d65 7661 6c73 0a0a  eturn timevals..
+0001da10: 0a64 6566 205f 6765 745f 6f64 696d 5f63  .def _get_odim_c
+0001da20: 6f6f 7264 696e 6174 6573 286e 6368 2c20  oordinates(nch, 
+0001da30: 6772 7073 293a 0a20 2020 2022 2222 5265  grps):.    """Re
+0001da40: 7472 6965 7665 2063 6f6f 7264 696e 6174  trieve coordinat
+0001da50: 6573 2061 6363 6f72 6469 6e67 204f 6469  es according Odi
+0001da60: 6d48 3520 7374 616e 6461 7264 2e0a 0a20  mH5 standard... 
+0001da70: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001da80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0001da90: 206e 6368 203a 206e 6574 4344 4634 2e44   nch : netCDF4.D
+0001daa0: 6174 6173 6574 2068 616e 646c 650a 2020  ataset handle.  
+0001dab0: 2020 2020 2020 736f 7572 6365 206e 6574        source net
+0001dac0: 4344 4634 2044 6174 6173 6574 0a20 2020  CDF4 Dataset.   
+0001dad0: 2067 7270 7320 3a20 6469 6374 0a20 2020   grps : dict.   
+0001dae0: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
+0001daf0: 6f66 2064 6174 6173 6574 2068 6466 3520  of dataset hdf5 
+0001db00: 6772 6f75 7073 2028 2768 6f77 272c 2027  groups ('how', '
+0001db10: 7768 6174 272c 2027 7768 6572 6527 290a  what', 'where').
+0001db20: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+0001db30: 202d 2d2d 2d2d 2d2d 0a20 2020 2063 6f6f   -------.    coo
+0001db40: 7264 7320 3a20 6469 6374 0a20 2020 2020  rds : dict.     
+0001db50: 2020 2044 6963 7469 6f6e 6172 7920 6f66     Dictionary of
+0001db60: 2063 6f6f 7264 696e 6174 6520 6172 7261   coordinate arra
+0001db70: 7973 0a20 2020 2022 2222 0a20 2020 2066  ys.    """.    f
+0001db80: 6c61 766f 7572 203d 206e 6368 2e66 6c61  lavour = nch.fla
+0001db90: 766f 7572 2e6c 6f77 6572 2829 0a20 2020  vour.lower().   
+0001dba0: 2063 6f6f 7264 7320 3d20 636f 6c6c 6563   coords = collec
+0001dbb0: 7469 6f6e 732e 4f72 6465 7265 6444 6963  tions.OrderedDic
+0001dbc0: 7428 290a 2020 2020 6966 2066 6c61 766f  t().    if flavo
+0001dbd0: 7572 203d 3d20 226f 6469 6d22 3a0a 2020  ur == "odim":.  
+0001dbe0: 2020 2020 2020 726e 6720 3d20 6772 7073        rng = grps
+0001dbf0: 5b22 7768 6572 6522 5d0a 2020 2020 2020  ["where"].      
+0001dc00: 2020 617a 203d 2065 6c20 3d20 6772 7073    az = el = grps
+0001dc10: 5b22 686f 7722 5d0a 2020 2020 6966 2066  ["how"].    if f
+0001dc20: 6c61 766f 7572 203d 3d20 2267 616d 6963  lavour == "gamic
+0001dc30: 223a 0a20 2020 2020 2020 2061 7a20 3d20  ":.        az = 
+0001dc40: 656c 203d 2067 7270 735b 2277 6861 7422  el = grps["what"
+0001dc50: 5d0a 2020 2020 2020 2020 726e 6720 3d20  ].        rng = 
+0001dc60: 6772 7073 5b22 686f 7722 5d0a 2020 2020  grps["how"].    
+0001dc70: 7472 793a 0a20 2020 2020 2020 2063 6f6f  try:.        coo
+0001dc80: 7264 735b 2261 7a69 6d75 7468 225d 203d  rds["azimuth"] =
+0001dc90: 2067 6574 6174 7472 2861 7a2c 2066 6c61   getattr(az, fla
+0001dca0: 766f 7572 292e 617a 696d 7574 685f 7261  vour).azimuth_ra
+0001dcb0: 6e67 650a 2020 2020 2020 2020 636f 6f72  nge.        coor
+0001dcc0: 6473 5b22 656c 6576 6174 696f 6e22 5d20  ds["elevation"] 
+0001dcd0: 3d20 6765 7461 7474 7228 656c 2c20 666c  = getattr(el, fl
+0001dce0: 6176 6f75 7229 2e65 6c65 7661 7469 6f6e  avour).elevation
+0001dcf0: 5f72 616e 6765 0a20 2020 2065 7863 6570  _range.    excep
+0001dd00: 7420 284b 6579 4572 726f 722c 2041 7474  t (KeyError, Att
+0001dd10: 7269 6275 7465 4572 726f 7229 3a0a 2020  ributeError):.  
+0001dd20: 2020 2020 2020 617a 203d 2065 6c20 3d20        az = el = 
+0001dd30: 6772 7073 5b22 7768 6572 6522 5d0a 2020  grps["where"].  
+0001dd40: 2020 2020 2020 636f 6f72 6473 5b22 617a        coords["az
+0001dd50: 696d 7574 6822 5d20 3d20 6765 7461 7474  imuth"] = getatt
+0001dd60: 7228 617a 2c20 666c 6176 6f75 7229 2e61  r(az, flavour).a
+0001dd70: 7a69 6d75 7468 5f72 616e 6765 320a 2020  zimuth_range2.  
+0001dd80: 2020 2020 2020 636f 6f72 6473 5b22 656c        coords["el
+0001dd90: 6576 6174 696f 6e22 5d20 3d20 6765 7461  evation"] = geta
+0001dda0: 7474 7228 656c 2c20 666c 6176 6f75 7229  ttr(el, flavour)
+0001ddb0: 2e65 6c65 7661 7469 6f6e 5f72 616e 6765  .elevation_range
+0001ddc0: 320a 2020 2020 636f 6f72 6473 5b22 7261  2.    coords["ra
+0001ddd0: 6e67 6522 5d20 3d20 6765 7461 7474 7228  nge"] = getattr(
+0001dde0: 726e 672c 2066 6c61 766f 7572 292e 7261  rng, flavour).ra
+0001ddf0: 6469 616c 5f72 616e 6765 0a0a 2020 2020  dial_range..    
+0001de00: 7265 7475 726e 2063 6f6f 7264 730a 0a0a  return coords...
+0001de10: 6465 6620 5f67 6574 5f6f 6469 6d5f 7377  def _get_odim_sw
+0001de20: 6565 705f 6d6f 6465 286e 6368 2c20 6772  eep_mode(nch, gr
+0001de30: 7029 3a0a 2020 2020 2222 2252 6574 7269  p):.    """Retri
+0001de40: 6576 6520 7377 6565 7020 6d6f 6465 0a0a  eve sweep mode..
+0001de50: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0001de60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0001de70: 2020 6e63 6820 3a20 6e65 7443 4446 342e    nch : netCDF4.
+0001de80: 4461 7461 7365 7420 6861 6e64 6c65 0a20  Dataset handle. 
+0001de90: 2020 2067 7270 203a 2064 6963 740a 2020     grp : dict.  
+0001dea0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+0001deb0: 206f 6620 6461 7461 7365 7420 6864 6635   of dataset hdf5
+0001dec0: 2067 726f 7570 7320 2827 686f 7727 2c20   groups ('how', 
+0001ded0: 2777 6861 7427 2c20 2777 6865 7265 2729  'what', 'where')
+0001dee0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+0001def0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6f75    -------.    ou
+0001df00: 7420 3a20 7374 720a 2020 2020 2020 2020  t : str.        
+0001df10: 2761 7a69 6d75 7468 5f73 7572 7665 696c  'azimuth_surveil
+0001df20: 6c61 6e63 6527 206f 7220 2772 6869 270a  lance' or 'rhi'.
+0001df30: 0a20 2020 2022 2222 0a20 2020 206f 6469  .    """.    odi
+0001df40: 6d5f 6d6f 6465 203d 2067 7270 5b22 7768  m_mode = grp["wh
+0001df50: 6174 225d 2e61 7474 7273 5b6e 6368 2e5f  at"].attrs[nch._
+0001df60: 7377 6d6f 6465 5d0a 2020 2020 7265 7475  swmode].    retu
+0001df70: 726e 2022 7268 6922 2069 6620 6f64 696d  rn "rhi" if odim
+0001df80: 5f6d 6f64 6520 3d3d 2022 5248 4922 2065  _mode == "RHI" e
+0001df90: 6c73 6520 2261 7a69 6d75 7468 5f73 7572  lse "azimuth_sur
+0001dfa0: 7665 696c 6c61 6e63 6522 0a0a 0a64 6566  veillance"...def
+0001dfb0: 205f 6765 745f 6f64 696d 5f66 756c 6c5f   _get_odim_full_
+0001dfc0: 7661 7273 286e 6368 2c20 6772 7073 293a  vars(nch, grps):
+0001dfd0: 0a20 2020 2022 2222 5265 7472 6965 7665  .    """Retrieve
+0001dfe0: 2061 7661 696c 6162 6c65 206e 6f6e 206d   available non m
+0001dff0: 616e 6461 746f 7279 2076 6172 6961 626c  andatory variabl
+0001e000: 6573 2066 726f 6d20 736f 7572 6365 2064  es from source d
+0001e010: 6174 612e 0a0a 2020 2020 5061 7261 6d65  ata...    Parame
+0001e020: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0001e030: 2d2d 2d0a 2020 2020 6e63 6820 3a20 6e65  ---.    nch : ne
+0001e040: 7443 4446 342e 4461 7461 7365 7420 6861  tCDF4.Dataset ha
+0001e050: 6e64 6c65 0a20 2020 2067 7270 7320 3a20  ndle.    grps : 
+0001e060: 6469 6374 0a20 2020 2020 2020 2044 6963  dict.        Dic
+0001e070: 7469 6f6e 6172 7920 6f66 2064 6174 6173  tionary of datas
+0001e080: 6574 2068 6466 3520 6772 6f75 7073 2028  et hdf5 groups (
+0001e090: 2768 6f77 272c 2027 7768 6174 272c 2027  'how', 'what', '
+0001e0a0: 7768 6572 6527 290a 0a20 2020 2052 6574  where')..    Ret
+0001e0b0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+0001e0c0: 0a20 2020 2066 756c 6c5f 7661 7273 203a  .    full_vars :
+0001e0d0: 2064 6963 740a 2020 2020 2020 2020 6675   dict.        fu
+0001e0e0: 6c6c 2063 662d 7661 7269 6162 6c65 730a  ll cf-variables.
+0001e0f0: 2020 2020 2222 220a 2020 2020 6675 6c6c      """.    full
+0001e100: 5f76 6172 7320 3d20 636f 6c6c 6563 7469  _vars = collecti
+0001e110: 6f6e 732e 4f72 6465 7265 6444 6963 7428  ons.OrderedDict(
+0001e120: 290a 2020 2020 6966 206e 6368 2e66 6c61  ).    if nch.fla
+0001e130: 766f 7572 203d 3d20 224f 4449 4d22 3a0a  vour == "ODIM":.
+0001e140: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0001e150: 2069 6e20 6366 5f66 756c 6c5f 7661 7273   in cf_full_vars
+0001e160: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0001e170: 2020 2020 2020 6675 6c6c 5f76 6172 735b        full_vars[
+0001e180: 6b5d 203d 2067 6574 6174 7472 2867 6574  k] = getattr(get
+0001e190: 6174 7472 2867 7270 735b 2268 6f77 225d  attr(grps["how"]
+0001e1a0: 2c20 6e63 682e 666c 6176 6f75 722e 6c6f  , nch.flavour.lo
+0001e1b0: 7765 7228 2929 2c20 6b29 0a20 2020 2069  wer()), k).    i
+0001e1c0: 6620 6e63 682e 666c 6176 6f75 7220 3d3d  f nch.flavour ==
+0001e1d0: 2022 4741 4d49 4322 3a0a 2020 2020 2020   "GAMIC":.      
+0001e1e0: 2020 7061 7373 0a0a 2020 2020 7265 7475    pass..    retu
+0001e1f0: 726e 2066 756c 6c5f 7661 7273 0a0a 0a64  rn full_vars...d
+0001e200: 6566 205f 6765 745f 6f64 696d 5f66 6978  ef _get_odim_fix
+0001e210: 6564 5f61 6e67 6c65 286e 6368 2c20 6772  ed_angle(nch, gr
+0001e220: 7073 293a 0a20 2020 2022 2222 5265 7472  ps):.    """Retr
+0001e230: 6965 7665 2066 6978 6564 2061 6e67 6c65  ieve fixed angle
+0001e240: 2066 726f 6d20 736f 7572 6365 2064 6174   from source dat
+0001e250: 612e 0a0a 2020 2020 5061 7261 6d65 7465  a...    Paramete
+0001e260: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0001e270: 2d0a 2020 2020 6e63 6820 3a20 6e65 7443  -.    nch : netC
+0001e280: 4446 342e 4461 7461 7365 7420 6861 6e64  DF4.Dataset hand
+0001e290: 6c65 0a20 2020 2067 7270 7320 3a20 6469  le.    grps : di
+0001e2a0: 6374 0a20 2020 2020 2020 2044 6963 7469  ct.        Dicti
+0001e2b0: 6f6e 6172 7920 6f66 2064 6174 6173 6574  onary of dataset
+0001e2c0: 2068 6466 3520 6772 6f75 7073 2028 2768   hdf5 groups ('h
+0001e2d0: 6f77 272c 2027 7768 6174 272c 2027 7768  ow', 'what', 'wh
+0001e2e0: 6572 6527 290a 0a20 2020 2052 6574 7572  ere')..    Retur
+0001e2f0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+0001e300: 2020 2066 6978 6564 2d61 6e67 6c65 203a     fixed-angle :
+0001e310: 2066 6c6f 6174 0a20 2020 2020 2020 2066   float.        f
+0001e320: 6978 6564 2061 6e67 6c65 206f 6620 7370  ixed angle of sp
+0001e330: 6563 6966 6963 2073 6361 6e0a 2020 2020  ecific scan.    
+0001e340: 2222 220a 2020 2020 6d6f 6465 203d 205f  """.    mode = _
+0001e350: 6765 745f 6f64 696d 5f73 7765 6570 5f6d  get_odim_sweep_m
+0001e360: 6f64 6528 6e63 682c 2067 7270 7329 0a20  ode(nch, grps). 
+0001e370: 2020 2069 6620 6e63 682e 666c 6176 6f75     if nch.flavou
+0001e380: 7220 3d3d 2022 4f44 494d 223a 0a20 2020  r == "ODIM":.   
+0001e390: 2020 2020 2061 6e67 203d 207b 2261 7a69       ang = {"azi
+0001e3a0: 6d75 7468 5f73 7572 7665 696c 6c61 6e63  muth_surveillanc
+0001e3b0: 6522 3a20 2265 6c61 6e67 6c65 222c 2022  e": "elangle", "
+0001e3c0: 7268 6922 3a20 2261 7a61 6e67 6c65 227d  rhi": "azangle"}
+0001e3d0: 0a20 2020 2020 2020 2066 6978 6564 5f61  .        fixed_a
+0001e3e0: 6e67 6c65 203d 2067 6574 6174 7472 2867  ngle = getattr(g
+0001e3f0: 7270 735b 2277 6865 7265 225d 2c20 616e  rps["where"], an
+0001e400: 675b 6d6f 6465 5d29 0a20 2020 2069 6620  g[mode]).    if 
+0001e410: 6e63 682e 666c 6176 6f75 7220 3d3d 2022  nch.flavour == "
+0001e420: 4741 4d49 4322 3a0a 2020 2020 2020 2020  GAMIC":.        
+0001e430: 616e 6720 3d20 7b22 617a 696d 7574 685f  ang = {"azimuth_
+0001e440: 7375 7276 6569 6c6c 616e 6365 223a 2022  surveillance": "
+0001e450: 656c 6576 6174 696f 6e22 2c20 2272 6869  elevation", "rhi
+0001e460: 223a 2022 617a 696d 7574 6822 7d0a 2020  ": "azimuth"}.  
+0001e470: 2020 2020 2020 6669 7865 645f 616e 676c        fixed_angl
+0001e480: 6520 3d20 6772 7073 5b22 686f 7722 5d2e  e = grps["how"].
+0001e490: 6174 7472 735b 616e 675b 6d6f 6465 5d5d  attrs[ang[mode]]
+0001e4a0: 0a20 2020 2072 6574 7572 6e20 6669 7865  .    return fixe
+0001e4b0: 645f 616e 676c 650a 0a0a 6465 6620 5f67  d_angle...def _g
+0001e4c0: 6574 5f6f 6469 6d5f 726f 6f74 5f61 7474  et_odim_root_att
+0001e4d0: 7269 6275 7465 7328 6e63 682c 2067 7270  ributes(nch, grp
+0001e4e0: 7329 3a0a 2020 2020 2222 2252 6574 7269  s):.    """Retri
+0001e4f0: 6576 6520 726f 6f74 2061 7474 7269 6275  eve root attribu
+0001e500: 7465 7320 6163 636f 7264 696e 6720 4366  tes according Cf
+0001e510: 5261 6469 616c 3220 7374 616e 6461 7264  Radial2 standard
+0001e520: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0001e530: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0001e540: 0a20 2020 2067 7270 7320 3a20 6469 6374  .    grps : dict
+0001e550: 0a20 2020 2020 2020 2044 6963 7469 6f6e  .        Diction
+0001e560: 6172 7920 6f66 2072 6f6f 7420 6864 6635  ary of root hdf5
+0001e570: 2067 726f 7570 7320 2827 686f 7727 2c20   groups ('how', 
+0001e580: 2777 6861 7427 2c20 2777 6865 7265 2729  'what', 'where')
+0001e590: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+0001e5a0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6174    -------.    at
+0001e5b0: 7472 7320 3a20 6469 6374 0a20 2020 2020  trs : dict.     
+0001e5c0: 2020 2044 6963 7469 6f6e 6172 7920 6f66     Dictionary of
+0001e5d0: 2072 6f6f 7420 6174 7472 6962 7574 6573   root attributes
+0001e5e0: 0a20 2020 2022 2222 0a0a 2020 2020 6174  .    """..    at
+0001e5f0: 7472 7320 3d20 636f 6c6c 6563 7469 6f6e  trs = collection
+0001e600: 732e 4f72 6465 7265 6444 6963 7428 290a  s.OrderedDict().
+0001e610: 2020 2020 6174 7472 732e 7570 6461 7465      attrs.update
+0001e620: 280a 2020 2020 2020 2020 7b0a 2020 2020  (.        {.    
+0001e630: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
+0001e640: 223a 2022 4e6f 6e65 222c 0a20 2020 2020  ": "None",.     
+0001e650: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
+0001e660: 224e 6f6e 6522 2c0a 2020 2020 2020 2020  "None",.        
+0001e670: 2020 2020 2269 6e73 7469 7475 7469 6f6e      "institution
+0001e680: 223a 2022 4e6f 6e65 222c 0a20 2020 2020  ": "None",.     
+0001e690: 2020 2020 2020 2022 7265 6665 7265 6e63         "referenc
+0001e6a0: 6573 223a 2022 4e6f 6e65 222c 0a20 2020  es": "None",.   
+0001e6b0: 2020 2020 2020 2020 2022 736f 7572 6365           "source
+0001e6c0: 223a 2022 4e6f 6e65 222c 0a20 2020 2020  ": "None",.     
+0001e6d0: 2020 2020 2020 2022 6869 7374 6f72 7922         "history"
+0001e6e0: 3a20 224e 6f6e 6522 2c0a 2020 2020 2020  : "None",.      
+0001e6f0: 2020 2020 2020 2263 6f6d 6d65 6e74 223a        "comment":
+0001e700: 2022 696d 2f65 7870 6f72 7465 6420 7573   "im/exported us
+0001e710: 696e 6720 7772 6164 6c69 6222 2c0a 2020  ing wradlib",.  
+0001e720: 2020 2020 2020 2020 2020 2269 6e73 7472            "instr
+0001e730: 756d 656e 745f 6e61 6d65 223a 2022 4e6f  ument_name": "No
+0001e740: 6e65 222c 0a20 2020 2020 2020 207d 0a20  ne",.        }. 
+0001e750: 2020 2029 0a20 2020 2061 7474 7273 5b22     ).    attrs["
+0001e760: 7665 7273 696f 6e22 5d20 3d20 6772 7073  version"] = grps
+0001e770: 5b22 7768 6174 225d 2e61 7474 7273 5b22  ["what"].attrs["
+0001e780: 7665 7273 696f 6e22 5d0a 0a20 2020 2069  version"]..    i
+0001e790: 6620 6e63 682e 666c 6176 6f75 7220 3d3d  f nch.flavour ==
+0001e7a0: 2022 4f44 494d 223a 0a20 2020 2020 2020   "ODIM":.       
+0001e7b0: 2061 7474 7273 5b22 696e 7374 6974 7574   attrs["institut
+0001e7c0: 696f 6e22 5d20 3d20 6772 7073 5b22 7768  ion"] = grps["wh
+0001e7d0: 6174 225d 2e61 7474 7273 5b22 736f 7572  at"].attrs["sour
+0001e7e0: 6365 225d 0a20 2020 2020 2020 2061 7474  ce"].        att
+0001e7f0: 7273 5b22 696e 7374 7275 6d65 6e74 225d  rs["instrument"]
+0001e800: 203d 2067 7270 735b 2277 6861 7422 5d2e   = grps["what"].
+0001e810: 6174 7472 735b 2273 6f75 7263 6522 5d0a  attrs["source"].
+0001e820: 2020 2020 6966 206e 6368 2e66 6c61 766f      if nch.flavo
+0001e830: 7572 203d 3d20 2247 414d 4943 223a 0a20  ur == "GAMIC":. 
+0001e840: 2020 2020 2020 2061 7474 7273 5b22 7469         attrs["ti
+0001e850: 746c 6522 5d20 3d20 6772 7073 5b22 686f  tle"] = grps["ho
+0001e860: 7722 5d2e 6174 7472 735b 2274 656d 706c  w"].attrs["templ
+0001e870: 6174 655f 6e61 6d65 225d 0a20 2020 2020  ate_name"].     
+0001e880: 2020 2061 7474 7273 5b22 696e 7374 7275     attrs["instru
+0001e890: 6d65 6e74 225d 203d 2067 7270 735b 2268  ment"] = grps["h
+0001e8a0: 6f77 225d 2e61 7474 7273 5b22 686f 7374  ow"].attrs["host
+0001e8b0: 5f6e 616d 6522 5d0a 0a20 2020 2072 6574  _name"]..    ret
+0001e8c0: 7572 6e20 6174 7472 730a                 urn attrs.
```

### Comparing `wradlib-1.9.0/wradlib/ipol.py` & `wradlib-1.9.1/wradlib/ipol.py`

 * *Files 1% similar despite different names*

```diff
@@ -333,15 +333,20 @@
         else:
             self.nnearest = nnearest
 
         self.remove_missing = remove_missing
 
         self.p = p
         # query tree
-        self.dists, self.ix = self.tree.query(trg, k=self.nnearest, n_jobs=-1)
+        # scipy kwarg changed from version 1.6
+        if LooseVersion(scipy.__version__) < "1.6":
+            query_kwargs = dict(n_jobs=-1)
+        else:
+            query_kwargs = dict(workers=-1)
+        self.dists, self.ix = self.tree.query(trg, k=self.nnearest, **query_kwargs)
         # avoid bug, if there is only one neighbor at all
         if self.dists.ndim == 1:
             self.dists = self.dists[:, np.newaxis]
             self.ix = self.ix[:, np.newaxis]
 
     def __call__(self, vals, maxdist=None):
         """
```

### Comparing `wradlib-1.9.0/wradlib/qual.py` & `wradlib-1.9.1/wradlib/qual.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_adjust.py` & `wradlib-1.9.1/wradlib/tests/test_adjust.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_atten.py` & `wradlib-1.9.1/wradlib/tests/test_atten.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_classify.py` & `wradlib-1.9.1/wradlib/tests/test_classify.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_clutter.py` & `wradlib-1.9.1/wradlib/tests/test_clutter.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_comp.py` & `wradlib-1.9.1/wradlib/tests/test_comp.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_dp.py` & `wradlib-1.9.1/wradlib/tests/test_dp.py`

 * *Files 0% similar despite different names*

```diff
@@ -46,15 +46,15 @@
     rho = np.random.uniform(0.8, 1.0, len(r))
 
     # for derivation tests
     window = 7
     az = 360
     rng = 1000
     pad = window // 2
-    kdp_true = np.arange(az * rng, dtype=np.float).reshape(az, rng)
+    kdp_true = np.arange(az * rng, dtype=np.float_).reshape(az, rng)
     phidp_true = np.power(kdp_true, 2)
     dr = 0.1
     kdp_true /= dr
     phidp_true_nan = phidp_true.copy()
     phidp_true_nan[:, window:-1:10] = np.nan
 
     def test_process_raw_phidp_vulpiani(self, derivation_method, window, copy):
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_georef.py` & `wradlib-1.9.1/wradlib/tests/test_georef.py`

 * *Files 2% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 import pytest
 import xarray as xr
 from osgeo import gdal, ogr, osr
 
 import wradlib
 from wradlib import georef, util
 
-from . import has_data, requires_data
+from . import has_data, requires_data, requires_secrets
 
 np.set_printoptions(
     edgeitems=3,
     infstr="inf",
     linewidth=75,
     nanstr="nan",
     precision=8,
@@ -240,16 +240,16 @@
     def test_maximum_intensity_projection(self):
         angle = 0.0
         elev = 0.0
 
         filename = util.get_wradlib_data_file("misc/polar_dBZ_tur.gz")
         data = np.loadtxt(filename)
         # we need to have meter here for the georef function inside mip
-        d1 = np.arange(data.shape[1], dtype=np.float) * 1000
-        d2 = np.arange(data.shape[0], dtype=np.float)
+        d1 = np.arange(data.shape[1], dtype=np.float_) * 1000
+        d2 = np.arange(data.shape[0], dtype=np.float_)
         data = np.roll(data, (d2 >= angle).nonzero()[0][0], axis=0)
 
         # calculate max intensity proj
         georef.maximum_intensity_projection(data, r=d1, az=d2, angle=angle, elev=elev)
         georef.maximum_intensity_projection(data, autoext=False)
 
 
@@ -826,21 +826,23 @@
     def test_extract_raster_dataset(self):
         ds = self.ds
         data, coords, proj = georef.extract_raster_dataset(ds)
         assert coords.shape[-1] == 2
         data, coords, proj = georef.extract_raster_dataset(ds, mode="edge")
         assert coords.shape[-1] == 2
 
+    @requires_data
+    @requires_secrets
     def test_get_raster_elevation(self):
         # crop file using translate to keep download sizes minimal
         gdal.Translate(
             "/vsimem/clip.tif", self.geofile1, projWin=[5.5, 49.5, 5.6, 49.4]
         )
         ds = wradlib.io.open_raster("/vsimem/clip.tif")
-        georef.get_raster_elevation(ds, download={"region": "Eurasia"})
+        georef.get_raster_elevation(ds)
 
     def test_get_raster_extent(self):
 
         extent = georef.get_raster_extent(self.ds2)
         window_map = np.array([3e5, 1e6, 3e5, 1e6])
         np.testing.assert_array_almost_equal(extent, window_map, decimal=3)
 
@@ -850,19 +852,18 @@
 
         extent = georef.get_raster_extent(self.ds2, window=False)
         np.testing.assert_array_almost_equal(extent, self.corner_gdalinfo, decimal=3)
 
         extent = georef.get_raster_extent(self.ds2, geo=True, window=False)
         np.testing.assert_array_almost_equal(extent, self.corner_geo_gdalinfo)
 
+    @requires_data
+    @requires_secrets
     def test_merge_raster_datasets(self):
-        download = {"region": "Eurasia"}
-        datasets = wradlib.io.dem.get_srtm(
-            [5, 6, 49.4, 49.5], merge=False, download=download
-        )
+        datasets = wradlib.io.dem.get_srtm([5, 6, 49.4, 49.5], merge=False)
         georef.merge_raster_datasets(datasets)
 
     def test_raster_to_polyvert(self):
         ds = self.ds
         polyvert = georef.raster_to_polyvert(ds)
         nx = ds.RasterXSize
         ny = ds.RasterYSize
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_io.py` & `wradlib-1.9.1/wradlib/tests/test_io.py`

 * *Files 1% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 import deprecation
 import numpy as np
 import pytest
 import xarray as xr
 
 from wradlib import georef, io, util, zonalstats
 
-from . import requires_data
+from . import requires_data, requires_secrets
 
 
 class TestDX:
     # testing functions related to read_dx
     @requires_data
     def test__get_timestamp_from_filename(self):
         filename = "raa00-dx_10488-200608050000-drs---bin"
@@ -1697,30 +1697,29 @@
             io.xarray.CfRadial(h5file, flavour="Cf/Radial3")
         with pytest.raises(AttributeError):
             io.xarray.CfRadial(h5file)
 
 
 class TestDem:
     @requires_data
+    @requires_secrets
     def test_get_srtm(self):
         targets = ["N51W001", "N51E000", "N51E001", "N52W001", "N52E000", "N52E001"]
-        targets = ["%s.hgt.zip" % (f) for f in targets]
+        targets = ["%s.SRTMGL3.hgt.zip" % (f) for f in targets]
 
-        opts = {"region": "Eurasia"}
         extent = [-0.3, 1.5, 51.4, 52.5]
-        datasets = io.dem.get_srtm(extent, merge=False, download=opts)
+        datasets = io.dem.get_srtm(extent, merge=False)
         filelist = [os.path.basename(d.GetFileList()[0]) for d in datasets]
         assert targets == filelist
 
         targets = ["S02E015", "S02E016", "S01E015", "S01E016", "N00E015", "N00E016"]
-        targets = ["%s.hgt.zip" % (f) for f in targets]
+        targets = ["%s.SRTMGL3.hgt.zip" % (f) for f in targets]
 
-        opts = {"region": "Africa"}
         extent = [15.3, 16.6, -1.4, 0.4]
-        datasets = io.dem.get_srtm(extent, merge=False, download=opts)
+        datasets = io.dem.get_srtm(extent, merge=False)
         filelist = [os.path.basename(d.GetFileList()[0]) for d in datasets]
         assert targets == filelist
 
         merged = io.dem.get_srtm(extent)
 
         xsize = (datasets[0].RasterXSize - 1) * 2 + 1
         ysize = (datasets[0].RasterXSize - 1) * 3 + 1
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_io_odim.py` & `wradlib-1.9.1/wradlib/tests/test_io_odim.py`

 * *Files 0% similar despite different names*

```diff
@@ -178,18 +178,18 @@
         "startazT": create_startazT(i, nrays=nrays),
         "stopazT": create_stopazT(i, nrays=nrays),
     }
 
 
 def create_dset_where(i, nrays=360):
     return {
-        "a1gate": np.array([create_a1gate(i)], dtype=np.int),
+        "a1gate": np.array([create_a1gate(i)], dtype=np.int_),
         "elangle": np.array([i + 0.5], dtype=np.float32),
-        "nrays": np.array([nrays], dtype=np.int),
-        "nbins": np.array([100], dtype=np.int),
+        "nrays": np.array([nrays], dtype=np.int_),
+        "nbins": np.array([100], dtype=np.int_),
         "rstart": np.array([0], dtype=np.float32),
         "rscale": np.array([1000], dtype=np.float32),
     }
 
 
 def create_dset_what():
     return {
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_ipol.py` & `wradlib-1.9.1/wradlib/tests/test_ipol.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_qual.py` & `wradlib-1.9.1/wradlib/tests/test_qual.py`

 * *Files 1% similar despite different names*

```diff
@@ -7,26 +7,26 @@
 
 from wradlib import qual
 
 
 class TestHelperFunctions:
     def test_get_bb_ratio(self):
         heights = np.array(
-            [[1100, 1100], [1100, 1100], [1100, 1100], [1100, 1100]], dtype=np.float
+            [[1100, 1100], [1100, 1100], [1100, 1100], [1100, 1100]], dtype=np.float_
         )
-        widths = np.array([[50, 50], [50, 50], [50, 50], [50, 50]], dtype=np.float)
-        quality = np.array([[1, 1], [1, 1], [1, 0], [0, 1]], dtype=np.float)
+        widths = np.array([[50, 50], [50, 50], [50, 50], [50, 50]], dtype=np.float_)
+        quality = np.array([[1, 1], [1, 1], [1, 0], [0, 1]], dtype=np.float_)
         z = np.array(
             [
                 [[1075, 1100, 1125, 900], [1000, 1090, 1110, 1300]],
                 [[1075, 1100, 1125, 900], [1000, 1090, 1110, 1300]],
                 [[1075, 1100, 1125, 900], [1000, 1090, 1110, 1300]],
                 [[1075, 1100, 1125, 900], [1000, 1090, 1110, 1300]],
             ],
-            dtype=np.float,
+            dtype=np.float_,
         )
         ratio_out = np.array(
             [
                 [[0.0, 0.5, 1.0, -3.5], [-1.5, 0.3, 0.7, 4.5]],
                 [[0.0, 0.5, 1.0, -3.5], [-1.5, 0.3, 0.7, 4.5]],
                 [[0.0, 0.5, 1.0, -3.5], [-1.5, 0.3, 0.7, 4.5]],
                 [[0.0, 0.5, 1.0, -3.5], [-1.5, 0.3, 0.7, 4.5]],
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_trafo.py` & `wradlib-1.9.1/wradlib/tests/test_trafo.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_util.py` & `wradlib-1.9.1/wradlib/tests/test_util.py`

 * *Files 1% similar despite different names*

```diff
@@ -87,16 +87,16 @@
     def test_maximum_intensity_projection(self):
         angle = 0.0
         elev = 0.0
 
         filename = util.get_wradlib_data_file("misc/polar_dBZ_tur.gz")
         data = np.loadtxt(filename)
         # we need to have meter here for the georef function inside mip
-        d1 = np.arange(data.shape[1], dtype=np.float) * 1000
-        d2 = np.arange(data.shape[0], dtype=np.float)
+        d1 = np.arange(data.shape[1], dtype=np.float_) * 1000
+        d2 = np.arange(data.shape[0], dtype=np.float_)
         data = np.roll(data, (d2 >= angle).nonzero()[0][0], axis=0)
 
         # calculate max intensity proj
         util.maximum_intensity_projection(data, r=d1, az=d2, angle=angle, elev=elev)
         util.maximum_intensity_projection(data, autoext=False)
 
     @requires_data
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_verify.py` & `wradlib-1.9.1/wradlib/tests/test_verify.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_vis.py` & `wradlib-1.9.1/wradlib/tests/test_vis.py`

 * *Files 8% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 mpl.use("Agg")  # noqa: E402
 import matplotlib.pyplot as pl
 import numpy as np
 import pytest
 
 from wradlib import georef, util, vis
 
-from . import requires_data
+from . import requires_data, requires_secrets
 
 cartopy = util.import_optional("cartopy")
 
 
 class TestPolarPlot:
     img = np.zeros((360, 10), dtype=np.float32)
     img[2, 2] = 10  # isolated pixel
@@ -182,14 +182,21 @@
     @requires_data
     def test_plot_scan_strategy(self):
         ranges = np.arange(0, 10000, 100)
         elevs = np.arange(1, 30, 3)
         site = (7.0, 53.0, 100.0)
         vis.plot_scan_strategy(ranges, elevs, site)
         vis.plot_scan_strategy(ranges, elevs, site, cg=True)
+
+    @requires_data
+    @requires_secrets
+    def test_plot_scan_strategy_terrain(self):
+        ranges = np.arange(0, 10000, 100)
+        elevs = np.arange(1, 30, 3)
+        site = (7.0, 53.0, 100.0)
         vis.plot_scan_strategy(ranges, elevs, site, terrain=True)
         vis.plot_scan_strategy(ranges, elevs, site, cg=True, terrain=True)
 
     def test_plot_plan_and_vert(self):
         x = np.arange(0, 10)
         y = np.arange(0, 10)
         z = np.arange(0, 5)
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_vpr.py` & `wradlib-1.9.1/wradlib/tests/test_vpr.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/tests/test_zonalstats.py` & `wradlib-1.9.1/wradlib/tests/test_zonalstats.py`

 * *Files 2% similar despite different names*

```diff
@@ -181,29 +181,31 @@
             [2625000.0, 5635000.0],
             [2615000.0, 5635000.0],
         ]
     )
 
     box5 = np.array(
         [
-            [2600000.0, 5635000.0],
+            # [2600000.0, 5635000.0],
             [2605000.0, 5635000.0],
             [2605000.0, 5630000.0],
             [2600000.0, 5630000.0],
             [2600000.0, 5635000.0],
+            [2605000.0, 5635000.0],
         ]
     )
 
     box6 = np.array(
         [
-            [2615000.0, 5635000.0],
+            # [2615000.0, 5635000.0],
             [2615000.0, 5640000.0],
             [2620000.0, 5640000.0],
             [2620000.0, 5635000.0],
             [2615000.0, 5635000.0],
+            [2615000.0, 5640000.0],
         ]
     )
 
     box7 = np.array(
         [
             [2715000.0, 5635000.0],
             [2715000.0, 5640000.0],
@@ -245,14 +247,15 @@
         assert zdb.count_intersections == 2
 
     def test_srs(self):
         zdb = zonalstats.ZonalDataBase(self.src, self.trg, srs=self.proj)
         assert zdb.srs == self.proj
 
     def test_isecs(self):
+        # todo: Normalize Polygons before comparison.
         zdb = zonalstats.ZonalDataBase(self.src, self.trg, srs=self.proj)
         np.testing.assert_equal(zdb.isecs, self.dst)
 
     def test_get_isec(self):
         zdb = zonalstats.ZonalDataBase(self.src, self.trg, srs=self.proj)
         np.testing.assert_equal(zdb.get_isec(0), [self.box5])
         np.testing.assert_equal(zdb.get_isec(1), [self.box6])
@@ -646,67 +649,73 @@
     zdpoint = zonalstats.ZonalDataPoint(radar_gkc, data, srs=proj_gk)
     # zdpoint.dump_vector('test_zdpoint')
 
     isec_poly0 = np.array(
         [
             np.array(
                 [
-                    [2600000.0, 5630000.0],
+                    # [2600000.0, 5630000.0],
                     [2600000.0, 5630100.0],
                     [2600009.61157242, 5630100.0],
                     [2600041.77844048, 5630000.0],
                     [2600000.0, 5630000.0],
+                    [2600000.0, 5630100.0],
                 ]
             ),
             np.array(
                 [
-                    [2600009.61157242, 5630100.0],
+                    # [2600009.61157242, 5630100.0],
                     [2600100.0, 5630100.0],
                     [2600100.0, 5630000.0],
                     [2600041.77844048, 5630000.0],
                     [2600009.61157242, 5630100.0],
+                    [2600100.0, 5630100.0],
                 ]
             ),
             np.array(
                 [
-                    [2600091.80406488, 5630100.0],
+                    # [2600091.80406488, 5630100.0],
                     [2600100.0, 5630100.0],
                     [2600100.0, 5630074.58501104],
                     [2600091.80406488, 5630100.0],
+                    [2600100.0, 5630100.0],
                 ]
             ),
         ],
         dtype=object,
     )
     isec_poly1 = np.array(
         [
             np.array(
                 [
-                    [2600100.0, 5630000.0],
+                    # [2600100.0, 5630000.0],
                     [2600100.0, 5630100.0],
                     [2600114.66582085, 5630100.0],
                     [2600146.83254704, 5630000.0],
                     [2600100.0, 5630000.0],
+                    [2600100.0, 5630100.0],
                 ]
             ),
             np.array(
                 [
-                    [2600114.66582085, 5630100.0],
+                    # [2600114.66582085, 5630100.0],
                     [2600200.0, 5630100.0],
                     [2600200.0, 5630000.0],
                     [2600146.83254704, 5630000.0],
                     [2600114.66582085, 5630100.0],
+                    [2600200.0, 5630100.0],
                 ]
             ),
             np.array(
                 [
-                    [2600197.20644071, 5630100.0],
+                    # [2600197.20644071, 5630100.0],
                     [2600200.0, 5630100.0],
                     [2600200.0, 5630091.33737992],
                     [2600197.20644071, 5630100.0],
+                    [2600200.0, 5630100.0],
                 ]
             ),
         ],
         dtype=object,
     )
 
     isec_point0 = np.array([[2600077.2899581, 5630056.0874306]])
```

### Comparing `wradlib-1.9.0/wradlib/tests/test_zr.py` & `wradlib-1.9.1/wradlib/tests/test_zr.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/trafo.py` & `wradlib-1.9.1/wradlib/trafo.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/util.py` & `wradlib-1.9.1/wradlib/util.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/verify.py` & `wradlib-1.9.1/wradlib/verify.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib/vis.py` & `wradlib-1.9.1/wradlib/vis.py`

 * *Files 0% similar despite different names*

```diff
@@ -455,26 +455,26 @@
             "as simple xy-offset"
         )
 
     # re/ke kwargs handling
     kw_spherical = {"re": kwargs.pop("re", None), "ke": kwargs.pop("ke", 4.0 / 3.0)}
 
     if az is None:
-        az = np.arange(data.shape[0], dtype=np.float)
+        az = np.arange(data.shape[0], dtype=np.float_)
         az += (az[1] - az[0]) / 2.0
 
     if r is None:
         if proj and proj != "cg":
             warnings.warn(
                 "Parameter `r` is None, falling back to `proj=None`."
                 "If using projection, r must be given as "
                 "array with units m."
             )
             proj = None
-        r = np.arange(data.shape[1], dtype=np.float)
+        r = np.arange(data.shape[1], dtype=np.float_)
         r += (r[1] - r[0]) / 2.0
 
     if np.isscalar(elev):
         elev = np.ones_like(az) * elev
 
     da = georef.create_xarray_dataarray(
         data,
@@ -789,15 +789,15 @@
         if proj and proj != "cg":
             warnings.warn(
                 "Parameter `r` is None, falling back to `proj=None`."
                 "If using projection, r must be given as "
                 "array with units m."
             )
             proj = None
-        r = np.arange(data.shape[1], dtype=np.float)
+        r = np.arange(data.shape[1], dtype=np.float_)
         r += (r[1] - r[0]) / 2.0
 
     if np.isscalar(az):
         az = np.ones_like(th) * az
 
     da = georef.create_xarray_dataarray(
         img,
@@ -1065,15 +1065,14 @@
     add_title = ""
     if terrain is True:
         add_title += f" - Azimuth {az[0]}"
         ll = georef.reproject(xyz, projection_source=rad)
         # (down-)load srtm data
         ds = io.get_srtm(
             [ll[..., 0].min(), ll[..., 0].max(), ll[..., 1].min(), ll[..., 1].max()],
-            download={},
         )
         rastervalues, rastercoords, proj = georef.extract_raster_dataset(
             ds, nodata=-32768.0
         )
         # map rastervalues to polar grid points
         terrain = ipol.cart_to_irregular_spline(
             rastercoords, rastervalues, ll[-1, ..., :2], order=3, prefilter=False
```

### Comparing `wradlib-1.9.0/wradlib/vpr.py` & `wradlib-1.9.1/wradlib/vpr.py`

 * *Files 4% similar despite different names*

```diff
@@ -28,53 +28,54 @@
 comparable. Basically, a CAPPI is simply one slice out of a 3-D volume grid.
 Analoguous, we will refer to the elements in a three dimensional Cartesian grid
 as *voxels*. In wradlib, you can create
 CAPPIS (:class:`~wradlib.vpr.CAPPI`) and Pseudo CAPPIs
 (:class:`~wradlib.vpr.PseudoCAPPI`) for different altitudes at once.
 
 Here's an example how a set of CAPPIs can be created from synthetic polar
-volume data::
+volume data:
 
-    import wradlib
-    import numpy as np
-
-    # define elevation and azimuth angles, ranges, radar site coordinates,
-    # projection
-    elevs  = np.array([0.5,1.5,2.4,3.4,4.3,5.3,6.2,7.5,8.7,10,12,14,16.7,19.5])
-    azims  = np.arange(0., 360., 1.)
-    ranges = np.arange(0., 120000., 1000.)
-    sitecoords = (14.924218,120.255547,500.)
-    proj = osr.SpatialReference()
-    proj.ImportFromEPSG(32651)
-
-    # create Cartesian coordinates corresponding the location of the
-    # polar volume bins
-    polxyz  = wradlib.vpr.volcoords_from_polar(sitecoords, elevs,
-                                               azims, ranges, proj)  # noqa
-    poldata = wradlib.vpr.synthetic_polar_volume(polxyz)
-    # this is the shape of our polar volume
-    polshape = (len(elevs),len(azims),len(ranges))
-
-    # now we define the coordinates for the 3-D grid (the CAPPI layers)
-    x = np.linspace(polxyz[:,0].min(), polxyz[:,0].max(), 120)
-    y = np.linspace(polxyz[:,1].min(), polxyz[:,1].max(), 120)
-    z = np.arange(500.,10500.,500.)
-    xyz = wradlib.util.gridaspoints(x, y, z)
-    gridshape = (len(x), len(y), len(z))
-
-    # create an instance of the CAPPI class and
-    # use it to create a series of CAPPIs
-    gridder = wradlib.vpr.CAPPI(polxyz, xyz, maxrange=ranges.max(),
-                                gridshape=gridshape, ipclass=wradlib.ipol.Idw)
-    gridded = np.ma.masked_invalid( gridder(poldata) ).reshape(gridshape)
-
-    # plot results
-    levels = np.linspace(0,100,25)
-    wradlib.vis.plot_max_plan_and_vert(x, y, z, gridded, levels=levels,
-                                       cmap=pl.cm.viridis)
+    >>> import wradlib
+    >>> import numpy as np
+    >>> from osgeo import osr
+    >>> import matplotlib.pyplot as pl
+    >>> pl.interactive(True)
+    >>> # define elevation and azimuth angles, ranges, radar site coordinates,
+    >>> # projection
+    >>> elevs  = np.array([0.5,1.5,2.4,3.4,4.3,5.3,6.2,7.5,8.7,10,12,14,16.7,19.5])
+    >>> azims  = np.arange(0., 360., 1.)
+    >>> ranges = np.arange(0., 120000., 1000.)
+    >>> sitecoords = (120.255547,14.924218,500.)
+    >>> proj = osr.SpatialReference()
+    >>> _ = proj.ImportFromEPSG(32651)
+    >>> # create Cartesian coordinates corresponding the location of the
+    >>> # polar volume bins
+    >>> polxyz  = wradlib.vpr.volcoords_from_polar(sitecoords, elevs,
+    ...                                            azims, ranges, proj)  # noqa
+    >>> poldata = wradlib.vpr.synthetic_polar_volume(polxyz)
+    >>> # this is the shape of our polar volume
+    >>> polshape = (len(elevs),len(azims),len(ranges))
+    >>> # now we define the coordinates for the 3-D grid (the CAPPI layers)
+    >>> x = np.linspace(polxyz[:,0].min(), polxyz[:,0].max(), 120)
+    >>> y = np.linspace(polxyz[:,1].min(), polxyz[:,1].max(), 120)
+    >>> z = np.arange(500.,10500.,500.)
+    >>> xyz = wradlib.util.gridaspoints(z, y, x)
+    >>> gridshape = (len(z), len(y), len(x))
+    >>> # create an instance of the CAPPI class and
+    >>> # use it to create a series of CAPPIs
+    >>> gridder = wradlib.vpr.CAPPI(polxyz, xyz, gridshape=gridshape, maxrange=ranges.max(),  # noqa
+    ...                             minelev=elevs.min(), maxelev=elevs.max(),
+    ...                             ipclass=wradlib.ipol.Idw)
+    >>> gridded = np.ma.masked_invalid( gridder(poldata) ).reshape(gridshape)
+    >>>
+    >>> # plot results
+    >>> levels = np.linspace(0,100,25)
+    >>> wradlib.vis.plot_max_plan_and_vert(x, y, z, gridded, levels=levels,
+    ...                                    cmap=pl.cm.viridis)
+    >>> pl.show()
 
 
 .. autosummary::
    :nosignatures:
    :toctree: generated/
 
    {}
@@ -147,15 +148,15 @@
         self.mask = self._get_mask(
             gridcoords, polcoords, gridshape, maxrange, minelev, maxelev
         )
         # create an instance of the Interpolation class
         self.trgix = np.where(np.logical_not(self.mask))
         self.ip = ipclass(src=polcoords, trg=gridcoords[self.trgix], **ipargs)
 
-    def __call__(self, data):
+    def __call__(self, data, **kwargs):
         """Interpolates the polar data to 3-dimensional Cartesian coordinates
 
         Parameters
         ----------
         data : :class:`numpy:numpy.ndarray`
             1-d array of length (num radar bins in volume,)
             The length of this array must be the same as len(polcoords)
@@ -164,15 +165,15 @@
         -------
         output : :class:`numpy:numpy.ndarray`
             1-d array of length (num voxels,)
 
         """
         # Interpolate data in 3-D
         ipdata = np.repeat(np.nan, len(self.mask))
-        ipdata[self.trgix] = self.ip(data)
+        ipdata[self.trgix] = self.ip(data, **kwargs)
 
         return ipdata
 
     def _get_mask(
         self,
         gridcoords,
         polcoords=None,
```

### Comparing `wradlib-1.9.0/wradlib/zonalstats.py` & `wradlib-1.9.1/wradlib/zonalstats.py`

 * *Files 0% similar despite different names*

```diff
@@ -1257,15 +1257,15 @@
 
     """
     clip = [clippoly]
 
     zd = ZonalDataPoint(coords.reshape(-1, coords.shape[-1]), clip, srs=srs)
 
     # Subsetting in order to use only precipitating profiles
-    src_mask = np.zeros(coords.shape[0:-1], dtype=np.bool)
+    src_mask = np.zeros(coords.shape[0:-1], dtype=np.bool_)
 
     try:
         obj = ZonalStatsPoint(zd)
 
         # Get source indices within polygon from zonal object
         # (0 because we have only one zone)
         pr_idx = obj.zdata.get_source_index(0)
```

### Comparing `wradlib-1.9.0/wradlib/zr.py` & `wradlib-1.9.1/wradlib/zr.py`

 * *Files identical despite different names*

### Comparing `wradlib-1.9.0/wradlib.egg-info/PKG-INFO` & `wradlib-1.9.1/wradlib.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: wradlib
-Version: 1.9.0
+Version: 1.9.1
 Summary: wradlib - An Open Source Library for Weather Radar Data Processing
 Home-page: http://wradlib.org
 Maintainer: wradlib developers
 Maintainer-email: wradlib@wradlib.org
 License: MIT
 Download-URL: https://github.com/wradlib/wradlib
 Description: wradlib is designed to assist you in the most important steps of
```

### Comparing `wradlib-1.9.0/wradlib.egg-info/SOURCES.txt` & `wradlib-1.9.1/wradlib.egg-info/SOURCES.txt`

 * *Files identical despite different names*

