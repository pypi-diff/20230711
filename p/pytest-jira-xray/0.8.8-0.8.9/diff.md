# Comparing `tmp/pytest_jira_xray-0.8.8-py3-none-any.whl.zip` & `tmp/pytest_jira_xray-0.8.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,18 @@
-Zip file size: 19067 bytes, number of entries: 16
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-05 16:58 pytest_xray/__init__.py
--rw-r--r--  2.0 unx     1239 b- defN 23-Jun-06 16:33 pytest_xray/constant.py
--rw-r--r--  2.0 unx     1401 b- defN 23-Jun-05 16:58 pytest_xray/evidence.py
--rw-r--r--  2.0 unx      137 b- defN 23-Jun-05 16:58 pytest_xray/exceptions.py
--rw-r--r--  2.0 unx      836 b- defN 23-Jun-05 16:58 pytest_xray/file_publisher.py
--rw-r--r--  2.0 unx     9205 b- defN 23-Jun-05 16:58 pytest_xray/helper.py
--rw-r--r--  2.0 unx      298 b- defN 23-Jun-05 16:58 pytest_xray/hooks.py
--rw-r--r--  2.0 unx     3864 b- defN 23-Jun-06 16:33 pytest_xray/plugin.py
--rw-r--r--  2.0 unx     7458 b- defN 23-Jun-06 16:33 pytest_xray/xray_plugin.py
--rw-r--r--  2.0 unx     4389 b- defN 23-Jun-05 16:58 pytest_xray/xray_publisher.py
--rw-r--r--  2.0 unx    11357 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/LICENSE
--rw-r--r--  2.0 unx     8691 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/WHEEL
--rw-r--r--  2.0 unx       37 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       12 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1340 b- defN 23-Jun-06 17:44 pytest_jira_xray-0.8.8.dist-info/RECORD
-16 files, 50356 bytes uncompressed, 16843 bytes compressed:  66.6%
+Zip file size: 19283 bytes, number of entries: 16
+-rw-rw-r--  2.0 unx        0 b- defN 22-May-08 18:35 pytest_xray/__init__.py
+-rw-rw-r--  2.0 unx     1239 b- defN 23-Jun-11 13:59 pytest_xray/constant.py
+-rw-rw-r--  2.0 unx     1401 b- defN 23-Jun-11 13:59 pytest_xray/evidence.py
+-rw-rw-r--  2.0 unx      137 b- defN 22-May-08 18:35 pytest_xray/exceptions.py
+-rw-rw-r--  2.0 unx      885 b- defN 23-Jul-11 15:15 pytest_xray/file_publisher.py
+-rw-rw-r--  2.0 unx     9522 b- defN 23-Jul-11 15:15 pytest_xray/helper.py
+-rw-rw-r--  2.0 unx      298 b- defN 22-Sep-25 16:30 pytest_xray/hooks.py
+-rw-rw-r--  2.0 unx     3864 b- defN 23-Jun-16 18:09 pytest_xray/plugin.py
+-rw-rw-r--  2.0 unx     7564 b- defN 23-Jul-11 15:15 pytest_xray/xray_plugin.py
+-rw-rw-r--  2.0 unx     4482 b- defN 23-Jul-11 15:15 pytest_xray/xray_publisher.py
+-rw-rw-r--  2.0 unx    11357 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/LICENSE
+-rw-rw-r--  2.0 unx     8760 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       37 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/entry_points.txt
+-rw-rw-r--  2.0 unx       12 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1340 b- defN 23-Jul-11 15:20 pytest_jira_xray-0.8.9.dist-info/RECORD
+16 files, 50990 bytes uncompressed, 17059 bytes compressed:  66.5%
```

## zipnote {}

```diff
@@ -24,26 +24,26 @@
 
 Filename: pytest_xray/xray_plugin.py
 Comment: 
 
 Filename: pytest_xray/xray_publisher.py
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/LICENSE
+Filename: pytest_jira_xray-0.8.9.dist-info/LICENSE
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/METADATA
+Filename: pytest_jira_xray-0.8.9.dist-info/METADATA
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/WHEEL
+Filename: pytest_jira_xray-0.8.9.dist-info/WHEEL
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/entry_points.txt
+Filename: pytest_jira_xray-0.8.9.dist-info/entry_points.txt
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/top_level.txt
+Filename: pytest_jira_xray-0.8.9.dist-info/top_level.txt
 Comment: 
 
-Filename: pytest_jira_xray-0.8.8.dist-info/RECORD
+Filename: pytest_jira_xray-0.8.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pytest_xray/file_publisher.py

```diff
@@ -5,16 +5,17 @@
 from pytest_xray.exceptions import XrayError
 
 
 logger = logging.getLogger(__name__)
 
 
 class FilePublisher:
+    """Exports Xray report to a file."""
 
-    def __init__(self, filepath: str):
+    def __init__(self, filepath: str) -> None:
         self.filepath: Path = Path(filepath)
 
     def publish(self, data: dict) -> str:
         """
         Save results to a file or raise XrayError.
 
         :param data: data to save
```

## pytest_xray/helper.py

```diff
@@ -29,56 +29,57 @@
     BLOCKED = 'BLOCKED'
 
 
 # This is the hierarchy of the Status, from bottom to top.
 # When merging two statuses, the highest will be picked.
 # For example, a PASS and a FAIL will result in a FAIL,
 # A TODO and an ABORTED in an ABORTED, A TODO and a PASS in a TODO.
-STATUS_HIERARCHY = [
+STATUS_HIERARCHY: List[Status] = [
     Status.PASS,
     Status.TODO,
     Status.EXECUTING,
     Status.PENDING,
     Status.FAIL,
     Status.ABORTED,
     Status.BLOCKED,
 ]
 
 # Maps the Status from the internal Status enum to the string representations
 # requested by either the Cloud Jira, or the on-site Jira
-STATUS_STR_MAPPER_CLOUD = {
+STATUS_STR_MAPPER_CLOUD: Dict[Status, str] = {
     Status.TODO: 'TODO',
     Status.EXECUTING: 'EXECUTING',
     Status.PENDING: 'PENDING',
     Status.PASS: 'PASSED',
     Status.FAIL: 'FAILED',
     Status.ABORTED: 'ABORTED',
     Status.BLOCKED: 'BLOCKED',
 }
 
 # On-site jira uses the enum strings directly
-STATUS_STR_MAPPER_JIRA = {x: x.value for x in Status}
+STATUS_STR_MAPPER_JIRA: Dict[Status, str] = {x: x.value for x in Status}
 
 
 class TestCase:
+
     def __init__(
         self,
         test_key: str,
         status: Status,
         comment: Optional[str] = None,
         status_str_mapper: Optional[Dict[Status, str]] = None,
         evidences: Optional[List[Dict[str, str]]] = None
-    ):
+    ) -> None:
         self.test_key = test_key
         self.status = status
         self.comment = comment or ''
         self.status_str_mapper = status_str_mapper or STATUS_STR_MAPPER_JIRA
         self.evidences = evidences or []
 
-    def merge(self, other: 'TestCase'):
+    def merge(self, other: 'TestCase') -> None:
         """
         Merges this test case with other, in order to obtain
         a combined result. Comments will be just appended one after the other.
         status will be merged according to a priority list.
         Merge is only possible if the two tests have the same test_key
         """
 
@@ -98,16 +99,17 @@
 
         self.status = _merge_status(self.status, other.status)
 
     def as_dict(self) -> Dict[str, Any]:
         data: Dict[str, Any] = dict(
             testKey=self.test_key,
             status=self.status_str_mapper[self.status],
-            comment=self.comment,
         )
+        if self.comment != '':
+            data['comment'] = "{noformat:borderWidth=0px|bgColor=transparent}" + self.comment + "{noformat}"
         if self.evidences:
             data['evidences'] = self.evidences
         return data
 
 
 class TestExecution:
 
@@ -153,14 +155,15 @@
         for test in self.tests:
             if test.test_key == test_key:
                 return test
 
         raise KeyError(test_key)
 
     def as_dict(self) -> Dict[str, Any]:
+        """Return test execution result as dictionary."""
         tests = [test.as_dict() for test in self.tests]
         info: Dict[str, Any] = dict(
             startDate=self.start_date.strftime(DATETIME_FORMAT),
             finishDate=self.finish_date.strftime(DATETIME_FORMAT),  # type: ignore
         )
 
         if self.fix_version:
@@ -186,14 +189,15 @@
             info['testPlanKey'] = self.test_plan_key
         if self.test_execution_key:
             data['testExecutionKey'] = self.test_execution_key
         return data
 
 
 def get_base_options() -> Dict[str, Any]:
+    """Return authentication configuration from environment variables."""
     options = {}
     try:
         base_url = environ[ENV_XRAY_API_BASE_URL]
     except KeyError as e:
         raise XrayError(
             f'pytest-jira-xray plugin requires environment variable: {ENV_XRAY_API_BASE_URL}'
         ) from e
@@ -286,14 +290,14 @@
     else:
         source = [param]
 
     # Return stripped non empty values
     return list(filter(lambda x: len(x) > 0, map(lambda x: x.strip(), source)))
 
 
-def _merge_status(status_1: Status, status_2: Status):
+def _merge_status(status_1: Status, status_2: Status) -> Status:
     """Merges the status of two tests."""
 
     return STATUS_HIERARCHY[max(
         STATUS_HIERARCHY.index(status_1),
         STATUS_HIERARCHY.index(status_2)
     )]
```

## pytest_xray/plugin.py

 * *Ordering differences only*

```diff
@@ -8,20 +8,20 @@
 from pytest_xray.constant import (
     JIRA_API_KEY,
     JIRA_CLIENT_SECRET_AUTH,
     JIRA_CLOUD,
     JIRA_XRAY_FLAG,
     TEST_EXECUTION_ENDPOINT,
     TEST_EXECUTION_ENDPOINT_CLOUD,
+    XRAY_ADD_CAPTURES,
     XRAY_ALLOW_DUPLICATE_IDS,
     XRAY_EXECUTION_ID,
     XRAY_PLUGIN,
     XRAY_TEST_PLAN_ID,
     XRAYPATH,
-    XRAY_ADD_CAPTURES,
 )
 from pytest_xray.file_publisher import FilePublisher
 from pytest_xray.helper import get_api_key_auth, get_basic_auth, get_bearer_auth
 from pytest_xray.xray_plugin import XrayPlugin
 from pytest_xray.xray_publisher import ApiKeyAuth, ClientSecretAuth, XrayPublisher
```

## pytest_xray/xray_plugin.py

```diff
@@ -9,32 +9,33 @@
 from _pytest.mark import Mark
 from _pytest.nodes import Item
 from _pytest.reports import TestReport
 from _pytest.terminal import TerminalReporter
 
 from pytest_xray.constant import (
     JIRA_CLOUD,
+    XRAY_ADD_CAPTURES,
     XRAY_ALLOW_DUPLICATE_IDS,
     XRAY_EXECUTION_ID,
     XRAY_MARKER_NAME,
     XRAY_TEST_PLAN_ID,
     XRAYPATH,
-    XRAY_ADD_CAPTURES,
 )
 from pytest_xray.exceptions import XrayError
 from pytest_xray.helper import (
     STATUS_STR_MAPPER_CLOUD,
     STATUS_STR_MAPPER_JIRA,
     Status,
     TestCase,
     TestExecution,
 )
 
 
 class XrayPlugin:
+    """Collects results from pytest and exports to Jira Xray server."""
 
     def __init__(self, config, publisher):
         self.config = config
         self.publisher = publisher
         self.test_execution_id: str = self.config.getoption(XRAY_EXECUTION_ID)
         self.test_plan_id: str = self.config.getoption(XRAY_TEST_PLAN_ID)
         self.is_cloud_server: str = self.config.getoption(JIRA_CLOUD)
@@ -118,15 +119,16 @@
         if test_keys is None:
             return
 
         evidences = getattr(report, 'evidences', [])
 
         comment = report.longreprtext
         if self.add_captures:
-            comment += '\n'
+            if comment != '':
+                comment += '\n'
             if report.capstdout:
                 comment += f"{'-'*29} Captured stdout call {'-'*29}\n{report.capstdout}"
             if report.capstderr:
                 comment += f"{'-'*29} Captured stderr call {'-'*29}\n{report.capstderr}"
             if report.caplog:
                 # Remove the ncurses escape chars used to color log level
                 logt = re.subn('\x1b.*?m', '', report.caplog)
```

## pytest_xray/xray_publisher.py

```diff
@@ -68,14 +68,15 @@
 
     def __call__(self, r: requests.PreparedRequest) -> requests.PreparedRequest:
         r.headers['Authorization'] = f'Bearer {self.api_key}'
         return r
 
 
 class XrayPublisher:
+    """Exports Xray report to a Jira server."""
 
     def __init__(
         self,
         base_url: str,
         endpoint: str,
         auth: Union[AuthBase, tuple],
         verify: Union[bool, str] = True
@@ -85,14 +86,15 @@
         self.base_url = base_url
         self.endpoint = endpoint
         self.auth = auth
         self.verify = verify
 
     @property
     def endpoint_url(self) -> str:
+        """Return full URL to the server."""
         return self.base_url + self.endpoint
 
     def _send_data(self, url: str, auth: Union[AuthBase, tuple], data: dict) -> dict:
         headers = {
             'Accept': 'application/json',
             'Content-Type': 'application/json'
         }
```

## Comparing `pytest_jira_xray-0.8.8.dist-info/LICENSE` & `pytest_jira_xray-0.8.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `pytest_jira_xray-0.8.8.dist-info/METADATA` & `pytest_jira_xray-0.8.9.dist-info/METADATA`

 * *Files 3% similar despite different names*

```diff
@@ -1,25 +1,26 @@
 Metadata-Version: 2.1
 Name: pytest-jira-xray
-Version: 0.8.8
+Version: 0.8.9
 Summary: pytest plugin to integrate tests with JIRA XRAY
-Home-page: https://github.com/fundakol/pytest-jira-xray
-Author: Lukasz Fundakowski
-Author-email: fundakol@yahoo.com
-Keywords: pytest,JIRA,XRAY
+Author-email: Lukasz Fundakowski <fundakol@yahoo.com>
+Project-URL: homepage, https://github.com/fundakol/pytest-jira-xray
+Keywords: pytest, JIRA, XRAY
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python :: 3
-Classifier: Programming Language :: Python :: 3.6
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
+Classifier: Programming Language :: Python :: 3.11
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: OS Independent
 Classifier: Framework :: Pytest
+Requires-Python: >=3.7
+Description-Content-Type: text/x-rst
 License-File: LICENSE
 Requires-Dist: pytest
 Requires-Dist: requests
 
 ================
 pytest-jira-xray
 ================
```

