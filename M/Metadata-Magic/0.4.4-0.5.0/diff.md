# Comparing `tmp/Metadata_Magic-0.4.4-py3-none-any.whl.zip` & `tmp/Metadata_Magic-0.5.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,42 +1,42 @@
-Zip file size: 73218 bytes, number of entries: 40
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/__init__.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/main/__init__.py
--rw-rw-r--  2.0 unx     2997 b- defN 23-Jun-16 04:28 metadata_magic/main/meta_finder.py
--rw-rw-r--  2.0 unx    12224 b- defN 23-Jun-16 04:28 metadata_magic/main/meta_reader.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/main/comic_archive/__init__.py
--rw-rw-r--  2.0 unx    15241 b- defN 23-Jun-16 04:28 metadata_magic/main/comic_archive/comic_archive.py
--rw-rw-r--  2.0 unx    10392 b- defN 23-Jun-16 04:28 metadata_magic/main/comic_archive/comic_xml.py
--rw-rw-r--  2.0 unx     8011 b- defN 23-Jun-16 04:28 metadata_magic/main/comic_archive/series_info.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/main/epub/__init__.py
--rw-rw-r--  2.0 unx    33842 b- defN 23-Jun-16 04:28 metadata_magic/main/epub/epub.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/main/error_finding/__init__.py
--rw-rw-r--  2.0 unx     2115 b- defN 23-Jun-16 04:28 metadata_magic/main/error_finding/missing_media.py
--rw-rw-r--  2.0 unx     2137 b- defN 23-Jun-16 04:28 metadata_magic/main/error_finding/missing_metadata.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/main/rename/__init__.py
--rw-rw-r--  2.0 unx     6930 b- defN 23-Jun-16 04:28 metadata_magic/main/rename/meta_rename.py
--rw-rw-r--  2.0 unx     3263 b- defN 23-Jun-16 04:28 metadata_magic/main/rename/rename_tools.py
--rw-rw-r--  2.0 unx     7793 b- defN 23-Jun-16 04:28 metadata_magic/main/rename/sort_rename.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/test/__init__.py
--rw-rw-r--  2.0 unx     1468 b- defN 23-Jun-16 04:28 metadata_magic/test/temp_file_tools.py
--rw-rw-r--  2.0 unx     4245 b- defN 23-Jun-16 04:28 metadata_magic/test/test_meta_finder.py
--rw-rw-r--  2.0 unx    22964 b- defN 23-Jun-16 04:28 metadata_magic/test/test_meta_reader.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/test/comic_archive/__init__.py
--rw-rw-r--  2.0 unx    16967 b- defN 23-Jun-16 04:28 metadata_magic/test/comic_archive/test_comic_archive.py
--rw-rw-r--  2.0 unx    19139 b- defN 23-Jun-16 04:28 metadata_magic/test/comic_archive/test_comic_xml.py
--rw-rw-r--  2.0 unx     8845 b- defN 23-Jun-16 04:28 metadata_magic/test/comic_archive/test_series_info.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/test/epub/__init__.py
--rw-rw-r--  2.0 unx    43418 b- defN 23-Jun-16 04:28 metadata_magic/test/epub/test_epub.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/test/error_finding/__init__.py
--rw-rw-r--  2.0 unx     1545 b- defN 23-Jun-16 04:28 metadata_magic/test/error_finding/test_missing_media.py
--rw-rw-r--  2.0 unx     1587 b- defN 23-Jun-16 04:28 metadata_magic/test/error_finding/test_missing_metadata.py
--rw-rw-r--  2.0 unx       23 b- defN 23-Jun-16 04:28 metadata_magic/test/rename/__init__.py
--rw-rw-r--  2.0 unx    10584 b- defN 23-Jun-16 04:28 metadata_magic/test/rename/test_meta_rename.py
--rw-rw-r--  2.0 unx     4648 b- defN 23-Jun-16 04:28 metadata_magic/test/rename/test_rename_tools.py
--rw-rw-r--  2.0 unx    10127 b- defN 23-Jun-16 04:28 metadata_magic/test/rename/test_sort_rename.py
--rw-rw-r--  2.0 unx    35149 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/LICENSE
--rw-rw-r--  2.0 unx     5754 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx      475 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/entry_points.txt
--rw-rw-r--  2.0 unx       15 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3902 b- defN 23-Jun-16 04:29 Metadata_Magic-0.4.4.dist-info/RECORD
-40 files, 296122 bytes uncompressed, 66772 bytes compressed:  77.5%
+Zip file size: 71951 bytes, number of entries: 40
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/__init__.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/main/__init__.py
+-rw-r--r--  2.0 unx     3095 b- defN 23-Jul-09 21:31 metadata_magic/main/meta_finder.py
+-rw-r--r--  2.0 unx    12224 b- defN 23-Jul-09 20:05 metadata_magic/main/meta_reader.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/main/comic_archive/__init__.py
+-rw-r--r--  2.0 unx    12945 b- defN 23-Jul-11 18:19 metadata_magic/main/comic_archive/comic_archive.py
+-rw-r--r--  2.0 unx     9964 b- defN 23-Jul-09 21:34 metadata_magic/main/comic_archive/comic_xml.py
+-rw-r--r--  2.0 unx     8012 b- defN 23-Jul-09 21:36 metadata_magic/main/comic_archive/series_info.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/main/epub/__init__.py
+-rw-r--r--  2.0 unx    33837 b- defN 23-Jul-10 17:24 metadata_magic/main/epub/epub.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/main/error_finding/__init__.py
+-rw-r--r--  2.0 unx     2115 b- defN 23-Jul-09 20:05 metadata_magic/main/error_finding/missing_media.py
+-rw-r--r--  2.0 unx     2137 b- defN 23-Jul-09 20:05 metadata_magic/main/error_finding/missing_metadata.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/main/rename/__init__.py
+-rw-r--r--  2.0 unx     6930 b- defN 23-Jul-09 20:05 metadata_magic/main/rename/meta_rename.py
+-rw-r--r--  2.0 unx     6652 b- defN 23-Jul-09 21:41 metadata_magic/main/rename/rename_tools.py
+-rw-r--r--  2.0 unx     4493 b- defN 23-Jul-09 21:42 metadata_magic/main/rename/sort_rename.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/test/__init__.py
+-rw-r--r--  2.0 unx     1468 b- defN 23-Jul-09 20:05 metadata_magic/test/temp_file_tools.py
+-rw-r--r--  2.0 unx     4239 b- defN 23-Jul-10 17:25 metadata_magic/test/test_meta_finder.py
+-rw-r--r--  2.0 unx    22958 b- defN 23-Jul-10 17:26 metadata_magic/test/test_meta_reader.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/test/comic_archive/__init__.py
+-rw-r--r--  2.0 unx     9745 b- defN 23-Jul-11 18:45 metadata_magic/test/comic_archive/test_comic_archive.py
+-rw-r--r--  2.0 unx    19943 b- defN 23-Jul-10 17:25 metadata_magic/test/comic_archive/test_comic_xml.py
+-rw-r--r--  2.0 unx     8777 b- defN 23-Jul-11 18:35 metadata_magic/test/comic_archive/test_series_info.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/test/epub/__init__.py
+-rw-r--r--  2.0 unx    43413 b- defN 23-Jul-10 17:23 metadata_magic/test/epub/test_epub.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/test/error_finding/__init__.py
+-rw-r--r--  2.0 unx     1539 b- defN 23-Jul-10 17:23 metadata_magic/test/error_finding/test_missing_media.py
+-rw-r--r--  2.0 unx     1581 b- defN 23-Jul-10 17:22 metadata_magic/test/error_finding/test_missing_metadata.py
+-rw-r--r--  2.0 unx       23 b- defN 23-Jul-09 20:05 metadata_magic/test/rename/__init__.py
+-rw-r--r--  2.0 unx     9717 b- defN 23-Jul-10 20:22 metadata_magic/test/rename/test_meta_rename.py
+-rw-r--r--  2.0 unx     8014 b- defN 23-Jul-10 17:21 metadata_magic/test/rename/test_rename_tools.py
+-rw-r--r--  2.0 unx     6753 b- defN 23-Jul-10 17:16 metadata_magic/test/rename/test_sort_rename.py
+-rw-r--r--  2.0 unx    35149 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5754 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx      475 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       15 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3898 b- defN 23-Jul-11 19:03 Metadata_Magic-0.5.0.dist-info/RECORD
+40 files, 286187 bytes uncompressed, 65505 bytes compressed:  77.1%
```

## zipnote {}

```diff
@@ -96,26 +96,26 @@
 
 Filename: metadata_magic/test/rename/test_rename_tools.py
 Comment: 
 
 Filename: metadata_magic/test/rename/test_sort_rename.py
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/LICENSE
+Filename: Metadata_Magic-0.5.0.dist-info/LICENSE
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/METADATA
+Filename: Metadata_Magic-0.5.0.dist-info/METADATA
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/WHEEL
+Filename: Metadata_Magic-0.5.0.dist-info/WHEEL
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/entry_points.txt
+Filename: Metadata_Magic-0.5.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/top_level.txt
+Filename: Metadata_Magic-0.5.0.dist-info/top_level.txt
 Comment: 
 
-Filename: Metadata_Magic-0.4.4.dist-info/RECORD
+Filename: Metadata_Magic-0.5.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## metadata_magic/main/meta_finder.py

```diff
@@ -1,10 +1,11 @@
 #!/usr/bin/env python3
 
 from html_string_tools.main.html_string_tools import get_extension
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from os import listdir, pardir
 from os.path import abspath, basename, exists, join, isdir
 from tqdm import tqdm
 from typing import List
 
 def separate_files(path:str) -> tuple:
     """
@@ -34,16 +35,16 @@
             directories.append(full_file)
     # Append files in subdirectories
     for directory in directories:
         new_jsons, new_media = separate_files(directory)
         jsons.extend(new_jsons)
         media.extend(new_media)
     # Return JSON and media files separated
-    jsons.sort()
-    media.sort()
+    jsons = sort_alphanum(jsons)
+    media = sort_alphanum(media)
     return (jsons, media)
 
 def get_pairs(path:str) -> List[dict]:
     """
     Returns a list of media files paired with their corresponding JSON metadata file.
     Returned in dicts with "json" and "media" fields.
```

## metadata_magic/main/comic_archive/comic_archive.py

```diff
@@ -1,82 +1,94 @@
 #!/usr/bin/env python3
 
 from argparse import ArgumentParser
 from os import getcwd, listdir, mkdir, pardir, remove
 from os.path import abspath, basename, exists, isdir, join, relpath
 from html_string_tools.main.html_string_tools import get_extension
+from metadata_magic.main.file_tools.file_tools import create_zip, extract_file_from_zip, extract_zip, get_temp_dir
 from metadata_magic.main.comic_archive.comic_xml import get_comic_xml
 from metadata_magic.main.comic_archive.comic_xml import generate_info_from_jsons
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.comic_archive.comic_xml import read_comic_info
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from python_print_tools.main.python_print_tools import color_print
-from tempfile import gettempdir
 from tqdm import tqdm
 from re import findall
 from re import sub as resub
-from shutil import copy, rmtree
-from zipfile import BadZipFile, is_zipfile, ZipFile
+from shutil import copy, move, rmtree
+from zipfile import is_zipfile
+from metadata_magic.test.temp_file_tools import create_text_file
 
-def get_temp_dir(folder_name:str="dvk_meta_magic") -> str:
+def create_cbz(directory:str, name:str=None, metadata:dict=None, remove_files:bool=False) -> str:
     """
-    Creates and returns test directory.
-
-    :param folder_name: Name to give the temporary directory, defaults to "dvk_meta_magic"
-    :type folder_name: str, optional
-    :return: File path of the test directory
-    :rtype: str
-    """
-    temp_dir = abspath(join(abspath(gettempdir()), folder_name))
-    if(exists(temp_dir)):
-        rmtree(temp_dir)
-    mkdir(temp_dir)
-    return temp_dir
-
-def create_cbz(directory:str) -> str:
-    """
-    Creates a cbz archive containing all the files in a given directory.
+    Creates a cbz archive containing the files of a given directory.
     
-    :param directory: Directory with files to compress into archive
+    :param directory: Directory with files to archive
     :type directory: str, required
-    :return: Full path of the created cbz archive
+    :param name: Name of the CBZ file, will use default name if not present, defaults to None
+    :type name: str, optional
+    :param metadata: Metadata to include as ComicInfo.xml, defaults to None
+    :type metadata: dict, optional
+    :param remove_files: Whether to delete the files now in the archive once the CBZ is completed, defaults to False
+    :type remove_files: bool, optional
+    :return: Path of the newly created CBZ file
     :rtype: str
     """
-    try:
-        # Get filenames
-        full_directory = abspath(directory)
-        cbz = abspath(join(full_directory, basename(full_directory) + ".cbz"))
-        # Simply update filename if cbz already exists
-        if exists(cbz):
-            xml_file = abspath(join(full_directory, "ComicInfo.xml"))
-            metadata = read_comic_info(xml_file)
-            update_cbz_info(cbz, metadata)
-            return cbz
-        # Get list of files in the directory
+    # Return None if directory is empty
+    full_directory = abspath(directory)
+    if len(listdir(full_directory)) == 0:
+        return None
+    # Create CBZ filename
+    filename = basename(full_directory) + ".cbz"
+    if name is not None:
+        filename = f"{name}.cbz"
+    cbz_file = abspath(join(full_directory, filename))
+    # Update CBZ if it already exists
+    if exists(cbz_file):
+        if metadata is not None:
+            update_cbz_info(cbz_file, metadata)
+        return cbz_file
+    # Check if there are existing directories
+    move_files = True
+    files = sort_alphanum(listdir(full_directory))
+    for file in files:
+        if isdir(abspath(join(full_directory, file))):
+            move_files = False
+            break
+    # Move files if required
+    if move_files:
+        # Create new folder to contain files
+        folder_name = files[0][:len(files[0]) - len(get_extension(files[0]))]
+        new_folder = abspath(join(full_directory, folder_name))
+        mkdir(new_folder)
+        # Move existing files to the new folder
+        for file in files:
+            current_file = abspath(join(full_directory, file))
+            new_file = abspath(join(new_folder, file))
+            move(current_file, new_file)
+    # Create metadata file, if specified
+    meta_file = abspath(join(full_directory, "ComicInfo.xml"))
+    if metadata is not None:
+        create_text_file(meta_file, get_comic_xml(metadata))
+    # Create cbz file
+    assert create_zip(full_directory, cbz_file)
+    # Remove all old files besides the CBZ, if specified.
+    if remove_files:
         files = listdir(full_directory)
-        for i in range(0, len(files)):
-            files[i] = abspath(join(full_directory, files[i]))
-        # Expand list of files to include subdirectories
         for file in files:
-            if isdir(file):
-                sub_files = listdir(file)
-                for i in range(0, len(sub_files)):
-                    files.append(abspath(join(file, sub_files[i])))
-        # Create empty cbz file
-        with ZipFile(cbz, "w") as out_file: pass
-        assert exists(cbz)
-        # Write contents of directory to cbz file
-        for file in tqdm(files):
-            relative = relpath(file, full_directory)
-            with ZipFile(cbz, "a") as out_file:
-                out_file.write(file, relative)
-        # Return the path of the written cbz archive
-        return cbz
-    except FileNotFoundError:
-        return None
+            full_file = abspath(join(full_directory, file))
+            if isdir(full_file):
+                rmtree(full_file)
+            elif not full_file == cbz_file:
+                remove(full_file)
+    # Remove ComicInfo.xml file, if exists
+    if exists(meta_file):
+        remove(meta_file)
+    # Return CBZ file
+    return cbz_file
 
 def get_info_from_cbz(cbz_file:str) -> dict:
     """
     Extracts ComicInfo.xml from a given .cbz file and returns the metadata as a dict.
     
     :param cbz_file: Path to a .cbz file
     :type cbz_file: str, required
@@ -84,20 +96,17 @@
     :rtype: dict
     """
     # Create temporary directory
     file = abspath(cbz_file)
     extract_dir = get_temp_dir("dvk_meta_extract")
     assert exists(extract_dir)
     # Extract ComicInfo.xml from given file
-    try:
-        with ZipFile(file, mode="r") as zfile:
-            zfile.extract("ComicInfo.xml", path=extract_dir)
-    except (BadZipFile, KeyError): return get_empty_metadata()
-    xml_file = abspath(join(extract_dir, "ComicInfo.xml"))
-    assert exists(xml_file)
+    xml_file = extract_file_from_zip(cbz_file, extract_dir, "ComicInfo.xml")
+    if xml_file is None or not exists(xml_file):
+        return get_empty_metadata()
     # Read XML file
     return read_comic_info(xml_file)
 
 def update_cbz_info(cbz_file:str, metadata:dict):
     """
     Replaces the ComicInfo.xml file in a given .cbz file to reflect the given metadata
     
@@ -107,112 +116,24 @@
     :type metadata: dict
     """
     # Check if given file is a valid cbz file
     file = abspath(cbz_file)
     if is_zipfile(file):
         # Extract cbz into temp file
         temp_dir = get_temp_dir("dvk_comic_info")
-        with ZipFile(cbz_file, mode="r") as ext_file:
-            ext_file.extractall(path=temp_dir)
+        extract_zip(cbz_file, temp_dir)
         # Create/Overwrite ComicInfo.xml file
-        xml = get_comic_xml(metadata)
         xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
-        with open(xml_file, "w") as out_file:
-            out_file.write(xml)
+        create_text_file(xml_file, get_comic_xml(metadata))
         # Pack files into archive
         new_cbz = create_cbz(temp_dir)
         # Replace the old cbz file
         remove(file)
         copy(new_cbz, file)
         remove(new_cbz)
-
-def get_comic_info_from_path(path:str) -> dict:
-    """
-    Attempts to get comic metadata from a given path in either cbz, standalone ComicInfo.xml, or JSON format.
-    In order of preference, metadata is gathered from cbz, ComicInfo.xml, then JSON.
-    
-    :param path: Path for either a directory or cbz file
-    :type path: str, required
-    :return: Comic metadata
-    :rtype: dict
-    """
-    # Get full path
-    full_path = abspath(path)
-    empty = get_empty_metadata()
-    empty["age_rating"] = "Unknown"
-    # Check if cbz file is present
-    cbz_file = None
-    if not isdir(full_path):
-        cbz_file = full_path
-    else:
-        files = listdir(full_path)
-        files = sort_alphanum(files)
-        for file in files:
-            if get_extension(file) == ".cbz":
-                cbz_file = abspath(join(full_path, file))
-                break
-    # Try to get info from cbz file, if available
-    if cbz_file is not None:
-        try:
-            metadata = get_info_from_cbz(cbz_file)
-        except FileNotFoundError: metadata = get_empty_metadata()
-        if not metadata == get_empty_metadata() and not metadata == empty:
-            return metadata
-        else:
-            full_path = abspath(join(cbz_file, pardir))
-    # Get metadata from XML file, if available
-    xml_file = abspath(join(full_path, "ComicInfo.xml"))
-    if exists(xml_file):
-        metadata = read_comic_info(xml_file)
-        if not metadata == get_empty_metadata() and not metadata == empty:
-            return metadata
-    # Get metadata from JSONS
-    try:
-        metadata = generate_info_from_jsons(full_path)
-        return metadata
-    except FileNotFoundError: return get_empty_metadata()
-
-def create_or_update_cbz(path:str, metadata:dict) -> str:
-    """
-    Attempts to either create a cbz archive or update an existing archive.
-    If a cbz file or directory containing cbz file is given, existing cbz is updated with giben metadata.
-    If a directory not containing cbz file is given, contents of the directory are archived as cbz.
-    
-    :param path: Path to either a directory or cbz file
-    :type path: str, required
-    :param metadata: Metadata to use when creating ComicInfo.xml
-    :type metadata: dict, required
-    :return: Path of the created or updated cbz file
-    :rtype: str
-    """
-    # Check if path is a directory
-    cbz_file = None
-    full_path = abspath(path)
-    if isdir(full_path):
-        # Create ComicInfo.xml from metadata
-        xml = get_comic_xml(metadata)
-        with open(abspath(join(full_path, "ComicInfo.xml")), "w") as out_file:
-            out_file.write(xml)
-        # See if cbz file already exists
-        files = listdir(full_path)
-        files = sort_alphanum(files)
-        for file in files:
-            if get_extension(file) == ".cbz":
-                cbz_file = abspath(join(full_path, file))
-                break
-        if cbz_file is None:
-            # Create cbz archive
-            print("Creating archive:")
-            cbz_file = create_cbz(full_path)
-            return cbz_file
-    # Update cbz file if applicable
-    if cbz_file is None:
-        cbz_file = full_path
-    update_cbz_info(cbz_file, metadata)
-    return cbz_file
     
 def create_comic_archive(path:str,
                 rp_description:bool=False,
                 rp_date:bool=False,
                 rp_artists:bool=False,
                 rp_publisher:bool=False,
                 rp_url:bool=False,
@@ -237,16 +158,25 @@
     :param rp_tags: Whether to replace the tags from gathered metadata, defaults to False
     :type rp_tags: bool, optional
     :param rp_age: Whether to replace the age rating from gathered metadata, defaults to False
     :type rp_age: bool, optional
     :param rp_score: Whether to replace the score from gathered metadata, defaults to False
     :type rp_score: bool, optional
     """
-    # Get default metadata
+    # Check if there is an existing .cbz file to update
+    filename = None
     full_path = abspath(path)
+    files = listdir(full_path)
+    if len(files) == 1 and get_extension(files[0]) == ".cbz":
+        # Get metadata from the .cbz file
+        filename = files[0][:len(files[0]-4)]
+        metadata = get_info_from_cbz(abspath(join(full_path, files[0])))
+    else:
+        # Get metadate from any existing JSON files
+        metadata = generate_info_from_jsons(full_path)
     metadata = get_comic_info_from_path(full_path)
     # Remove metadata fields the user wishes to replace
     if rp_description:
         metadata["description"] = None
     if rp_date:
         metadata["date"] = None
     if rp_artists:
@@ -332,15 +262,15 @@
             metadata["age_rating"] = "X18+"
     # Get score
     if rp_score:
         score = str(input("Score (Range 0-5): "))
         if not score == "":
             metadata["score"] = score
     # Create/Update .cbz
-    create_or_update_cbz(full_path, metadata)
+    create_cbz(full_path, name=filename, metadata=metadata)
 
 def main():
     """
     Sets up the parser for creating a comic archive.
     """
     # Set up argument parser
     parser = ArgumentParser()
@@ -401,11 +331,8 @@
                 rp_description=args.summary,
                 rp_date=args.date,
                 rp_artists=args.artists,
                 rp_publisher=args.publisher,
                 rp_url=args.url,
                 rp_tags=args.tags,
                 rp_age=args.rating,
-                rp_score=args.grade)
-            
-if __name__ == "__main__":
-    main()
+                rp_score=args.grade)
```

## metadata_magic/main/comic_archive/comic_xml.py

```diff
@@ -3,17 +3,18 @@
 from html_string_tools.main.html_string_tools import get_extension
 from html_string_tools.main.html_string_tools import remove_whitespace
 from html_string_tools.main.html_string_tools import replace_entities
 from re import findall
 from re import sub as resub
 from os import listdir
 from os.path import abspath, exists, isdir, join
+from metadata_magic.main.meta_finder import get_pairs
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.meta_reader import load_metadata
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from xml.etree.ElementTree import Element, SubElement
 from xml.etree.ElementTree import indent as xml_indent
 from xml.etree.ElementTree import parse as xml_parse
 from xml.etree.ElementTree import ParseError
 from xml.etree.ElementTree import tostring as xml_to_string
 
 def get_comic_xml(metadata:dict, indent:bool=True) -> str:
@@ -188,35 +189,22 @@
     Searches sub-directories as well.
     
     :param path: Directory in which to search for JSON files
     :type path: str, required
     :return: Dictionary containing the metadata info
     :rtype: dict
     """
-    # Get list of all files in a directory
-    full_directory = abspath(path)
-    files = listdir(full_directory)
-    for i in range(0, len(files)):
-        files[i] = abspath(join(full_directory, files[i]))
-    for file in files:
-        if isdir(file):
-            sub_files = listdir(file)
-            for i in range(0, len(sub_files)):
-                files.append(abspath(join(file, sub_files[i])))
-    # Get all the JSONS
-    jsons = []
-    for file in files:
-        if get_extension(file) == ".json":
-            jsons.append(file)
-    jsons = sort_alphanum(jsons)
-    # Get metadata from all JSONs
-    try:
-        json_metas = []
-        for json in jsons:
-            json_metas.append(load_metadata(json))
+    # Get all the JSON pairs
+    pairs = get_pairs(path)
+    # Read all JSON metadata
+    json_metas = []
+    for pair in pairs:
+        json_metas.append(load_metadata(pair["json"]))
+    # Get first instance of JSON metadata
+    try:
         main_meta = json_metas[0]
     except IndexError: return get_empty_metadata()
     # Get most metadata from first JSON
     metadata = get_empty_metadata()
     metadata["title"] = main_meta["title"]
     metadata["date"] = main_meta["date"]
     metadata["writer"] = main_meta["writer"]
```

## metadata_magic/main/comic_archive/series_info.py

```diff
@@ -1,15 +1,15 @@
 #!/usr/bin/env python3
 
 from argparse import ArgumentParser
 from metadata_magic.main.comic_archive.comic_archive import get_info_from_cbz
 from metadata_magic.main.comic_archive.comic_archive import update_cbz_info
 from html_string_tools.main.html_string_tools import get_extension
 from math import floor
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from os import name as os_name
 from os import getcwd, listdir, system
 from os.path import abspath, basename, exists, isdir, join
 from python_print_tools.main.python_print_tools import color_print
 from tqdm import tqdm
 from typing import List
```

## metadata_magic/main/epub/epub.py

```diff
@@ -1,17 +1,17 @@
 #!/usr/bin/env python3
 
 from argparse import ArgumentParser
 from html_string_tools.main.html_string_tools import get_extension, regex_replace
 from lxml.html import fromstring as html_from_string
 from lxml.etree import tostring as lxml_to_string
 from metadata_magic.main.comic_archive.comic_archive import create_cbz
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.comic_archive.comic_xml import generate_info_from_jsons
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from metadata_magic.test.temp_file_tools import create_text_file
 from metadata_magic.test.temp_file_tools import read_text_file
 from os import getcwd, listdir, mkdir
 from os.path import abspath, basename, exists, isdir, join, relpath
 from PIL import Image, UnidentifiedImageError
 from python_print_tools.main.python_print_tools import color_print
 from re import sub as resub
```

## metadata_magic/main/rename/rename_tools.py

```diff
@@ -1,13 +1,114 @@
 #!/usr/bin/env python3
 
+from _functools import cmp_to_key
 from html_string_tools.main.html_string_tools import get_extension
 from os import rename, pardir
 from os.path import abspath, basename, exists, join
+from re import findall
 from re import sub as resub
+from typing import List
+
+def get_section(string:str) -> str:
+    """
+    Gets the first "section" of a given string.
+    A section should contain either only text or only a number.
+    
+    :param string: String to get section from
+    :type string: str, required
+    :return: The first "section" of the given string
+    :rtype: str
+    """
+    # Check if string starts with a number
+    if len(findall("^[0-9]", string)) > 0:
+        # Return number section if string starts with a number
+        return findall("[0-9]+[0-9,\\.]*", string)[0]
+    # Return non-number section if string doesn't start with number
+    sections = findall("[^0-9]+", string)
+    if len(sections) > 0:
+        return sections[0]
+    # Return empty string if no sections could be found
+    return ""
+
+def compare_sections(section1:str, section2:str) -> int:
+    """
+    Compares two sections alphanumerically.
+    Returns -1 if section1 comes first, 1 if section2 comes first.
+    Returns 0 if section1 and section2 are identical.
+    
+    :param section1: First section to compare
+    :type section1: str, required
+    :param section2: Second section to compare
+    :type section2: str, required
+    :return: Integer describing which section should come first
+    :rtype: int
+    """
+    try:
+        # Compare numbers, if applicable.
+        float1 = float(section1.replace(",", ""))
+        float2 = float(section2.replace(",", ""))
+        if float1 > float2:
+            return 1
+        elif float1 < float2:
+            return -1
+        return 0
+    except ValueError:
+        # Return 0 if sections are identical
+        if section1 == section2:
+            return 0
+        # Compare text values
+        sort = sorted([section1, section2])
+        if sort[0] == section1:
+            return -1
+        return 1
+
+def compare_alphanum(string1:str, string2:str) -> int:
+    """
+    Compares two string alphanumerically.
+    Returns -1 if string1 comes first, 1 if string2 comes first.
+    Returns 0 if string1 and string2 are identical.
+    
+    :param string1: First string to compare
+    :type string1: str, required
+    :param string2: Second string to compare
+    :type string1: str, required
+    :return: Integer describing which string should come first
+    :rtype: int
+    """
+    # Prepare strings for comparison
+    compare = 0
+    left1 = create_filename(string1).lower()
+    left2 = create_filename(string2).lower()
+    # Run through comparing strings section by section
+    while compare == 0 and not left1 == "" and not left2 == "":
+        # Get the first sections
+        section1 = get_section(left1)
+        section2 = get_section(left2)
+        # Modify what's left of strings
+        left1 = left1[len(section1):]
+        left2 = left2[len(section2):]
+        # Compare sections
+        compare = compare_sections(section1, section2)
+    # Compare full strings if comparing by section inconclusive
+    if compare == 0:
+        compare = compare_sections(f"T{string1}", f"T{string2}")
+    # Return result
+    return compare
+
+def sort_alphanum(lst:List[str]) -> List[str]:
+    """
+    Sorts a given list alphanumerically.
+    
+    :param lst: List to sort
+    :type lst: list[str], required
+    :return: Sorted list
+    :rtype: list[str]
+    """
+    comparator = cmp_to_key(compare_alphanum)
+    return sorted(lst, key=comparator)
 
 def create_filename(string:str) -> str:
     """
     Creates a string suitable for a filename from a given string.
     :param string: Any string to convert into filename
     :type string: str, required
     :return: String with all invalid characters removed or replaced
```

## metadata_magic/main/rename/sort_rename.py

```diff
@@ -1,119 +1,20 @@
 #!/usr/bin/env python3
 
 from argparse import ArgumentParser
-from _functools import cmp_to_key
 from metadata_magic.main.meta_finder import get_pairs
 from metadata_magic.main.rename.rename_tools import create_filename
 from metadata_magic.main.rename.rename_tools import rename_file
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from os import getcwd, listdir, pardir
 from os.path import abspath, basename, exists, isdir, join
 from python_print_tools.main.python_print_tools import color_print
+from tqdm import tqdm
 from re import findall
 from re import sub as resub
-from typing import List
-from tqdm import tqdm
-
-def get_section(string:str) -> str:
-    """
-    Gets the first "section" of a given string.
-    A section should contain either only text or only a number.
-    
-    :param string: String to get section from
-    :type string: str, required
-    :return: The first "section" of the given string
-    :rtype: str
-    """
-    # Check if string starts with a number
-    if len(findall("^[0-9]", string)) > 0:
-        # Return number section if string starts with a number
-        return findall("[0-9]+[0-9,\\.]*", string)[0]
-    # Return non-number section if string doesn't start with number
-    sections = findall("[^0-9]+", string)
-    if len(sections) > 0:
-        return sections[0]
-    # Return empty string if no sections could be found
-    return ""
-
-def compare_sections(section1:str, section2:str) -> int:
-    """
-    Compares two sections alphanumerically.
-    Returns -1 if section1 comes first, 1 if section2 comes first.
-    Returns 0 if section1 and section2 are identical.
-    
-    :param section1: First section to compare
-    :type section1: str, required
-    :param section2: Second section to compare
-    :type section2: str, required
-    :return: Integer describing which section should come first
-    :rtype: int
-    """
-    try:
-        # Compare numbers, if applicable.
-        float1 = float(section1.replace(",", ""))
-        float2 = float(section2.replace(",", ""))
-        if float1 > float2:
-            return 1
-        elif float1 < float2:
-            return -1
-        return 0
-    except ValueError:
-        # Return 0 if sections are identical
-        if section1 == section2:
-            return 0
-        # Compare text values
-        sort = sorted([section1, section2])
-        if sort[0] == section1:
-            return -1
-        return 1
-
-def compare_alphanum(string1:str, string2:str) -> int:
-    """
-    Compares two string alphanumerically.
-    Returns -1 if string1 comes first, 1 if string2 comes first.
-    Returns 0 if string1 and string2 are identical.
-    
-    :param string1: First string to compare
-    :type string1: str, required
-    :param string2: Second string to compare
-    :type string1: str, required
-    :return: Integer describing which string should come first
-    :rtype: int
-    """
-    # Prepare strings for comparison
-    compare = 0
-    left1 = create_filename(string1).lower()
-    left2 = create_filename(string2).lower()
-    # Run through comparing strings section by section
-    while compare == 0 and not left1 == "" and not left2 == "":
-        # Get the first sections
-        section1 = get_section(left1)
-        section2 = get_section(left2)
-        # Modify what's left of strings
-        left1 = left1[len(section1):]
-        left2 = left2[len(section2):]
-        # Compare sections
-        compare = compare_sections(section1, section2)
-    # Compare full strings if comparing by section inconclusive
-    if compare == 0:
-        compare = compare_sections(f"T{string1}", f"T{string2}")
-    # Return result
-    return compare
-
-def sort_alphanum(lst:List[str]) -> List[str]:
-    """
-    Sorts a given list alphanumerically.
-    
-    :param lst: List to sort
-    :type lst: list[str], required
-    :return: Sorted list
-    :rtype: list[str]
-    """
-    comparator = cmp_to_key(compare_alphanum)
-    return sorted(lst, key=comparator)
 
 def sort_rename(path:str, name:str, start_index:int=1):
     """
     Renames all files in a given path to a common title, sequenced in order with numbers.
     JSON-media pairs are renamed to the same name, all other files named separately.
     "#" Characters in name are converted to actual index number when renaming.
     Number of "#" characters corresponds to the number of padded digits for the index.
```

## metadata_magic/test/test_meta_finder.py

```diff
@@ -1,10 +1,10 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.meta_finder import get_pairs, separate_files
 from metadata_magic.test.temp_file_tools import create_text_file
 from os import mkdir
 from os.path import abspath, basename, join, exists
 
 def test_separate_files():
     """
```

## metadata_magic/test/test_meta_reader.py

```diff
@@ -1,10 +1,10 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.meta_reader import get_artist
 from metadata_magic.main.meta_reader import get_date
 from metadata_magic.main.meta_reader import get_description
 from metadata_magic.main.meta_reader import get_id
 from metadata_magic.main.meta_reader import get_publisher
 from metadata_magic.main.meta_reader import get_tags
 from metadata_magic.main.meta_reader import get_title
```

## metadata_magic/test/comic_archive/test_comic_archive.py

```diff
@@ -1,192 +1,137 @@
 #!/usr/bin/env python3
 
 from metadata_magic.main.comic_archive.comic_archive import create_cbz
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
 from metadata_magic.main.comic_archive.comic_archive import get_info_from_cbz
-from metadata_magic.main.comic_archive.comic_archive import get_comic_info_from_path
 from metadata_magic.main.comic_archive.comic_archive import update_cbz_info
-from metadata_magic.main.comic_archive.comic_archive import create_or_update_cbz
 from metadata_magic.main.comic_archive.comic_xml import get_comic_xml
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.comic_archive.comic_xml import read_comic_info
+from metadata_magic.main.file_tools.file_tools import get_temp_dir, extract_zip
 from metadata_magic.test.temp_file_tools import create_json_file, create_text_file, read_text_file
 from shutil import copy
 from os import listdir, mkdir, pardir, remove
 from os.path import abspath, basename, exists, isdir, join
-from zipfile import ZipFile
-
-def test_get_temp_dir():
-    """
-    Tests the get_temp_dir function.
-    """
-    # Test creating temporary directories
-    temp_dir = get_temp_dir("dvk_test_thing")
-    assert exists(temp_dir)
-    assert isdir(temp_dir)
-    assert basename(temp_dir) == "dvk_test_thing"
-    # Test that all files are deleted when overwriting temp dir
-    text_file = abspath(join(temp_dir, "text.txt"))
-    sub_dir = abspath(join(temp_dir, "sub"))
-    other_file = abspath(join(sub_dir, "other.txt"))
-    mkdir(sub_dir)
-    create_text_file(text_file, "Test text.")
-    create_text_file(other_file, "Other!")
-    assert exists(text_file)
-    assert exists(other_file)
-    assert exists(sub_dir)
-    assert isdir(sub_dir)
-    temp_dir = get_temp_dir("dvk_test_thing")
-    assert len(listdir(temp_dir)) == 0
-    assert not exists(text_file)
-    assert not exists(other_file)
-    assert not exists(sub_dir)
-    assert not isdir(sub_dir)
 
 def test_create_cbz():
     """
-    Tests the create_cbz function
+    Tests the create_cbz function.
     """
-    # Test creating a cbz file with loose files
-    temp_dir = get_temp_dir()
-    text_file = abspath(join(temp_dir, "text.txt"))
-    create_text_file(text_file, "Some text!")
-    other_file = abspath(join(temp_dir, "other.txt"))
-    create_text_file(other_file, "Other text file.")
-    assert exists(text_file)
-    assert exists(other_file)
-    cbz = create_cbz(temp_dir)
-    assert exists(cbz)
-    assert basename(cbz) == basename(temp_dir) + ".cbz"
-    assert abspath(join(cbz, pardir)) == temp_dir
-    extract_dir = abspath(join(temp_dir, "ext"))
-    mkdir(extract_dir)
-    with ZipFile(cbz, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 2
-    assert exists(abspath(join(extract_dir, "text.txt")))
-    assert exists(abspath(join(extract_dir, "other.txt")))
-    # Test creating a cbz file with internal directories
-    temp_dir = get_temp_dir()
-    text_file = abspath(join(temp_dir, "main.txt"))
-    sub_dir = abspath(join(temp_dir, "sub"))
-    other_file = abspath(join(sub_dir, "sub_text.txt"))
-    mkdir(sub_dir)
+    # Test creating a CBZ with loose files and no name
+    cbz_directory = get_temp_dir("dvk_cbz_test")
+    text_file = abspath(join(cbz_directory, "text.txt"))
+    media_file = abspath(join(cbz_directory, "other.txt"))
     create_text_file(text_file, "TEXT!")
-    create_text_file(other_file, "sub")
-    assert exists(text_file)
-    assert exists(sub_dir)
-    assert exists(other_file)
-    cbz = create_cbz(temp_dir)
-    assert exists(cbz)
-    assert basename(cbz) == basename(temp_dir) + ".cbz"
-    assert abspath(join(cbz, pardir)) == temp_dir
-    extract_dir = abspath(join(temp_dir, "ext"))
-    mkdir(extract_dir)
-    with ZipFile(cbz, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 2
-    assert exists(abspath(join(extract_dir, "main.txt")))
-    sub = abspath(join(extract_dir, "sub"))
-    assert exists(sub)
-    assert isdir(sub)
-    assert exists(abspath(join(sub, "sub_text.txt")))
-    # Test creating cbz file with multiple internal directories
-    temp_dir = get_temp_dir()
-    sub_dir = abspath(join(temp_dir, "sub"))
-    deeper = abspath(join(sub_dir, "deeper"))
-    text_file = abspath(join(temp_dir, "text.txt"))
-    sub_file = abspath(join(sub_dir, "sub.txt"))
-    other_sub = abspath(join(sub_dir, "sub2.txt"))
-    deep_file = abspath(join(deeper, "deep.txt"))
-    mkdir(sub_dir)
-    mkdir(deeper)
-    create_text_file(text_file, "This is text!")
-    create_text_file(sub_file, "Subtext?")
-    create_text_file(other_sub, "More subtext.")
-    create_text_file(deep_file, "Even deeper!!!")
-    assert isdir(sub_dir)
-    assert isdir(deeper)
-    assert exists(text_file)
-    assert exists(sub_file)
-    assert exists(other_sub)
-    assert exists(deep_file)
-    cbz = create_cbz(temp_dir)
-    assert exists(cbz)
-    assert basename(cbz) == basename(temp_dir) + ".cbz"
-    assert abspath(join(cbz, pardir)) == temp_dir
-    extract_dir = abspath(join(temp_dir, "ext"))
-    mkdir(extract_dir)
-    with ZipFile(cbz, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 2
-    assert exists(abspath(join(extract_dir, "text.txt")))
-    sub_dir = abspath(join(extract_dir, "sub"))
-    assert isdir(sub_dir)
-    assert len(listdir(sub_dir)) == 3
-    assert exists(abspath(join(sub_dir, "sub.txt")))
-    assert exists(abspath(join(sub_dir, "sub2.txt")))
-    deeper = abspath(join(sub_dir, "deeper"))
-    assert isdir(deeper)
-    assert len(listdir(deeper)) == 1
-    assert exists(abspath(join(deeper, "deep.txt")))
-    # Test that cbz is only updated if cbz already exists
-    temp_dir = get_temp_dir()
-    text_file = abspath(join(temp_dir, "file.txt"))
-    create_text_file(text_file, "This is some text!")
+    create_text_file(media_file, "Yet more text.")
     assert exists(text_file)
-    cbz = create_cbz(temp_dir)
-    assert basename(cbz) == "dvk_meta_magic.cbz"
-    assert exists(cbz)
-    assert get_info_from_cbz(cbz) == get_empty_metadata()
+    assert exists(media_file)
+    cbz_file = create_cbz(cbz_directory)
+    assert basename(cbz_file) == "dvk_cbz_test.cbz"
+    assert exists(cbz_file)
+    assert sorted(listdir(cbz_directory)) == ["dvk_cbz_test.cbz", "other"]
+    sub_directory = abspath(join(cbz_directory, "other"))
+    assert sorted(listdir(sub_directory)) == ["other.txt", "text.txt"]
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["other"]
+    sub_directory = abspath(join(extract_directory, "other"))
+    assert sorted(listdir(sub_directory)) == ["other.txt", "text.txt"]
+    # Test creating CBZ with existing directories and a Name
+    cbz_directory = get_temp_dir("dvk_cbz_test")
+    directory_a = abspath(join(cbz_directory, "AA"))
+    directory_b = abspath(join(cbz_directory, "BB"))
+    text_file = abspath(join(directory_a, "text.txt"))
+    media_file = abspath(join(directory_b, "media.png"))
+    mkdir(directory_a)
+    mkdir(directory_b)
+    create_text_file(text_file, "Text in A")
+    create_text_file(media_file, "Not actually png")
+    assert exists(text_file)
+    assert exists(media_file)
+    cbz_file = create_cbz(cbz_directory, "Totally Cool!")
+    assert basename(cbz_file) == "Totally Cool!.cbz"
+    assert exists(cbz_file)
+    assert exists(directory_a)
+    assert exists(directory_b)
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["AA", "BB"]
+    directory_a = abspath(join(extract_directory, "AA"))
+    directory_b = abspath(join(extract_directory, "BB"))
+    assert listdir(directory_a) == ["text.txt"]
+    assert listdir(directory_b) == ["media.png"]
+    # Test creating CBZ with metadata
+    remove(cbz_file)
     metadata = get_empty_metadata()
-    metadata["title"] = "Updated!"
-    metadata["tags"] = "Some,Tags!"
-    xml = get_comic_xml(metadata)
-    xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
-    create_text_file(xml_file, xml)
-    assert exists(xml_file)
-    cbz = create_cbz(temp_dir)
-    read_metadata = get_info_from_cbz(cbz)
-    assert read_metadata["title"] == "Updated!"
-    assert read_metadata["tags"] == "Some,Tags!"
-    extract_dir = abspath(join(temp_dir, "ext"))
-    mkdir(extract_dir)
-    with ZipFile(cbz, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 2
-    text_file = abspath(join(extract_dir, "file.txt"))
-    assert exists(text_file)
-    assert exists(abspath(join(extract_dir, "ComicInfo.xml")))
-    assert read_text_file(text_file) == "This is some text!"
-    # Test same update with no ComicInfo
-    remove(xml_file)
-    assert not exists(xml_file)
-    assert create_cbz(temp_dir) is None
-    read_metadata = get_info_from_cbz(cbz)
-    assert read_metadata["title"] == "Updated!"
-    assert read_metadata["tags"] == "Some,Tags!"
-    # Test with non-existant file
-    assert create_cbz("/non/existant/dir") is None
+    metadata["title"] = "What Fun!"
+    metadata["artist"] = "Person"
+    cbz_file = create_cbz(cbz_directory, "New", metadata=metadata)
+    assert sorted(listdir(cbz_directory)) == ["AA", "BB", "New.cbz"]
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["AA", "BB", "ComicInfo.xml"]
+    read_meta = read_comic_info(abspath(join(extract_directory, "ComicInfo.xml")))
+    assert read_meta["title"] == "What Fun!"
+    assert read_meta["artist"] == "Person"
+    # Test creating CBZ while removing remaining files
+    remove(cbz_file)
+    media_file = abspath(join(cbz_directory, "Another_one.txt"))
+    create_text_file(media_file, "Some more text.")
+    assert exists(media_file)
+    cbz_file = create_cbz(cbz_directory, "Another", metadata=metadata, remove_files=True)
+    assert listdir(cbz_directory) == ["Another.cbz"]
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["AA", "Another_one.txt", "BB", "ComicInfo.xml"]
+    # Test creating CBZ with metadata and no subdirectories
+    cbz_directory = get_temp_dir("dvk_cbz_test")
+    text_file = abspath(join(cbz_directory, "new.txt"))
+    media_file = abspath(join(cbz_directory, "things.txt"))
+    create_text_file(text_file, "NEWER")
+    create_text_file(media_file, "More things")
+    assert exists(text_file)
+    assert exists(media_file)
+    cbz_file = create_cbz(cbz_directory, "None", metadata=metadata, remove_files=True)
+    assert listdir(cbz_directory) == ["None.cbz"]
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["ComicInfo.xml", "new"]
+    sub_directory = abspath(join(extract_directory, "new"))
+    assert sorted(listdir(sub_directory)) == ["new.txt", "things.txt"]
+    # Test that CBZ is only updated with new metadata if CBZ already exists
+    metadata["title"] = "New!"
+    metadata["tags"] = "Some, More, Stuff"
+    cbz_file = create_cbz(cbz_directory, "None", metadata=metadata)
+    assert listdir(cbz_directory) == ["None.cbz"]
+    extract_directory = get_temp_dir("dvk_extract_test")
+    assert extract_zip(cbz_file, extract_directory)
+    assert sorted(listdir(extract_directory)) == ["ComicInfo.xml", "new"]
+    sub_directory = abspath(join(extract_directory, "new"))
+    assert sorted(listdir(sub_directory)) == ["new.txt", "things.txt"]
+    read_meta = read_comic_info(abspath(join(extract_directory, "ComicInfo.xml")))
+    assert read_meta["title"] == "New!"
+    assert read_meta["tags"] == "Some,More,Stuff"
+    assert read_meta["artist"] == "Person"
+    # Test creating a CBZ with no files
+    cbz_directory = get_temp_dir("dvk_cbz_test")
+    assert create_cbz(cbz_directory) is None
 
 def test_get_info_from_cbz():
     """
-    Tests the get_info_from_cbz function.
+    Tests the get_info_from_cbz file
     """
     # Create test cbz file.
     temp_dir = get_temp_dir()
-    xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
     metadata = get_empty_metadata()
     metadata["title"] = "CBZ Title!"
     metadata["tags"] = "Some,Tags"
-    xml = get_comic_xml(metadata)
-    create_text_file(xml_file, xml)
-    assert exists(xml_file)
-    cbz_file = create_cbz(temp_dir)
-    assert len(listdir(temp_dir)) == 2
+    text_file = abspath(join(temp_dir, "text.txt"))
+    create_text_file(text_file, "Text")
+    assert exists(text_file)
+    cbz_file = create_cbz(temp_dir, metadata=metadata)
     assert exists(cbz_file)
     # Test extracting the ComicInfo from .cbz file
     read_meta = get_info_from_cbz(cbz_file)
     assert read_meta["title"] == "CBZ Title!"
     assert read_meta["tags"] == "Some,Tags"
     # Test trying to get ComicInfo when not present in .cbz file
     temp_dir = get_temp_dir()
@@ -196,53 +141,49 @@
     cbz_file = create_cbz(temp_dir)
     assert len(listdir(temp_dir)) == 2
     assert exists(cbz_file)
     read_meta = get_info_from_cbz(cbz_file)
     assert read_meta["title"] is None
     assert read_meta["artist"] is None
     # Test if file is not cbz
+    text_file = abspath(join(temp_dir, "text.txt"))
+    create_text_file(text_file, "Text")
     read_meta = get_info_from_cbz(text_file)
     assert read_meta["title"] is None
     assert read_meta["artist"] is None
 
 def test_update_cbz_info():
     """
     Tests the update_cbz_info function.
     """
     # Create a test cbz file
     temp_dir = get_temp_dir()
-    xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
     text_file = abspath(join(temp_dir, "other.txt"))
     metadata = get_empty_metadata()
     metadata["title"] = "Old title."
     metadata["tags"] = "Some,Tags"
-    xml = get_comic_xml(metadata)
-    create_text_file(xml_file, xml)
     create_text_file(text_file, "This is text!")
-    assert exists(xml_file)
     assert exists(text_file)
-    cbz_file = create_cbz(temp_dir)
+    cbz_file = create_cbz(temp_dir, metadata=metadata)
     assert exists(cbz_file)
     # Update cbz with new info
     metadata["title"] = "New Title!!!"
     metadata["artist"] = "Dude"
     metadata["tags"] = "Something,Else"
     update_cbz_info(cbz_file, metadata)
     read_meta = get_info_from_cbz(cbz_file)
     assert read_meta["title"] == "New Title!!!"
     assert read_meta["artist"] == "Dude"
     assert read_meta["tags"] == "Something,Else"
     # Test that all other archived files are still present
     extract_dir = abspath(join(temp_dir, "ext"))
     mkdir(extract_dir)
-    with ZipFile(cbz_file, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 2
-    assert exists(abspath(join(extract_dir, "other.txt")))
-    assert exists(abspath(join(extract_dir, "ComicInfo.xml")))
+    assert extract_zip(cbz_file, extract_dir)
+    assert sorted(listdir(extract_dir)) == ["ComicInfo.xml", "other"]
+    assert listdir(abspath(join(extract_dir, "other"))) == ["other.txt"]
     # Test updating cbz that had no comic info in the first place
     temp_dir = get_temp_dir()
     text_file = abspath(join(temp_dir, "text.txt"))
     other_file = abspath(join(temp_dir, "other.txt"))
     create_text_file(text_file, "This is text!")
     create_text_file(other_file, "More text!")
     assert exists(text_file)
@@ -255,161 +196,17 @@
     read_meta = get_info_from_cbz(cbz_file)
     assert read_meta["title"] == "New Title!!!"
     assert read_meta["artist"] == "Dude"
     assert read_meta["tags"] == "Something,Else"
     # Test that files are present
     extract_dir = abspath(join(temp_dir, "ext"))
     mkdir(extract_dir)
-    with ZipFile(cbz_file, mode="r") as file:
-        file.extractall(path=extract_dir)
-    assert len(listdir(extract_dir)) == 3
-    assert exists(abspath(join(extract_dir, "text.txt")))
-    assert exists(abspath(join(extract_dir, "other.txt")))
-    assert exists(abspath(join(extract_dir, "ComicInfo.xml")))
+    assert extract_zip(cbz_file, extract_dir)
+    assert sorted(listdir(extract_dir)) == ["ComicInfo.xml", "other"]
+    assert sorted(listdir(abspath(join(extract_dir, "other")))) == ["other.txt", "text.txt"]
     # Test trying to update non-cbz file
-    update_cbz_info(text_file, metadata)
-    assert exists(text_file)
-    assert read_text_file(text_file) == "This is text!"
-
-def test_get_comic_info_from_path():
-    """
-    Tests the get_comic_info_from_path function.
-    """
-    # Test getting metadata from jsons
-    temp_dir = get_temp_dir()
-    json_file = abspath(join(temp_dir, "file.json"))
-    text_file = abspath(join(temp_dir, "file.txt"))
-    create_json_file(json_file, {"title":"This is a title!", "other":"blah", "tags":["some", "things!"]})
-    create_text_file(text_file, "This is text!!")
-    assert exists(json_file)
-    assert exists(text_file)
-    read_meta = get_comic_info_from_path(temp_dir)
-    assert read_meta["title"] == "This is a title!"
-    assert read_meta["tags"] == "some,things!"
-    # Test getting metadata from existing ComicInfo.xml
-    metadata = get_empty_metadata()
-    metadata["title"] = "XML title?"
-    metadata["cover_artist"] = "Person"
-    xml = get_comic_xml(metadata)
-    xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
-    create_text_file(xml_file, xml)
-    assert exists(xml_file)
-    read_meta = get_comic_info_from_path(temp_dir)
-    assert read_meta["title"] == "XML title?"
-    assert read_meta["cover_artist"] == "Person"
-    assert len(listdir(temp_dir)) == 3
-    # Test falling back to JSONs if existing ComicInfo.xml is empty
-    create_text_file(xml_file, get_comic_xml(get_empty_metadata()))
-    read_meta = get_comic_info_from_path(temp_dir)
-    assert read_meta["title"] == "This is a title!"
-    assert read_meta["tags"] == "some,things!"
-    assert read_meta["cover_artist"] is None
-    assert len(listdir(temp_dir)) == 3
-    # Test getting metadata from cbz in directory with multiple cbz files
-    create_text_file(xml_file, xml)
-    cbz = create_cbz(temp_dir)
-    new_cbz = abspath(join(temp_dir, "aaa.cbz"))
-    copy(cbz, new_cbz)
-    assert exists(cbz)
-    assert exists(new_cbz)
-    metadata["title"] = "New Title"
-    metadata["tags"] = "total,thing"
-    update_cbz_info(new_cbz, metadata)
-    read_meta = get_comic_info_from_path(temp_dir)
-    assert read_meta["title"] == "New Title"
-    assert read_meta["tags"] == "total,thing"
-    read_meta = get_info_from_cbz(cbz)
-    assert read_meta["title"] == "XML title?"
-    assert read_meta["cover_artist"] == "Person"
-    assert read_meta["tags"] is None
-    # Test getting metatada from specific given cbz file
-    read_meta = get_comic_info_from_path(new_cbz)
-    assert read_meta["title"] == "New Title"
-    assert read_meta["tags"] == "total,thing"
-    # Test falling back to ComicInfo.xml if cbz is empty
-    update_cbz_info(new_cbz, get_empty_metadata())
-    read_meta = get_comic_info_from_path(new_cbz)
-    assert read_meta["title"] == "XML title?"
-    assert read_meta["cover_artist"] == "Person"
-    # Test falling back if file given is not cbz
-    read_meta = None
-    assert exists(text_file)
-    read_meta = get_comic_info_from_path(text_file)
-    assert read_meta["title"] == "XML title?"
-    assert read_meta["cover_artist"] == "Person"
-    # Test falling back to JSONs if ComicInfo and cbz are empty
-    update_cbz_info(cbz, get_empty_metadata())
-    update_cbz_info(new_cbz, get_empty_metadata())
-    create_text_file(xml_file, get_comic_xml(get_empty_metadata()))
-    read_meta = get_comic_info_from_path(temp_dir)
-    assert read_meta["title"] == "This is a title!"
-    assert read_meta["tags"] == "some,things!"
-    # Test if given file is non-existant
-    read_meta = get_comic_info_from_path("non/existant/path/")
-    assert read_meta == get_empty_metadata()
-    read_meta = get_comic_info_from_path("non/existant/file.txt")
-    assert read_meta == get_empty_metadata()
-
-def test_create_or_update_cbz():
-    """
-    Tests the create_or_update_cbz function.
-    """
-    # Test creating cbz from files in directory
     temp_dir = get_temp_dir()
     text_file = abspath(join(temp_dir, "text.txt"))
-    xml_file = abspath(join(temp_dir, "ComicInfo.xml"))
-    create_text_file(text_file, "this is text!")
+    create_text_file(text_file, "Some text")
+    update_cbz_info(text_file, metadata)
     assert exists(text_file)
-    assert not exists(xml_file)
-    metadata = get_empty_metadata()
-    metadata["title"] = "This is a title!"
-    metadata["tags"] = "These,are,tags!"
-    cbz = create_or_update_cbz(temp_dir, metadata)
-    assert exists(cbz)
-    assert exists(xml_file)
-    read_meta = get_info_from_cbz(cbz)
-    assert read_meta["title"] == "This is a title!"
-    assert read_meta["tags"] == "These,are,tags!"
-    # Test updating cbz in a given directory
-    metadata["title"] = "New title!"
-    metadata["cover_artist"] = "Person"
-    new_cbz = create_or_update_cbz(temp_dir, metadata)
-    assert exists(new_cbz)
-    assert cbz == new_cbz
-    other_meta = read_comic_info(xml_file)
-    assert other_meta["title"] == "New title!"
-    assert other_meta["tags"] == "These,are,tags!"
-    assert other_meta["cover_artist"] == "Person"
-    read_meta = get_info_from_cbz(new_cbz)
-    assert read_meta["title"] == "New title!"
-    assert read_meta["tags"] == "These,are,tags!"
-    assert read_meta["cover_artist"] == "Person"
-    assert len(listdir(temp_dir)) == 3
-    # Test updating cbz from given directory when there are multiple cbz files
-    new_cbz = abspath(join(temp_dir, "aaa.cbz"))
-    assert not exists(new_cbz)
-    copy(cbz, new_cbz)
-    assert exists(new_cbz)
-    metadata["title"] = "Totally New!!!"
-    metadata["score"] = "4"
-    new_cbz = create_or_update_cbz(temp_dir, metadata)
-    new_meta = get_info_from_cbz(new_cbz)
-    assert new_meta["title"] == "Totally New!!!"
-    assert new_meta["score"] == "4"
-    old_meta = get_info_from_cbz(cbz)
-    assert old_meta["title"] == "New title!"
-    assert old_meta["score"] is None
-    # Test updating a given cbz file
-    metadata["title"] = "Other?"
-    metadata["tags"] = "Separate,thing"
-    cbz = create_or_update_cbz(cbz, metadata)
-    new_meta = get_info_from_cbz(cbz)
-    assert new_meta["title"] == "Other?"
-    assert new_meta["score"] == "4"
-    assert new_meta["tags"] == "Separate,thing"
-    old_meta = get_info_from_cbz(new_cbz)
-    assert old_meta["title"] == "Totally New!!!"
-    assert old_meta["score"] == "4"
-    # Test if given cbz file is not actually cbz
-    test = create_or_update_cbz(text_file, metadata)
-    assert len(listdir(temp_dir)) == 4
-    
+    assert read_text_file(text_file) == "Some text"
```

## metadata_magic/test/comic_archive/test_comic_xml.py

```diff
@@ -1,10 +1,10 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.comic_archive.comic_xml import get_comic_xml
 from metadata_magic.main.comic_archive.comic_xml import generate_info_from_jsons
 from metadata_magic.main.comic_archive.comic_xml import read_comic_info
 from metadata_magic.test.temp_file_tools import create_text_file, create_json_file
 from os import mkdir
 from os.path import abspath, exists, join
@@ -301,23 +301,26 @@
     """
     Tests the generate_info_from_jsons function.
     """
     # Test getting title
     temp_dir = get_temp_dir()
     sub_dir = abspath(join(temp_dir, "sub"))
     mkdir(sub_dir)
-    not_json = abspath(join(temp_dir, "aaa.txt"))
+    main_media = abspath(join(temp_dir, "json.txt"))
     main_json = abspath(join(temp_dir, "json.json"))
+    sub_media = abspath(join(sub_dir, "blah.png"))
     sub_json = abspath(join(sub_dir, "blah.json"))
     json_meta = {"title":"This is a title!"}
-    create_text_file(not_json, "This is text")
+    create_text_file(main_media, "This is text")
     create_json_file(main_json, json_meta)
+    create_text_file(sub_media, "Not actually an image")
     create_json_file(sub_json, {"no":"info"})
-    assert exists(not_json)
+    assert exists(main_media)
     assert exists(main_json)
+    assert exists(sub_media)
     assert exists(sub_json)
     meta = generate_info_from_jsons(temp_dir)
     assert meta["title"] == "This is a title!"
     assert meta["artist"] is None
     assert meta["description"] is None
     # Test getting description
     json_meta["description"] = "Some caption."
@@ -383,46 +386,60 @@
     meta = generate_info_from_jsons(temp_dir)
     assert meta["title"] == "This is a title!"
     assert meta["url"] == "someurlthing.net"
     assert meta["tags"] is None
     assert meta["age_rating"] == "Unknown"
     # Test getting age rating
     temp_dir = get_temp_dir()
+    media_everyone = abspath(join(temp_dir, "everyone.png"))
     json_everyone = abspath(join(temp_dir, "everyone.json"))
+    create_text_file(media_everyone, "E For All")
     create_json_file(json_everyone, {"title":"Thing!", "url":"newgrounds.com/", "rating":"E"})
     meta = generate_info_from_jsons(temp_dir)
     assert meta["title"] == "Thing!"
     assert meta["age_rating"] == "Everyone"
+    media_teen = abspath(join(temp_dir, "teen.gif"))
     json_teen = abspath(join(temp_dir, "teen.json"))
+    create_json_file(media_teen, "Edgy")
     create_json_file(json_teen, {"rating":"t", "url":"www.newgrounds.com"})
     meta = generate_info_from_jsons(temp_dir)
     assert meta["age_rating"] == "Teen"
+    media_mature = abspath(join(temp_dir, "mature.txt"))
     json_mature = abspath(join(temp_dir, "mature.json"))
+    create_text_file(media_mature, "Blood Bleeder")
     create_json_file(json_mature, {"url":"newgrounds", "rating":"m"})
     meta = generate_info_from_jsons(temp_dir)
     assert meta["age_rating"] == "Mature 17+"
+    media_adult = abspath(join(temp_dir, "adult.png"))
     json_adult = abspath(join(temp_dir, "adult.json"))
+    create_text_file(media_adult, "AAAAAAAAAA!")
     create_json_file(json_adult, {"url":"www.newgrounds.com/thing", "rating":"A"})
     meta = generate_info_from_jsons(temp_dir)
     assert meta["age_rating"] == "X18+"
     assert exists(json_everyone)
     assert exists(json_teen)
     assert exists(json_mature)
     assert exists(json_adult)
     # Test with JSON files only in subdirectories
     temp_dir = get_temp_dir()
     sub1 = abspath(join(temp_dir, "aaaa"))
     sub2 = abspath(join(temp_dir, "bbbb"))
+    main_media = abspath(join(sub1, "thing.png"))
     main_json = abspath(join(sub1, "thing.json"))
+    sub_media = abspath(join(sub2, "first.txt"))
     sub_json = abspath(join(sub2, "first.json"))
     mkdir(sub1)
     mkdir(sub2)
+    create_text_file(main_media, "Main File")
     create_json_file(main_json, {"title":"Real Title."})
+    create_text_file(sub_media, "Sub file")
     create_json_file(sub_json, {"title":"Not this one."})
+    assert exists(main_media)
     assert exists(main_json)
+    assert exists(sub_media)
     assert exists(sub_json)
     meta = generate_info_from_jsons(temp_dir)
     assert meta["title"] == "Real Title."
     # Test with no JSON files
     temp_dir = get_temp_dir()
     test_file = abspath(join(temp_dir, "File!.txt"))
     create_text_file(test_file, "Blah.")
```

## metadata_magic/test/comic_archive/test_series_info.py

```diff
@@ -1,14 +1,14 @@
 #!/usr/bin/env python3
 
 from os import listdir, mkdir, pardir
 from os.path import abspath, basename, exists, isdir, join
 from metadata_magic.main.comic_archive.comic_archive import create_cbz
 from metadata_magic.main.comic_archive.comic_archive import get_info_from_cbz
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.comic_archive.comic_xml import get_comic_xml
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.comic_archive.series_info import get_comic_archives
 from metadata_magic.main.comic_archive.series_info import label_files_with_numbers
 from metadata_magic.main.comic_archive.series_info import list_file_labels
 from metadata_magic.main.comic_archive.series_info import write_series_info
 from metadata_magic.test.temp_file_tools import create_text_file
@@ -137,36 +137,32 @@
     """
     Tests the write_series_info function.
     """
     # Create test cbz file
     temp_dir = get_temp_dir()
     cbz_sub = abspath(join(temp_dir, "cbz_sub"))
     mkdir(cbz_sub)
-    assert isdir(cbz_sub)
+    text_file = abspath(join(cbz_sub, "text.txt"))
+    create_text_file(text_file, "This is text")
+    assert exists(text_file)
     metadata = get_empty_metadata()
     metadata["title"] = "This is CBZ"
     metadata["description"] = "Some words."
-    xml = get_comic_xml(metadata)
-    xml_file = abspath(join(cbz_sub, "ComicInfo.xml"))
-    create_text_file(xml_file, xml)
-    assert exists(xml_file)
-    cbz_file = create_cbz(cbz_sub)
+    cbz_file = create_cbz(cbz_sub, metadata=metadata)
     assert exists(cbz_file)
-    # Create second cb7 file
+    # Create second cbz file
     next_sub = abspath(join(temp_dir, "other_sub"))
     mkdir(next_sub)
-    assert isdir(next_sub)
+    media_file = abspath(join(next_sub, "thing.png"))
+    create_text_file(media_file, "Still text.")
+    assert exists(media_file)
     metadata = get_empty_metadata()
     metadata["title"] = "This is now also CBZ"
     metadata["description"] = "Other words."
-    xml = get_comic_xml(metadata)
-    xml_file = abspath(join(next_sub, "ComicInfo.xml"))
-    create_text_file(xml_file, xml)
-    assert exists(xml_file)
-    next_file = create_cbz(next_sub)
+    next_file = create_cbz(next_sub, metadata=metadata)
     assert exists(next_file)
     # Test that existing metadata is intact
     read_meta = get_info_from_cbz(cbz_file)
     assert read_meta["title"] == "This is CBZ"
     assert read_meta["description"] == "Some words."
     assert read_meta["series"] is None
     assert read_meta["series_number"] is None
```

## metadata_magic/test/epub/test_epub.py

```diff
@@ -1,27 +1,27 @@
 #!/usr/bin/env python3
 
 from os import mkdir, listdir
 from os.path import abspath, basename, exists, isdir, join
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.meta_reader import get_empty_metadata
 from metadata_magic.main.epub.epub import create_epub
 from metadata_magic.main.epub.epub import create_epub_files
 from metadata_magic.main.epub.epub import create_image_page
 from metadata_magic.main.epub.epub import create_nav_file
 from metadata_magic.main.epub.epub import create_ncx_file
 from metadata_magic.main.epub.epub import create_manifest
 from metadata_magic.main.epub.epub import create_metadata_xml
 from metadata_magic.main.epub.epub import create_style_file
 from metadata_magic.main.epub.epub import get_title_from_file
 from metadata_magic.main.epub.epub import html_to_xhtml
 from metadata_magic.main.epub.epub import format_xhtml
 from metadata_magic.main.epub.epub import newline_to_tag
 from metadata_magic.main.epub.epub import txt_to_xhtml
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from metadata_magic.test.temp_file_tools import create_text_file, read_text_file
 from PIL import Image
 from zipfile import ZipFile
 
 def test_newline_to_tag():
     """
     Tests the newline_to_tag function.
```

## metadata_magic/test/error_finding/test_missing_media.py

```diff
@@ -1,10 +1,10 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.error_finding.missing_media import find_missing_media
 from metadata_magic.test.temp_file_tools import create_text_file
 from os import mkdir, pardir
 from os.path import abspath, basename, join, exists
 
 def test_find_missing_media():
     """
```

## metadata_magic/test/error_finding/test_missing_metadata.py

```diff
@@ -1,10 +1,10 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.error_finding.missing_metadata import find_missing_metadata
 from metadata_magic.test.temp_file_tools import create_text_file
 from os import mkdir, pardir
 from os.path import abspath, basename, join, exists
 
 def test_find_missing_metadata():
     """
```

## metadata_magic/test/rename/test_meta_rename.py

```diff
@@ -1,22 +1,25 @@
 #!/usr/bin/env python3
 
-from os import listdir, mkdir
+from os import listdir, mkdir, remove
 from os.path import abspath, exists, join
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.meta_reader import get_empty_metadata
-from metadata_magic.main.comic_archive.comic_archive import create_or_update_cbz
+from metadata_magic.main.comic_archive.comic_archive import create_cbz
 from metadata_magic.main.rename.meta_rename import get_filename_from_metadata
 from metadata_magic.main.rename.meta_rename import rename_cbz_files
 from metadata_magic.main.rename.meta_rename import rename_json_pairs
 from metadata_magic.test.temp_file_tools import create_json_file
 from metadata_magic.test.temp_file_tools import create_text_file
 from shutil import copy
 
 def test_rename_cbz_files():
+    """
+    Tests the rename_cbz_files() function
+    """
     # Write test media files
     temp_dir = get_temp_dir("dvk_meta_cbz")
     sub_dir_1 = abspath(join(temp_dir, "sub1"))
     sub_dir_2 = abspath(join(temp_dir, "sub2"))
     mkdir(sub_dir_1)
     mkdir(sub_dir_2)
     text_file_1 = abspath(join(sub_dir_1, "file1.txt"))
@@ -29,74 +32,40 @@
     metadata2 = get_empty_metadata()
     metadata1["title"] = "Some Name"
     metadata1["artist"] = "Person"
     metadata1["date"] = "2020-05-30"
     metadata2["title"] = "Thing"
     metadata2["writer"] = "Dude"
     metadata2["date"] = "2018-11-15"
-    cbz1 = create_or_update_cbz(sub_dir_1, metadata1)
-    cbz2 = create_or_update_cbz(sub_dir_2, metadata2)
+    cbz1 = create_cbz(sub_dir_1, metadata=metadata1, remove_files=True)
+    cbz2 = create_cbz(sub_dir_2, metadata=metadata2, remove_files=True)
     assert exists(cbz1)
     assert exists(cbz2)
     # Test renaming cbz files
     rename_cbz_files(temp_dir)
-    files = sorted(listdir(sub_dir_1))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "Some Name.cbz"
-    assert files[2] == "file1.txt"
-    files = sorted(listdir(sub_dir_2))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "Thing.cbz"
-    assert files[2] == "file2.txt"
+    assert sorted(listdir(sub_dir_1)) == ["Some Name.cbz"]
+    assert sorted(listdir(sub_dir_2)) == ["Thing.cbz"]
     # Test renaming with added artist
     rename_cbz_files(temp_dir, add_artist=True)
-    files = sorted(listdir(sub_dir_1))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "[Person] Some Name.cbz"
-    assert files[2] == "file1.txt"
-    files = sorted(listdir(sub_dir_2))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "[Dude] Thing.cbz"
-    assert files[2] == "file2.txt"
+    assert sorted(listdir(sub_dir_1)) == ["[Person] Some Name.cbz"]
+    assert sorted(listdir(sub_dir_2)) == ["[Dude] Thing.cbz"]
     # Test renaming with added date
     rename_cbz_files(temp_dir, add_date=True)
-    files = sorted(listdir(sub_dir_1))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "[2020-05-30] Some Name.cbz"
-    assert files[2] == "file1.txt"
-    files = sorted(listdir(sub_dir_2))
-    assert len(files) == 3
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "[2018-11-15] Thing.cbz"
-    assert files[2] == "file2.txt"
+    assert sorted(listdir(sub_dir_1)) == ["[2020-05-30] Some Name.cbz"]
+    assert sorted(listdir(sub_dir_2)) == ["[2018-11-15] Thing.cbz"]
     # Test renaming with no title
     new_metadata = get_empty_metadata()
-    new_cbz = create_or_update_cbz(temp_dir, new_metadata)
+    new_cbz = create_cbz(temp_dir, metadata=new_metadata)
     rename_cbz_files(temp_dir)
-    files = sorted(listdir(temp_dir))
-    assert len(files) == 4
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "dvk_meta_cbz.cbz"
-    assert files[2] == "sub1"
-    assert files[3] == "sub2"
+    assert sorted(listdir(temp_dir)) == ["dvk_meta_cbz.cbz", "sub1", "sub2"]
     # Test renaming files with identical names
     cbz1 = abspath(join(sub_dir_1, "Some Name.cbz"))
     copy(cbz1, abspath(join(sub_dir_1, "newer_cbz.cbz")))
     rename_cbz_files(temp_dir)
-    files = sorted(listdir(sub_dir_1))
-    assert len(files) == 4
-    assert files[0] == "ComicInfo.xml"
-    assert files[1] == "Some Name-2.cbz"
-    assert files[2] == "Some Name.cbz"
-    assert files[3] == "file1.txt"
+    assert sorted(listdir(sub_dir_1)) == ["Some Name-2.cbz", "Some Name.cbz"]
 
 def test_rename_json_pairs():
     """
     Tests the rename_json_pairs function.
     """
     # Write test media files
     temp_dir = get_temp_dir()
@@ -183,33 +152,35 @@
     json_file = abspath(join(temp_dir, "json.json"))
     create_json_file(json_file, {"title":"This is a title!"})
     assert exists(json_file)
     assert get_filename_from_metadata(json_file) == "This is a title!"
     # Test getting filename from CBZ
     metadata = get_empty_metadata()
     metadata["title"] = "CBZ Time"
-    cbz_file = create_or_update_cbz(temp_dir, metadata)
+    cbz_file = create_cbz(temp_dir, metadata=metadata)
     assert exists(cbz_file)
     assert get_filename_from_metadata(cbz_file) == "CBZ Time"
     # Test getting filename with no metadata
     text_file = abspath(join(temp_dir, "Nope!.txt"))
     create_text_file(text_file, "Some Text!")
     assert exists(text_file)
     assert get_filename_from_metadata(text_file) == "Nope!"
     # Test adding a date
     create_json_file(json_file, {"title":"Thing", "date":"2020-03-01"})
     assert get_filename_from_metadata(json_file, add_date=True) == "[2020-03-01] Thing"
     metadata["date"] = "2017-08-05"
-    cbz_file = create_or_update_cbz(temp_dir, metadata)
+    remove(cbz_file)
+    cbz_file = create_cbz(temp_dir, metadata=metadata)
     assert get_filename_from_metadata(cbz_file, add_date=True) == "[2017-08-05] CBZ Time"
     # Test adding an artist/writer
     create_json_file(json_file, {"title":"Other", "artist":"Person"})
     assert get_filename_from_metadata(json_file, add_artist=True) == "[Person] Other"
     metadata["writer"] = "Writer"
-    cbz_file = create_or_update_cbz(temp_dir, metadata)
+    remove(cbz_file)
+    cbz_file = create_cbz(temp_dir, metadata=metadata)
     assert get_filename_from_metadata(cbz_file, add_artist=True) == "[Writer] CBZ Time"
     # Test adding an ID
     create_json_file(json_file, {"title":"Identifier", "id":"ID12345"})
     assert get_filename_from_metadata(json_file, add_id=True) == "[ID12345] Identifier"
     # Test adding multiple fields
     create_json_file(json_file, {"title":"Title", "date":"2012-12-21", "id":"ID36", "artist":"Guy"})
     title = get_filename_from_metadata(json_file, add_id=True, add_date=True)
```

## metadata_magic/test/rename/test_rename_tools.py

```diff
@@ -1,18 +1,98 @@
 #!/usr/bin/env python3
 
 from os import pardir
 from os.path import abspath, basename, exists, join
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
+from metadata_magic.main.rename.rename_tools import get_section
+from metadata_magic.main.rename.rename_tools import compare_sections
+from metadata_magic.main.rename.rename_tools import compare_alphanum
+from metadata_magic.main.rename.rename_tools import sort_alphanum
 from metadata_magic.main.rename.rename_tools import create_filename
 from metadata_magic.main.rename.rename_tools import rename_file
 from metadata_magic.test.temp_file_tools import create_json_file
 from metadata_magic.test.temp_file_tools import create_text_file
 from metadata_magic.test.temp_file_tools import read_text_file
 
+def test_get_section():
+    """
+    Tests the get_section_function.
+    """
+    # Test getting number sections
+    assert get_section("12") == "12"
+    assert get_section("123 Thing!") == "123"
+    assert get_section("1.25Words") == "1.25"
+    assert get_section("1,000 Next") == "1,000"
+    assert get_section("1,523.26!Numbers") == "1,523.26"
+    # Test getting non-number sections
+    assert get_section("Just text.") == "Just text."
+    assert get_section("Text, then Numbers.137") == "Text, then Numbers."
+    # Test getting section from string that has none
+    assert get_section("") == ""
+
+def test_compare_sections():
+    """
+    Tests the compare_sections function.
+    """
+    # Test comparing just numbers
+    assert compare_sections("25", "0025") == 0
+    assert compare_sections("1,000", "1000") == 0
+    assert compare_sections("2", "2.000") == 0
+    assert compare_sections("2", "3") == -1
+    assert compare_sections("54", "023") == 1
+    assert compare_sections("1,200", "1250") == -1
+    assert compare_sections("3,500", "3,000") == 1
+    assert compare_sections("0105.3", "105.38") == -1
+    assert compare_sections("1.5", "1.25") == 1
+    # Test comparing just text
+    assert compare_sections("text", "text") == 0
+    assert compare_sections("abc", "def") == -1
+    assert compare_sections("test", "blah") == 1
+    assert compare_sections("un", "unfinished") == -1
+    assert compare_sections("ending", "end") == 1
+    # Test comparing text and numbers
+    assert compare_sections("43", "text") == -1
+    assert compare_sections("other", "5.8") == 1
+    # Test with missing sections
+    assert compare_sections("", "540") == -1
+    assert compare_sections("0", "") == 1
+    assert compare_sections("", "word") == -1
+    assert compare_sections("other", "")
+
+def test_compare_alphanum():
+    """
+    Tests the compare_alphanum function.
+    """
+    # Test identical strings
+    assert compare_alphanum("", "") == 0
+    assert compare_alphanum("23 test", "23 test") == 0
+    # Test comparing by number
+    assert compare_alphanum("Test 4", "  test 10") == -1
+    assert compare_alphanum("  Thing 34.5 more",  "Thing 5") == 1
+    assert compare_alphanum("14 Name 1", "14   name 3") == -1
+    assert compare_alphanum("024 thing next 5", "24 thing next 2") == 1
+    # Test comparing by text
+    assert compare_alphanum("45 abc", "45 Test") == -1
+    assert compare_alphanum("987 banana", "0987   AAA") == 1
+    assert compare_alphanum("5 Thing 65 next", "5 thing 65.0 other") == -1
+    assert compare_alphanum("5.8 next 4 zzz", " 5.80 next 4 aaa") == 1
+    assert compare_alphanum("12 thing", "12 thing next") == -1
+    assert compare_alphanum("50 other next", "050 Other") == 1
+    # Test comparing that with identical sections
+    assert compare_alphanum("AAA", "aaa") == -1
+    assert compare_alphanum("1.0", "1") == 1
+
+def test_sort_alphanum():
+    """
+    Tests the sort_alphanum function.
+    """
+    lst = ["test 10", "test 1", "test 003", "3.5", "06 Next", "middle"]
+    sort = sort_alphanum(lst)
+    assert sort == ["3.5", "06 Next", "middle", "test 1", "test 003", "test 10"]
+
 def test_create_filename():
     """
     Tests the create_filename function.
     """
     # Test replacing invalid characters
     assert create_filename("**What?!?!") == "What-!-!"
     assert create_filename("This:That") == "This - That"
```

## metadata_magic/test/rename/test_sort_rename.py

```diff
@@ -1,95 +1,15 @@
 #!/usr/bin/env python3
 
-from metadata_magic.main.comic_archive.comic_archive import get_temp_dir
-from metadata_magic.main.rename.sort_rename import compare_alphanum
-from metadata_magic.main.rename.sort_rename import compare_sections
-from metadata_magic.main.rename.sort_rename import get_section
-from metadata_magic.main.rename.sort_rename import sort_alphanum
+from metadata_magic.main.file_tools.file_tools import get_temp_dir
 from metadata_magic.main.rename.sort_rename import sort_rename
 from metadata_magic.test.temp_file_tools import create_text_file
 from os import listdir, mkdir
 from os.path import abspath, exists, isdir, join
 
-def test_get_section():
-    """
-    Tests the get_section_function.
-    """
-    # Test getting number sections
-    assert get_section("12") == "12"
-    assert get_section("123 Thing!") == "123"
-    assert get_section("1.25Words") == "1.25"
-    assert get_section("1,000 Next") == "1,000"
-    assert get_section("1,523.26!Numbers") == "1,523.26"
-    # Test getting non-number sections
-    assert get_section("Just text.") == "Just text."
-    assert get_section("Text, then Numbers.137") == "Text, then Numbers."
-    # Test getting section from string that has none
-    assert get_section("") == ""
-
-def test_compare_sections():
-    """
-    Tests the compare_sections function.
-    """
-    # Test comparing just numbers
-    assert compare_sections("25", "0025") == 0
-    assert compare_sections("1,000", "1000") == 0
-    assert compare_sections("2", "2.000") == 0
-    assert compare_sections("2", "3") == -1
-    assert compare_sections("54", "023") == 1
-    assert compare_sections("1,200", "1250") == -1
-    assert compare_sections("3,500", "3,000") == 1
-    assert compare_sections("0105.3", "105.38") == -1
-    assert compare_sections("1.5", "1.25") == 1
-    # Test comparing just text
-    assert compare_sections("text", "text") == 0
-    assert compare_sections("abc", "def") == -1
-    assert compare_sections("test", "blah") == 1
-    assert compare_sections("un", "unfinished") == -1
-    assert compare_sections("ending", "end") == 1
-    # Test comparing text and numbers
-    assert compare_sections("43", "text") == -1
-    assert compare_sections("other", "5.8") == 1
-    # Test with missing sections
-    assert compare_sections("", "540") == -1
-    assert compare_sections("0", "") == 1
-    assert compare_sections("", "word") == -1
-    assert compare_sections("other", "")
-
-def test_compare_alphanum():
-    """
-    Tests the compare_alphanum function.
-    """
-    # Test identical strings
-    assert compare_alphanum("", "") == 0
-    assert compare_alphanum("23 test", "23 test") == 0
-    # Test comparing by number
-    assert compare_alphanum("Test 4", "  test 10") == -1
-    assert compare_alphanum("  Thing 34.5 more",  "Thing 5") == 1
-    assert compare_alphanum("14 Name 1", "14   name 3") == -1
-    assert compare_alphanum("024 thing next 5", "24 thing next 2") == 1
-    # Test comparing by text
-    assert compare_alphanum("45 abc", "45 Test") == -1
-    assert compare_alphanum("987 banana", "0987   AAA") == 1
-    assert compare_alphanum("5 Thing 65 next", "5 thing 65.0 other") == -1
-    assert compare_alphanum("5.8 next 4 zzz", " 5.80 next 4 aaa") == 1
-    assert compare_alphanum("12 thing", "12 thing next") == -1
-    assert compare_alphanum("50 other next", "050 Other") == 1
-    # Test comparing that with identical sections
-    assert compare_alphanum("AAA", "aaa") == -1
-    assert compare_alphanum("1.0", "1") == 1
-
-def test_sort_alphanum():
-    """
-    Tests the sort_alphanum function.
-    """
-    lst = ["test 10", "test 1", "test 003", "3.5", "06 Next", "middle"]
-    sort = sort_alphanum(lst)
-    assert sort == ["3.5", "06 Next", "middle", "test 1", "test 003", "test 10"]
-
 def test_sort_rename():
     """
     Tests the sort_rename function.
     """
     # Create test files
     temp_dir = get_temp_dir()
     unlinked1 = abspath(join(temp_dir, "Unlinked 01.txt"))
```

## Comparing `Metadata_Magic-0.4.4.dist-info/LICENSE` & `Metadata_Magic-0.5.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `Metadata_Magic-0.4.4.dist-info/METADATA` & `Metadata_Magic-0.5.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Metadata-Magic
-Version: 0.4.4
+Version: 0.5.0
 Summary: Utility for managing metadata.
 Home-page: https://github.com/Drakovek/MetadataMagic
 Author: Drakovek
 Author-email: DrakovekMail@gmail.com
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Operating System :: OS Independent
```

## Comparing `Metadata_Magic-0.4.4.dist-info/RECORD` & `Metadata_Magic-0.5.0.dist-info/RECORD`

 * *Files 15% similar despite different names*

```diff
@@ -1,40 +1,40 @@
 metadata_magic/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
 metadata_magic/main/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/main/meta_finder.py,sha256=uAqPChgpcz2dRw4AT9gjBN7sl80Wge5dfIAtnGRKq78,2997
+metadata_magic/main/meta_finder.py,sha256=o5ACDKV-1boEkzeOVGT09DDLxic-ehtRRO2cotVfbT8,3095
 metadata_magic/main/meta_reader.py,sha256=GYTVgwZVPWu1o9QQpMd50FBtowcRRw_1PJ3ekHLMCwI,12224
 metadata_magic/main/comic_archive/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/main/comic_archive/comic_archive.py,sha256=8fS3YFK6oV4pm8mk6qpraH8JNEgQnJgo5oh6VEMIP-k,15241
-metadata_magic/main/comic_archive/comic_xml.py,sha256=Rxzo_MDnnGqRnHPExJI3t03Jw62ryk-c-DY2JSHST80,10392
-metadata_magic/main/comic_archive/series_info.py,sha256=egGWHL2yTVv4HXNPM0G_C5MtvgWoMzj_PkwKrxvSkmU,8011
+metadata_magic/main/comic_archive/comic_archive.py,sha256=Vx2oiACrMh2RI7EnnKdSMuZyuei-8EpQkD_YsN2C3L0,12945
+metadata_magic/main/comic_archive/comic_xml.py,sha256=jZVokSJDnd4UPaPm3svfgkQEkNbOVveq5uwujLKRh88,9964
+metadata_magic/main/comic_archive/series_info.py,sha256=5D6M6hQD-O92X7o6gC99oqHHQDZ64gxEg6aJVbhuOv0,8012
 metadata_magic/main/epub/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/main/epub/epub.py,sha256=6N-BrY7aZwdtRDI-0rGtu5RjhDBvnuc8sdKIAYlZYTw,33842
+metadata_magic/main/epub/epub.py,sha256=sdMTzKumy_RNg0rC9MYz1qUcDQ582iA3b_1QRzvkVoM,33837
 metadata_magic/main/error_finding/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
 metadata_magic/main/error_finding/missing_media.py,sha256=gziABuhFrn97HmNuhllNFrKemi1af5xZxrvObFA-a-o,2115
 metadata_magic/main/error_finding/missing_metadata.py,sha256=kpPSMIcWBpkOhSt617DYpmOp00TXSAU8IRzdHb9obDM,2137
 metadata_magic/main/rename/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
 metadata_magic/main/rename/meta_rename.py,sha256=9jRvIjsczQMkpg43rvOqJyuUPDLi_cWLxfvfxlQFZC8,6930
-metadata_magic/main/rename/rename_tools.py,sha256=UzWJnAtvPkRVWFV8NCBK7iPdRd-BI5Vr9_UCBmS-AFs,3263
-metadata_magic/main/rename/sort_rename.py,sha256=dRsXHzBEtAd0-CthaNY0nFa9as_I29KPM9ChfXE4jls,7793
+metadata_magic/main/rename/rename_tools.py,sha256=_3_up7BYO5Soqsp-c6IOFbknAmg9027WwAakk1EOcY4,6652
+metadata_magic/main/rename/sort_rename.py,sha256=exUxorkxB9vXcQlyQxCozH2d4Uuc1mftVcqbbjxenbI,4493
 metadata_magic/test/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
 metadata_magic/test/temp_file_tools.py,sha256=e3TGngm-nHBEy3qNBItEO7qDvtLCt4-roWsRJQWwVAs,1468
-metadata_magic/test/test_meta_finder.py,sha256=TbimBk30oHsZ4jAY_kL1m1aIFQ-XXZ-aoqgzgZwTACk,4245
-metadata_magic/test/test_meta_reader.py,sha256=mDeYuaTwXzkiBvZ6i_3rdBFh00LbSFV18mYTLZ8S2z8,22964
+metadata_magic/test/test_meta_finder.py,sha256=iKQvvbLkJWj5cM5U1i4jM1N3NlRy_M9FOkY5dyo9IT8,4239
+metadata_magic/test/test_meta_reader.py,sha256=aT0V5dNanGHsnJQwJU9s-j9d1BRxlov8TheLo-pidmQ,22958
 metadata_magic/test/comic_archive/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/test/comic_archive/test_comic_archive.py,sha256=YtusSL0zaFbMN0oxbKs9YC-RuOKLiuJQZJgmL8v8xQM,16967
-metadata_magic/test/comic_archive/test_comic_xml.py,sha256=BDx1yeyyAB23pOY7ErS2Rcd9gHSvze670bx6rd44VLE,19139
-metadata_magic/test/comic_archive/test_series_info.py,sha256=ZH7hWqJb5Qe17myC0US75xVzwFwTsD_NwuQmoW3Vq-k,8845
+metadata_magic/test/comic_archive/test_comic_archive.py,sha256=uWpE9CUf_U8Yn0SpoHs2KZjjaq-bWo3cRh-cDbunfsM,9745
+metadata_magic/test/comic_archive/test_comic_xml.py,sha256=l9mq8fOZ6fKNJgKFTrgXxFkq7kiPLSODkh7Pw1QW5tk,19943
+metadata_magic/test/comic_archive/test_series_info.py,sha256=NKW3hmapFlZxOLhNek6_ZcnqF9xvdxQ3lrWwKJFIiaY,8777
 metadata_magic/test/epub/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/test/epub/test_epub.py,sha256=CH0B_XOcEMyxfxvJ3mRJF9jwZSt4BTwc8bGuwEHJI7k,43418
+metadata_magic/test/epub/test_epub.py,sha256=IlzzufmqvDL94teafZvrX6yxmiyGHndtXShuO2xsOws,43413
 metadata_magic/test/error_finding/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/test/error_finding/test_missing_media.py,sha256=5VqspBlJZV7sgh4z-KUHpsblGSkixVpS3_RNTyNaaqQ,1545
-metadata_magic/test/error_finding/test_missing_metadata.py,sha256=3vO289fMXfEaLEM8ncLLUE-Mq2WqsmmuSfRRRXpn6vc,1587
+metadata_magic/test/error_finding/test_missing_media.py,sha256=Tzx2OGDVvYXqyqW8fBFuDPoMeOd9cD02lIs8WYCCg9Y,1539
+metadata_magic/test/error_finding/test_missing_metadata.py,sha256=THwq9XCLBr4L175dQOf3WpjvOy2QTrMYT9291hcKryc,1581
 metadata_magic/test/rename/__init__.py,sha256=1oLL20yLB1GL9IbFiZD8OReDqiCpFr-yetIR6x1cNkI,23
-metadata_magic/test/rename/test_meta_rename.py,sha256=RpAXivB1TuyFHl4R6Z07If2xTVYVipHeeQu6nAkZ7Ak,10584
-metadata_magic/test/rename/test_rename_tools.py,sha256=A-7BSTxJkxrD60Kr1dZqxqH7LM2buBP7v73CRwYxp5g,4648
-metadata_magic/test/rename/test_sort_rename.py,sha256=8tMO1GZpe_iai0gKIOOkX14RIk2XtHZygj65I-d2oR0,10127
-Metadata_Magic-0.4.4.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-Metadata_Magic-0.4.4.dist-info/METADATA,sha256=lamaqr2Z9-lxiA09BmApuHHTle_3-Eh4yL_8S0wRNYA,5754
-Metadata_Magic-0.4.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-Metadata_Magic-0.4.4.dist-info/entry_points.txt,sha256=1rYlR8kcgLKsG5gjewW6ntTlQ_1ZLSn59x2EZBcbGKE,475
-Metadata_Magic-0.4.4.dist-info/top_level.txt,sha256=xiXw1Za6sizhihwckAr1UAU5GxhrzpKEd6cIPCRmuT0,15
-Metadata_Magic-0.4.4.dist-info/RECORD,,
+metadata_magic/test/rename/test_meta_rename.py,sha256=SB7R2oSRYZylzldLZ8i72NlDx0EItS0EYWdWkkecN0o,9717
+metadata_magic/test/rename/test_rename_tools.py,sha256=xJI9zxJFWqOSlqOtpX_KINpT0a0DCxzRNFQr5osE0N4,8014
+metadata_magic/test/rename/test_sort_rename.py,sha256=WwdzT7yMHoAndjAiCQUWOU6K5_ksPCKb8XEZhNQra0g,6753
+Metadata_Magic-0.5.0.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+Metadata_Magic-0.5.0.dist-info/METADATA,sha256=tDZD7KlNY8689byVQENlLo2tjev0BM7tZi2g5Q983Hg,5754
+Metadata_Magic-0.5.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+Metadata_Magic-0.5.0.dist-info/entry_points.txt,sha256=1rYlR8kcgLKsG5gjewW6ntTlQ_1ZLSn59x2EZBcbGKE,475
+Metadata_Magic-0.5.0.dist-info/top_level.txt,sha256=xiXw1Za6sizhihwckAr1UAU5GxhrzpKEd6cIPCRmuT0,15
+Metadata_Magic-0.5.0.dist-info/RECORD,,
```

