# Comparing `tmp/earthmover-0.1.5-py3-none-any.whl.zip` & `tmp/earthmover-0.1.6-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,51 +1,51 @@
-Zip file size: 65339 bytes, number of entries: 49
--rwxrwxrwx  2.0 unx        5 b- defN 23-Jun-13 22:10 earthmover/VERSION.txt
+Zip file size: 65379 bytes, number of entries: 49
+-rwxrwxrwx  2.0 unx        5 b- defN 23-Jul-11 15:25 earthmover/VERSION.txt
 -rw-r--r--  2.0 unx        2 b- defN 22-Sep-15 19:37 earthmover/__init__.py
 -rw-r--r--  2.0 unx     6377 b- defN 23-Jun-13 22:05 earthmover/__main__.py
--rw-r--r--  2.0 unx    19714 b- defN 23-Jun-13 22:05 earthmover/earthmover.py
+-rw-r--r--  2.0 unx    19840 b- defN 23-Jul-11 15:16 earthmover/earthmover.py
 -rw-r--r--  2.0 unx     3108 b- defN 23-Mar-23 13:31 earthmover/error_handler.py
 -rw-r--r--  2.0 unx     9179 b- defN 23-Mar-23 13:31 earthmover/graph.py
 -rw-r--r--  2.0 unx     4433 b- defN 23-May-05 14:34 earthmover/node.py
 -rw-r--r--  2.0 unx     8190 b- defN 23-Jun-08 14:00 earthmover/runs_file.py
 -rw-r--r--  2.0 unx     3495 b- defN 23-May-05 22:00 earthmover/util.py
 -rw-r--r--  2.0 unx     1491 b- defN 23-Apr-26 14:48 earthmover/yaml_parser.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-15 19:41 earthmover/nodes/__init__.py
 -rw-r--r--  2.0 unx     4369 b- defN 23-May-12 20:05 earthmover/nodes/destination.py
--rw-r--r--  2.0 unx     3957 b- defN 23-Mar-22 20:54 earthmover/nodes/operation.py
--rw-r--r--  2.0 unx    12577 b- defN 23-May-04 19:44 earthmover/nodes/source.py
+-rw-r--r--  2.0 unx     3971 b- defN 23-Jul-11 15:19 earthmover/nodes/operation.py
+-rw-r--r--  2.0 unx    12619 b- defN 23-Jul-11 15:19 earthmover/nodes/source.py
 -rw-r--r--  2.0 unx     1881 b- defN 23-Mar-22 20:54 earthmover/nodes/transformation.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-15 19:41 earthmover/operations/__init__.py
 -rw-r--r--  2.0 unx    14824 b- defN 23-May-12 20:05 earthmover/operations/column.py
 -rw-r--r--  2.0 unx     7332 b- defN 23-Feb-17 18:03 earthmover/operations/dataframe.py
 -rw-r--r--  2.0 unx     9033 b- defN 23-Feb-23 16:23 earthmover/operations/groupby.py
 -rw-r--r--  2.0 unx     2858 b- defN 23-Feb-17 18:03 earthmover/operations/row.py
 -rwxrwxrwx  2.0 unx     8773 b- defN 23-Mar-22 20:54 earthmover/tests/earthmover.yaml
 -rwxrwxrwx  2.0 unx     7571 b- defN 22-Sep-16 13:53 earthmover/tests/expected/animals.jsonl
 -rwxrwxrwx  2.0 unx      434 b- defN 22-Sep-16 13:32 earthmover/tests/expected/big_cats.jsonl
 -rwxrwxrwx  2.0 unx      406 b- defN 22-Sep-16 13:32 earthmover/tests/expected/species_count_by_zoo.jsonl
 -rwxrwxrwx  2.0 unx      821 b- defN 22-Sep-16 13:35 earthmover/tests/expected/total_of_each_species.jsonl
 -rwxrwxrwx  2.0 unx      797 b- defN 22-Sep-16 13:32 earthmover/tests/expected/zoo_count_by_species.jsonl
 -rwxrwxrwx  2.0 unx      280 b- defN 22-Sep-16 13:32 earthmover/tests/expected/zoo_count_by_year_founded.jsonl
--rwxrwxrwx  2.0 unx     7571 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/animals.jsonl
--rwxrwxrwx  2.0 unx      434 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/big_cats.jsonl
--rwxrwxrwx  2.0 unx      406 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/species_count_by_zoo.jsonl
--rwxrwxrwx  2.0 unx      821 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/total_of_each_species.jsonl
--rwxrwxrwx  2.0 unx      797 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/zoo_count_by_species.jsonl
--rwxrwxrwx  2.0 unx      280 b- defN 23-Jun-13 22:07 earthmover/tests/outputs/zoo_count_by_year_founded.jsonl
+-rwxrwxrwx  2.0 unx     7571 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/animals.jsonl
+-rwxrwxrwx  2.0 unx      434 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/big_cats.jsonl
+-rwxrwxrwx  2.0 unx      406 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/species_count_by_zoo.jsonl
+-rwxrwxrwx  2.0 unx      821 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/total_of_each_species.jsonl
+-rwxrwxrwx  2.0 unx      797 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/zoo_count_by_species.jsonl
+-rwxrwxrwx  2.0 unx      280 b- defN 23-Jul-11 14:04 earthmover/tests/outputs/zoo_count_by_year_founded.jsonl
 -rwxrwxrwx  2.0 unx      712 b- defN 22-Sep-16 15:38 earthmover/tests/sources/birds.csv
 -rwxrwxrwx  2.0 unx      422 b- defN 22-May-24 21:36 earthmover/tests/sources/fishes.csv
 -rwxrwxrwx  2.0 unx      156 b- defN 22-May-24 21:14 earthmover/tests/sources/inventories.csv
 -rwxrwxrwx  2.0 unx      930 b- defN 22-May-24 21:06 earthmover/tests/sources/mammals.csv
 -rwxrwxrwx  2.0 unx      478 b- defN 22-May-24 21:06 earthmover/tests/sources/reptiles.csv
 -rwxrwxrwx  2.0 unx      284 b- defN 22-May-25 14:00 earthmover/tests/sources/zoos.csv
 -rwxrwxrwx  2.0 unx      215 b- defN 22-Jul-14 20:55 earthmover/tests/templates/animal.jsont
 -rwxrwxrwx  2.0 unx      184 b- defN 22-May-24 21:33 earthmover/tests/templates/cats.jsont
 -rwxrwxrwx  2.0 unx       93 b- defN 22-Jun-20 13:40 earthmover/tests/templates/count.jsont
--rwxrwxrwx  2.0 unx    11349 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/LICENSE
--rw-r--r--  2.0 unx    45162 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/WHEEL
--rwxrwxrwx  2.0 unx      135 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/dependency_links.txt
--rwxrwxrwx  2.0 unx       56 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/entry_points.txt
--rwxrwxrwx  2.0 unx       11 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4436 b- defN 23-Jun-13 22:12 earthmover-0.1.5.dist-info/RECORD
-49 files, 206931 bytes uncompressed, 58131 bytes compressed:  71.9%
+-rwxrwxrwx  2.0 unx    11349 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/LICENSE
+-rw-r--r--  2.0 unx    45162 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/WHEEL
+-rwxrwxrwx  2.0 unx      135 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/dependency_links.txt
+-rwxrwxrwx  2.0 unx       56 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/entry_points.txt
+-rwxrwxrwx  2.0 unx       11 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4436 b- defN 23-Jul-11 15:31 earthmover-0.1.6.dist-info/RECORD
+49 files, 207113 bytes uncompressed, 58171 bytes compressed:  71.9%
```

## zipnote {}

```diff
@@ -120,29 +120,29 @@
 
 Filename: earthmover/tests/templates/cats.jsont
 Comment: 
 
 Filename: earthmover/tests/templates/count.jsont
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/LICENSE
+Filename: earthmover-0.1.6.dist-info/LICENSE
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/METADATA
+Filename: earthmover-0.1.6.dist-info/METADATA
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/WHEEL
+Filename: earthmover-0.1.6.dist-info/WHEEL
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/dependency_links.txt
+Filename: earthmover-0.1.6.dist-info/dependency_links.txt
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/entry_points.txt
+Filename: earthmover-0.1.6.dist-info/entry_points.txt
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/top_level.txt
+Filename: earthmover-0.1.6.dist-info/top_level.txt
 Comment: 
 
-Filename: earthmover-0.1.5.dist-info/RECORD
+Filename: earthmover-0.1.6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## earthmover/VERSION.txt

```diff
@@ -1 +1 @@
-0.1.5
+0.1.6
```

## earthmover/earthmover.py

```diff
@@ -452,14 +452,18 @@
                 node = self.graph.ref(node_name)
                 node.num_rows = num_rows
 
             active_graph.draw()
         
         ### Create structured output results_file if necessary
         if self.results_file:
+
+            # create directory if not exists
+            os.makedirs(os.path.dirname(self.results_file), exist_ok=True)
+
             self.end_timestamp = datetime.datetime.now()
             self.metadata.update({"completed_at": self.end_timestamp.isoformat(timespec='microseconds')})
             self.metadata.update({"runtime_sec": (self.end_timestamp - self.start_timestamp).total_seconds()})
             with open(self.results_file, 'w') as fp:
                 fp.write(json.dumps(self.metadata, indent=4))
```

## earthmover/nodes/operation.py

```diff
@@ -101,15 +101,15 @@
         :return:
         """
         super().execute()
 
         # If multiple sources are required for an operation, self.data must be defined in the child class execute().
         if self.source_list:
             self.source_data_list = [
-                self.get_source_node(source).data for source in self.source_list
+                self.get_source_node(source).data.copy() for source in self.source_list
             ]
         else:
-            self.data = self.get_source_node(self.source).data
+            self.data = self.get_source_node(self.source).data.copy()
 
         self.verify()
 
         pass
```

## earthmover/nodes/source.py

```diff
@@ -247,15 +247,15 @@
             'feather'   : lambda file, _     : pd.read_feather(file),
             'fixedwidth': lambda file, _     : dd.read_fwf(file),
             'html'      : lambda file, config: pd.read_html(file, match=config.get('match', ".+"), keep_default_na=False)[0],
             'orc'       : lambda file, _     : dd.read_orc(file),
             'json'      : lambda file, config: dd.read_json(file, typ=config.get('object_type', "frame"), orient=config.get('orientation', "columns")),
             'jsonl'     : lambda file, config: dd.read_json(file, lines=True),
             'parquet'   : lambda file, _     : dd.read_parquet(file),
-            'sas'       : lambda file, _     : pd.read_sas(file),
+            'sas'       : lambda file, config: pd.read_sas(file, encoding=config.get('encoding', "utf-8")),
             'spss'      : lambda file, _     : pd.read_spss(file),
             'stata'     : lambda file, _     : pd.read_stata(file),
             'xml'       : lambda file, config: pd.read_xml(file, xpath=config.get('xpath', "./*")),
             'tsv'       : lambda file, config: dd.read_csv(file, sep=sep, dtype=str, encoding=config.get('encoding', "utf8"), keep_default_na=False, skiprows=__get_skiprows(config)),
         }
         return read_lambda_mapping.get(file_type)
```

## Comparing `earthmover-0.1.5.dist-info/LICENSE` & `earthmover-0.1.6.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `earthmover-0.1.5.dist-info/METADATA` & `earthmover-0.1.6.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: earthmover
-Version: 0.1.5
+Version: 0.1.6
 Summary: Transforms tabular data sources into text-based data via YAML configuration
 Home-page: https://github.com/edanalytics/earthmover
 Download-URL: https://github.com/edanalytics/earthmover/archive/refs/tags/v0.0.4.tar.gz
 Author: Tom Reitz, Jay Kaiser
 Author-email: treitz@edanalytics.org, jkaiser@edanalytics.org
 License: Apache 2.0
 Classifier: Development Status :: 4 - Beta
```

## Comparing `earthmover-0.1.5.dist-info/RECORD` & `earthmover-0.1.6.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-earthmover/VERSION.txt,sha256=QXCYE8RmYkHVrHvVrvCJYMkGMqpOawbNrZOJ4WODczY,5
+earthmover/VERSION.txt,sha256=Us6-ekrSteRiwlfY-S3rQlmDLCZyBEVABgGI-6YEsGQ,5
 earthmover/__init__.py,sha256=frcCV1k9oG9oKj3dpUqdJg1PxRT2RSN_XKdLCPjaYaY,2
 earthmover/__main__.py,sha256=h149nOOjizsBUgljvkym9V6UtPB-PFLKz9xJMZ-LssY,6377
-earthmover/earthmover.py,sha256=zJMTSbWH3tWP_mItQM4MleweBgg_cQWQiibKRrki_as,19714
+earthmover/earthmover.py,sha256=HLlFNF4u08iUnKSLqUdjWIgM3ndScuF9jSX57Iy-Auo,19840
 earthmover/error_handler.py,sha256=Dho3WOlJYrXDUBEoB8BUK4x_VSsG1HA_Q6GZhg7W2O4,3108
 earthmover/graph.py,sha256=Jty1IDu3tNrl-6FUlEoXZ5aq2RDxF89rDRAU9WHGLHI,9179
 earthmover/node.py,sha256=yqDuKUtQ9BPX2_LInbZodNlNOrOJRzYa6d5PbRUZxUo,4433
 earthmover/runs_file.py,sha256=HI2wQOLPtllZppEsLyVQURCwUkg_iYkndWommvkogwM,8190
 earthmover/util.py,sha256=sVhjvyJJ1EzYevyvvv1JV4M8yoopql8NUD9UKsgE5Pg,3495
 earthmover/yaml_parser.py,sha256=eLWj79ZTg4VsWlooOUQDr42-aAcE8ddPD_xjWuqQvSw,1491
 earthmover/nodes/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 earthmover/nodes/destination.py,sha256=0kfNwVrfaK1UgRZaiXg4U6o5cODHYzDHG_jmiAwaQCw,4369
-earthmover/nodes/operation.py,sha256=FMHsCSUOAbzD0CSIt35piZydtDNWYVmQbhWviW2_v5E,3957
-earthmover/nodes/source.py,sha256=Vos9BSLd5XXG_AO7_wg9KYOijsAHa8iHvBu1_sJJLAM,12577
+earthmover/nodes/operation.py,sha256=2HwpU5Sh0SY4bSrz4QTluIaLHwWUtmVLbzIpTW3CVa4,3971
+earthmover/nodes/source.py,sha256=aw1I2Wq9vxnBpNX0aB32OB3nYAfrgioCbBfupFFtvZA,12619
 earthmover/nodes/transformation.py,sha256=N0DiAGZytMYN2PlpICJDhNUy7hSE1bIwU_yTd7Z3S2Y,1881
 earthmover/operations/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 earthmover/operations/column.py,sha256=pWSHY76o_j3pm9qMc9nfmCcJbPDdQI-aAyRCrdEkWC8,14824
 earthmover/operations/dataframe.py,sha256=ISDc8UFwCuPpEpalz2XYzl2q1gYYupIPJZPdgKM6Huk,7332
 earthmover/operations/groupby.py,sha256=ghYeS2XTguNBsqKgenDBmiE7bjvrEmF8UiVNZMCUTm0,9033
 earthmover/operations/row.py,sha256=mf5a51qX6dm3-nLjLN7aHcBp8I5W9BIFQqQQQJhGff8,2858
 earthmover/tests/earthmover.yaml,sha256=mHyJZTFh5-20pXxbU0PqmjlMC6QmMtay52R-qjdtGdc,8773
@@ -36,14 +36,14 @@
 earthmover/tests/sources/inventories.csv,sha256=5fERQS45u7YSg0fW35QvnHUbYThwYdWW5KDVQoHHRss,156
 earthmover/tests/sources/mammals.csv,sha256=7zsmutOUCEBvEmCHdaBOIgMiRKBNA46p3V-rBWShjJc,930
 earthmover/tests/sources/reptiles.csv,sha256=HE5LXBv2zwfS_Ccbx5UFzG-FGwCUAaHGDUoQ949tAtY,478
 earthmover/tests/sources/zoos.csv,sha256=qHchJkWezmCKL7Wu82Mlhhpc9YyB0LqzyGtquS5fYjM,284
 earthmover/tests/templates/animal.jsont,sha256=WVANYqoyPAysz2eFjIgftCk9XbN_7bM-Dr1awGSIxwM,215
 earthmover/tests/templates/cats.jsont,sha256=drWhdwDPwv_mDqvYbHJgVRODGkt7iq5yGYQguSmFfTc,184
 earthmover/tests/templates/count.jsont,sha256=CRmgEGZ0PYfyTfT0_bnSZvap9lst8SKUrDBtn51r-fo,93
-earthmover-0.1.5.dist-info/LICENSE,sha256=QoIB1PHNf6dGs6i0VkXumtNelR-vv2rfNMAHMnlaIDw,11349
-earthmover-0.1.5.dist-info/METADATA,sha256=6VCF5eDEyRHivzg543oOGSzhUzKM3rodQgLr0c9_AaA,45162
-earthmover-0.1.5.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-earthmover-0.1.5.dist-info/dependency_links.txt,sha256=zUjtOVgogWsGh-RNRqXTvs-OUh-L6P7e4OmQNBt6iWU,135
-earthmover-0.1.5.dist-info/entry_points.txt,sha256=3Tx8TE2CCFvNikmltqOCkCLlLmlf3x7P51PxpNrPOOQ,56
-earthmover-0.1.5.dist-info/top_level.txt,sha256=M55nBRq8JtBFEJcnqz1GpG8EtnXFHeWJ38QIFp0N26Q,11
-earthmover-0.1.5.dist-info/RECORD,,
+earthmover-0.1.6.dist-info/LICENSE,sha256=QoIB1PHNf6dGs6i0VkXumtNelR-vv2rfNMAHMnlaIDw,11349
+earthmover-0.1.6.dist-info/METADATA,sha256=Qxs9S9ClQXa4i9jHdPPlVHb7J0nwjVGEfXgkelHSGJ8,45162
+earthmover-0.1.6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+earthmover-0.1.6.dist-info/dependency_links.txt,sha256=zUjtOVgogWsGh-RNRqXTvs-OUh-L6P7e4OmQNBt6iWU,135
+earthmover-0.1.6.dist-info/entry_points.txt,sha256=3Tx8TE2CCFvNikmltqOCkCLlLmlf3x7P51PxpNrPOOQ,56
+earthmover-0.1.6.dist-info/top_level.txt,sha256=M55nBRq8JtBFEJcnqz1GpG8EtnXFHeWJ38QIFp0N26Q,11
+earthmover-0.1.6.dist-info/RECORD,,
```

