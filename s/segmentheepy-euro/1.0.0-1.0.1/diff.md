# Comparing `tmp/segmentheepy_euro-1.0.0-py3-none-any.whl.zip` & `tmp/segmentheepy_euro-1.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,11 +1,11 @@
-Zip file size: 18689 bytes, number of entries: 9
+Zip file size: 18723 bytes, number of entries: 9
 -rw-rw-r--  2.0 unx        0 b- defN 23-Jan-31 09:33 segmenthee/__init__.py
--rw-rw-r--  2.0 unx    25329 b- defN 23-Jun-22 10:58 segmenthee/cart_api.py
--rw-rw-r--  2.0 unx      756 b- defN 23-Jul-04 10:21 segmenthee/config.py
--rw-rw-r--  2.0 unx     2018 b- defN 23-Jun-22 10:58 segmenthee/parser_api.py
--rw-rw-r--  2.0 unx    82195 b- defN 23-Jun-27 12:13 segmenthee/shop.py
--rw-rw-r--  2.0 unx      261 b- defN 23-Jul-04 11:07 segmentheepy_euro-1.0.0.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Jul-04 11:07 segmentheepy_euro-1.0.0.dist-info/WHEEL
--rw-rw-r--  2.0 unx       11 b- defN 23-Jul-04 11:07 segmentheepy_euro-1.0.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx      726 b- defN 23-Jul-04 11:07 segmentheepy_euro-1.0.0.dist-info/RECORD
-9 files, 111388 bytes uncompressed, 17435 bytes compressed:  84.3%
+-rw-rw-r--  2.0 unx    25329 b- defN 23-Jul-06 11:12 segmenthee/cart_api.py
+-rw-rw-r--  2.0 unx      756 b- defN 23-Jul-06 11:12 segmenthee/config.py
+-rw-rw-r--  2.0 unx     2018 b- defN 23-Jul-06 11:12 segmenthee/parser_api.py
+-rw-rw-r--  2.0 unx    82295 b- defN 23-Jul-10 13:17 segmenthee/shop.py
+-rw-rw-r--  2.0 unx      261 b- defN 23-Jul-11 09:33 segmentheepy_euro-1.0.1.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Jul-11 09:33 segmentheepy_euro-1.0.1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       11 b- defN 23-Jul-11 09:33 segmentheepy_euro-1.0.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx      726 b- defN 23-Jul-11 09:33 segmentheepy_euro-1.0.1.dist-info/RECORD
+9 files, 111488 bytes uncompressed, 17469 bytes compressed:  84.3%
```

## zipnote {}

```diff
@@ -9,20 +9,20 @@
 
 Filename: segmenthee/parser_api.py
 Comment: 
 
 Filename: segmenthee/shop.py
 Comment: 
 
-Filename: segmentheepy_euro-1.0.0.dist-info/METADATA
+Filename: segmentheepy_euro-1.0.1.dist-info/METADATA
 Comment: 
 
-Filename: segmentheepy_euro-1.0.0.dist-info/WHEEL
+Filename: segmentheepy_euro-1.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: segmentheepy_euro-1.0.0.dist-info/top_level.txt
+Filename: segmentheepy_euro-1.0.1.dist-info/top_level.txt
 Comment: 
 
-Filename: segmentheepy_euro-1.0.0.dist-info/RECORD
+Filename: segmentheepy_euro-1.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## segmenthee/shop.py

```diff
@@ -4539,600 +4539,606 @@
 00011ba0: 6428 7061 6765 5f70 6174 6829 203e 202d  d(page_path) > -
 00011bb0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
 00011bc0: 2020 206b 7761 7267 735b 2763 6174 6567     kwargs['categ
 00011bd0: 6f72 795f 6964 275d 203d 2063 6174 0a20  ory_id'] = cat. 
 00011be0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
 00011bf0: 7265 616b 0a0a 2020 2020 2020 2020 6b77  reak..        kw
 00011c00: 6172 6773 5b27 7072 6963 6527 5d20 3d20  args['price'] = 
-00011c10: 726f 756e 6428 666c 6f61 7428 6974 656d  round(float(item
-00011c20: 2e67 6574 2827 7072 3170 7227 2c20 3029  .get('pr1pr', 0)
-00011c30: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-00011c40: 6e20 5072 6f64 7563 7450 6167 6542 726f  n ProductPageBro
-00011c50: 7773 696e 6745 7665 6e74 282a 2a6b 7761  wsingEvent(**kwa
-00011c60: 7267 7329 0a0a 2020 2020 7175 6572 793a  rgs)..    query:
-00011c70: 2044 6963 745b 7374 722c 2073 7472 5d20   Dict[str, str] 
-00011c80: 3d20 7061 7273 655f 7175 6572 7928 7061  = parse_query(pa
-00011c90: 7274 732e 7175 6572 7929 0a20 2020 2069  rts.query).    i
-00011ca0: 6620 7061 7274 732e 7061 7468 203d 3d20  f parts.path == 
-00011cb0: 272f 273a 0a20 2020 2020 2020 2072 6574  '/':.        ret
-00011cc0: 7572 6e20 4d61 696e 5061 6765 4272 6f77  urn MainPageBrow
-00011cd0: 7369 6e67 4576 656e 7428 2a2a 6b77 6172  singEvent(**kwar
-00011ce0: 6773 290a 0a20 2020 2069 6620 7061 7274  gs)..    if part
-00011cf0: 732e 7061 7468 203d 3d20 272f 757a 6c65  s.path == '/uzle
-00011d00: 7465 696e 6b27 3a0a 2020 2020 2020 2020  teink':.        
-00011d10: 7265 7475 726e 2053 686f 704c 6973 7442  return ShopListB
-00011d20: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
-00011d30: 7761 7267 7329 0a0a 2020 2020 6966 2070  wargs)..    if p
-00011d40: 6172 7473 2e70 6174 6820 3d3d 2027 2f72  arts.path == '/r
-00011d50: 6566 6c65 7873 686f 702d 7461 7273 6173  eflexshop-tarsas
-00011d60: 6a61 7465 6b6f 6b27 3a0a 2020 2020 2020  jatekok':.      
-00011d70: 2020 7265 7475 726e 2042 6f61 7264 4761    return BoardGa
-00011d80: 6d65 7355 7064 6174 6545 7665 6e74 282a  mesUpdateEvent(*
-00011d90: 2a6b 7761 7267 7329 0a0a 2020 2020 6966  *kwargs)..    if
-00011da0: 2070 6172 7473 2e70 6174 6820 3d3d 2027   parts.path == '
-00011db0: 2f69 6e64 6578 2e70 6870 2720 616e 6420  /index.php' and 
-00011dc0: 7175 6572 792e 6765 7428 2772 6f75 7465  query.get('route
-00011dd0: 2729 203d 3d20 2777 6973 686c 6973 742f  ') == 'wishlist/
-00011de0: 7769 7368 6c69 7374 273a 0a20 2020 2020  wishlist':.     
-00011df0: 2020 2072 6574 7572 6e20 5769 7368 4c69     return WishLi
-00011e00: 7374 4272 6f77 7369 6e67 4576 656e 7428  stBrowsingEvent(
-00011e10: 2a2a 6b77 6172 6773 290a 0a20 2020 2069  **kwargs)..    i
-00011e20: 6620 7061 7274 732e 7061 7468 203d 3d20  f parts.path == 
-00011e30: 272f 696e 6465 782e 7068 7027 2061 6e64  '/index.php' and
-00011e40: 2071 7565 7279 2e67 6574 2827 726f 7574   query.get('rout
-00011e50: 6527 2c20 2727 292e 7374 6172 7473 7769  e', '').startswi
-00011e60: 7468 2827 6163 636f 756e 742f 2729 3a0a  th('account/'):.
-00011e70: 2020 2020 2020 2020 7265 7475 726e 2041          return A
-00011e80: 6363 6f75 6e74 5061 6765 4272 6f77 7369  ccountPageBrowsi
-00011e90: 6e67 4576 656e 7428 2a2a 6b77 6172 6773  ngEvent(**kwargs
-00011ea0: 290a 0a20 2020 2023 2043 6174 6567 6f72  )..    # Categor
-00011eb0: 7950 6167 650a 2020 2020 666f 7220 7061  yPage.    for pa
-00011ec0: 7468 2c20 6361 7465 676f 7279 2069 6e20  th, category in 
-00011ed0: 4341 5445 474f 5259 5f4d 4150 2e69 7465  CATEGORY_MAP.ite
-00011ee0: 6d73 2829 3a0a 2020 2020 2020 2020 6966  ms():.        if
-00011ef0: 2070 6172 7473 2e70 6174 6820 3d3d 2070   parts.path == p
-00011f00: 6174 6820 6f72 2070 6172 7473 2e70 6174  ath or parts.pat
-00011f10: 682e 6669 6e64 2870 6174 6829 203e 202d  h.find(path) > -
-00011f20: 313a 0a20 2020 2020 2020 2020 2020 206b  1:.            k
-00011f30: 7761 7267 7320 3d20 7b2a 2a6b 7761 7267  wargs = {**kwarg
-00011f40: 732c 2027 6361 7465 676f 7279 5f69 6427  s, 'category_id'
-00011f50: 3a20 6361 7465 676f 7279 2c20 2a2a 6765  : category, **ge
-00011f60: 745f 7061 6769 6e61 7469 6f6e 2871 7565  t_pagination(que
-00011f70: 7279 297d 0a20 2020 2020 2020 2020 2020  ry)}.           
-00011f80: 2072 6574 7572 6e20 4361 7465 676f 7279   return Category
-00011f90: 5061 6765 4272 6f77 7369 6e67 4576 656e  PageBrowsingEven
-00011fa0: 7428 2a2a 6b77 6172 6773 290a 0a20 2020  t(**kwargs)..   
-00011fb0: 2023 2043 6174 6567 6f72 7950 6167 650a   # CategoryPage.
-00011fc0: 2020 2020 6966 2070 6172 7473 2e70 6174      if parts.pat
-00011fd0: 6820 3d3d 2027 2f69 6e64 6578 2e70 6870  h == '/index.php
-00011fe0: 2720 616e 6420 7175 6572 792e 6765 7428  ' and query.get(
-00011ff0: 2772 6f75 7465 2729 203d 3d20 2770 726f  'route') == 'pro
-00012000: 6475 6374 2f6c 6973 7427 3a0a 2020 2020  duct/list':.    
-00012010: 2020 2020 6966 2071 7565 7279 2e67 6574      if query.get
-00012020: 2827 6b65 7977 6f72 6427 2920 6973 204e  ('keyword') is N
-00012030: 6f6e 6520 616e 6420 2863 6174 5f69 6420  one and (cat_id 
-00012040: 3a3d 2071 7565 7279 2e67 6574 2827 6361  := query.get('ca
-00012050: 7465 676f 7279 5f69 6427 2929 3a0a 2020  tegory_id')):.  
-00012060: 2020 2020 2020 2020 2020 6361 7465 676f            catego
-00012070: 7279 203d 2043 4154 4547 4f52 595f 4649  ry = CATEGORY_FI
-00012080: 4c54 4552 2e67 6574 2869 6e74 2863 6174  LTER.get(int(cat
-00012090: 5f69 6429 2c20 2d31 290a 2020 2020 2020  _id), -1).      
-000120a0: 2020 2020 2020 6b77 6172 6773 203d 207b        kwargs = {
-000120b0: 2a2a 6b77 6172 6773 2c20 2763 6174 6567  **kwargs, 'categ
-000120c0: 6f72 795f 6964 273a 2063 6174 6567 6f72  ory_id': categor
-000120d0: 792c 202a 2a67 6574 5f70 6167 696e 6174  y, **get_paginat
-000120e0: 696f 6e28 7175 6572 7929 7d0a 2020 2020  ion(query)}.    
-000120f0: 2020 2020 2020 2020 7265 7475 726e 2043          return C
-00012100: 6174 6567 6f72 7950 6167 6542 726f 7773  ategoryPageBrows
-00012110: 696e 6745 7665 6e74 282a 2a6b 7761 7267  ingEvent(**kwarg
-00012120: 7329 0a0a 2020 2020 2320 5072 6564 6566  s)..    # Predef
-00012130: 696e 6564 4669 6c74 6572 202d 3e20 4361  inedFilter -> Ca
-00012140: 7465 676f 7279 5061 6765 202d 3e20 5365  tegoryPage -> Se
-00012150: 6172 6368 5265 7375 6c74 730a 2020 2020  archResults.    
-00012160: 6966 2070 6172 7473 2e70 6174 6820 3d3d  if parts.path ==
-00012170: 2027 2f69 6e64 6578 2e70 6870 2720 616e   '/index.php' an
-00012180: 6420 7175 6572 792e 6765 7428 2772 6f75  d query.get('rou
-00012190: 7465 2729 203d 3d20 2766 696c 7465 7227  te') == 'filter'
-000121a0: 3a0a 2020 2020 2020 2020 6361 7465 676f  :.        catego
-000121b0: 7279 203d 2050 5245 4445 4649 4e45 445f  ry = PREDEFINED_
-000121c0: 4649 4c54 4552 2e67 6574 2871 7565 7279  FILTER.get(query
-000121d0: 2e67 6574 2827 6669 6c74 6572 2729 2c20  .get('filter'), 
-000121e0: 2d32 290a 2020 2020 2020 2020 6966 2063  -2).        if c
-000121f0: 6174 6567 6f72 7920 3e20 2d32 3a0a 2020  ategory > -2:.  
-00012200: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-00012210: 203d 207b 2a2a 6b77 6172 6773 2c20 2763   = {**kwargs, 'c
-00012220: 6174 6567 6f72 795f 6964 273a 2063 6174  ategory_id': cat
-00012230: 6567 6f72 792c 202a 2a67 6574 5f70 6167  egory, **get_pag
-00012240: 696e 6174 696f 6e28 7175 6572 7929 7d0a  ination(query)}.
-00012250: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00012260: 726e 2050 7265 6465 6669 6e65 6446 696c  rn PredefinedFil
-00012270: 7465 7242 726f 7773 696e 6745 7665 6e74  terBrowsingEvent
-00012280: 282a 2a6b 7761 7267 7329 0a0a 2020 2020  (**kwargs)..    
-00012290: 2020 2020 6966 2071 7565 7279 2e67 6574      if query.get
-000122a0: 2827 6669 6c74 6572 272c 2027 2729 2e73  ('filter', '').s
-000122b0: 7461 7274 7377 6974 6828 2763 6174 6567  tartswith('categ
-000122c0: 6f72 797c 2729 2061 6e64 2071 7565 7279  ory|') and query
-000122d0: 2e67 6574 2827 6b65 7977 6f72 6427 2920  .get('keyword') 
-000122e0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000122f0: 2020 2020 206e 756d 6265 7273 203d 2072       numbers = r
-00012300: 652e 6669 6e64 616c 6c28 7227 5c64 2b27  e.findall(r'\d+'
-00012310: 2c20 7175 6572 792e 6765 7428 2766 696c  , query.get('fil
-00012320: 7465 7227 2929 0a20 2020 2020 2020 2020  ter')).         
-00012330: 2020 2063 6174 6567 6f72 7920 3d20 4341     category = CA
-00012340: 5445 474f 5259 5f46 494c 5445 522e 6765  TEGORY_FILTER.ge
-00012350: 7428 696e 7428 6e75 6d62 6572 735b 305d  t(int(numbers[0]
-00012360: 292c 202d 3229 2069 6620 6e75 6d62 6572  ), -2) if number
-00012370: 7320 656c 7365 202d 320a 2020 2020 2020  s else -2.      
-00012380: 2020 2020 2020 6966 2063 6174 6567 6f72        if categor
-00012390: 7920 3e20 2d32 3a0a 2020 2020 2020 2020  y > -2:.        
-000123a0: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
-000123b0: 207b 2a2a 6b77 6172 6773 2c20 2763 6174   {**kwargs, 'cat
-000123c0: 6567 6f72 795f 6964 273a 2063 6174 6567  egory_id': categ
-000123d0: 6f72 792c 202a 2a67 6574 5f70 6167 696e  ory, **get_pagin
-000123e0: 6174 696f 6e28 7175 6572 7929 7d0a 2020  ation(query)}.  
-000123f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00012400: 7475 726e 2043 6174 6567 6f72 7950 6167  turn CategoryPag
-00012410: 6542 726f 7773 696e 6745 7665 6e74 282a  eBrowsingEvent(*
-00012420: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-00012430: 2020 6b77 6172 6773 203d 207b 2a2a 6b77    kwargs = {**kw
-00012440: 6172 6773 2c20 2a2a 6765 745f 7061 6769  args, **get_pagi
-00012450: 6e61 7469 6f6e 2871 7565 7279 297d 0a20  nation(query)}. 
-00012460: 2020 2020 2020 2072 6574 7572 6e20 5365         return Se
-00012470: 6172 6368 5265 7375 6c74 7342 726f 7773  archResultsBrows
-00012480: 696e 6745 7665 6e74 282a 2a6b 7761 7267  ingEvent(**kwarg
-00012490: 7329 0a0a 2020 2020 2320 5365 6172 6368  s)..    # Search
-000124a0: 5265 7375 6c74 730a 2020 2020 6966 2070  Results.    if p
-000124b0: 6172 7473 2e70 6174 6820 3d3d 2027 2f73  arts.path == '/s
-000124c0: 6561 7263 6827 3a0a 2020 2020 2020 2020  earch':.        
-000124d0: 6b77 6172 6773 203d 207b 2a2a 6b77 6172  kwargs = {**kwar
-000124e0: 6773 2c20 2a2a 6765 745f 7061 6769 6e61  gs, **get_pagina
-000124f0: 7469 6f6e 2871 7565 7279 297d 0a20 2020  tion(query)}.   
-00012500: 2020 2020 2072 6574 7572 6e20 5365 6172       return Sear
-00012510: 6368 5265 7375 6c74 7342 726f 7773 696e  chResultsBrowsin
-00012520: 6745 7665 6e74 282a 2a6b 7761 7267 7329  gEvent(**kwargs)
-00012530: 0a0a 2020 2020 2320 496e 666f 726d 6174  ..    # Informat
-00012540: 696f 6e50 6167 650a 2020 2020 6966 2070  ionPage.    if p
-00012550: 6172 7473 2e70 6174 6820 696e 2049 4e46  arts.path in INF
-00012560: 4f5f 5041 4745 5320 6f72 2071 7565 7279  O_PAGES or query
-00012570: 2e67 6574 2827 726f 7574 6527 2920 696e  .get('route') in
-00012580: 2049 4e46 4f5f 5041 4745 533a 0a20 2020   INFO_PAGES:.   
-00012590: 2020 2020 2072 6574 7572 6e20 496e 666f       return Info
-000125a0: 726d 6174 696f 6e50 6167 6542 726f 7773  rmationPageBrows
-000125b0: 696e 6745 7665 6e74 282a 2a6b 7761 7267  ingEvent(**kwarg
-000125c0: 7329 0a0a 2020 2020 7265 7475 726e 2042  s)..    return B
-000125d0: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
-000125e0: 7761 7267 7329 0a0a 0a64 6566 2067 6574  wargs)...def get
-000125f0: 5f65 7665 6e74 5f75 6128 6974 656d 3a20  _event_ua(item: 
-00012600: 4469 6374 2920 2d3e 2053 6573 7369 6f6e  Dict) -> Session
-00012610: 426f 6479 4576 656e 743a 0a20 2020 2074  BodyEvent:.    t
-00012620: 696d 653a 2069 6e74 203d 2069 7465 6d2e  ime: int = item.
-00012630: 6765 7428 275f 7473 272c 2069 6e74 2864  get('_ts', int(d
-00012640: 742e 6e6f 7728 292e 7469 6d65 7374 616d  t.now().timestam
-00012650: 7028 2929 290a 2020 2020 6272 6f77 7369  p())).    browsi
-00012660: 6e67 5f64 6174 6120 3d20 7b27 7469 6d65  ng_data = {'time
-00012670: 273a 2074 696d 652c 0a20 2020 2020 2020  ': time,.       
-00012680: 2020 2020 2020 2020 2020 2020 2020 2772                'r
-00012690: 6566 6572 7265 7227 3a20 6765 745f 7265  eferrer': get_re
-000126a0: 6665 7272 6572 2869 7465 6d2e 6765 7428  ferrer(item.get(
-000126b0: 436f 6e66 6967 2e43 445f 5245 4645 5252  Config.CD_REFERR
-000126c0: 4552 2929 2c0a 2020 2020 2020 2020 2020  ER)),.          
-000126d0: 2020 2020 2020 2020 2020 2027 7461 6263             'tabc
-000126e0: 6f75 6e74 273a 2069 6e74 2869 7465 6d5b  ount': int(item[
-000126f0: 436f 6e66 6967 2e43 445f 5441 4243 4f55  Config.CD_TABCOU
-00012700: 4e54 5d29 2c0a 2020 2020 2020 2020 2020  NT]),.          
-00012710: 2020 2020 2020 2020 2020 2027 7461 6274             'tabt
-00012720: 7970 6527 3a20 6765 745f 7461 6274 7970  ype': get_tabtyp
-00012730: 6528 6974 656d 5b43 6f6e 6669 672e 4344  e(item[Config.CD
-00012740: 5f54 4142 5459 5045 5d29 2c0a 2020 2020  _TABTYPE]),.    
-00012750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012760: 2027 6e61 7669 6761 7469 6f6e 273a 2067   'navigation': g
-00012770: 6574 5f6e 6176 6967 6174 696f 6e28 6974  et_navigation(it
-00012780: 656d 5b43 6f6e 6669 672e 4344 5f4e 4156  em[Config.CD_NAV
-00012790: 4947 4154 494f 4e5d 292c 0a20 2020 2020  IGATION]),.     
-000127a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127b0: 2772 6564 6972 6563 7473 273a 2069 6e74  'redirects': int
-000127c0: 2869 7465 6d5b 436f 6e66 6967 2e43 445f  (item[Config.CD_
-000127d0: 5245 4449 5245 4354 535d 292c 0a20 2020  REDIRECTS]),.   
-000127e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127f0: 2020 2774 6974 6c65 273a 2069 7465 6d2e    'title': item.
-00012800: 6765 7428 2764 7427 292c 0a20 2020 2020  get('dt'),.     
-00012810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012820: 2775 746d 5f73 6f75 7263 6527 3a20 6765  'utm_source': ge
-00012830: 745f 7574 6d5f 736f 7572 6365 2869 7465  t_utm_source(ite
-00012840: 6d29 2c0a 2020 2020 2020 2020 2020 2020  m),.            
-00012850: 2020 2020 2020 2020 2027 7574 6d5f 6d65           'utm_me
-00012860: 6469 756d 273a 2069 7465 6d2e 6765 7428  dium': item.get(
-00012870: 2775 746d 5f6d 6564 6975 6d27 2c20 2727  'utm_medium', ''
-00012880: 297d 0a0a 2020 2020 6966 2069 7465 6d2e  )}..    if item.
-00012890: 6765 7428 2774 2729 203d 3d20 2770 6167  get('t') == 'pag
-000128a0: 6576 6965 7727 3a0a 2020 2020 2020 2020  eview':.        
-000128b0: 7061 7274 7320 3d20 7572 6c70 6172 7365  parts = urlparse
-000128c0: 2867 6574 5f66 6978 6564 5f75 726c 2869  (get_fixed_url(i
-000128d0: 7465 6d2e 6765 7428 2764 6c27 2929 290a  tem.get('dl'))).
-000128e0: 2020 2020 2020 2020 7175 6572 793a 2044          query: D
-000128f0: 6963 745b 7374 722c 2073 7472 5d20 3d20  ict[str, str] = 
-00012900: 7061 7273 655f 7175 6572 7928 7061 7274  parse_query(part
-00012910: 732e 7175 6572 7929 0a20 2020 2020 2020  s.query).       
-00012920: 2069 6620 7061 7274 732e 7061 7468 203d   if parts.path =
-00012930: 3d20 272f 273a 0a20 2020 2020 2020 2020  = '/':.         
-00012940: 2020 2065 7665 6e74 203d 204d 6169 6e50     event = MainP
-00012950: 6167 6542 726f 7773 696e 6745 7665 6e74  ageBrowsingEvent
-00012960: 282a 2a62 726f 7773 696e 675f 6461 7461  (**browsing_data
-00012970: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00012980: 7475 726e 2065 7665 6e74 0a20 2020 2020  turn event.     
-00012990: 2020 2069 6620 6974 656d 2e67 6574 2827     if item.get('
-000129a0: 7061 2729 203d 3d20 2764 6574 6169 6c27  pa') == 'detail'
-000129b0: 3a0a 2020 2020 2020 2020 2020 2020 6272  :.            br
-000129c0: 6f77 7369 6e67 5f64 6174 615b 2770 726f  owsing_data['pro
-000129d0: 6475 6374 5f69 6427 5d20 3d20 6974 656d  duct_id'] = item
-000129e0: 2e67 6574 2827 7072 3169 6427 290a 2020  .get('pr1id').  
-000129f0: 2020 2020 2020 2020 2020 6272 6f77 7369            browsi
-00012a00: 6e67 5f64 6174 615b 2763 6174 6567 6f72  ng_data['categor
-00012a10: 795f 6964 275d 203d 202d 310a 2020 2020  y_id'] = -1.    
-00012a20: 2020 2020 2020 2020 666f 7220 7061 7468          for path
-00012a30: 2c20 6361 7420 696e 2043 4154 4547 4f52  , cat in CATEGOR
-00012a40: 595f 4d41 502e 6974 656d 7328 293a 0a20  Y_MAP.items():. 
-00012a50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012a60: 6620 7061 7274 732e 7061 7468 2e73 7461  f parts.path.sta
-00012a70: 7274 7377 6974 6828 7061 7468 293a 0a20  rtswith(path):. 
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2062 726f 7773 696e 675f 6461 7461     browsing_data
-00012aa0: 5b27 6361 7465 676f 7279 5f69 6427 5d20  ['category_id'] 
-00012ab0: 3d20 6361 740a 2020 2020 2020 2020 2020  = cat.          
-00012ac0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-00012ad0: 0a20 2020 2020 2020 2020 2020 2070 7231  .            pr1
-00012ae0: 7072 203d 2069 7465 6d2e 6765 7428 2770  pr = item.get('p
-00012af0: 7231 7072 272c 2030 290a 2020 2020 2020  r1pr', 0).      
-00012b00: 2020 2020 2020 6272 6f77 7369 6e67 5f64        browsing_d
-00012b10: 6174 615b 2770 7269 6365 275d 203d 2069  ata['price'] = i
-00012b20: 6e74 2870 7231 7072 2920 6966 2070 7231  nt(pr1pr) if pr1
-00012b30: 7072 2021 3d20 274e 614e 2720 656c 7365  pr != 'NaN' else
-00012b40: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
-00012b50: 7665 6e74 203d 2050 726f 6475 6374 5061  vent = ProductPa
-00012b60: 6765 4272 6f77 7369 6e67 4576 656e 7428  geBrowsingEvent(
-00012b70: 2a2a 6272 6f77 7369 6e67 5f64 6174 6129  **browsing_data)
-00012b80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00012b90: 7572 6e20 6576 656e 740a 2020 2020 2020  urn event.      
-00012ba0: 2020 6966 2070 6172 7473 2e70 6174 6820    if parts.path 
-00012bb0: 3d3d 2027 2f73 7a61 6b75 7a6c 6574 756e  == '/szakuzletun
-00012bc0: 6b27 3a0a 2020 2020 2020 2020 2020 2020  k':.            
-00012bd0: 6576 656e 7420 3d20 5368 6f70 4c69 7374  event = ShopList
-00012be0: 4272 6f77 7369 6e67 4576 656e 7428 2a2a  BrowsingEvent(**
-00012bf0: 6272 6f77 7369 6e67 5f64 6174 6129 0a20  browsing_data). 
-00012c00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012c10: 6e20 6576 656e 740a 2020 2020 2020 2020  n event.        
-00012c20: 6966 2070 6172 7473 2e70 6174 6820 3d3d  if parts.path ==
-00012c30: 2027 2f72 6566 6c65 7873 686f 702d 7461   '/reflexshop-ta
-00012c40: 7273 6173 6a61 7465 6b6f 6b27 3a0a 2020  rsasjatekok':.  
-00012c50: 2020 2020 2020 2020 2020 6576 656e 7420            event 
-00012c60: 3d20 426f 6172 6447 616d 6573 5570 6461  = BoardGamesUpda
-00012c70: 7465 4576 656e 7428 2a2a 6272 6f77 7369  teEvent(**browsi
-00012c80: 6e67 5f64 6174 6129 0a20 2020 2020 2020  ng_data).       
-00012c90: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
-00012ca0: 740a 2020 2020 2020 2020 6966 2070 6172  t.        if par
-00012cb0: 7473 2e70 6174 6820 3d3d 2027 2f63 6172  ts.path == '/car
-00012cc0: 7427 3a0a 2020 2020 2020 2020 2020 2020  t':.            
-00012cd0: 6576 656e 7420 3d20 4361 7274 4272 6f77  event = CartBrow
-00012ce0: 7369 6e67 4576 656e 7428 2a2a 6272 6f77  singEvent(**brow
-00012cf0: 7369 6e67 5f64 6174 6129 0a20 2020 2020  sing_data).     
-00012d00: 2020 2020 2020 2072 6574 7572 6e20 6576         return ev
-00012d10: 656e 740a 2020 2020 2020 2020 6966 2070  ent.        if p
-00012d20: 6172 7473 2e70 6174 6820 3d3d 2027 2f63  arts.path == '/c
-00012d30: 6865 636b 6f75 7427 3a0a 2020 2020 2020  heckout':.      
-00012d40: 2020 2020 2020 6966 2070 6172 7473 2e66        if parts.f
-00012d50: 7261 676d 656e 7420 3d3d 2027 2f63 7573  ragment == '/cus
-00012d60: 746f 6d65 7264 6174 612f 273a 0a20 2020  tomerdata/':.   
-00012d70: 2020 2020 2020 2020 2020 2020 2065 7665               eve
-00012d80: 6e74 203d 2043 7573 746f 6d65 7244 6174  nt = CustomerDat
-00012d90: 6145 6e74 7279 4272 6f77 7369 6e67 4576  aEntryBrowsingEv
-00012da0: 656e 7428 2a2a 6272 6f77 7369 6e67 5f64  ent(**browsing_d
-00012db0: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-00012dc0: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
-00012dd0: 740a 2020 2020 2020 2020 2020 2020 6966  t.            if
-00012de0: 2070 6172 7473 2e66 7261 676d 656e 7420   parts.fragment 
-00012df0: 3d3d 2027 2f73 6869 7070 696e 676d 6574  == '/shippingmet
-00012e00: 686f 642f 273a 0a20 2020 2020 2020 2020  hod/':.         
-00012e10: 2020 2020 2020 2065 7665 6e74 203d 2053         event = S
-00012e20: 6869 7070 696e 674d 6574 686f 6442 726f  hippingMethodBro
-00012e30: 7773 696e 6745 7665 6e74 282a 2a62 726f  wsingEvent(**bro
-00012e40: 7773 696e 675f 6461 7461 290a 2020 2020  wsing_data).    
-00012e50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00012e60: 726e 2065 7665 6e74 0a20 2020 2020 2020  rn event.       
-00012e70: 2020 2020 2069 6620 7061 7274 732e 6672       if parts.fr
-00012e80: 6167 6d65 6e74 203d 3d20 272f 7061 796d  agment == '/paym
-00012e90: 656e 746d 6574 686f 642f 273a 0a20 2020  entmethod/':.   
-00012ea0: 2020 2020 2020 2020 2020 2020 2065 7665               eve
-00012eb0: 6e74 203d 2050 6179 6d65 6e74 4d65 7468  nt = PaymentMeth
-00012ec0: 6f64 4272 6f77 7369 6e67 4576 656e 7428  odBrowsingEvent(
-00012ed0: 2a2a 6272 6f77 7369 6e67 5f64 6174 6129  **browsing_data)
-00012ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012ef0: 2072 6574 7572 6e20 6576 656e 740a 2020   return event.  
-00012f00: 2020 2020 2020 2020 2020 6966 2070 6172            if par
-00012f10: 7473 2e66 7261 676d 656e 7420 3d3d 2027  ts.fragment == '
-00012f20: 2f63 6f6e 6669 726d 6174 696f 6e2f 273a  /confirmation/':
-00012f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012f40: 2065 7665 6e74 203d 2043 6f6e 6669 726d   event = Confirm
-00012f50: 6174 696f 6e50 6167 6542 726f 7773 696e  ationPageBrowsin
-00012f60: 6745 7665 6e74 282a 2a62 726f 7773 696e  gEvent(**browsin
-00012f70: 675f 6461 7461 290a 2020 2020 2020 2020  g_data).        
-00012f80: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00012f90: 7665 6e74 0a0a 2020 2020 2020 2020 2020  vent..          
-00012fa0: 2020 6576 656e 7420 3d20 4368 6563 6b6f    event = Checko
-00012fb0: 7574 5061 6765 4272 6f77 7369 6e67 4576  utPageBrowsingEv
-00012fc0: 656e 7428 2a2a 6272 6f77 7369 6e67 5f64  ent(**browsing_d
-00012fd0: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-00012fe0: 2072 6574 7572 6e20 6576 656e 740a 0a20   return event.. 
-00012ff0: 2020 2020 2020 2069 6620 7061 7274 732e         if parts.
-00013000: 7061 7468 203d 3d20 272f 696e 6465 782e  path == '/index.
-00013010: 7068 7027 2061 6e64 2071 7565 7279 2e67  php' and query.g
-00013020: 6574 2827 726f 7574 6527 2920 3d3d 2027  et('route') == '
-00013030: 6368 6563 6b6f 7574 2f73 7563 6365 7373  checkout/success
-00013040: 273a 0a20 2020 2020 2020 2020 2020 2065  ':.            e
-00013050: 7665 6e74 203d 2043 6865 636b 6f75 7453  vent = CheckoutS
-00013060: 7563 6365 7373 5061 6765 4272 6f77 7369  uccessPageBrowsi
-00013070: 6e67 4576 656e 7428 2a2a 6272 6f77 7369  ngEvent(**browsi
-00013080: 6e67 5f64 6174 6129 0a20 2020 2020 2020  ng_data).       
-00013090: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
-000130a0: 740a 0a20 2020 2020 2020 2069 6620 7061  t..        if pa
-000130b0: 7274 732e 7061 7468 203d 3d20 272f 696e  rts.path == '/in
-000130c0: 6465 782e 7068 7027 2061 6e64 2071 7565  dex.php' and que
-000130d0: 7279 2e67 6574 2827 726f 7574 6527 2920  ry.get('route') 
-000130e0: 3d3d 2027 7769 7368 6c69 7374 2f77 6973  == 'wishlist/wis
-000130f0: 686c 6973 7427 3a0a 2020 2020 2020 2020  hlist':.        
-00013100: 2020 2020 6576 656e 7420 3d20 5769 7368      event = Wish
-00013110: 4c69 7374 4272 6f77 7369 6e67 4576 656e  ListBrowsingEven
-00013120: 7428 2a2a 6272 6f77 7369 6e67 5f64 6174  t(**browsing_dat
-00013130: 6129 0a20 2020 2020 2020 2020 2020 2072  a).            r
-00013140: 6574 7572 6e20 6576 656e 740a 0a20 2020  eturn event..   
-00013150: 2020 2020 2069 6620 7061 7274 732e 7061       if parts.pa
-00013160: 7468 203d 3d20 272f 696e 6465 782e 7068  th == '/index.ph
-00013170: 7027 2061 6e64 2071 7565 7279 2e67 6574  p' and query.get
-00013180: 2827 726f 7574 6527 2c20 2727 292e 7374  ('route', '').st
-00013190: 6172 7473 7769 7468 2827 6163 636f 756e  artswith('accoun
-000131a0: 742f 2729 3a0a 2020 2020 2020 2020 2020  t/'):.          
-000131b0: 2020 6576 656e 7420 3d20 4163 636f 756e    event = Accoun
-000131c0: 7450 6167 6542 726f 7773 696e 6745 7665  tPageBrowsingEve
-000131d0: 6e74 282a 2a62 726f 7773 696e 675f 6461  nt(**browsing_da
-000131e0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-000131f0: 7265 7475 726e 2065 7665 6e74 0a0a 2020  return event..  
-00013200: 2020 2020 2020 2320 4361 7465 676f 7279        # Category
-00013210: 5061 6765 0a20 2020 2020 2020 2066 6f72  Page.        for
-00013220: 2070 6174 682c 2063 6174 6567 6f72 7920   path, category 
-00013230: 696e 2043 4154 4547 4f52 595f 4d41 502e  in CATEGORY_MAP.
-00013240: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00013250: 2020 2020 2069 6620 7061 7274 732e 7061       if parts.pa
-00013260: 7468 203d 3d20 7061 7468 206f 7220 7061  th == path or pa
-00013270: 7274 732e 7061 7468 2e66 696e 6428 7061  rts.path.find(pa
-00013280: 7468 2920 3e20 2d31 3a0a 2020 2020 2020  th) > -1:.      
-00013290: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-000132a0: 203d 207b 2a2a 6272 6f77 7369 6e67 5f64   = {**browsing_d
-000132b0: 6174 612c 2027 6361 7465 676f 7279 5f69  ata, 'category_i
-000132c0: 6427 3a20 6361 7465 676f 7279 2c20 2a2a  d': category, **
-000132d0: 6765 745f 7061 6769 6e61 7469 6f6e 2871  get_pagination(q
-000132e0: 7565 7279 297d 0a20 2020 2020 2020 2020  uery)}.         
-000132f0: 2020 2020 2020 2065 7665 6e74 203d 2043         event = C
-00013300: 6174 6567 6f72 7950 6167 6542 726f 7773  ategoryPageBrows
-00013310: 696e 6745 7665 6e74 282a 2a6b 7761 7267  ingEvent(**kwarg
-00013320: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00013330: 2020 2072 6574 7572 6e20 6576 656e 740a     return event.
-00013340: 0a20 2020 2020 2020 2023 2043 6174 6567  .        # Categ
-00013350: 6f72 7950 6167 650a 2020 2020 2020 2020  oryPage.        
-00013360: 6966 2070 6172 7473 2e70 6174 6820 3d3d  if parts.path ==
-00013370: 2027 2f69 6e64 6578 2e70 6870 2720 616e   '/index.php' an
-00013380: 6420 7175 6572 792e 6765 7428 2772 6f75  d query.get('rou
-00013390: 7465 2729 203d 3d20 2770 726f 6475 6374  te') == 'product
-000133a0: 2f6c 6973 7427 3a0a 2020 2020 2020 2020  /list':.        
-000133b0: 2020 2020 6966 2071 7565 7279 2e67 6574      if query.get
-000133c0: 2827 6b65 7977 6f72 6427 2920 6973 204e  ('keyword') is N
-000133d0: 6f6e 6520 616e 6420 2863 6174 5f69 6420  one and (cat_id 
-000133e0: 3a3d 2071 7565 7279 2e67 6574 2827 6361  := query.get('ca
-000133f0: 7465 676f 7279 5f69 6427 2929 3a0a 2020  tegory_id')):.  
-00013400: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-00013410: 7465 676f 7279 203d 2043 4154 4547 4f52  tegory = CATEGOR
-00013420: 595f 4649 4c54 4552 2e67 6574 2869 6e74  Y_FILTER.get(int
-00013430: 2863 6174 5f69 6429 2c20 2d31 290a 2020  (cat_id), -1).  
-00013440: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
-00013450: 6172 6773 203d 207b 2a2a 6272 6f77 7369  args = {**browsi
-00013460: 6e67 5f64 6174 612c 2027 6361 7465 676f  ng_data, 'catego
-00013470: 7279 5f69 6427 3a20 6361 7465 676f 7279  ry_id': category
-00013480: 2c20 2a2a 6765 745f 7061 6769 6e61 7469  , **get_paginati
-00013490: 6f6e 2871 7565 7279 297d 0a20 2020 2020  on(query)}.     
-000134a0: 2020 2020 2020 2020 2020 2065 7665 6e74             event
-000134b0: 203d 2043 6174 6567 6f72 7950 6167 6542   = CategoryPageB
-000134c0: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
-000134d0: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
-000134e0: 2020 2020 2020 2072 6574 7572 6e20 6576         return ev
-000134f0: 656e 740a 0a20 2020 2020 2020 2023 2050  ent..        # P
-00013500: 7265 6465 6669 6e65 6446 696c 7465 7220  redefinedFilter 
-00013510: 2d3e 2043 6174 6567 6f72 7950 6167 6520  -> CategoryPage 
-00013520: 2d3e 2053 6561 7263 6852 6573 756c 7473  -> SearchResults
-00013530: 0a20 2020 2020 2020 2069 6620 7061 7274  .        if part
-00013540: 732e 7061 7468 203d 3d20 272f 696e 6465  s.path == '/inde
-00013550: 782e 7068 7027 2061 6e64 2071 7565 7279  x.php' and query
-00013560: 2e67 6574 2827 726f 7574 6527 2920 3d3d  .get('route') ==
-00013570: 2027 6669 6c74 6572 273a 0a20 2020 2020   'filter':.     
-00013580: 2020 2020 2020 2063 6174 6567 6f72 7920         category 
-00013590: 3d20 5052 4544 4546 494e 4544 5f46 494c  = PREDEFINED_FIL
-000135a0: 5445 522e 6765 7428 7175 6572 792e 6765  TER.get(query.ge
-000135b0: 7428 2766 696c 7465 7227 292c 202d 3229  t('filter'), -2)
-000135c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000135d0: 6361 7465 676f 7279 203e 202d 323a 0a20  category > -2:. 
-000135e0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-000135f0: 7761 7267 7320 3d20 7b2a 2a62 726f 7773  wargs = {**brows
-00013600: 696e 675f 6461 7461 2c20 2763 6174 6567  ing_data, 'categ
-00013610: 6f72 795f 6964 273a 2063 6174 6567 6f72  ory_id': categor
-00013620: 792c 202a 2a67 6574 5f70 6167 696e 6174  y, **get_paginat
-00013630: 696f 6e28 7175 6572 7929 7d0a 2020 2020  ion(query)}.    
-00013640: 2020 2020 2020 2020 2020 2020 6576 656e              even
-00013650: 7420 3d20 5072 6564 6566 696e 6564 4669  t = PredefinedFi
-00013660: 6c74 6572 4272 6f77 7369 6e67 4576 656e  lterBrowsingEven
-00013670: 7428 2a2a 6b77 6172 6773 290a 2020 2020  t(**kwargs).    
-00013680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00013690: 726e 2065 7665 6e74 0a0a 2020 2020 2020  rn event..      
-000136a0: 2020 2020 2020 6966 2071 7565 7279 2e67        if query.g
-000136b0: 6574 2827 6669 6c74 6572 272c 2027 2729  et('filter', '')
-000136c0: 2e73 7461 7274 7377 6974 6828 2763 6174  .startswith('cat
-000136d0: 6567 6f72 797c 2729 2061 6e64 2071 7565  egory|') and que
-000136e0: 7279 2e67 6574 2827 6b65 7977 6f72 6427  ry.get('keyword'
-000136f0: 2920 6973 204e 6f6e 653a 0a20 2020 2020  ) is None:.     
-00013700: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00013710: 7273 203d 2072 652e 6669 6e64 616c 6c28  rs = re.findall(
-00013720: 7227 5c64 2b27 2c20 7175 6572 792e 6765  r'\d+', query.ge
-00013730: 7428 2766 696c 7465 7227 2929 0a20 2020  t('filter')).   
-00013740: 2020 2020 2020 2020 2020 2020 2063 6174               cat
-00013750: 6567 6f72 7920 3d20 4341 5445 474f 5259  egory = CATEGORY
-00013760: 5f46 494c 5445 522e 6765 7428 696e 7428  _FILTER.get(int(
-00013770: 6e75 6d62 6572 735b 305d 292c 202d 3229  numbers[0]), -2)
-00013780: 2069 6620 6e75 6d62 6572 7320 656c 7365   if numbers else
-00013790: 202d 320a 2020 2020 2020 2020 2020 2020   -2.            
-000137a0: 2020 2020 6966 2063 6174 6567 6f72 7920      if category 
-000137b0: 3e20 2d32 3a0a 2020 2020 2020 2020 2020  > -2:.          
-000137c0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-000137d0: 203d 207b 2a2a 6272 6f77 7369 6e67 5f64   = {**browsing_d
-000137e0: 6174 612c 2027 6361 7465 676f 7279 5f69  ata, 'category_i
-000137f0: 6427 3a20 6361 7465 676f 7279 2c20 2a2a  d': category, **
-00013800: 6765 745f 7061 6769 6e61 7469 6f6e 2871  get_pagination(q
-00013810: 7565 7279 297d 0a20 2020 2020 2020 2020  uery)}.         
-00013820: 2020 2020 2020 2020 2020 2065 7665 6e74             event
-00013830: 203d 2043 6174 6567 6f72 7950 6167 6542   = CategoryPageB
-00013840: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
-00013850: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
-00013860: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013870: 6e20 6576 656e 740a 0a20 2020 2020 2020  n event..       
-00013880: 2020 2020 206b 7761 7267 7320 3d20 7b2a       kwargs = {*
-00013890: 2a62 726f 7773 696e 675f 6461 7461 2c20  *browsing_data, 
-000138a0: 2a2a 6765 745f 7061 6769 6e61 7469 6f6e  **get_pagination
-000138b0: 2871 7565 7279 297d 0a20 2020 2020 2020  (query)}.       
-000138c0: 2020 2020 2065 7665 6e74 203d 2053 6561       event = Sea
-000138d0: 7263 6852 6573 756c 7473 4272 6f77 7369  rchResultsBrowsi
-000138e0: 6e67 4576 656e 7428 2a2a 6b77 6172 6773  ngEvent(**kwargs
-000138f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00013900: 7475 726e 2065 7665 6e74 0a0a 2020 2020  turn event..    
-00013910: 2020 2020 2320 5365 6172 6368 5265 7375      # SearchResu
-00013920: 6c74 730a 2020 2020 2020 2020 6966 2070  lts.        if p
-00013930: 6172 7473 2e70 6174 6820 3d3d 2027 2f6b  arts.path == '/k
-00013940: 6572 6573 6573 2720 6f72 2071 7565 7279  ereses' or query
-00013950: 2e67 6574 2827 726f 7574 6527 2920 3d3d  .get('route') ==
-00013960: 2027 7072 6f64 7563 742f 6c69 7374 273a   'product/list':
-00013970: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
-00013980: 7267 7320 3d20 7b2a 2a62 726f 7773 696e  rgs = {**browsin
-00013990: 675f 6461 7461 2c20 2a2a 6765 745f 7061  g_data, **get_pa
-000139a0: 6769 6e61 7469 6f6e 2871 7565 7279 297d  gination(query)}
-000139b0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
-000139c0: 6e74 203d 2053 6561 7263 6852 6573 756c  nt = SearchResul
-000139d0: 7473 4272 6f77 7369 6e67 4576 656e 7428  tsBrowsingEvent(
-000139e0: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
-000139f0: 2020 2020 2020 7265 7475 726e 2065 7665        return eve
-00013a00: 6e74 0a0a 2020 2020 2020 2020 2320 496e  nt..        # In
-00013a10: 666f 726d 6174 696f 6e50 6167 650a 2020  formationPage.  
-00013a20: 2020 2020 2020 6966 2070 6172 7473 2e70        if parts.p
-00013a30: 6174 6820 696e 2049 4e46 4f5f 5041 4745  ath in INFO_PAGE
-00013a40: 5320 6f72 2071 7565 7279 2e67 6574 2827  S or query.get('
-00013a50: 726f 7574 6527 2920 696e 2049 4e46 4f5f  route') in INFO_
-00013a60: 5041 4745 533a 0a20 2020 2020 2020 2020  PAGES:.         
-00013a70: 2020 2065 7665 6e74 203d 2049 6e66 6f72     event = Infor
-00013a80: 6d61 7469 6f6e 5061 6765 4272 6f77 7369  mationPageBrowsi
-00013a90: 6e67 4576 656e 7428 2a2a 6272 6f77 7369  ngEvent(**browsi
-00013aa0: 6e67 5f64 6174 6129 0a20 2020 2020 2020  ng_data).       
-00013ab0: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
-00013ac0: 740a 0a20 2020 2020 2020 2065 7665 6e74  t..        event
-00013ad0: 203d 2042 726f 7773 696e 6745 7665 6e74   = BrowsingEvent
-00013ae0: 282a 2a62 726f 7773 696e 675f 6461 7461  (**browsing_data
-00013af0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00013b00: 2065 7665 6e74 0a0a 2020 2020 6966 2069   event..    if i
-00013b10: 7465 6d2e 6765 7428 2774 2729 203d 3d20  tem.get('t') == 
-00013b20: 2765 7665 6e74 273a 0a20 2020 2020 2020  'event':.       
-00013b30: 2069 6620 6974 656d 2e67 6574 2827 6563   if item.get('ec
-00013b40: 2729 203d 3d20 27c3 8972 7465 73c3 ad74  ') == '..rtes..t
-00013b50: c3a9 7320 6bc3 a972 c3a9 7365 2720 616e  ..s k..r..se' an
-00013b60: 6420 6974 656d 2e67 6574 2827 6561 2729  d item.get('ea')
-00013b70: 203d 3d20 27c3 8972 7465 73c3 ad74 c3a9   == '..rtes..t..
-00013b80: 7320 6bc3 a972 c3a9 7365 2073 696b 6572  s k..r..se siker
-00013b90: 6573 273a 0a20 2020 2020 2020 2020 2020  es':.           
-00013ba0: 2065 7665 6e74 203d 2052 6567 6973 7472   event = Registr
-00013bb0: 6174 696f 6e45 7665 6e74 2874 696d 6529  ationEvent(time)
-00013bc0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00013bd0: 7572 6e20 6576 656e 740a 2020 2020 2020  urn event.      
-00013be0: 2020 6966 2069 7465 6d2e 6765 7428 2765    if item.get('e
-00013bf0: 6327 2920 3d3d 2027 652d 6361 7274 2720  c') == 'e-cart' 
-00013c00: 616e 6420 6974 656d 2e67 6574 2827 6561  and item.get('ea
-00013c10: 2729 203d 3d20 2775 7064 6174 6527 3a0a  ') == 'update':.
-00013c20: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00013c30: 203d 206a 736f 6e2e 6c6f 6164 7328 6974   = json.loads(it
-00013c40: 656d 2e67 6574 2827 656c 2729 290a 2020  em.get('el')).  
-00013c50: 2020 2020 2020 2020 2020 6465 6c74 615f            delta_
-00013c60: 636f 756e 7420 3d20 6461 7461 2e67 6574  count = data.get
-00013c70: 2827 6974 656d 436f 756e 7427 290a 2020  ('itemCount').  
-00013c80: 2020 2020 2020 2020 2020 6465 6c74 615f            delta_
-00013c90: 746f 7461 6c20 3d20 726f 756e 6428 6461  total = round(da
-00013ca0: 7461 2e67 6574 2827 746f 7461 6c27 292c  ta.get('total'),
-00013cb0: 2032 290a 2020 2020 2020 2020 2020 2020   2).            
-00013cc0: 6576 656e 7420 3d20 4361 7274 4d6f 6469  event = CartModi
-00013cd0: 6679 4576 656e 7428 7469 6d65 2c20 6465  fyEvent(time, de
-00013ce0: 6c74 615f 636f 756e 742c 2064 656c 7461  lta_count, delta
-00013cf0: 5f74 6f74 616c 290a 2020 2020 2020 2020  _total).        
-00013d00: 2020 2020 7265 7475 726e 2065 7665 6e74      return event
-00013d10: 0a20 2020 2020 2020 2069 6620 6974 656d  .        if item
-00013d20: 2e67 6574 2827 6563 2729 203d 3d20 274f  .get('ec') == 'O
-00013d30: 7074 694d 6f6e 6b27 3a0a 2020 2020 2020  ptiMonk':.      
-00013d40: 2020 2020 2020 6966 2069 7465 6d2e 6765        if item.ge
-00013d50: 7428 2765 6127 2920 3d3d 2027 7368 6f77  t('ea') == 'show
-00013d60: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-00013d70: 2020 2020 6576 656e 7420 3d20 436f 7570      event = Coup
-00013d80: 6f6e 4f66 6665 7265 6445 7665 6e74 2874  onOfferedEvent(t
-00013d90: 696d 652c 2069 7465 6d2e 6765 7428 2765  ime, item.get('e
-00013da0: 6c27 2929 0a20 2020 2020 2020 2020 2020  l')).           
-00013db0: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
-00013dc0: 740a 2020 2020 2020 2020 2020 2020 6966  t.            if
-00013dd0: 2069 7465 6d2e 6765 7428 2765 6127 2920   item.get('ea') 
-00013de0: 3d3d 2027 6669 6c6c 6564 273a 0a20 2020  == 'filled':.   
-00013df0: 2020 2020 2020 2020 2020 2020 2065 7665               eve
-00013e00: 6e74 203d 2043 6f75 706f 6e41 6363 6570  nt = CouponAccep
-00013e10: 7465 6445 7665 6e74 2874 696d 652c 2069  tedEvent(time, i
-00013e20: 7465 6d2e 6765 7428 2765 6c27 2929 0a20  tem.get('el')). 
-00013e30: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00013e40: 6574 7572 6e20 6576 656e 740a 0a20 2020  eturn event..   
-00013e50: 2065 7665 6e74 203d 2053 7973 7465 6d45   event = SystemE
-00013e60: 7665 6e74 2874 696d 6529 0a20 2020 2072  vent(time).    r
-00013e70: 6574 7572 6e20 6576 656e 740a 0a0a 6465  eturn event...de
-00013e80: 6620 6765 745f 6669 7865 645f 7572 6c28  f get_fixed_url(
-00013e90: 7572 6c3a 2073 7472 2920 2d3e 2073 7472  url: str) -> str
-00013ea0: 3a0a 2020 2020 7031 203d 2075 726c 2e66  :.    p1 = url.f
-00013eb0: 696e 6428 273f 2729 0a20 2020 2070 3220  ind('?').    p2 
-00013ec0: 3d20 7572 6c2e 6669 6e64 2827 2627 290a  = url.find('&').
-00013ed0: 2020 2020 6966 2070 3120 3d3d 202d 3120      if p1 == -1 
-00013ee0: 616e 6420 7032 203e 202d 313a 0a20 2020  and p2 > -1:.   
-00013ef0: 2020 2020 2072 6574 7572 6e20 7572 6c5b       return url[
-00013f00: 3a70 325d 202b 2027 3f27 202b 2075 726c  :p2] + '?' + url
-00013f10: 5b70 322b 313a 5d0a 2020 2020 7265 7475  [p2+1:].    retu
-00013f20: 726e 2075 726c 5b3a 7032 5d20 2b20 7572  rn url[:p2] + ur
-00013f30: 6c5b 7031 3a5d 202b 2075 726c 5b70 323a  l[p1:] + url[p2:
-00013f40: 7031 5d20 6966 202d 3120 3c20 7032 203c  p1] if -1 < p2 <
-00013f50: 2070 3120 656c 7365 2075 726c 0a0a 0a64   p1 else url...d
-00013f60: 6566 2070 6172 7365 5f71 7565 7279 2871  ef parse_query(q
-00013f70: 7565 7279 3a20 7374 7229 202d 3e20 4469  uery: str) -> Di
-00013f80: 6374 5b73 7472 2c20 7374 725d 3a0a 2020  ct[str, str]:.  
-00013f90: 2020 7265 7475 726e 207b 7d20 6966 2071    return {} if q
-00013fa0: 7565 7279 2e73 7472 6970 2829 203d 3d20  uery.strip() == 
-00013fb0: 2727 2065 6c73 6520 7b6b 3a20 765b 305d  '' else {k: v[0]
-00013fc0: 2066 6f72 206b 2c20 7620 696e 2070 6172   for k, v in par
-00013fd0: 7365 5f71 7328 756e 7175 6f74 6528 7175  se_qs(unquote(qu
-00013fe0: 6572 7929 292e 6974 656d 7328 297d 0a0a  ery)).items()}..
-00013ff0: 0a64 6566 2067 6574 5f70 6167 696e 6174  .def get_paginat
-00014000: 696f 6e28 7175 6572 793a 2044 6963 7429  ion(query: Dict)
-00014010: 202d 3e20 4469 6374 3a0a 2020 2020 7061   -> Dict:.    pa
-00014020: 6769 6e61 7469 6f6e 203d 207b 2270 6167  gination = {"pag
-00014030: 6522 3a20 6765 745f 7061 6765 2871 7565  e": get_page(que
-00014040: 7279 2e67 6574 2827 7061 6765 272c 2027  ry.get('page', '
-00014050: 3127 2929 7d0a 2020 2020 6966 2027 6669  1'))}.    if 'fi
-00014060: 6c74 6572 5b6f 7264 6572 5d27 2069 6e20  lter[order]' in 
-00014070: 7175 6572 792e 6b65 7973 2829 3a0a 2020  query.keys():.  
-00014080: 2020 2020 2020 7061 6769 6e61 7469 6f6e        pagination
-00014090: 5b22 736f 7274 225d 203d 2067 6574 5f73  ["sort"] = get_s
-000140a0: 6f72 7428 7175 6572 792e 6765 7428 2766  ort(query.get('f
-000140b0: 696c 7465 725b 6f72 6465 725d 2729 290a  ilter[order]')).
-000140c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000140d0: 2020 7061 6769 6e61 7469 6f6e 5b22 736f    pagination["so
-000140e0: 7274 225d 203d 2067 6574 5f73 6f72 7428  rt"] = get_sort(
-000140f0: 2772 656c 6576 616e 6365 2729 0a20 2020  'relevance').   
-00014100: 2072 6574 7572 6e20 7061 6769 6e61 7469   return paginati
-00014110: 6f6e 0a                                  on.
+00011c10: 666c 6f61 745f 6f72 5f6e 6f6e 6528 6974  float_or_none(it
+00011c20: 656d 2e67 6574 2827 7072 3170 7227 2929  em.get('pr1pr'))
+00011c30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00011c40: 5072 6f64 7563 7450 6167 6542 726f 7773  ProductPageBrows
+00011c50: 696e 6745 7665 6e74 282a 2a6b 7761 7267  ingEvent(**kwarg
+00011c60: 7329 0a0a 2020 2020 7175 6572 793a 2044  s)..    query: D
+00011c70: 6963 745b 7374 722c 2073 7472 5d20 3d20  ict[str, str] = 
+00011c80: 7061 7273 655f 7175 6572 7928 7061 7274  parse_query(part
+00011c90: 732e 7175 6572 7929 0a20 2020 2069 6620  s.query).    if 
+00011ca0: 7061 7274 732e 7061 7468 203d 3d20 272f  parts.path == '/
+00011cb0: 273a 0a20 2020 2020 2020 2072 6574 7572  ':.        retur
+00011cc0: 6e20 4d61 696e 5061 6765 4272 6f77 7369  n MainPageBrowsi
+00011cd0: 6e67 4576 656e 7428 2a2a 6b77 6172 6773  ngEvent(**kwargs
+00011ce0: 290a 0a20 2020 2069 6620 7061 7274 732e  )..    if parts.
+00011cf0: 7061 7468 203d 3d20 272f 757a 6c65 7465  path == '/uzlete
+00011d00: 696e 6b27 3a0a 2020 2020 2020 2020 7265  ink':.        re
+00011d10: 7475 726e 2053 686f 704c 6973 7442 726f  turn ShopListBro
+00011d20: 7773 696e 6745 7665 6e74 282a 2a6b 7761  wsingEvent(**kwa
+00011d30: 7267 7329 0a0a 2020 2020 6966 2070 6172  rgs)..    if par
+00011d40: 7473 2e70 6174 6820 3d3d 2027 2f72 6566  ts.path == '/ref
+00011d50: 6c65 7873 686f 702d 7461 7273 6173 6a61  lexshop-tarsasja
+00011d60: 7465 6b6f 6b27 3a0a 2020 2020 2020 2020  tekok':.        
+00011d70: 7265 7475 726e 2042 6f61 7264 4761 6d65  return BoardGame
+00011d80: 7355 7064 6174 6545 7665 6e74 282a 2a6b  sUpdateEvent(**k
+00011d90: 7761 7267 7329 0a0a 2020 2020 6966 2070  wargs)..    if p
+00011da0: 6172 7473 2e70 6174 6820 3d3d 2027 2f69  arts.path == '/i
+00011db0: 6e64 6578 2e70 6870 2720 616e 6420 7175  ndex.php' and qu
+00011dc0: 6572 792e 6765 7428 2772 6f75 7465 2729  ery.get('route')
+00011dd0: 203d 3d20 2777 6973 686c 6973 742f 7769   == 'wishlist/wi
+00011de0: 7368 6c69 7374 273a 0a20 2020 2020 2020  shlist':.       
+00011df0: 2072 6574 7572 6e20 5769 7368 4c69 7374   return WishList
+00011e00: 4272 6f77 7369 6e67 4576 656e 7428 2a2a  BrowsingEvent(**
+00011e10: 6b77 6172 6773 290a 0a20 2020 2069 6620  kwargs)..    if 
+00011e20: 7061 7274 732e 7061 7468 203d 3d20 272f  parts.path == '/
+00011e30: 696e 6465 782e 7068 7027 2061 6e64 2071  index.php' and q
+00011e40: 7565 7279 2e67 6574 2827 726f 7574 6527  uery.get('route'
+00011e50: 2c20 2727 292e 7374 6172 7473 7769 7468  , '').startswith
+00011e60: 2827 6163 636f 756e 742f 2729 3a0a 2020  ('account/'):.  
+00011e70: 2020 2020 2020 7265 7475 726e 2041 6363        return Acc
+00011e80: 6f75 6e74 5061 6765 4272 6f77 7369 6e67  ountPageBrowsing
+00011e90: 4576 656e 7428 2a2a 6b77 6172 6773 290a  Event(**kwargs).
+00011ea0: 0a20 2020 2023 2043 6174 6567 6f72 7950  .    # CategoryP
+00011eb0: 6167 650a 2020 2020 666f 7220 7061 7468  age.    for path
+00011ec0: 2c20 6361 7465 676f 7279 2069 6e20 4341  , category in CA
+00011ed0: 5445 474f 5259 5f4d 4150 2e69 7465 6d73  TEGORY_MAP.items
+00011ee0: 2829 3a0a 2020 2020 2020 2020 6966 2070  ():.        if p
+00011ef0: 6172 7473 2e70 6174 6820 3d3d 2070 6174  arts.path == pat
+00011f00: 6820 6f72 2070 6172 7473 2e70 6174 682e  h or parts.path.
+00011f10: 6669 6e64 2870 6174 6829 203e 202d 313a  find(path) > -1:
+00011f20: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
+00011f30: 7267 7320 3d20 7b2a 2a6b 7761 7267 732c  rgs = {**kwargs,
+00011f40: 2027 6361 7465 676f 7279 5f69 6427 3a20   'category_id': 
+00011f50: 6361 7465 676f 7279 2c20 2a2a 6765 745f  category, **get_
+00011f60: 7061 6769 6e61 7469 6f6e 2871 7565 7279  pagination(query
+00011f70: 297d 0a20 2020 2020 2020 2020 2020 2072  )}.            r
+00011f80: 6574 7572 6e20 4361 7465 676f 7279 5061  eturn CategoryPa
+00011f90: 6765 4272 6f77 7369 6e67 4576 656e 7428  geBrowsingEvent(
+00011fa0: 2a2a 6b77 6172 6773 290a 0a20 2020 2023  **kwargs)..    #
+00011fb0: 2043 6174 6567 6f72 7950 6167 650a 2020   CategoryPage.  
+00011fc0: 2020 6966 2070 6172 7473 2e70 6174 6820    if parts.path 
+00011fd0: 3d3d 2027 2f69 6e64 6578 2e70 6870 2720  == '/index.php' 
+00011fe0: 616e 6420 7175 6572 792e 6765 7428 2772  and query.get('r
+00011ff0: 6f75 7465 2729 203d 3d20 2770 726f 6475  oute') == 'produ
+00012000: 6374 2f6c 6973 7427 3a0a 2020 2020 2020  ct/list':.      
+00012010: 2020 6966 2071 7565 7279 2e67 6574 2827    if query.get('
+00012020: 6b65 7977 6f72 6427 2920 6973 204e 6f6e  keyword') is Non
+00012030: 6520 616e 6420 2863 6174 5f69 6420 3a3d  e and (cat_id :=
+00012040: 2071 7565 7279 2e67 6574 2827 6361 7465   query.get('cate
+00012050: 676f 7279 5f69 6427 2929 3a0a 2020 2020  gory_id')):.    
+00012060: 2020 2020 2020 2020 6361 7465 676f 7279          category
+00012070: 203d 2043 4154 4547 4f52 595f 4649 4c54   = CATEGORY_FILT
+00012080: 4552 2e67 6574 2869 6e74 2863 6174 5f69  ER.get(int(cat_i
+00012090: 6429 2c20 2d31 290a 2020 2020 2020 2020  d), -1).        
+000120a0: 2020 2020 6b77 6172 6773 203d 207b 2a2a      kwargs = {**
+000120b0: 6b77 6172 6773 2c20 2763 6174 6567 6f72  kwargs, 'categor
+000120c0: 795f 6964 273a 2063 6174 6567 6f72 792c  y_id': category,
+000120d0: 202a 2a67 6574 5f70 6167 696e 6174 696f   **get_paginatio
+000120e0: 6e28 7175 6572 7929 7d0a 2020 2020 2020  n(query)}.      
+000120f0: 2020 2020 2020 7265 7475 726e 2043 6174        return Cat
+00012100: 6567 6f72 7950 6167 6542 726f 7773 696e  egoryPageBrowsin
+00012110: 6745 7665 6e74 282a 2a6b 7761 7267 7329  gEvent(**kwargs)
+00012120: 0a0a 2020 2020 2320 5072 6564 6566 696e  ..    # Predefin
+00012130: 6564 4669 6c74 6572 202d 3e20 4361 7465  edFilter -> Cate
+00012140: 676f 7279 5061 6765 202d 3e20 5365 6172  goryPage -> Sear
+00012150: 6368 5265 7375 6c74 730a 2020 2020 6966  chResults.    if
+00012160: 2070 6172 7473 2e70 6174 6820 3d3d 2027   parts.path == '
+00012170: 2f69 6e64 6578 2e70 6870 2720 616e 6420  /index.php' and 
+00012180: 7175 6572 792e 6765 7428 2772 6f75 7465  query.get('route
+00012190: 2729 203d 3d20 2766 696c 7465 7227 3a0a  ') == 'filter':.
+000121a0: 2020 2020 2020 2020 6361 7465 676f 7279          category
+000121b0: 203d 2050 5245 4445 4649 4e45 445f 4649   = PREDEFINED_FI
+000121c0: 4c54 4552 2e67 6574 2871 7565 7279 2e67  LTER.get(query.g
+000121d0: 6574 2827 6669 6c74 6572 2729 2c20 2d32  et('filter'), -2
+000121e0: 290a 2020 2020 2020 2020 6966 2063 6174  ).        if cat
+000121f0: 6567 6f72 7920 3e20 2d32 3a0a 2020 2020  egory > -2:.    
+00012200: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
+00012210: 207b 2a2a 6b77 6172 6773 2c20 2763 6174   {**kwargs, 'cat
+00012220: 6567 6f72 795f 6964 273a 2063 6174 6567  egory_id': categ
+00012230: 6f72 792c 202a 2a67 6574 5f70 6167 696e  ory, **get_pagin
+00012240: 6174 696f 6e28 7175 6572 7929 7d0a 2020  ation(query)}.  
+00012250: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00012260: 2050 7265 6465 6669 6e65 6446 696c 7465   PredefinedFilte
+00012270: 7242 726f 7773 696e 6745 7665 6e74 282a  rBrowsingEvent(*
+00012280: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
+00012290: 2020 6966 2071 7565 7279 2e67 6574 2827    if query.get('
+000122a0: 6669 6c74 6572 272c 2027 2729 2e73 7461  filter', '').sta
+000122b0: 7274 7377 6974 6828 2763 6174 6567 6f72  rtswith('categor
+000122c0: 797c 2729 2061 6e64 2071 7565 7279 2e67  y|') and query.g
+000122d0: 6574 2827 6b65 7977 6f72 6427 2920 6973  et('keyword') is
+000122e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000122f0: 2020 206e 756d 6265 7273 203d 2072 652e     numbers = re.
+00012300: 6669 6e64 616c 6c28 7227 5c64 2b27 2c20  findall(r'\d+', 
+00012310: 7175 6572 792e 6765 7428 2766 696c 7465  query.get('filte
+00012320: 7227 2929 0a20 2020 2020 2020 2020 2020  r')).           
+00012330: 2063 6174 6567 6f72 7920 3d20 4341 5445   category = CATE
+00012340: 474f 5259 5f46 494c 5445 522e 6765 7428  GORY_FILTER.get(
+00012350: 696e 7428 6e75 6d62 6572 735b 305d 292c  int(numbers[0]),
+00012360: 202d 3229 2069 6620 6e75 6d62 6572 7320   -2) if numbers 
+00012370: 656c 7365 202d 320a 2020 2020 2020 2020  else -2.        
+00012380: 2020 2020 6966 2063 6174 6567 6f72 7920      if category 
+00012390: 3e20 2d32 3a0a 2020 2020 2020 2020 2020  > -2:.          
+000123a0: 2020 2020 2020 6b77 6172 6773 203d 207b        kwargs = {
+000123b0: 2a2a 6b77 6172 6773 2c20 2763 6174 6567  **kwargs, 'categ
+000123c0: 6f72 795f 6964 273a 2063 6174 6567 6f72  ory_id': categor
+000123d0: 792c 202a 2a67 6574 5f70 6167 696e 6174  y, **get_paginat
+000123e0: 696f 6e28 7175 6572 7929 7d0a 2020 2020  ion(query)}.    
+000123f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00012400: 726e 2043 6174 6567 6f72 7950 6167 6542  rn CategoryPageB
+00012410: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
+00012420: 7761 7267 7329 0a0a 2020 2020 2020 2020  wargs)..        
+00012430: 6b77 6172 6773 203d 207b 2a2a 6b77 6172  kwargs = {**kwar
+00012440: 6773 2c20 2a2a 6765 745f 7061 6769 6e61  gs, **get_pagina
+00012450: 7469 6f6e 2871 7565 7279 297d 0a20 2020  tion(query)}.   
+00012460: 2020 2020 2072 6574 7572 6e20 5365 6172       return Sear
+00012470: 6368 5265 7375 6c74 7342 726f 7773 696e  chResultsBrowsin
+00012480: 6745 7665 6e74 282a 2a6b 7761 7267 7329  gEvent(**kwargs)
+00012490: 0a0a 2020 2020 2320 5365 6172 6368 5265  ..    # SearchRe
+000124a0: 7375 6c74 730a 2020 2020 6966 2070 6172  sults.    if par
+000124b0: 7473 2e70 6174 6820 3d3d 2027 2f73 6561  ts.path == '/sea
+000124c0: 7263 6827 3a0a 2020 2020 2020 2020 6b77  rch':.        kw
+000124d0: 6172 6773 203d 207b 2a2a 6b77 6172 6773  args = {**kwargs
+000124e0: 2c20 2a2a 6765 745f 7061 6769 6e61 7469  , **get_paginati
+000124f0: 6f6e 2871 7565 7279 297d 0a20 2020 2020  on(query)}.     
+00012500: 2020 2072 6574 7572 6e20 5365 6172 6368     return Search
+00012510: 5265 7375 6c74 7342 726f 7773 696e 6745  ResultsBrowsingE
+00012520: 7665 6e74 282a 2a6b 7761 7267 7329 0a0a  vent(**kwargs)..
+00012530: 2020 2020 2320 496e 666f 726d 6174 696f      # Informatio
+00012540: 6e50 6167 650a 2020 2020 6966 2070 6172  nPage.    if par
+00012550: 7473 2e70 6174 6820 696e 2049 4e46 4f5f  ts.path in INFO_
+00012560: 5041 4745 5320 6f72 2071 7565 7279 2e67  PAGES or query.g
+00012570: 6574 2827 726f 7574 6527 2920 696e 2049  et('route') in I
+00012580: 4e46 4f5f 5041 4745 533a 0a20 2020 2020  NFO_PAGES:.     
+00012590: 2020 2072 6574 7572 6e20 496e 666f 726d     return Inform
+000125a0: 6174 696f 6e50 6167 6542 726f 7773 696e  ationPageBrowsin
+000125b0: 6745 7665 6e74 282a 2a6b 7761 7267 7329  gEvent(**kwargs)
+000125c0: 0a0a 2020 2020 7265 7475 726e 2042 726f  ..    return Bro
+000125d0: 7773 696e 6745 7665 6e74 282a 2a6b 7761  wsingEvent(**kwa
+000125e0: 7267 7329 0a0a 0a64 6566 2066 6c6f 6174  rgs)...def float
+000125f0: 5f6f 725f 6e6f 6e65 2876 616c 7565 3a20  _or_none(value: 
+00012600: 7374 7229 3a0a 2020 2020 7472 793a 0a20  str):.    try:. 
+00012610: 2020 2020 2020 2072 6574 7572 6e20 666c         return fl
+00012620: 6f61 7428 7661 6c75 6529 0a20 2020 2065  oat(value).    e
+00012630: 7863 6570 743a 0a20 2020 2020 2020 2072  xcept:.        r
+00012640: 6574 7572 6e20 4e6f 6e65 0a0a 0a64 6566  eturn None...def
+00012650: 2067 6574 5f65 7665 6e74 5f75 6128 6974   get_event_ua(it
+00012660: 656d 3a20 4469 6374 2920 2d3e 2053 6573  em: Dict) -> Ses
+00012670: 7369 6f6e 426f 6479 4576 656e 743a 0a20  sionBodyEvent:. 
+00012680: 2020 2074 696d 653a 2069 6e74 203d 2069     time: int = i
+00012690: 7465 6d2e 6765 7428 275f 7473 272c 2069  tem.get('_ts', i
+000126a0: 6e74 2864 742e 6e6f 7728 292e 7469 6d65  nt(dt.now().time
+000126b0: 7374 616d 7028 2929 290a 2020 2020 6272  stamp())).    br
+000126c0: 6f77 7369 6e67 5f64 6174 6120 3d20 7b27  owsing_data = {'
+000126d0: 7469 6d65 273a 2074 696d 652c 0a20 2020  time': time,.   
+000126e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126f0: 2020 2772 6566 6572 7265 7227 3a20 6765    'referrer': ge
+00012700: 745f 7265 6665 7272 6572 2869 7465 6d2e  t_referrer(item.
+00012710: 6765 7428 436f 6e66 6967 2e43 445f 5245  get(Config.CD_RE
+00012720: 4645 5252 4552 2929 2c0a 2020 2020 2020  FERRER)),.      
+00012730: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00012740: 7461 6263 6f75 6e74 273a 2069 6e74 2869  tabcount': int(i
+00012750: 7465 6d5b 436f 6e66 6967 2e43 445f 5441  tem[Config.CD_TA
+00012760: 4243 4f55 4e54 5d29 2c0a 2020 2020 2020  BCOUNT]),.      
+00012770: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00012780: 7461 6274 7970 6527 3a20 6765 745f 7461  tabtype': get_ta
+00012790: 6274 7970 6528 6974 656d 5b43 6f6e 6669  btype(item[Confi
+000127a0: 672e 4344 5f54 4142 5459 5045 5d29 2c0a  g.CD_TABTYPE]),.
+000127b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000127c0: 2020 2020 2027 6e61 7669 6761 7469 6f6e       'navigation
+000127d0: 273a 2067 6574 5f6e 6176 6967 6174 696f  ': get_navigatio
+000127e0: 6e28 6974 656d 5b43 6f6e 6669 672e 4344  n(item[Config.CD
+000127f0: 5f4e 4156 4947 4154 494f 4e5d 292c 0a20  _NAVIGATION]),. 
+00012800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012810: 2020 2020 2772 6564 6972 6563 7473 273a      'redirects':
+00012820: 2069 6e74 2869 7465 6d5b 436f 6e66 6967   int(item[Config
+00012830: 2e43 445f 5245 4449 5245 4354 535d 292c  .CD_REDIRECTS]),
+00012840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012850: 2020 2020 2020 2774 6974 6c65 273a 2069        'title': i
+00012860: 7465 6d2e 6765 7428 2764 7427 292c 0a20  tem.get('dt'),. 
+00012870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012880: 2020 2020 2775 746d 5f73 6f75 7263 6527      'utm_source'
+00012890: 3a20 6765 745f 7574 6d5f 736f 7572 6365  : get_utm_source
+000128a0: 2869 7465 6d29 2c0a 2020 2020 2020 2020  (item),.        
+000128b0: 2020 2020 2020 2020 2020 2020 2027 7574               'ut
+000128c0: 6d5f 6d65 6469 756d 273a 2069 7465 6d2e  m_medium': item.
+000128d0: 6765 7428 2775 746d 5f6d 6564 6975 6d27  get('utm_medium'
+000128e0: 2c20 2727 297d 0a0a 2020 2020 6966 2069  , '')}..    if i
+000128f0: 7465 6d2e 6765 7428 2774 2729 203d 3d20  tem.get('t') == 
+00012900: 2770 6167 6576 6965 7727 3a0a 2020 2020  'pageview':.    
+00012910: 2020 2020 7061 7274 7320 3d20 7572 6c70      parts = urlp
+00012920: 6172 7365 2867 6574 5f66 6978 6564 5f75  arse(get_fixed_u
+00012930: 726c 2869 7465 6d2e 6765 7428 2764 6c27  rl(item.get('dl'
+00012940: 2929 290a 2020 2020 2020 2020 7175 6572  ))).        quer
+00012950: 793a 2044 6963 745b 7374 722c 2073 7472  y: Dict[str, str
+00012960: 5d20 3d20 7061 7273 655f 7175 6572 7928  ] = parse_query(
+00012970: 7061 7274 732e 7175 6572 7929 0a20 2020  parts.query).   
+00012980: 2020 2020 2069 6620 7061 7274 732e 7061       if parts.pa
+00012990: 7468 203d 3d20 272f 273a 0a20 2020 2020  th == '/':.     
+000129a0: 2020 2020 2020 2065 7665 6e74 203d 204d         event = M
+000129b0: 6169 6e50 6167 6542 726f 7773 696e 6745  ainPageBrowsingE
+000129c0: 7665 6e74 282a 2a62 726f 7773 696e 675f  vent(**browsing_
+000129d0: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+000129e0: 2020 7265 7475 726e 2065 7665 6e74 0a20    return event. 
+000129f0: 2020 2020 2020 2069 6620 6974 656d 2e67         if item.g
+00012a00: 6574 2827 7061 2729 203d 3d20 2764 6574  et('pa') == 'det
+00012a10: 6169 6c27 3a0a 2020 2020 2020 2020 2020  ail':.          
+00012a20: 2020 6272 6f77 7369 6e67 5f64 6174 615b    browsing_data[
+00012a30: 2770 726f 6475 6374 5f69 6427 5d20 3d20  'product_id'] = 
+00012a40: 6974 656d 2e67 6574 2827 7072 3169 6427  item.get('pr1id'
+00012a50: 290a 2020 2020 2020 2020 2020 2020 6272  ).            br
+00012a60: 6f77 7369 6e67 5f64 6174 615b 2763 6174  owsing_data['cat
+00012a70: 6567 6f72 795f 6964 275d 203d 202d 310a  egory_id'] = -1.
+00012a80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00012a90: 7061 7468 2c20 6361 7420 696e 2043 4154  path, cat in CAT
+00012aa0: 4547 4f52 595f 4d41 502e 6974 656d 7328  EGORY_MAP.items(
+00012ab0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00012ac0: 2020 2069 6620 7061 7274 732e 7061 7468     if parts.path
+00012ad0: 2e73 7461 7274 7377 6974 6828 7061 7468  .startswith(path
+00012ae0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00012af0: 2020 2020 2020 2062 726f 7773 696e 675f         browsing_
+00012b00: 6461 7461 5b27 6361 7465 676f 7279 5f69  data['category_i
+00012b10: 6427 5d20 3d20 6361 740a 2020 2020 2020  d'] = cat.      
+00012b20: 2020 2020 2020 2020 2020 2020 2020 6272                br
+00012b30: 6561 6b0a 0a20 2020 2020 2020 2020 2020  eak..           
+00012b40: 2070 7231 7072 203d 2069 7465 6d2e 6765   pr1pr = item.ge
+00012b50: 7428 2770 7231 7072 272c 2030 290a 2020  t('pr1pr', 0).  
+00012b60: 2020 2020 2020 2020 2020 6272 6f77 7369            browsi
+00012b70: 6e67 5f64 6174 615b 2770 7269 6365 275d  ng_data['price']
+00012b80: 203d 2069 6e74 2870 7231 7072 2920 6966   = int(pr1pr) if
+00012b90: 2070 7231 7072 2021 3d20 274e 614e 2720   pr1pr != 'NaN' 
+00012ba0: 656c 7365 2030 0a20 2020 2020 2020 2020  else 0.         
+00012bb0: 2020 2065 7665 6e74 203d 2050 726f 6475     event = Produ
+00012bc0: 6374 5061 6765 4272 6f77 7369 6e67 4576  ctPageBrowsingEv
+00012bd0: 656e 7428 2a2a 6272 6f77 7369 6e67 5f64  ent(**browsing_d
+00012be0: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00012bf0: 2072 6574 7572 6e20 6576 656e 740a 2020   return event.  
+00012c00: 2020 2020 2020 6966 2070 6172 7473 2e70        if parts.p
+00012c10: 6174 6820 3d3d 2027 2f73 7a61 6b75 7a6c  ath == '/szakuzl
+00012c20: 6574 756e 6b27 3a0a 2020 2020 2020 2020  etunk':.        
+00012c30: 2020 2020 6576 656e 7420 3d20 5368 6f70      event = Shop
+00012c40: 4c69 7374 4272 6f77 7369 6e67 4576 656e  ListBrowsingEven
+00012c50: 7428 2a2a 6272 6f77 7369 6e67 5f64 6174  t(**browsing_dat
+00012c60: 6129 0a20 2020 2020 2020 2020 2020 2072  a).            r
+00012c70: 6574 7572 6e20 6576 656e 740a 2020 2020  eturn event.    
+00012c80: 2020 2020 6966 2070 6172 7473 2e70 6174      if parts.pat
+00012c90: 6820 3d3d 2027 2f72 6566 6c65 7873 686f  h == '/reflexsho
+00012ca0: 702d 7461 7273 6173 6a61 7465 6b6f 6b27  p-tarsasjatekok'
+00012cb0: 3a0a 2020 2020 2020 2020 2020 2020 6576  :.            ev
+00012cc0: 656e 7420 3d20 426f 6172 6447 616d 6573  ent = BoardGames
+00012cd0: 5570 6461 7465 4576 656e 7428 2a2a 6272  UpdateEvent(**br
+00012ce0: 6f77 7369 6e67 5f64 6174 6129 0a20 2020  owsing_data).   
+00012cf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00012d00: 6576 656e 740a 2020 2020 2020 2020 6966  event.        if
+00012d10: 2070 6172 7473 2e70 6174 6820 3d3d 2027   parts.path == '
+00012d20: 2f63 6172 7427 3a0a 2020 2020 2020 2020  /cart':.        
+00012d30: 2020 2020 6576 656e 7420 3d20 4361 7274      event = Cart
+00012d40: 4272 6f77 7369 6e67 4576 656e 7428 2a2a  BrowsingEvent(**
+00012d50: 6272 6f77 7369 6e67 5f64 6174 6129 0a20  browsing_data). 
+00012d60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00012d70: 6e20 6576 656e 740a 2020 2020 2020 2020  n event.        
+00012d80: 6966 2070 6172 7473 2e70 6174 6820 3d3d  if parts.path ==
+00012d90: 2027 2f63 6865 636b 6f75 7427 3a0a 2020   '/checkout':.  
+00012da0: 2020 2020 2020 2020 2020 6966 2070 6172            if par
+00012db0: 7473 2e66 7261 676d 656e 7420 3d3d 2027  ts.fragment == '
+00012dc0: 2f63 7573 746f 6d65 7264 6174 612f 273a  /customerdata/':
+00012dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012de0: 2065 7665 6e74 203d 2043 7573 746f 6d65   event = Custome
+00012df0: 7244 6174 6145 6e74 7279 4272 6f77 7369  rDataEntryBrowsi
+00012e00: 6e67 4576 656e 7428 2a2a 6272 6f77 7369  ngEvent(**browsi
+00012e10: 6e67 5f64 6174 6129 0a20 2020 2020 2020  ng_data).       
+00012e20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00012e30: 6576 656e 740a 2020 2020 2020 2020 2020  event.          
+00012e40: 2020 6966 2070 6172 7473 2e66 7261 676d    if parts.fragm
+00012e50: 656e 7420 3d3d 2027 2f73 6869 7070 696e  ent == '/shippin
+00012e60: 676d 6574 686f 642f 273a 0a20 2020 2020  gmethod/':.     
+00012e70: 2020 2020 2020 2020 2020 2065 7665 6e74             event
+00012e80: 203d 2053 6869 7070 696e 674d 6574 686f   = ShippingMetho
+00012e90: 6442 726f 7773 696e 6745 7665 6e74 282a  dBrowsingEvent(*
+00012ea0: 2a62 726f 7773 696e 675f 6461 7461 290a  *browsing_data).
+00012eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ec0: 7265 7475 726e 2065 7665 6e74 0a20 2020  return event.   
+00012ed0: 2020 2020 2020 2020 2069 6620 7061 7274           if part
+00012ee0: 732e 6672 6167 6d65 6e74 203d 3d20 272f  s.fragment == '/
+00012ef0: 7061 796d 656e 746d 6574 686f 642f 273a  paymentmethod/':
+00012f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012f10: 2065 7665 6e74 203d 2050 6179 6d65 6e74   event = Payment
+00012f20: 4d65 7468 6f64 4272 6f77 7369 6e67 4576  MethodBrowsingEv
+00012f30: 656e 7428 2a2a 6272 6f77 7369 6e67 5f64  ent(**browsing_d
+00012f40: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00012f50: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
+00012f60: 740a 2020 2020 2020 2020 2020 2020 6966  t.            if
+00012f70: 2070 6172 7473 2e66 7261 676d 656e 7420   parts.fragment 
+00012f80: 3d3d 2027 2f63 6f6e 6669 726d 6174 696f  == '/confirmatio
+00012f90: 6e2f 273a 0a20 2020 2020 2020 2020 2020  n/':.           
+00012fa0: 2020 2020 2065 7665 6e74 203d 2043 6f6e       event = Con
+00012fb0: 6669 726d 6174 696f 6e50 6167 6542 726f  firmationPageBro
+00012fc0: 7773 696e 6745 7665 6e74 282a 2a62 726f  wsingEvent(**bro
+00012fd0: 7773 696e 675f 6461 7461 290a 2020 2020  wsing_data).    
+00012fe0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00012ff0: 726e 2065 7665 6e74 0a0a 2020 2020 2020  rn event..      
+00013000: 2020 2020 2020 6576 656e 7420 3d20 4368        event = Ch
+00013010: 6563 6b6f 7574 5061 6765 4272 6f77 7369  eckoutPageBrowsi
+00013020: 6e67 4576 656e 7428 2a2a 6272 6f77 7369  ngEvent(**browsi
+00013030: 6e67 5f64 6174 6129 0a20 2020 2020 2020  ng_data).       
+00013040: 2020 2020 2072 6574 7572 6e20 6576 656e       return even
+00013050: 740a 0a20 2020 2020 2020 2069 6620 7061  t..        if pa
+00013060: 7274 732e 7061 7468 203d 3d20 272f 696e  rts.path == '/in
+00013070: 6465 782e 7068 7027 2061 6e64 2071 7565  dex.php' and que
+00013080: 7279 2e67 6574 2827 726f 7574 6527 2920  ry.get('route') 
+00013090: 3d3d 2027 6368 6563 6b6f 7574 2f73 7563  == 'checkout/suc
+000130a0: 6365 7373 273a 0a20 2020 2020 2020 2020  cess':.         
+000130b0: 2020 2065 7665 6e74 203d 2043 6865 636b     event = Check
+000130c0: 6f75 7453 7563 6365 7373 5061 6765 4272  outSuccessPageBr
+000130d0: 6f77 7369 6e67 4576 656e 7428 2a2a 6272  owsingEvent(**br
+000130e0: 6f77 7369 6e67 5f64 6174 6129 0a20 2020  owsing_data).   
+000130f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013100: 6576 656e 740a 0a20 2020 2020 2020 2069  event..        i
+00013110: 6620 7061 7274 732e 7061 7468 203d 3d20  f parts.path == 
+00013120: 272f 696e 6465 782e 7068 7027 2061 6e64  '/index.php' and
+00013130: 2071 7565 7279 2e67 6574 2827 726f 7574   query.get('rout
+00013140: 6527 2920 3d3d 2027 7769 7368 6c69 7374  e') == 'wishlist
+00013150: 2f77 6973 686c 6973 7427 3a0a 2020 2020  /wishlist':.    
+00013160: 2020 2020 2020 2020 6576 656e 7420 3d20          event = 
+00013170: 5769 7368 4c69 7374 4272 6f77 7369 6e67  WishListBrowsing
+00013180: 4576 656e 7428 2a2a 6272 6f77 7369 6e67  Event(**browsing
+00013190: 5f64 6174 6129 0a20 2020 2020 2020 2020  _data).         
+000131a0: 2020 2072 6574 7572 6e20 6576 656e 740a     return event.
+000131b0: 0a20 2020 2020 2020 2069 6620 7061 7274  .        if part
+000131c0: 732e 7061 7468 203d 3d20 272f 696e 6465  s.path == '/inde
+000131d0: 782e 7068 7027 2061 6e64 2071 7565 7279  x.php' and query
+000131e0: 2e67 6574 2827 726f 7574 6527 2c20 2727  .get('route', ''
+000131f0: 292e 7374 6172 7473 7769 7468 2827 6163  ).startswith('ac
+00013200: 636f 756e 742f 2729 3a0a 2020 2020 2020  count/'):.      
+00013210: 2020 2020 2020 6576 656e 7420 3d20 4163        event = Ac
+00013220: 636f 756e 7450 6167 6542 726f 7773 696e  countPageBrowsin
+00013230: 6745 7665 6e74 282a 2a62 726f 7773 696e  gEvent(**browsin
+00013240: 675f 6461 7461 290a 2020 2020 2020 2020  g_data).        
+00013250: 2020 2020 7265 7475 726e 2065 7665 6e74      return event
+00013260: 0a0a 2020 2020 2020 2020 2320 4361 7465  ..        # Cate
+00013270: 676f 7279 5061 6765 0a20 2020 2020 2020  goryPage.       
+00013280: 2066 6f72 2070 6174 682c 2063 6174 6567   for path, categ
+00013290: 6f72 7920 696e 2043 4154 4547 4f52 595f  ory in CATEGORY_
+000132a0: 4d41 502e 6974 656d 7328 293a 0a20 2020  MAP.items():.   
+000132b0: 2020 2020 2020 2020 2069 6620 7061 7274           if part
+000132c0: 732e 7061 7468 203d 3d20 7061 7468 206f  s.path == path o
+000132d0: 7220 7061 7274 732e 7061 7468 2e66 696e  r parts.path.fin
+000132e0: 6428 7061 7468 2920 3e20 2d31 3a0a 2020  d(path) > -1:.  
+000132f0: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+00013300: 6172 6773 203d 207b 2a2a 6272 6f77 7369  args = {**browsi
+00013310: 6e67 5f64 6174 612c 2027 6361 7465 676f  ng_data, 'catego
+00013320: 7279 5f69 6427 3a20 6361 7465 676f 7279  ry_id': category
+00013330: 2c20 2a2a 6765 745f 7061 6769 6e61 7469  , **get_paginati
+00013340: 6f6e 2871 7565 7279 297d 0a20 2020 2020  on(query)}.     
+00013350: 2020 2020 2020 2020 2020 2065 7665 6e74             event
+00013360: 203d 2043 6174 6567 6f72 7950 6167 6542   = CategoryPageB
+00013370: 726f 7773 696e 6745 7665 6e74 282a 2a6b  rowsingEvent(**k
+00013380: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
+00013390: 2020 2020 2020 2072 6574 7572 6e20 6576         return ev
+000133a0: 656e 740a 0a20 2020 2020 2020 2023 2043  ent..        # C
+000133b0: 6174 6567 6f72 7950 6167 650a 2020 2020  ategoryPage.    
+000133c0: 2020 2020 6966 2070 6172 7473 2e70 6174      if parts.pat
+000133d0: 6820 3d3d 2027 2f69 6e64 6578 2e70 6870  h == '/index.php
+000133e0: 2720 616e 6420 7175 6572 792e 6765 7428  ' and query.get(
+000133f0: 2772 6f75 7465 2729 203d 3d20 2770 726f  'route') == 'pro
+00013400: 6475 6374 2f6c 6973 7427 3a0a 2020 2020  duct/list':.    
+00013410: 2020 2020 2020 2020 6966 2071 7565 7279          if query
+00013420: 2e67 6574 2827 6b65 7977 6f72 6427 2920  .get('keyword') 
+00013430: 6973 204e 6f6e 6520 616e 6420 2863 6174  is None and (cat
+00013440: 5f69 6420 3a3d 2071 7565 7279 2e67 6574  _id := query.get
+00013450: 2827 6361 7465 676f 7279 5f69 6427 2929  ('category_id'))
+00013460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013470: 2020 6361 7465 676f 7279 203d 2043 4154    category = CAT
+00013480: 4547 4f52 595f 4649 4c54 4552 2e67 6574  EGORY_FILTER.get
+00013490: 2869 6e74 2863 6174 5f69 6429 2c20 2d31  (int(cat_id), -1
+000134a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000134b0: 2020 6b77 6172 6773 203d 207b 2a2a 6272    kwargs = {**br
+000134c0: 6f77 7369 6e67 5f64 6174 612c 2027 6361  owsing_data, 'ca
+000134d0: 7465 676f 7279 5f69 6427 3a20 6361 7465  tegory_id': cate
+000134e0: 676f 7279 2c20 2a2a 6765 745f 7061 6769  gory, **get_pagi
+000134f0: 6e61 7469 6f6e 2871 7565 7279 297d 0a20  nation(query)}. 
+00013500: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00013510: 7665 6e74 203d 2043 6174 6567 6f72 7950  vent = CategoryP
+00013520: 6167 6542 726f 7773 696e 6745 7665 6e74  ageBrowsingEvent
+00013530: 282a 2a6b 7761 7267 7329 0a20 2020 2020  (**kwargs).     
+00013540: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00013550: 6e20 6576 656e 740a 0a20 2020 2020 2020  n event..       
+00013560: 2023 2050 7265 6465 6669 6e65 6446 696c   # PredefinedFil
+00013570: 7465 7220 2d3e 2043 6174 6567 6f72 7950  ter -> CategoryP
+00013580: 6167 6520 2d3e 2053 6561 7263 6852 6573  age -> SearchRes
+00013590: 756c 7473 0a20 2020 2020 2020 2069 6620  ults.        if 
+000135a0: 7061 7274 732e 7061 7468 203d 3d20 272f  parts.path == '/
+000135b0: 696e 6465 782e 7068 7027 2061 6e64 2071  index.php' and q
+000135c0: 7565 7279 2e67 6574 2827 726f 7574 6527  uery.get('route'
+000135d0: 2920 3d3d 2027 6669 6c74 6572 273a 0a20  ) == 'filter':. 
+000135e0: 2020 2020 2020 2020 2020 2063 6174 6567             categ
+000135f0: 6f72 7920 3d20 5052 4544 4546 494e 4544  ory = PREDEFINED
+00013600: 5f46 494c 5445 522e 6765 7428 7175 6572  _FILTER.get(quer
+00013610: 792e 6765 7428 2766 696c 7465 7227 292c  y.get('filter'),
+00013620: 202d 3229 0a20 2020 2020 2020 2020 2020   -2).           
+00013630: 2069 6620 6361 7465 676f 7279 203e 202d   if category > -
+00013640: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+00013650: 2020 206b 7761 7267 7320 3d20 7b2a 2a62     kwargs = {**b
+00013660: 726f 7773 696e 675f 6461 7461 2c20 2763  rowsing_data, 'c
+00013670: 6174 6567 6f72 795f 6964 273a 2063 6174  ategory_id': cat
+00013680: 6567 6f72 792c 202a 2a67 6574 5f70 6167  egory, **get_pag
+00013690: 696e 6174 696f 6e28 7175 6572 7929 7d0a  ination(query)}.
+000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136b0: 6576 656e 7420 3d20 5072 6564 6566 696e  event = Predefin
+000136c0: 6564 4669 6c74 6572 4272 6f77 7369 6e67  edFilterBrowsing
+000136d0: 4576 656e 7428 2a2a 6b77 6172 6773 290a  Event(**kwargs).
+000136e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136f0: 7265 7475 726e 2065 7665 6e74 0a0a 2020  return event..  
+00013700: 2020 2020 2020 2020 2020 6966 2071 7565            if que
+00013710: 7279 2e67 6574 2827 6669 6c74 6572 272c  ry.get('filter',
+00013720: 2027 2729 2e73 7461 7274 7377 6974 6828   '').startswith(
+00013730: 2763 6174 6567 6f72 797c 2729 2061 6e64  'category|') and
+00013740: 2071 7565 7279 2e67 6574 2827 6b65 7977   query.get('keyw
+00013750: 6f72 6427 2920 6973 204e 6f6e 653a 0a20  ord') is None:. 
+00013760: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00013770: 756d 6265 7273 203d 2072 652e 6669 6e64  umbers = re.find
+00013780: 616c 6c28 7227 5c64 2b27 2c20 7175 6572  all(r'\d+', quer
+00013790: 792e 6765 7428 2766 696c 7465 7227 2929  y.get('filter'))
+000137a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000137b0: 2063 6174 6567 6f72 7920 3d20 4341 5445   category = CATE
+000137c0: 474f 5259 5f46 494c 5445 522e 6765 7428  GORY_FILTER.get(
+000137d0: 696e 7428 6e75 6d62 6572 735b 305d 292c  int(numbers[0]),
+000137e0: 202d 3229 2069 6620 6e75 6d62 6572 7320   -2) if numbers 
+000137f0: 656c 7365 202d 320a 2020 2020 2020 2020  else -2.        
+00013800: 2020 2020 2020 2020 6966 2063 6174 6567          if categ
+00013810: 6f72 7920 3e20 2d32 3a0a 2020 2020 2020  ory > -2:.      
+00013820: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+00013830: 6172 6773 203d 207b 2a2a 6272 6f77 7369  args = {**browsi
+00013840: 6e67 5f64 6174 612c 2027 6361 7465 676f  ng_data, 'catego
+00013850: 7279 5f69 6427 3a20 6361 7465 676f 7279  ry_id': category
+00013860: 2c20 2a2a 6765 745f 7061 6769 6e61 7469  , **get_paginati
+00013870: 6f6e 2871 7565 7279 297d 0a20 2020 2020  on(query)}.     
+00013880: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00013890: 7665 6e74 203d 2043 6174 6567 6f72 7950  vent = CategoryP
+000138a0: 6167 6542 726f 7773 696e 6745 7665 6e74  ageBrowsingEvent
+000138b0: 282a 2a6b 7761 7267 7329 0a20 2020 2020  (**kwargs).     
+000138c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000138d0: 6574 7572 6e20 6576 656e 740a 0a20 2020  eturn event..   
+000138e0: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
+000138f0: 3d20 7b2a 2a62 726f 7773 696e 675f 6461  = {**browsing_da
+00013900: 7461 2c20 2a2a 6765 745f 7061 6769 6e61  ta, **get_pagina
+00013910: 7469 6f6e 2871 7565 7279 297d 0a20 2020  tion(query)}.   
+00013920: 2020 2020 2020 2020 2065 7665 6e74 203d           event =
+00013930: 2053 6561 7263 6852 6573 756c 7473 4272   SearchResultsBr
+00013940: 6f77 7369 6e67 4576 656e 7428 2a2a 6b77  owsingEvent(**kw
+00013950: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
+00013960: 2020 7265 7475 726e 2065 7665 6e74 0a0a    return event..
+00013970: 2020 2020 2020 2020 2320 5365 6172 6368          # Search
+00013980: 5265 7375 6c74 730a 2020 2020 2020 2020  Results.        
+00013990: 6966 2070 6172 7473 2e70 6174 6820 3d3d  if parts.path ==
+000139a0: 2027 2f6b 6572 6573 6573 2720 6f72 2071   '/kereses' or q
+000139b0: 7565 7279 2e67 6574 2827 726f 7574 6527  uery.get('route'
+000139c0: 2920 3d3d 2027 7072 6f64 7563 742f 6c69  ) == 'product/li
+000139d0: 7374 273a 0a20 2020 2020 2020 2020 2020  st':.           
+000139e0: 206b 7761 7267 7320 3d20 7b2a 2a62 726f   kwargs = {**bro
+000139f0: 7773 696e 675f 6461 7461 2c20 2a2a 6765  wsing_data, **ge
+00013a00: 745f 7061 6769 6e61 7469 6f6e 2871 7565  t_pagination(que
+00013a10: 7279 297d 0a20 2020 2020 2020 2020 2020  ry)}.           
+00013a20: 2065 7665 6e74 203d 2053 6561 7263 6852   event = SearchR
+00013a30: 6573 756c 7473 4272 6f77 7369 6e67 4576  esultsBrowsingEv
+00013a40: 656e 7428 2a2a 6b77 6172 6773 290a 2020  ent(**kwargs).  
+00013a50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013a60: 2065 7665 6e74 0a0a 2020 2020 2020 2020   event..        
+00013a70: 2320 496e 666f 726d 6174 696f 6e50 6167  # InformationPag
+00013a80: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
+00013a90: 7473 2e70 6174 6820 696e 2049 4e46 4f5f  ts.path in INFO_
+00013aa0: 5041 4745 5320 6f72 2071 7565 7279 2e67  PAGES or query.g
+00013ab0: 6574 2827 726f 7574 6527 2920 696e 2049  et('route') in I
+00013ac0: 4e46 4f5f 5041 4745 533a 0a20 2020 2020  NFO_PAGES:.     
+00013ad0: 2020 2020 2020 2065 7665 6e74 203d 2049         event = I
+00013ae0: 6e66 6f72 6d61 7469 6f6e 5061 6765 4272  nformationPageBr
+00013af0: 6f77 7369 6e67 4576 656e 7428 2a2a 6272  owsingEvent(**br
+00013b00: 6f77 7369 6e67 5f64 6174 6129 0a20 2020  owsing_data).   
+00013b10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013b20: 6576 656e 740a 0a20 2020 2020 2020 2065  event..        e
+00013b30: 7665 6e74 203d 2042 726f 7773 696e 6745  vent = BrowsingE
+00013b40: 7665 6e74 282a 2a62 726f 7773 696e 675f  vent(**browsing_
+00013b50: 6461 7461 290a 2020 2020 2020 2020 7265  data).        re
+00013b60: 7475 726e 2065 7665 6e74 0a0a 2020 2020  turn event..    
+00013b70: 6966 2069 7465 6d2e 6765 7428 2774 2729  if item.get('t')
+00013b80: 203d 3d20 2765 7665 6e74 273a 0a20 2020   == 'event':.   
+00013b90: 2020 2020 2069 6620 6974 656d 2e67 6574       if item.get
+00013ba0: 2827 6563 2729 203d 3d20 27c3 8972 7465  ('ec') == '..rte
+00013bb0: 73c3 ad74 c3a9 7320 6bc3 a972 c3a9 7365  s..t..s k..r..se
+00013bc0: 2720 616e 6420 6974 656d 2e67 6574 2827  ' and item.get('
+00013bd0: 6561 2729 203d 3d20 27c3 8972 7465 73c3  ea') == '..rtes.
+00013be0: ad74 c3a9 7320 6bc3 a972 c3a9 7365 2073  .t..s k..r..se s
+00013bf0: 696b 6572 6573 273a 0a20 2020 2020 2020  ikeres':.       
+00013c00: 2020 2020 2065 7665 6e74 203d 2052 6567       event = Reg
+00013c10: 6973 7472 6174 696f 6e45 7665 6e74 2874  istrationEvent(t
+00013c20: 696d 6529 0a20 2020 2020 2020 2020 2020  ime).           
+00013c30: 2072 6574 7572 6e20 6576 656e 740a 2020   return event.  
+00013c40: 2020 2020 2020 6966 2069 7465 6d2e 6765        if item.ge
+00013c50: 7428 2765 6327 2920 3d3d 2027 652d 6361  t('ec') == 'e-ca
+00013c60: 7274 2720 616e 6420 6974 656d 2e67 6574  rt' and item.get
+00013c70: 2827 6561 2729 203d 3d20 2775 7064 6174  ('ea') == 'updat
+00013c80: 6527 3a0a 2020 2020 2020 2020 2020 2020  e':.            
+00013c90: 6461 7461 203d 206a 736f 6e2e 6c6f 6164  data = json.load
+00013ca0: 7328 6974 656d 2e67 6574 2827 656c 2729  s(item.get('el')
+00013cb0: 290a 2020 2020 2020 2020 2020 2020 6465  ).            de
+00013cc0: 6c74 615f 636f 756e 7420 3d20 6461 7461  lta_count = data
+00013cd0: 2e67 6574 2827 6974 656d 436f 756e 7427  .get('itemCount'
+00013ce0: 290a 2020 2020 2020 2020 2020 2020 6465  ).            de
+00013cf0: 6c74 615f 746f 7461 6c20 3d20 726f 756e  lta_total = roun
+00013d00: 6428 6461 7461 2e67 6574 2827 746f 7461  d(data.get('tota
+00013d10: 6c27 292c 2032 290a 2020 2020 2020 2020  l'), 2).        
+00013d20: 2020 2020 6576 656e 7420 3d20 4361 7274      event = Cart
+00013d30: 4d6f 6469 6679 4576 656e 7428 7469 6d65  ModifyEvent(time
+00013d40: 2c20 6465 6c74 615f 636f 756e 742c 2064  , delta_count, d
+00013d50: 656c 7461 5f74 6f74 616c 290a 2020 2020  elta_total).    
+00013d60: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013d70: 7665 6e74 0a20 2020 2020 2020 2069 6620  vent.        if 
+00013d80: 6974 656d 2e67 6574 2827 6563 2729 203d  item.get('ec') =
+00013d90: 3d20 274f 7074 694d 6f6e 6b27 3a0a 2020  = 'OptiMonk':.  
+00013da0: 2020 2020 2020 2020 2020 6966 2069 7465            if ite
+00013db0: 6d2e 6765 7428 2765 6127 2920 3d3d 2027  m.get('ea') == '
+00013dc0: 7368 6f77 6e27 3a0a 2020 2020 2020 2020  shown':.        
+00013dd0: 2020 2020 2020 2020 6576 656e 7420 3d20          event = 
+00013de0: 436f 7570 6f6e 4f66 6665 7265 6445 7665  CouponOfferedEve
+00013df0: 6e74 2874 696d 652c 2069 7465 6d2e 6765  nt(time, item.ge
+00013e00: 7428 2765 6c27 2929 0a20 2020 2020 2020  t('el')).       
+00013e10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013e20: 6576 656e 740a 2020 2020 2020 2020 2020  event.          
+00013e30: 2020 6966 2069 7465 6d2e 6765 7428 2765    if item.get('e
+00013e40: 6127 2920 3d3d 2027 6669 6c6c 6564 273a  a') == 'filled':
+00013e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013e60: 2065 7665 6e74 203d 2043 6f75 706f 6e41   event = CouponA
+00013e70: 6363 6570 7465 6445 7665 6e74 2874 696d  cceptedEvent(tim
+00013e80: 652c 2069 7465 6d2e 6765 7428 2765 6c27  e, item.get('el'
+00013e90: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00013ea0: 2020 2072 6574 7572 6e20 6576 656e 740a     return event.
+00013eb0: 0a20 2020 2065 7665 6e74 203d 2053 7973  .    event = Sys
+00013ec0: 7465 6d45 7665 6e74 2874 696d 6529 0a20  temEvent(time). 
+00013ed0: 2020 2072 6574 7572 6e20 6576 656e 740a     return event.
+00013ee0: 0a0a 6465 6620 6765 745f 6669 7865 645f  ..def get_fixed_
+00013ef0: 7572 6c28 7572 6c3a 2073 7472 2920 2d3e  url(url: str) ->
+00013f00: 2073 7472 3a0a 2020 2020 7031 203d 2075   str:.    p1 = u
+00013f10: 726c 2e66 696e 6428 273f 2729 0a20 2020  rl.find('?').   
+00013f20: 2070 3220 3d20 7572 6c2e 6669 6e64 2827   p2 = url.find('
+00013f30: 2627 290a 2020 2020 6966 2070 3120 3d3d  &').    if p1 ==
+00013f40: 202d 3120 616e 6420 7032 203e 202d 313a   -1 and p2 > -1:
+00013f50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013f60: 7572 6c5b 3a70 325d 202b 2027 3f27 202b  url[:p2] + '?' +
+00013f70: 2075 726c 5b70 322b 313a 5d0a 2020 2020   url[p2+1:].    
+00013f80: 7265 7475 726e 2075 726c 5b3a 7032 5d20  return url[:p2] 
+00013f90: 2b20 7572 6c5b 7031 3a5d 202b 2075 726c  + url[p1:] + url
+00013fa0: 5b70 323a 7031 5d20 6966 202d 3120 3c20  [p2:p1] if -1 < 
+00013fb0: 7032 203c 2070 3120 656c 7365 2075 726c  p2 < p1 else url
+00013fc0: 0a0a 0a64 6566 2070 6172 7365 5f71 7565  ...def parse_que
+00013fd0: 7279 2871 7565 7279 3a20 7374 7229 202d  ry(query: str) -
+00013fe0: 3e20 4469 6374 5b73 7472 2c20 7374 725d  > Dict[str, str]
+00013ff0: 3a0a 2020 2020 7265 7475 726e 207b 7d20  :.    return {} 
+00014000: 6966 2071 7565 7279 2e73 7472 6970 2829  if query.strip()
+00014010: 203d 3d20 2727 2065 6c73 6520 7b6b 3a20   == '' else {k: 
+00014020: 765b 305d 2066 6f72 206b 2c20 7620 696e  v[0] for k, v in
+00014030: 2070 6172 7365 5f71 7328 756e 7175 6f74   parse_qs(unquot
+00014040: 6528 7175 6572 7929 292e 6974 656d 7328  e(query)).items(
+00014050: 297d 0a0a 0a64 6566 2067 6574 5f70 6167  )}...def get_pag
+00014060: 696e 6174 696f 6e28 7175 6572 793a 2044  ination(query: D
+00014070: 6963 7429 202d 3e20 4469 6374 3a0a 2020  ict) -> Dict:.  
+00014080: 2020 7061 6769 6e61 7469 6f6e 203d 207b    pagination = {
+00014090: 2270 6167 6522 3a20 6765 745f 7061 6765  "page": get_page
+000140a0: 2871 7565 7279 2e67 6574 2827 7061 6765  (query.get('page
+000140b0: 272c 2027 3127 2929 7d0a 2020 2020 6966  ', '1'))}.    if
+000140c0: 2027 6669 6c74 6572 5b6f 7264 6572 5d27   'filter[order]'
+000140d0: 2069 6e20 7175 6572 792e 6b65 7973 2829   in query.keys()
+000140e0: 3a0a 2020 2020 2020 2020 7061 6769 6e61  :.        pagina
+000140f0: 7469 6f6e 5b22 736f 7274 225d 203d 2067  tion["sort"] = g
+00014100: 6574 5f73 6f72 7428 7175 6572 792e 6765  et_sort(query.ge
+00014110: 7428 2766 696c 7465 725b 6f72 6465 725d  t('filter[order]
+00014120: 2729 290a 2020 2020 656c 7365 3a0a 2020  ')).    else:.  
+00014130: 2020 2020 2020 7061 6769 6e61 7469 6f6e        pagination
+00014140: 5b22 736f 7274 225d 203d 2067 6574 5f73  ["sort"] = get_s
+00014150: 6f72 7428 2772 656c 6576 616e 6365 2729  ort('relevance')
+00014160: 0a20 2020 2072 6574 7572 6e20 7061 6769  .    return pagi
+00014170: 6e61 7469 6f6e 0a                        nation.
```

